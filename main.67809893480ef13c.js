"use strict";(self.webpackChunkaquarium_manager=self.webpackChunkaquarium_manager||[]).push([[179],{2011:(_t,ke,F)=>{F.d(ke,{Dh:()=>we,GT:()=>ye,cc:()=>Ae,hO:()=>Le,on:()=>$,pX:()=>ge,xv:()=>_e});var _=F(4650),ne=F(127),B=F(880);_t=F.hmd(_t);const ue=["ngOnDestroy"],ge=(fe,ft,lt,Pe={})=>new Proxy(fe,{get:(Te,xe)=>lt.runOutsideAngular(()=>{var Ze;if(fe[xe])return!(null===(Ze=Pe?.spy)||void 0===Ze)&&Ze.get&&Pe.spy.get(xe,fe[xe]),fe[xe];if(ue.indexOf(xe)>-1)return()=>{};const $e=ft.toPromise().then(j=>{const Ce=j&&j[xe];return"function"==typeof Ce?Ce.bind(j):Ce&&Ce.then?Ce.then(J=>lt.run(()=>J)):lt.run(()=>Ce)});return new Proxy(()=>{},{get:(j,Ce)=>$e[Ce],apply:(j,Ce,J)=>$e.then(re=>{var le;const ie=re&&re(...J);return!(null===(le=Pe?.spy)||void 0===le)&&le.apply&&Pe.spy.apply(xe,J,ie),ie})})})}),ye=(fe,ft)=>{ft.forEach(lt=>{Object.getOwnPropertyNames(lt.prototype||lt).forEach(Pe=>{Object.defineProperty(fe.prototype,Pe,Object.getOwnPropertyDescriptor(lt.prototype||lt,Pe))})})};class ce{constructor(ft){return ft}}const we=new _.OlP("angularfire2.app.options"),_e=new _.OlP("angularfire2.app.name");function $(fe,ft,lt){const Te="object"==typeof lt&&lt||{};Te.name=Te.name||"string"==typeof lt&&lt||"[DEFAULT]";const Ze=ne.Z.apps.filter($e=>$e&&$e.name===Te.name)[0]||ft.runOutsideAngular(()=>ne.Z.initializeApp(fe,Te));try{JSON.stringify(fe)!==JSON.stringify(Ze.options)&&W("error",`${Ze.name} Firebase App already initialized with different options${_t.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new ce(Ze)}const W=(fe,...ft)=>{(0,_.X6Q)()&&typeof console<"u"&&console[fe](...ft)},te={provide:ce,useFactory:$,deps:[we,_.R0b,[new _.FiY,_e]]};let Le=(()=>{class fe{constructor(lt){ne.Z.registerVersion("angularfire",B.q4.full,"core"),ne.Z.registerVersion("angularfire",B.q4.full,"app-compat"),ne.Z.registerVersion("angular",_.q4F.full,lt.toString())}static initializeApp(lt,Pe){return{ngModule:fe,providers:[{provide:we,useValue:lt},{provide:_e,useValue:Pe}]}}}return fe.\u0275fac=function(lt){return new(lt||fe)(_.LFG(_.Lbi))},fe.\u0275mod=_.oAB({type:fe}),fe.\u0275inj=_.cJS({providers:[te]}),fe})();function Ae(fe,ft,lt,Pe,Te){const[,xe,Ze]=globalThis.\u0275AngularfireInstanceCache.find($e=>$e[0]===fe)||[];if(xe)return function De(fe,ft){try{return fe.toString()===ft.toString()}catch{return fe===ft}}(Te,Ze)||(Ee("error",`${ft} was already initialized on the ${lt} Firebase App with different settings.${it?" You may need to reload as Firebase is not HMR aware.":""}`),Ee("warn",{is:Te,was:Ze})),xe;{const $e=Pe();return globalThis.\u0275AngularfireInstanceCache.push([fe,$e,Te]),$e}}const it=!!_t.hot,Ee=(fe,...ft)=>{(0,_.X6Q)()&&typeof console<"u"&&console[fe](...ft)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},880:(_t,ke,F)=>{F.d(ke,{q4:()=>al,iC:()=>ll,fc:()=>Kc,HU:()=>qc,vb:()=>ou,JM:()=>Xn});var _=F(4650),ne=F(5867),B=F(5861),ue=F(9681),ge=F(2090),ye=F(4859),ce=F(1877);F(2833);const _e="@firebase/remote-config",$="0.3.11",Ae=new ge.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class mt{constructor(O,K,de,Ue){this.client=O,this.storage=K,this.storageCache=de,this.logger=Ue}isCachedDataFresh(O,K){if(!K)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const de=Date.now()-K,Ue=de<=O;return this.logger.debug(`Config fetch cache check. Cache age millis: ${de}. Cache max age millis (minimumFetchIntervalMillis setting): ${O}. Is cache hit: ${Ue}.`),Ue}fetch(O){var K=this;return(0,B.Z)(function*(){const[de,Ue]=yield Promise.all([K.storage.getLastSuccessfulFetchTimestampMillis(),K.storage.getLastSuccessfulFetchResponse()]);if(Ue&&K.isCachedDataFresh(O.cacheMaxAgeMillis,de))return Ue;O.eTag=Ue&&Ue.eTag;const tt=yield K.client.fetch(O),gt=[K.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===tt.status&&gt.push(K.storage.setLastSuccessfulFetchResponse(tt)),yield Promise.all(gt),tt})()}}function rn(N=navigator){return N.languages&&N.languages[0]||N.language}class Bt{constructor(O,K,de,Ue,tt,gt){this.firebaseInstallations=O,this.sdkVersion=K,this.namespace=de,this.projectId=Ue,this.apiKey=tt,this.appId=gt}fetch(O){var K=this;return(0,B.Z)(function*(){var de,Ue,tt;const[gt,ln]=yield Promise.all([K.firebaseInstallations.getId(),K.firebaseInstallations.getToken()]),Me=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${K.projectId}/namespaces/${K.namespace}:fetch?key=${K.apiKey}`,Et={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":O.eTag||"*"},Vt={sdk_version:K.sdkVersion,app_instance_id:gt,app_instance_id_token:ln,app_id:K.appId,language_code:rn()},Ds={method:"POST",headers:Et,body:JSON.stringify(Vt)},Hn=fetch(Me,Ds),wa=new Promise((no,ro)=>{O.signal.addEventListener(()=>{const Ia=new Error("The operation was aborted.");Ia.name="AbortError",ro(Ia)})});let Wi;try{yield Promise.race([Hn,wa]),Wi=yield Hn}catch(no){let ro="fetch-client-network";throw"AbortError"===(null===(de=no)||void 0===de?void 0:de.name)&&(ro="fetch-timeout"),Ae.create(ro,{originalErrorMessage:null===(Ue=no)||void 0===Ue?void 0:Ue.message})}let Gr=Wi.status;const uu=Wi.headers.get("ETag")||void 0;let Ea,to;if(200===Wi.status){let no;try{no=yield Wi.json()}catch(ro){throw Ae.create("fetch-client-parse",{originalErrorMessage:null===(tt=ro)||void 0===tt?void 0:tt.message})}Ea=no.entries,to=no.state}if("INSTANCE_STATE_UNSPECIFIED"===to?Gr=500:"NO_CHANGE"===to?Gr=304:("NO_TEMPLATE"===to||"EMPTY_CONFIG"===to)&&(Ea={}),304!==Gr&&200!==Gr)throw Ae.create("fetch-status",{httpStatus:Gr});return{status:Gr,eTag:uu,config:Ea}})()}}class ar{constructor(O,K){this.client=O,this.storage=K}fetch(O){var K=this;return(0,B.Z)(function*(){const de=(yield K.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return K.attemptFetch(O,de)})()}attemptFetch(O,{throttleEndTimeMillis:K,backoffCount:de}){var Ue=this;return(0,B.Z)(function*(){yield function Xe(N,O){return new Promise((K,de)=>{const Ue=Math.max(O-Date.now(),0),tt=setTimeout(K,Ue);N.addEventListener(()=>{clearTimeout(tt),de(Ae.create("fetch-throttle",{throttleEndTimeMillis:O}))})})}(O.signal,K);try{const tt=yield Ue.client.fetch(O);return yield Ue.storage.deleteThrottleMetadata(),tt}catch(tt){if(!function yn(N){if(!(N instanceof ge.ZR&&N.customData))return!1;const O=Number(N.customData.httpStatus);return 429===O||500===O||503===O||504===O}(tt))throw tt;const gt={throttleEndTimeMillis:Date.now()+(0,ge.$s)(de),backoffCount:de+1};return yield Ue.storage.setThrottleMetadata(gt),Ue.attemptFetch(O,gt)}})()}}class rr{constructor(O,K,de,Ue,tt){this.app=O,this._client=K,this._storageCache=de,this._storage=Ue,this._logger=tt,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function St(N,O){var K;const de=N.target.error||void 0;return Ae.create(O,{originalErrorMessage:de&&(null===(K=de)||void 0===K?void 0:K.message)})}const Zt="app_namespace_store";class On{constructor(O,K,de,Ue=function pr(){return new Promise((N,O)=>{var K;try{const de=indexedDB.open("firebase_remote_config",1);de.onerror=Ue=>{O(St(Ue,"storage-open"))},de.onsuccess=Ue=>{N(Ue.target.result)},de.onupgradeneeded=Ue=>{0===Ue.oldVersion&&Ue.target.result.createObjectStore(Zt,{keyPath:"compositeKey"})}}catch(de){O(Ae.create("storage-open",{originalErrorMessage:null===(K=de)||void 0===K?void 0:K.message}))}})}()){this.appId=O,this.appName=K,this.namespace=de,this.openDbPromise=Ue}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(O){return this.set("last_fetch_status",O)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(O){return this.set("last_successful_fetch_timestamp_millis",O)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(O){return this.set("last_successful_fetch_response",O)}getActiveConfig(){return this.get("active_config")}setActiveConfig(O){return this.set("active_config",O)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(O){return this.set("active_config_etag",O)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(O){return this.set("throttle_metadata",O)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(O){var K=this;return(0,B.Z)(function*(){const de=yield K.openDbPromise;return new Promise((Ue,tt)=>{var gt;const ir=de.transaction([Zt],"readonly").objectStore(Zt),Me=K.createCompositeKey(O);try{const Et=ir.get(Me);Et.onerror=Vt=>{tt(St(Vt,"storage-get"))},Et.onsuccess=Vt=>{const Ds=Vt.target.result;Ue(Ds?Ds.value:void 0)}}catch(Et){tt(Ae.create("storage-get",{originalErrorMessage:null===(gt=Et)||void 0===gt?void 0:gt.message}))}})})()}set(O,K){var de=this;return(0,B.Z)(function*(){const Ue=yield de.openDbPromise;return new Promise((tt,gt)=>{var ln;const Me=Ue.transaction([Zt],"readwrite").objectStore(Zt),Et=de.createCompositeKey(O);try{const Vt=Me.put({compositeKey:Et,value:K});Vt.onerror=Ds=>{gt(St(Ds,"storage-set"))},Vt.onsuccess=()=>{tt()}}catch(Vt){gt(Ae.create("storage-set",{originalErrorMessage:null===(ln=Vt)||void 0===ln?void 0:ln.message}))}})})()}delete(O){var K=this;return(0,B.Z)(function*(){const de=yield K.openDbPromise;return new Promise((Ue,tt)=>{var gt;const ir=de.transaction([Zt],"readwrite").objectStore(Zt),Me=K.createCompositeKey(O);try{const Et=ir.delete(Me);Et.onerror=Vt=>{tt(St(Vt,"storage-delete"))},Et.onsuccess=()=>{Ue()}}catch(Et){tt(Ae.create("storage-delete",{originalErrorMessage:null===(gt=Et)||void 0===gt?void 0:gt.message}))}})})()}createCompositeKey(O){return[this.appId,this.appName,this.namespace,O].join()}}class Yr{constructor(O){this.storage=O}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var O=this;return(0,B.Z)(function*(){const K=O.storage.getLastFetchStatus(),de=O.storage.getLastSuccessfulFetchTimestampMillis(),Ue=O.storage.getActiveConfig(),tt=yield K;tt&&(O.lastFetchStatus=tt);const gt=yield de;gt&&(O.lastSuccessfulFetchTimestampMillis=gt);const ln=yield Ue;ln&&(O.activeConfig=ln)})()}setLastFetchStatus(O){return this.lastFetchStatus=O,this.storage.setLastFetchStatus(O)}setLastSuccessfulFetchTimestampMillis(O){return this.lastSuccessfulFetchTimestampMillis=O,this.storage.setLastSuccessfulFetchTimestampMillis(O)}setActiveConfig(O){return this.activeConfig=O,this.storage.setActiveConfig(O)}}function xi(){return st.apply(this,arguments)}function st(){return(st=(0,B.Z)(function*(){if(!(0,ge.hl)())return!1;try{return yield(0,ge.eu)()}catch{return!1}})).apply(this,arguments)}!function gr(){(0,ue._registerComponent)(new ye.wA("remote-config",function N(O,{instanceIdentifier:K}){const de=O.getProvider("app").getImmediate(),Ue=O.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ae.create("registration-window");if(!(0,ge.hl)())throw Ae.create("indexed-db-unavailable");const{projectId:tt,apiKey:gt,appId:ln}=de.options;if(!tt)throw Ae.create("registration-project-id");if(!gt)throw Ae.create("registration-api-key");if(!ln)throw Ae.create("registration-app-id");const ir=new On(ln,de.name,K=K||"firebase"),Me=new Yr(ir),Et=new ce.Yd(_e);Et.logLevel=ce.in.ERROR;const Vt=new Bt(Ue,ue.SDK_VERSION,K,tt,gt,ln),Ds=new ar(Vt,ir),Hn=new mt(Ds,ir,Me,Et),wa=new rr(de,Hn,Me,ir,Et);return function Ze(N){const O=(0,ge.m9)(N);O._initializePromise||(O._initializePromise=O._storageCache.loadFromStorage().then(()=>{O._isInitializationComplete=!0}))}(wa),wa},"PUBLIC").setMultipleInstances(!0)),(0,ue.registerVersion)(_e,$),(0,ue.registerVersion)(_e,$,"esm2017")}();var Pn=F(8766);const di="/firebase-messaging-sw.js",xn="/firebase-cloud-messaging-push-scope",jr="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Fn="google.c.a.c_id",Gn="google.c.a.c_l",fn="google.c.a.ts",yt="google.c.a.e";var Gt=(()=>{return(N=Gt||(Gt={})).PUSH_RECEIVED="push-received",N.NOTIFICATION_CLICKED="notification-clicked",Gt;var N})();function wn(N){const O=new Uint8Array(N);return btoa(String.fromCharCode(...O)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function mr(N){const K=(N+"=".repeat((4-N.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),de=atob(K),Ue=new Uint8Array(de.length);for(let tt=0;tt<de.length;++tt)Ue[tt]=de.charCodeAt(tt);return Ue}const lr="fcm_token_details_db",Qr="fcm_token_object_Store";function un(N){return Dr.apply(this,arguments)}function Dr(){return Dr=(0,B.Z)(function*(N){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(tt=>tt.name).includes(lr))return null;let O=null;return(yield(0,Pn.X3)(lr,5,{upgrade:(de=(0,B.Z)(function*(Ue,tt,gt,ln){var ir;if(tt<2||!Ue.objectStoreNames.contains(Qr))return;const Me=ln.objectStore(Qr),Et=yield Me.index("fcmSenderId").get(N);if(yield Me.clear(),Et)if(2===tt){const Vt=Et;if(!Vt.auth||!Vt.p256dh||!Vt.endpoint)return;O={token:Vt.fcmToken,createTime:null!==(ir=Vt.createTime)&&void 0!==ir?ir:Date.now(),subscriptionOptions:{auth:Vt.auth,p256dh:Vt.p256dh,endpoint:Vt.endpoint,swScope:Vt.swScope,vapidKey:"string"==typeof Vt.vapidKey?Vt.vapidKey:wn(Vt.vapidKey)}}}else if(3===tt){const Vt=Et;O={token:Vt.fcmToken,createTime:Vt.createTime,subscriptionOptions:{auth:wn(Vt.auth),p256dh:wn(Vt.p256dh),endpoint:Vt.endpoint,swScope:Vt.swScope,vapidKey:wn(Vt.vapidKey)}}}else if(4===tt){const Vt=Et;O={token:Vt.fcmToken,createTime:Vt.createTime,subscriptionOptions:{auth:wn(Vt.auth),p256dh:wn(Vt.p256dh),endpoint:Vt.endpoint,swScope:Vt.swScope,vapidKey:wn(Vt.vapidKey)}}}}),function(tt,gt,ln,ir){return de.apply(this,arguments)})})).close(),yield(0,Pn.Lj)(lr),yield(0,Pn.Lj)("fcm_vapid_details_db"),yield(0,Pn.Lj)("undefined"),sn(O)?O:null;var de}),Dr.apply(this,arguments)}function sn(N){if(!N||!N.subscriptionOptions)return!1;const{subscriptionOptions:O}=N;return"number"==typeof N.createTime&&N.createTime>0&&"string"==typeof N.token&&N.token.length>0&&"string"==typeof O.auth&&O.auth.length>0&&"string"==typeof O.p256dh&&O.p256dh.length>0&&"string"==typeof O.endpoint&&O.endpoint.length>0&&"string"==typeof O.swScope&&O.swScope.length>0&&"string"==typeof O.vapidKey&&O.vapidKey.length>0}const V="firebase-messaging-store";let G=null;function z(){return G||(G=(0,Pn.X3)("firebase-messaging-database",1,{upgrade:(N,O)=>{0===O&&N.createObjectStore(V)}})),G}function Ne(N){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,B.Z)(function*(N){const O=pe(N),de=yield(yield z()).transaction(V).objectStore(V).get(O);if(de)return de;{const Ue=yield un(N.appConfig.senderId);if(Ue)return yield ht(N,Ue),Ue}})).apply(this,arguments)}function ht(N,O){return En.apply(this,arguments)}function En(){return(En=(0,B.Z)(function*(N,O){const K=pe(N),Ue=(yield z()).transaction(V,"readwrite");return yield Ue.objectStore(V).put(O,K),yield Ue.done,O})).apply(this,arguments)}function pn(N){return ae.apply(this,arguments)}function ae(){return(ae=(0,B.Z)(function*(N){const O=pe(N),de=(yield z()).transaction(V,"readwrite");yield de.objectStore(V).delete(O),yield de.done})).apply(this,arguments)}function pe({appConfig:N}){return N.appId}const Be=new ge.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Qe(N,O){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,B.Z)(function*(N,O){var K;const de=yield Ln(N),Ue=mn(O),tt={method:"POST",headers:de,body:JSON.stringify(Ue)};let gt;try{gt=yield(yield fetch(Lt(N.appConfig),tt)).json()}catch(ln){throw Be.create("token-subscribe-failed",{errorInfo:null===(K=ln)||void 0===K?void 0:K.toString()})}if(gt.error)throw Be.create("token-subscribe-failed",{errorInfo:gt.error.message});if(!gt.token)throw Be.create("token-subscribe-no-token");return gt.token})).apply(this,arguments)}function At(N,O){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,B.Z)(function*(N,O){var K;const de=yield Ln(N),Ue=mn(O.subscriptionOptions),tt={method:"PATCH",headers:de,body:JSON.stringify(Ue)};let gt;try{gt=yield(yield fetch(`${Lt(N.appConfig)}/${O.token}`,tt)).json()}catch(ln){throw Be.create("token-update-failed",{errorInfo:null===(K=ln)||void 0===K?void 0:K.toString()})}if(gt.error)throw Be.create("token-update-failed",{errorInfo:gt.error.message});if(!gt.token)throw Be.create("token-update-no-token");return gt.token})).apply(this,arguments)}function Oe(N,O){return at.apply(this,arguments)}function at(){return(at=(0,B.Z)(function*(N,O){var K;const Ue={method:"DELETE",headers:yield Ln(N)};try{const gt=yield(yield fetch(`${Lt(N.appConfig)}/${O}`,Ue)).json();if(gt.error)throw Be.create("token-unsubscribe-failed",{errorInfo:gt.error.message})}catch(tt){throw Be.create("token-unsubscribe-failed",{errorInfo:null===(K=tt)||void 0===K?void 0:K.toString()})}})).apply(this,arguments)}function Lt({projectId:N}){return`https://fcmregistrations.googleapis.com/v1/projects/${N}/registrations`}function Ln(N){return Yn.apply(this,arguments)}function Yn(){return(Yn=(0,B.Z)(function*({appConfig:N,installations:O}){const K=yield O.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":N.apiKey,"x-goog-firebase-installations-auth":`FIS ${K}`})})).apply(this,arguments)}function mn({p256dh:N,auth:O,endpoint:K,vapidKey:de}){const Ue={web:{endpoint:K,auth:O,p256dh:N}};return de!==jr&&(Ue.web.applicationPubKey=de),Ue}const Ri=6048e5;function Rn(N){return $i.apply(this,arguments)}function $i(){return($i=(0,B.Z)(function*(N){const O=yield Yt(N.swRegistration,N.vapidKey),K={vapidKey:N.vapidKey,swScope:N.swRegistration.scope,endpoint:O.endpoint,auth:wn(O.getKey("auth")),p256dh:wn(O.getKey("p256dh"))},de=yield Ne(N.firebaseDependencies);if(de){if(Qn(de.subscriptionOptions,K))return Date.now()>=de.createTime+Ri?X(N,{token:de.token,createTime:Date.now(),subscriptionOptions:K}):de.token;try{yield Oe(N.firebaseDependencies,de.token)}catch(Ue){console.warn(Ue)}return He(N.firebaseDependencies,K)}return He(N.firebaseDependencies,K)})).apply(this,arguments)}function vs(N){return $t.apply(this,arguments)}function $t(){return($t=(0,B.Z)(function*(N){const O=yield Ne(N.firebaseDependencies);O&&(yield Oe(N.firebaseDependencies,O.token),yield pn(N.firebaseDependencies));const K=yield N.swRegistration.pushManager.getSubscription();return!K||K.unsubscribe()})).apply(this,arguments)}function X(N,O){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,B.Z)(function*(N,O){try{const K=yield At(N.firebaseDependencies,O),de=Object.assign(Object.assign({},O),{token:K,createTime:Date.now()});return yield ht(N.firebaseDependencies,de),K}catch(K){throw yield vs(N),K}})).apply(this,arguments)}function He(N,O){return pt.apply(this,arguments)}function pt(){return(pt=(0,B.Z)(function*(N,O){const de={token:yield Qe(N,O),createTime:Date.now(),subscriptionOptions:O};return yield ht(N,de),de.token})).apply(this,arguments)}function Yt(N,O){return hn.apply(this,arguments)}function hn(){return(hn=(0,B.Z)(function*(N,O){return(yield N.pushManager.getSubscription())||N.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:mr(O)})})).apply(this,arguments)}function Qn(N,O){return O.vapidKey===N.vapidKey&&O.endpoint===N.endpoint&&O.auth===N.auth&&O.p256dh===N.p256dh}function In(N){const O={from:N.from,collapseKey:N.collapse_key,messageId:N.fcmMessageId};return function Xr(N,O){if(!O.notification)return;N.notification={};const K=O.notification.title;K&&(N.notification.title=K);const de=O.notification.body;de&&(N.notification.body=de);const Ue=O.notification.image;Ue&&(N.notification.image=Ue)}(O,N),function xr(N,O){!O.data||(N.data=O.data)}(O,N),function bn(N,O){var K,de,Ue,tt,gt;if(!(O.fcmOptions||null!==(K=O.notification)&&void 0!==K&&K.click_action))return;N.fcmOptions={};const ln=null!==(Ue=null===(de=O.fcmOptions)||void 0===de?void 0:de.link)&&void 0!==Ue?Ue:null===(tt=O.notification)||void 0===tt?void 0:tt.click_action;ln&&(N.fcmOptions.link=ln);const ir=null===(gt=O.fcmOptions)||void 0===gt?void 0:gt.analytics_label;ir&&(N.fcmOptions.analyticsLabel=ir)}(O,N),O}function rl(N){return"object"==typeof N&&!!N&&Fn in N}function il(N,O){const K=[];for(let de=0;de<N.length;de++)K.push(N.charAt(de)),de<O.length&&K.push(O.charAt(de));return K.join("")}function ga(N){return Be.create("missing-app-config-values",{valueName:N})}il("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),il("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class ws{constructor(O,K,de){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Ue=function Qs(N){if(!N||!N.options)throw ga("App Configuration Object");if(!N.name)throw ga("App Name");const O=["projectId","apiKey","appId","messagingSenderId"],{options:K}=N;for(const de of O)if(!K[de])throw ga(de);return{appName:N.name,projectId:K.projectId,apiKey:K.apiKey,appId:K.appId,senderId:K.messagingSenderId}}(O);this.firebaseDependencies={app:O,appConfig:Ue,installations:K,analyticsProvider:de}}_delete(){return Promise.resolve()}}function us(N){return Ni.apply(this,arguments)}function Ni(){return(Ni=(0,B.Z)(function*(N){var O;try{N.swRegistration=yield navigator.serviceWorker.register(di,{scope:xn}),N.swRegistration.update().catch(()=>{})}catch(K){throw Be.create("failed-service-worker-registration",{browserErrorMessage:null===(O=K)||void 0===O?void 0:O.message})}})).apply(this,arguments)}function Sr(N,O){return ma.apply(this,arguments)}function ma(){return(ma=(0,B.Z)(function*(N,O){if(!O&&!N.swRegistration&&(yield us(N)),O||!N.swRegistration){if(!(O instanceof ServiceWorkerRegistration))throw Be.create("invalid-sw-registration");N.swRegistration=O}})).apply(this,arguments)}function $r(N,O){return Ar.apply(this,arguments)}function Ar(){return(Ar=(0,B.Z)(function*(N,O){O?N.vapidKey=O:N.vapidKey||(N.vapidKey=jr)})).apply(this,arguments)}function Es(){return(Es=(0,B.Z)(function*(N,O){if(!navigator)throw Be.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Be.create("permission-blocked");return yield $r(N,O?.vapidKey),yield Sr(N,O?.serviceWorkerRegistration),Rn(N)})).apply(this,arguments)}function tu(N,O,K){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,B.Z)(function*(N,O,K){const de=Bc(O);(yield N.firebaseDependencies.analyticsProvider.get()).logEvent(de,{message_id:K[Fn],message_name:K[Gn],message_time:K[fn],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Bc(N){switch(N){case Gt.NOTIFICATION_CLICKED:return"notification_open";case Gt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function sl(){return(sl=(0,B.Z)(function*(N,O){const K=O.data;if(!K.isFirebaseMessaging)return;N.onMessageHandler&&K.messageType===Gt.PUSH_RECEIVED&&("function"==typeof N.onMessageHandler?N.onMessageHandler(In(K)):N.onMessageHandler.next(In(K)));const de=K.data;rl(de)&&"1"===de[yt]&&(yield tu(N,K.messageType,de))})).apply(this,arguments)}const nu="@firebase/messaging",_r=N=>{const O=new ws(N.getProvider("app").getImmediate(),N.getProvider("installations-internal").getImmediate(),N.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",K=>function Vc(N,O){return sl.apply(this,arguments)}(O,K)),O},jc=N=>{const O=N.getProvider("messaging").getImmediate();return{getToken:de=>function No(N,O){return Es.apply(this,arguments)}(O,de)}};function Hi(){return $c.apply(this,arguments)}function $c(){return($c=(0,B.Z)(function*(){try{yield(0,ge.eu)()}catch{return!1}return typeof window<"u"&&(0,ge.hl)()&&(0,ge.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function og(){(0,ue._registerComponent)(new ye.wA("messaging",_r,"PUBLIC")),(0,ue._registerComponent)(new ye.wA("messaging-internal",jc,"PRIVATE")),(0,ue.registerVersion)(nu,"0.9.16"),(0,ue.registerVersion)(nu,"0.9.16","esm2017")}();var Is=F(6148),ol=F(4408),iu=F(7565);const Gi=new class j_ extends iu.v{}(class ag extends ol.o{constructor(O,K){super(O,K),this.scheduler=O,this.work=K}schedule(O,K=0){return K>0?super.schedule(O,K):(this.delay=K,this.state=O,this.scheduler.flush(this),this)}execute(O,K){return K>0||this.closed?super.execute(O,K):this._execute(O,K)}requestAsyncId(O,K,de=0){return null!=de&&de>0||null==de&&this.delay>0?super.requestAsyncId(O,K,de):O.flush(this)}});var Cs=F(4986),Xs=F(8505),_a=F(5363),su=F(9468);const al=new _.GfV("7.4.1"),ul="__angularfire_symbol__analyticsIsSupportedValue",Ts="__angularfire_symbol__analyticsIsSupported",ko="__angularfire_symbol__remoteConfigIsSupportedValue",Po="__angularfire_symbol__remoteConfigIsSupported",Hr="__angularfire_symbol__messagingIsSupportedValue",Oo="__angularfire_symbol__messagingIsSupported";function Xn(N,O,K){if(O){if(1===O.length)return O[0];const tt=O.filter(gt=>gt.app===K);if(1===tt.length)return tt[0]}return K.container.getProvider(N).getImmediate({optional:!0})}globalThis[Ts]||(globalThis[Ts]=(0,Is.Gb)().then(N=>globalThis[ul]=N).catch(()=>globalThis[ul]=!1)),globalThis[Oo]||(globalThis[Oo]=Hi().then(N=>globalThis[Hr]=N).catch(()=>globalThis[Hr]=!1)),globalThis[Po]||(globalThis[Po]=xi().then(N=>globalThis[ko]=N).catch(()=>globalThis[ko]=!1));const ou=(N,O)=>{const K=O?[O]:(0,ne.C6)(),de=[];return K.forEach(Ue=>{Ue.container.getProvider(N).instances.forEach(gt=>{de.includes(gt)||de.push(gt)})}),de};function Fo(){}class Js{constructor(O,K=Gi){this.zone=O,this.delegate=K}now(){return this.delegate.now()}schedule(O,K,de){const Ue=this.zone;return this.delegate.schedule(function(gt){Ue.runGuarded(()=>{O.apply(this,[gt])})},K,de)}}class gi{constructor(O){this.zone=O,this.task=null}call(O,K){const de=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Fo,{},Fo,Fo)),K.pipe((0,Xs.b)({next:de,complete:de,error:de})).subscribe(O).add(de)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let qc=(()=>{class N{constructor(K){this.ngZone=K,this.outsideAngular=K.runOutsideAngular(()=>new Js(Zone.current)),this.insideAngular=K.run(()=>new Js(Zone.current,Cs.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return N.\u0275fac=function(K){return new(K||N)(_.LFG(_.R0b))},N.\u0275prov=_.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();function ki(){const N=globalThis.\u0275AngularFireScheduler;if(!N)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return N}function Kc(N){return N.pipe((0,_a.Q)(ki().outsideAngular))}function ll(N){return ki(),function ls(N){return function(K){return(K=K.lift(new gi(N.ngZone))).pipe((0,su.R)(N.outsideAngular),(0,_a.Q)(N.insideAngular))}}(ki())(N)}},2090:(_t,ke,F)=>{F.d(ke,{$s:()=>Qr,BH:()=>Le,DV:()=>St,Dv:()=>jr,G6:()=>$e,GJ:()=>dn,L:()=>we,LL:()=>We,Pz:()=>Bt,Sg:()=>Ae,UG:()=>Ee,UI:()=>Mi,US:()=>ye,Wj:()=>Gn,Yr:()=>Ze,ZB:()=>W,ZR:()=>ie,b$:()=>lt,cI:()=>rn,dS:()=>yt,eu:()=>Ce,g5:()=>B,gK:()=>$n,gQ:()=>ur,h$:()=>ce,hl:()=>j,hu:()=>ne,jU:()=>fe,lb:()=>fn,m9:()=>sn,ne:()=>xi,p$:()=>$,pd:()=>Vr,r3:()=>rr,ru:()=>ft,tV:()=>_e,uI:()=>it,ug:()=>dt,vZ:()=>ci,w1:()=>Te,w9:()=>vn,xO:()=>Yr,xb:()=>Zt,z$:()=>De,zI:()=>J,zd:()=>gr});const ne=function(Y,H){if(!Y)throw B(H)},B=function(Y){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+Y)},ue=function(Y){const H=[];let V=0;for(let G=0;G<Y.length;G++){let z=Y.charCodeAt(G);z<128?H[V++]=z:z<2048?(H[V++]=z>>6|192,H[V++]=63&z|128):55296==(64512&z)&&G+1<Y.length&&56320==(64512&Y.charCodeAt(G+1))?(z=65536+((1023&z)<<10)+(1023&Y.charCodeAt(++G)),H[V++]=z>>18|240,H[V++]=z>>12&63|128,H[V++]=z>>6&63|128,H[V++]=63&z|128):(H[V++]=z>>12|224,H[V++]=z>>6&63|128,H[V++]=63&z|128)}return H},ye={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(Y,H){if(!Array.isArray(Y))throw Error("encodeByteArray takes an array as a parameter");this.init_();const V=H?this.byteToCharMapWebSafe_:this.byteToCharMap_,G=[];for(let z=0;z<Y.length;z+=3){const Ne=Y[z],Ye=z+1<Y.length,ht=Ye?Y[z+1]:0,En=z+2<Y.length,pn=En?Y[z+2]:0;let Se=(15&ht)<<2|pn>>6,Be=63&pn;En||(Be=64,Ye||(Se=64)),G.push(V[Ne>>2],V[(3&Ne)<<4|ht>>4],V[Se],V[Be])}return G.join("")},encodeString(Y,H){return this.HAS_NATIVE_SUPPORT&&!H?btoa(Y):this.encodeByteArray(ue(Y),H)},decodeString(Y,H){return this.HAS_NATIVE_SUPPORT&&!H?atob(Y):function(Y){const H=[];let V=0,G=0;for(;V<Y.length;){const z=Y[V++];if(z<128)H[G++]=String.fromCharCode(z);else if(z>191&&z<224){const Ne=Y[V++];H[G++]=String.fromCharCode((31&z)<<6|63&Ne)}else if(z>239&&z<365){const En=((7&z)<<18|(63&Y[V++])<<12|(63&Y[V++])<<6|63&Y[V++])-65536;H[G++]=String.fromCharCode(55296+(En>>10)),H[G++]=String.fromCharCode(56320+(1023&En))}else{const Ne=Y[V++],Ye=Y[V++];H[G++]=String.fromCharCode((15&z)<<12|(63&Ne)<<6|63&Ye)}}return H.join("")}(this.decodeStringToByteArray(Y,H))},decodeStringToByteArray(Y,H){this.init_();const V=H?this.charToByteMapWebSafe_:this.charToByteMap_,G=[];for(let z=0;z<Y.length;){const Ne=V[Y.charAt(z++)],ht=z<Y.length?V[Y.charAt(z)]:0;++z;const pn=z<Y.length?V[Y.charAt(z)]:64;++z;const pe=z<Y.length?V[Y.charAt(z)]:64;if(++z,null==Ne||null==ht||null==pn||null==pe)throw Error();G.push(Ne<<2|ht>>4),64!==pn&&(G.push(ht<<4&240|pn>>2),64!==pe&&G.push(pn<<6&192|pe))}return G},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let Y=0;Y<this.ENCODED_VALS.length;Y++)this.byteToCharMap_[Y]=this.ENCODED_VALS.charAt(Y),this.charToByteMap_[this.byteToCharMap_[Y]]=Y,this.byteToCharMapWebSafe_[Y]=this.ENCODED_VALS_WEBSAFE.charAt(Y),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[Y]]=Y,Y>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(Y)]=Y,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(Y)]=Y)}}},ce=function(Y){const H=ue(Y);return ye.encodeByteArray(H,!0)},we=function(Y){return ce(Y).replace(/\./g,"")},_e=function(Y){try{return ye.decodeString(Y,!0)}catch(H){console.error("base64Decode failed: ",H)}return null};function $(Y){return W(void 0,Y)}function W(Y,H){if(!(H instanceof Object))return H;switch(H.constructor){case Date:return new Date(H.getTime());case Object:void 0===Y&&(Y={});break;case Array:Y=[];break;default:return H}for(const V in H)!H.hasOwnProperty(V)||!te(V)||(Y[V]=W(Y[V],H[V]));return Y}function te(Y){return"__proto__"!==Y}class Le{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((H,V)=>{this.resolve=H,this.reject=V})}wrapCallback(H){return(V,G)=>{V?this.reject(V):this.resolve(G),"function"==typeof H&&(this.promise.catch(()=>{}),1===H.length?H(V):H(V,G))}}}function Ae(Y,H){if(Y.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const G=H||"demo-project",z=Y.iat||0,Ne=Y.sub||Y.user_id;if(!Ne)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Ye=Object.assign({iss:`https://securetoken.google.com/${G}`,aud:G,iat:z,exp:z+3600,auth_time:z,sub:Ne,user_id:Ne,firebase:{sign_in_provider:"custom",identities:{}}},Y);return[we(JSON.stringify({alg:"none",type:"JWT"})),we(JSON.stringify(Ye)),""].join(".")}function De(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function it(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(De())}function Ee(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function fe(){return"object"==typeof self&&self.self===self}function ft(){const Y="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof Y&&void 0!==Y.id}function lt(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Te(){const Y=De();return Y.indexOf("MSIE ")>=0||Y.indexOf("Trident/")>=0}function Ze(){return!1}function $e(){return!Ee()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function j(){return"object"==typeof indexedDB}function Ce(){return new Promise((Y,H)=>{try{let V=!0;const G="validate-browser-context-for-indexeddb-analytics-module",z=self.indexedDB.open(G);z.onsuccess=()=>{z.result.close(),V||self.indexedDB.deleteDatabase(G),Y(!0)},z.onupgradeneeded=()=>{V=!1},z.onerror=()=>{var Ne;H((null===(Ne=z.error)||void 0===Ne?void 0:Ne.message)||"")}}catch(V){H(V)}})}function J(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class ie extends Error{constructor(H,V,G){super(V),this.code=H,this.customData=G,this.name="FirebaseError",Object.setPrototypeOf(this,ie.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,We.prototype.create)}}class We{constructor(H,V,G){this.service=H,this.serviceName=V,this.errors=G}create(H,...V){const G=V[0]||{},z=`${this.service}/${H}`,Ne=this.errors[H],Ye=Ne?function je(Y,H){return Y.replace(mt,(V,G)=>{const z=H[G];return null!=z?String(z):`<${G}?>`})}(Ne,G):"Error";return new ie(z,`${this.serviceName}: ${Ye} (${z}).`,G)}}const mt=/\{\$([^}]+)}/g;function rn(Y){return JSON.parse(Y)}function Bt(Y){return JSON.stringify(Y)}const Xe=function(Y){let H={},V={},G={},z="";try{const Ne=Y.split(".");H=rn(_e(Ne[0])||""),V=rn(_e(Ne[1])||""),z=Ne[2],G=V.d||{},delete V.d}catch{}return{header:H,claims:V,data:G,signature:z}},vn=function(Y){const V=Xe(Y).claims;return!!V&&"object"==typeof V&&V.hasOwnProperty("iat")},dn=function(Y){const H=Xe(Y).claims;return"object"==typeof H&&!0===H.admin};function rr(Y,H){return Object.prototype.hasOwnProperty.call(Y,H)}function St(Y,H){if(Object.prototype.hasOwnProperty.call(Y,H))return Y[H]}function Zt(Y){for(const H in Y)if(Object.prototype.hasOwnProperty.call(Y,H))return!1;return!0}function Mi(Y,H,V){const G={};for(const z in Y)Object.prototype.hasOwnProperty.call(Y,z)&&(G[z]=H.call(V,Y[z],z,Y));return G}function ci(Y,H){if(Y===H)return!0;const V=Object.keys(Y),G=Object.keys(H);for(const z of V){if(!G.includes(z))return!1;const Ne=Y[z],Ye=H[z];if(pr(Ne)&&pr(Ye)){if(!ci(Ne,Ye))return!1}else if(Ne!==Ye)return!1}for(const z of G)if(!V.includes(z))return!1;return!0}function pr(Y){return null!==Y&&"object"==typeof Y}function Yr(Y){const H=[];for(const[V,G]of Object.entries(Y))Array.isArray(G)?G.forEach(z=>{H.push(encodeURIComponent(V)+"="+encodeURIComponent(z))}):H.push(encodeURIComponent(V)+"="+encodeURIComponent(G));return H.length?"&"+H.join("&"):""}function gr(Y){const H={};return Y.replace(/^\?/,"").split("&").forEach(G=>{if(G){const[z,Ne]=G.split("=");H[decodeURIComponent(z)]=decodeURIComponent(Ne)}}),H}function Vr(Y){const H=Y.indexOf("?");if(!H)return"";const V=Y.indexOf("#",H);return Y.substring(H,V>0?V:void 0)}class ur{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let H=1;H<this.blockSize;++H)this.pad_[H]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(H,V){V||(V=0);const G=this.W_;if("string"==typeof H)for(let pe=0;pe<16;pe++)G[pe]=H.charCodeAt(V)<<24|H.charCodeAt(V+1)<<16|H.charCodeAt(V+2)<<8|H.charCodeAt(V+3),V+=4;else for(let pe=0;pe<16;pe++)G[pe]=H[V]<<24|H[V+1]<<16|H[V+2]<<8|H[V+3],V+=4;for(let pe=16;pe<80;pe++){const Se=G[pe-3]^G[pe-8]^G[pe-14]^G[pe-16];G[pe]=4294967295&(Se<<1|Se>>>31)}let pn,ae,z=this.chain_[0],Ne=this.chain_[1],Ye=this.chain_[2],ht=this.chain_[3],En=this.chain_[4];for(let pe=0;pe<80;pe++){pe<40?pe<20?(pn=ht^Ne&(Ye^ht),ae=1518500249):(pn=Ne^Ye^ht,ae=1859775393):pe<60?(pn=Ne&Ye|ht&(Ne|Ye),ae=2400959708):(pn=Ne^Ye^ht,ae=3395469782);const Se=(z<<5|z>>>27)+pn+En+ae+G[pe]&4294967295;En=ht,ht=Ye,Ye=4294967295&(Ne<<30|Ne>>>2),Ne=z,z=Se}this.chain_[0]=this.chain_[0]+z&4294967295,this.chain_[1]=this.chain_[1]+Ne&4294967295,this.chain_[2]=this.chain_[2]+Ye&4294967295,this.chain_[3]=this.chain_[3]+ht&4294967295,this.chain_[4]=this.chain_[4]+En&4294967295}update(H,V){if(null==H)return;void 0===V&&(V=H.length);const G=V-this.blockSize;let z=0;const Ne=this.buf_;let Ye=this.inbuf_;for(;z<V;){if(0===Ye)for(;z<=G;)this.compress_(H,z),z+=this.blockSize;if("string"==typeof H){for(;z<V;)if(Ne[Ye]=H.charCodeAt(z),++Ye,++z,Ye===this.blockSize){this.compress_(Ne),Ye=0;break}}else for(;z<V;)if(Ne[Ye]=H[z],++Ye,++z,Ye===this.blockSize){this.compress_(Ne),Ye=0;break}}this.inbuf_=Ye,this.total_+=V}digest(){const H=[];let V=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let z=this.blockSize-1;z>=56;z--)this.buf_[z]=255&V,V/=256;this.compress_(this.buf_);let G=0;for(let z=0;z<5;z++)for(let Ne=24;Ne>=0;Ne-=8)H[G]=this.chain_[z]>>Ne&255,++G;return H}}function xi(Y,H){const V=new st(Y,H);return V.subscribe.bind(V)}class st{constructor(H,V){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=V,this.task.then(()=>{H(this)}).catch(G=>{this.error(G)})}next(H){this.forEachObserver(V=>{V.next(H)})}error(H){this.forEachObserver(V=>{V.error(H)}),this.close(H)}complete(){this.forEachObserver(H=>{H.complete()}),this.close()}subscribe(H,V,G){let z;if(void 0===H&&void 0===V&&void 0===G)throw new Error("Missing Observer.");z=function di(Y,H){if("object"!=typeof Y||null===Y)return!1;for(const V of H)if(V in Y&&"function"==typeof Y[V])return!0;return!1}(H,["next","error","complete"])?H:{next:H,error:V,complete:G},void 0===z.next&&(z.next=xn),void 0===z.error&&(z.error=xn),void 0===z.complete&&(z.complete=xn);const Ne=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?z.error(this.finalError):z.complete()}catch{}}),this.observers.push(z),Ne}unsubscribeOne(H){void 0===this.observers||void 0===this.observers[H]||(delete this.observers[H],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(H){if(!this.finalized)for(let V=0;V<this.observers.length;V++)this.sendOne(V,H)}sendOne(H,V){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[H])try{V(this.observers[H])}catch(G){typeof console<"u"&&console.error&&console.error(G)}})}close(H){this.finalized||(this.finalized=!0,void 0!==H&&(this.finalError=H),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xn(){}const jr=function(Y,H,V,G){let z;if(G<H?z="at least "+H:G>V&&(z=0===V?"none":"no more than "+V),z)throw new Error(Y+" failed: Was called with "+G+(1===G?" argument.":" arguments.")+" Expects "+z+".")};function $n(Y,H){return`${Y} failed: ${H} argument `}function Gn(Y,H,V,G){if((!G||V)&&"function"!=typeof V)throw new Error($n(Y,H)+"must be a valid function.")}function fn(Y,H,V,G){if((!G||V)&&("object"!=typeof V||null===V))throw new Error($n(Y,H)+"must be a valid context object.")}const yt=function(Y){const H=[];let V=0;for(let G=0;G<Y.length;G++){let z=Y.charCodeAt(G);if(z>=55296&&z<=56319){const Ne=z-55296;G++,ne(G<Y.length,"Surrogate pair missing trail surrogate."),z=65536+(Ne<<10)+(Y.charCodeAt(G)-56320)}z<128?H[V++]=z:z<2048?(H[V++]=z>>6|192,H[V++]=63&z|128):z<65536?(H[V++]=z>>12|224,H[V++]=z>>6&63|128,H[V++]=63&z|128):(H[V++]=z>>18|240,H[V++]=z>>12&63|128,H[V++]=z>>6&63|128,H[V++]=63&z|128)}return H},dt=function(Y){let H=0;for(let V=0;V<Y.length;V++){const G=Y.charCodeAt(V);G<128?H++:G<2048?H+=2:G>=55296&&G<=56319?(H+=4,V++):H+=3}return H};function Qr(Y,H=1e3,V=2){const G=H*Math.pow(V,Y),z=Math.round(.5*G*(Math.random()-.5)*2);return Math.min(144e5,G+z)}function sn(Y){return Y&&Y._delegate?Y._delegate:Y}},5488:(_t,ke,F)=>{var _=F(4650);let ne=null;function B(){return ne}const ce=new _.OlP("DocumentToken");let we=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return function _e(){return(0,_.LFG)(W)}()},providedIn:"platform"}),n})();const $=new _.OlP("Location Initialized");let W=(()=>{class n extends we{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return B().getBaseHref(this._doc)}onPopState(t){const r=B().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=B().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){te()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){te()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function Le(){return new W((0,_.LFG)(ce))}()},providedIn:"platform"}),n})();function te(){return!!window.history.pushState}function Ae(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function De(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function it(n){return n&&"?"!==n[0]?"?"+n:n}let Ee=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(ft)},providedIn:"root"}),n})();const fe=new _.OlP("appBaseHref");let ft=(()=>{class n extends Ee{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,_.f3M)(ce).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Ae(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+it(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+it(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+it(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(we),_.LFG(fe,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),lt=(()=>{class n extends Ee{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Ae(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+it(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+it(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(we),_.LFG(fe,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Pe=(()=>{class n{constructor(t){this._subject=new _.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._baseHref=De(Ze(r)),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+it(r))}normalize(t){return n.stripTrailingSlash(function xe(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,Ze(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+it(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+it(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=it,n.joinWithSlash=Ae,n.stripTrailingSlash=De,n.\u0275fac=function(t){return new(t||n)(_.LFG(Ee))},n.\u0275prov=_.Yz7({token:n,factory:function(){return function Te(){return new Pe((0,_.LFG)(Ee))}()},providedIn:"root"}),n})();function Ze(n){return n.replace(/\/index.html$/,"")}class ga{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ws=(()=>{class n{constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,a,l)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new ga(i.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)r.remove(null===a?void 0:a);else if(null!==a){const d=r.get(a);r.move(d,l),us(d,i)}});for(let i=0,a=r.length;i<a;i++){const d=r.get(i).context;d.index=i,d.count=a,d.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{us(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.s_b),_.Y36(_.Rgc),_.Y36(_.ZZ4))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function us(n,e){n.context.$implicit=e.item}let Sr=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new ma,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){$r("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){$r("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.s_b),_.Y36(_.Rgc))},n.\u0275dir=_.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class ma{constructor(){this.$implicit=null,this.ngIf=null}}function $r(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,_.AaK)(e)}'.`)}let Ts=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})();const ko="browser";function ei(n){return"server"===n}let ou=(()=>{class n{}return n.\u0275prov=(0,_.Yz7)({token:n,providedIn:"root",factory:()=>new Fo((0,_.LFG)(ce),window)}),n})();class Fo{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function gi(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Js(this.window.history)||Js(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Js(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class hl extends class hg extends class ye{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function ge(n){ne||(ne=n)}(new hl)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function $h(){return lu=lu||document.querySelector("base"),lu?lu.getAttribute("href"):null}();return null==t?null:function Pi(n){Rr=Rr||document.createElement("a"),Rr.setAttribute("href",n);const e=Rr.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){lu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function xr(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}(document.cookie,e)}}let Rr,lu=null;const Wn=new _.OlP("TRANSITION_ID"),z_=[{provide:_.ip1,useFactory:function W_(n,e,t){return()=>{t.get(_.CZH).donePromise.then(()=>{const r=B(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[Wn,ce,_.zs3],multi:!0}];let K_=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const Zc=new _.OlP("EventManagerPlugins");let Hh=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Zc),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class Yc{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=B().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Qc=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),Ca=(()=>{class n extends Qc{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(Gh),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Gh))}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();function Gh(n){B().remove(n)}const Wh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},fg=/%COMP%/g;function Xc(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?Xc(n,i,t):(i=i.replace(fg,n),t.push(i))}return t}function pg(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let pl=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new cu(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case _.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new gg(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case _.ifc.ShadowDom:return new mg(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=Xc(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Hh),_.LFG(Ca),_.LFG(_.AFp))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class cu{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Wh[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(ml(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(ml(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=Wh[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=Wh[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(_.JOm.DashCase|_.JOm.Important)?e.style.setProperty(t,r,i&_.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&_.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,pg(r)):this.eventManager.addEventListener(e,t,pg(r))}}function ml(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class gg extends cu{constructor(e,t,r,i){super(e),this.component=r;const a=Xc(i+"-"+r.id,r.styles,[]);t.addStyles(a),this.contentAttr=function fl(n){return"_ngcontent-%COMP%".replace(fg,n)}(i+"-"+r.id),this.hostAttr=function qh(n){return"_nghost-%COMP%".replace(fg,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class mg extends cu{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=Xc(i.id,i.styles,[]);for(let l=0;l<a.length;l++){const d=document.createElement("style");d.textContent=a[l],this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let _l=(()=>{class n extends Yc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const yl=["alt","control","meta","shift"],vl={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},As={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ed=(()=>{class n extends Yc{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>B().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="",d=r.indexOf("code");if(d>-1&&(r.splice(d,1),l="code."),yl.forEach(y=>{const b=r.indexOf(y);b>-1&&(r.splice(b,1),l+=y+".")}),l+=a,0!=r.length||0===a.length)return null;const p={};return p.domEventName=i,p.fullKey=l,p}static matchEventFullKeyCode(t,r){let i=vl[t.key]||t.key,a="";return r.indexOf("code.")>-1&&(i=t.code,a="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),yl.forEach(l=>{l!==i&&(0,As[l])(t)&&(a+=l+".")}),a+=i,a===r)}static eventCallback(t,r,i){return a=>{n.matchEventFullKeyCode(a,t)&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const nd=(0,_.eFA)(_._c5,"browser",[{provide:_.Lbi,useValue:ko},{provide:_.g9A,useValue:function Kh(){hl.makeCurrent()},multi:!0},{provide:ce,useFactory:function Il(){return(0,_.RDi)(document),document},deps:[]}]),du=new _.OlP(""),yg=[{provide:_.rWj,useClass:class q_{addToWindow(e){_.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},_.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),_.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),_.dqk.frameworkStabilizers||(_.dqk.frameworkStabilizers=[]),_.dqk.frameworkStabilizers.push(r=>{const i=_.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const d=function(p){l=l||p,a--,0==a&&r(l)};i.forEach(function(p){p.whenStable(d)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?B().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:_.lri,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]},{provide:_.dDg,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]}],hu=[{provide:_.zSh,useValue:"root"},{provide:_.qLn,useFactory:function El(){return new _.qLn},deps:[]},{provide:Zc,useClass:_l,multi:!0,deps:[ce,_.R0b,_.Lbi]},{provide:Zc,useClass:ed,multi:!0,deps:[ce]},{provide:pl,useClass:pl,deps:[Hh,Ca,_.AFp]},{provide:_.FYo,useExisting:pl},{provide:Qc,useExisting:Ca},{provide:Ca,useClass:Ca,deps:[ce]},{provide:Hh,useClass:Hh,deps:[Zc,_.R0b]},{provide:class ki{},useClass:K_,deps:[]},[]];let rd=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:_.AFp,useValue:t.appId},{provide:Wn,useExisting:_.AFp},z_]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(du,12))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[...hu,...yg],imports:[Ts,_.hGG]}),n})(),Da=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function fu(){return new Da((0,_.LFG)(ce))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var be=F(5861),Jn=F(9681),Ms=F(4859),k=F(2090),er=F(1877);const zi="@firebase/database";let $o="";function so(n){$o=n}class ad{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,k.Pz)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,k.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class X_{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,k.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const ud=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ad(e)}}catch{}return new X_},xs=ud("localStorage"),Ho=ud("sessionStorage"),oo=new er.Yd("@firebase/database"),mi=function(){let n=1;return function(){return n++}}(),ld=function(n){const e=(0,k.dS)(n),t=new k.gQ;t.update(e);const r=t.digest();return k.US.encodeByteArray(r)},Rs=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=Rs.apply(null,r):e+="object"==typeof r?(0,k.Pz)(r):r,e+=" "}return e};let Go=null,cd=!0;const Ig=function(n,e){(0,k.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(oo.logLevel=er.in.VERBOSE,Go=oo.log.bind(oo),e&&Ho.set("logging_enabled",!0)):"function"==typeof n?Go=n:(Go=null,Ho.remove("logging_enabled"))},kr=function(...n){if(!0===cd&&(cd=!1,null===Go&&!0===Ho.get("logging_enabled")&&Ig(!0)),Go){const e=Rs.apply(null,n);Go(e)}},Aa=function(n){return function(...e){kr(n,...e)}},tf=function(...n){const e="FIREBASE INTERNAL ERROR: "+Rs(...n);oo.error(e)},qi=function(...n){const e=`FIREBASE FATAL ERROR: ${Rs(...n)}`;throw oo.error(e),new Error(e)},ti=function(...n){const e="FIREBASE WARNING: "+Rs(...n);oo.warn(e)},ao=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Wr="[MIN_NAME]",Ki="[MAX_NAME]",Ns=function(n,e){if(n===e)return 0;if(n===Wr||e===Ki)return-1;if(e===Wr||n===Ki)return 1;{const t=mu(n),r=mu(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},nf=function(n,e){return n===e?0:n<e?-1:1},Ma=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,k.Pz)(e))},Ml=function(n){if("object"!=typeof n||null===n)return(0,k.Pz)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,k.Pz)(e[r]),t+=":",t+=Ml(n[e[r]]);return t+="}",t},rf=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function zn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Wo=function(n){(0,k.hu)(!ao(n),"Invalid JSON number");const r=1023;let i,a,l,d,p;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(d=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=d+r,l=Math.round(n*Math.pow(2,52-d)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const y=[];for(p=52;p;p-=1)y.push(l%2?1:0),l=Math.floor(l/2);for(p=11;p;p-=1)y.push(a%2?1:0),a=Math.floor(a/2);y.push(i?1:0),y.reverse();const b=y.join("");let T="";for(p=0;p<64;p+=8){let M=parseInt(b.substr(p,8),2).toString(16);1===M.length&&(M="0"+M),T+=M}return T.toLowerCase()},dd=new RegExp("^-?(0*)\\d{1,10}$"),hd=-2147483648,xa=2147483647,mu=function(n){if(dd.test(n)){const e=Number(n);if(e>=hd&&e<=xa)return e}return null},_u=function(n){try{n()}catch(e){setTimeout(()=>{throw ti("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},uo=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class xl{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){ti(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class fd{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(kr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ti(e)}}let Zi=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const sf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,md="websocket",ey="long_polling";class _d{constructor(e,t,r,i,a=!1,l="",d=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xs.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&xs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function uf(n,e,t){let r;if((0,k.hu)("string"==typeof e,"typeof type must == string"),(0,k.hu)("object"==typeof t,"typeof params must == object"),e===md)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==ey)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function ty(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return zn(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class ny{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,k.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,k.p$)(this.counters_)}}const lf={},yd={};function vu(n){const e=n.toString();return lf[e]||(lf[e]=new ny),lf[e]}class ry{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&_u(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class lo{constructor(e,t,r,i,a,l,d){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=d,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Aa(e),this.stats_=vu(t),this.urlFn=p=>(this.appCheckToken&&(p.ac=this.appCheckToken),uf(t,ey,p))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ry(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,k.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bu((...a)=>{const[l,d,p,y,b]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=d,this.password=p;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);d?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(d,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,d]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,d)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&sf.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){lo.forceAllow_=!0}static forceDisallow(){lo.forceDisallow_=!0}static isAvailable(){return!((0,k.Yr)()||!lo.forceAllow_&&(lo.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,k.Pz)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,k.h$)(t),i=rf(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,k.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,k.Pz)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class bu{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,k.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=mi(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=bu.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(d){kr("frame writing exception"),d.stack&&kr(d.stack),kr(d)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||kr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,k.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{kr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let wd=null;typeof MozWebSocket<"u"?wd=MozWebSocket:typeof WebSocket<"u"&&(wd=WebSocket);let Na=(()=>{class n{constructor(t,r,i,a,l,d,p){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Aa(this.connId),this.stats_=vu(r),this.connURL=n.connectionURL_(r,d,p,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const d={v:"5"};return!(0,k.Yr)()&&typeof location<"u"&&location.hostname&&sf.test(location.hostname)&&(d.r="f"),r&&(d.s=r),i&&(d.ls=i),a&&(d.ac=a),l&&(d.p=l),uf(t,md,d)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xs.set("previous_websocket_failure",!0);try{let i;if((0,k.Yr)()){i={headers:{"User-Agent":`Firebase/5/${$o}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,d=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;d&&(i.proxy={origin:d})}this.mySock=new wd(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==wd&&!n.forceDisallow_}static previouslyFailed(){return xs.isInMemoryStorage||!0===xs.get("previous_websocket_failure")}markConnectionHealthy(){xs.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,k.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,k.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,k.Pz)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=rf(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),Mg=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[lo,Na]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Na&&Na.isAvailable();let i=r&&!Na.previouslyFailed();if(t.webSocketOnly&&(r||ti("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Na];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class Ps{constructor(e,t,r,i,a,l,d,p,y,b){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=d,this.onDisconnect_=p,this.onKill_=y,this.lastSessionId=b,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Aa("c:"+this.id+":"),this.transportManager_=new Mg(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=uo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ma("t",e),r=Ma("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ma("t",e),r=Ma("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ma("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?tf("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):tf("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&ti("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),uo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):uo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Cu{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class Ol{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,k.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,k.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class Fl extends Ol{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,k.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Fl}getInitialEvent(e){return(0,k.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class An{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Cn(){return new An("")}function Qt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Os(n){return n.pieces_.length-n.pieceNum_}function Bn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new An(n.pieces_,e)}function _f(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Ll(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Og(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new An(e,0)}function Vn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof An)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new An(t,0)}function Xt(n){return n.pieceNum_>=n.pieces_.length}function ni(n,e){const t=Qt(n),r=Qt(e);if(null===t)return e;if(t===r)return ni(Bn(n),Bn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function bd(n,e){const t=Ll(n,0),r=Ll(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=Ns(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function Tu(n,e){if(Os(n)!==Os(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function _i(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Os(n)>Os(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class cy{constructor(e,t){this.errorPrefix_=t,this.parts_=Ll(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,k.ug)(this.parts_[r]);Lg(this)}}function Lg(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+co(n))}function co(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class Cd extends Ol{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new Cd}getInitialEvent(e){return(0,k.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Ul=1e3;let Pa,cs=(()=>{class n extends Cu{constructor(t,r,i,a,l,d,p,y){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=d,this.appCheckTokenProvider_=p,this.authOverride_=y,this.id=n.nextPersistentConnectionId_++,this.log_=Aa("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ul,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,y&&!(0,k.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Cd.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&Fl.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,k.Pz)(l)),(0,k.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new k.BH,i={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:d=>{const p=d.d;"ok"===d.s?r.resolve(p):r.reject(p)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,d=t._path.toString();this.log_("Listen called for "+d+" "+l),this.listens.has(d)||this.listens.set(d,new Map),(0,k.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,k.hu)(!this.listens.get(d).has(l),"listen() called twice for same path/queryId.");const p={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(d).set(l,p),this.connected_&&this.sendListen_(p)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,p=>{const y=p.d,b=p.s;n.warnOnListenWarnings_(y,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",p),"ok"!==b&&this.removeListen_(i,a),t.onComplete&&t.onComplete(b,y))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,k.r3)(t,"w")){const i=(0,k.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();ti(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,k.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,k.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,d=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,d))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,k.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,d=>{a&&setTimeout(()=>{a(d.s,d.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const d={p:r,d:i};void 0!==l&&(d.h=l),this.outstandingPuts_.push({action:t,request:d,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,k.Pz)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):tf("Unrecognized action received from server: "+(0,k.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,k.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ul,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ul,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ul),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,be.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,d=t.lastSessionId;let p=!1,y=null;const b=function(){y?y.close():(p=!0,a())};t.realtime_={close:b,sendRequest:function(P){(0,k.hu)(y,"sendRequest call when we're not connected not allowed."),y.sendRequest(P)}};const M=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[P,U]=yield Promise.all([t.authTokenProvider_.getToken(M),t.appCheckTokenProvider_.getToken(M)]);p?kr("getToken() completed but was canceled"):(kr("getToken() completed. Creating connection."),t.authToken_=P&&P.accessToken,t.appCheckToken_=U&&U.token,y=new Ps(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,ee=>{ti(ee+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},d))}catch(P){t.log_("Failed to get token: "+P),p||(t.repoInfo_.nodeAdmin&&ti(P),b())}}})()}interrupt(t){kr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){kr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,k.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Ul,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>Ml(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new An(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){kr("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){kr("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,k.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+$o.replace(/\./g,"-")]=1,(0,k.uI)()?t["framework.cordova"]=1:(0,k.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Fl.getInstance().currentlyOnline();return(0,k.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class Jt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Jt(e,t)}}class ka{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Jt(Wr,e),i=new Jt(Wr,t);return 0!==this.compare(r,i)}minPost(){return Jt.MIN}}class Td extends ka{static get __EMPTY_NODE(){return Pa}static set __EMPTY_NODE(e){Pa=e}compare(e,t){return Ns(e.name,t.name)}isDefinedOn(e){throw(0,k.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Jt.MIN}maxPost(){return new Jt(Ki,Pa)}makePost(e,t){return(0,k.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Jt(e,Pa)}toString(){return".key"}}const Fs=new Td;class Oa{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let Du,Yi=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??zr.EMPTY_NODE,this.right=l??zr.EMPTY_NODE}copy(t,r,i,a,l){return new n(t??this.key,r??this.value,i??this.color,a??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return zr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return zr.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class zr{constructor(e,t=zr.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new zr(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Yi.BLACK,null,null))}remove(e){return new zr(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Yi.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Oa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Oa(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Oa(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Oa(this.root_,null,this.comparator_,!0,e)}}function Vg(n,e){return Ns(n.name,e.name)}function Vl(n,e){return Ns(n,e)}zr.EMPTY_NODE=new class hi{copy(e,t,r,i,a){return this}insert(e,t,r){return new Yi(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Zo=function(n){return"number"==typeof n?"number:"+Wo(n):"string:"+n},yf=function(n){if(n.isLeafNode()){const e=n.val();(0,k.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,k.r3)(e,".sv"),"Priority must be a string or number.")}else(0,k.hu)(n===Du||n.isEmpty(),"priority of unexpected type.");(0,k.hu)(n===Du||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Sd,vf,Ad,ri=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,k.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),yf(this.priorityNode_)}static set __childrenNodeConstructor(t){Sd=t}static get __childrenNodeConstructor(){return Sd}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Xt(t)?this:".priority"===Qt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=Qt(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,k.hu)(".priority"!==i||1===Os(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Bn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Zo(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?Wo(this.value_):this.value_,this.lazyHash_=ld(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,k.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,k.hu)(a>=0,"Unknown leaf type: "+r),(0,k.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const en=new class wf extends ka{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?Ns(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Jt.MIN}maxPost(){return new Jt(Ki,new ri("[PRIORITY-POST]",Ad))}makePost(e,t){const r=vf(e);return new Jt(t,new ri("[PRIORITY-POST]",r))}toString(){return".priority"}},Ef=Math.log(2);class If{constructor(e){this.count=parseInt(Math.log(e+1)/Ef,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const jl=function(n,e,t,r){n.sort(e);const i=function(p,y){const b=y-p;let T,M;if(0===b)return null;if(1===b)return T=n[p],M=t?t(T):T,new Yi(M,T.node,Yi.BLACK,null,null);{const P=parseInt(b/2,10)+p,U=i(p,P),ee=i(P+1,y);return T=n[P],M=t?t(T):T,new Yi(M,T.node,Yi.BLACK,U,ee)}},d=function(p){let y=null,b=null,T=n.length;const M=function(U,ee){const oe=T-U,Ge=T;T-=U;const Je=i(oe+1,Ge),rt=n[oe],et=t?t(rt):rt;P(new Yi(et,rt.node,ee,null,Je))},P=function(U){y?(y.left=U,y=U):(b=U,y=U)};for(let U=0;U<p.count;++U){const ee=p.nextBitIsOne(),oe=Math.pow(2,p.count-(U+1));ee?M(oe,Yi.BLACK):(M(oe,Yi.BLACK),M(oe,Yi.RED))}return b}(new If(n.length));return new zr(r||e,d)};let ii;const Ls={};class Us{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,k.hu)(Ls&&en,"ChildrenNode.ts has not been loaded"),ii=ii||new Us({".priority":Ls},{".priority":en}),ii}get(e){const t=(0,k.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof zr?t:null}hasIndex(e){return(0,k.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,k.hu)(e!==Fs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(Jt.Wrap);let d,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();d=i?jl(r,e.getCompare()):Ls;const p=e.toString(),y=Object.assign({},this.indexSet_);y[p]=e;const b=Object.assign({},this.indexes_);return b[p]=d,new Us(b,y)}addToIndexes(e,t){const r=(0,k.UI)(this.indexes_,(i,a)=>{const l=(0,k.DV)(this.indexSet_,a);if((0,k.hu)(l,"Missing index implementation for "+a),i===Ls){if(l.isDefinedOn(e.node)){const d=[],p=t.getIterator(Jt.Wrap);let y=p.getNext();for(;y;)y.name!==e.name&&d.push(y),y=p.getNext();return d.push(e),jl(d,l.getCompare())}return Ls}{const d=t.get(e.name);let p=i;return d&&(p=p.remove(new Jt(e.name,d))),p.insert(e,e.node)}});return new Us(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,k.UI)(this.indexes_,i=>{if(i===Ls)return i;{const a=t.get(e.name);return a?i.remove(new Jt(e.name,a)):i}});return new Us(r,this.indexSet_)}}let Su,qt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&yf(this.priorityNode_),this.children_.isEmpty()&&(0,k.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Su||(Su=new n(new zr(Vl),null,Us.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Su}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?Su:r}}getChild(t){const r=Qt(t);return null===r?this:this.getImmediateChild(r).getChild(Bn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,k.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new Jt(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const d=a.isEmpty()?Su:this.priorityNode_;return new n(a,d,l)}}updateChild(t,r){const i=Qt(t);if(null===i)return r;{(0,k.hu)(".priority"!==Qt(t)||1===Os(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(Bn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(en,(d,p)=>{r[d]=p.val(t),i++,l&&n.INTEGER_REGEXP_.test(d)?a=Math.max(a,Number(d)):l=!1}),!t&&l&&a<2*i){const d=[];for(const p in r)d[p]=r[p];return d}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Zo(this.getPriority().val())+":"),this.forEachChild(en,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":ld(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new Jt(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Jt(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Jt(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,Jt.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,Jt.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Hl?-1:0}withIndex(t){if(t===Fs||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Fs||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(en),a=r.getIterator(en);let l=i.getNext(),d=a.getNext();for(;l&&d;){if(l.name!==d.name||!l.node.equals(d.node))return!1;l=i.getNext(),d=a.getNext()}return null===l&&null===d}return!1}return!1}}resolveIndex_(t){return t===Fs?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Hl=new class $l extends qt{constructor(){super(new zr(Vl),qt.EMPTY_NODE,Us.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return qt.EMPTY_NODE}isEmpty(){return!1}};function tr(n,e=null){if(null===n)return qt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,k.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new ri(n,tr(e));if(n instanceof Array){let t=qt.EMPTY_NODE;return zn(n,(r,i)=>{if((0,k.r3)(n,r)&&"."!==r.substring(0,1)){const a=tr(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(tr(e))}{const t=[];let r=!1;if(zn(n,(l,d)=>{if("."!==l.substring(0,1)){const p=tr(d);p.isEmpty()||(r=r||!p.getPriority().isEmpty(),t.push(new Jt(l,p)))}}),0===t.length)return qt.EMPTY_NODE;const a=jl(t,Vg,l=>l.name,Vl);if(r){const l=jl(t,en.getCompare());return new qt(a,tr(e),new Us({".priority":l},{".priority":en}))}return new qt(a,tr(e),Us.Default)}}Object.defineProperties(Jt,{MIN:{value:new Jt(Wr,qt.EMPTY_NODE)},MAX:{value:new Jt(Ki,Hl)}}),Td.__EMPTY_NODE=qt.EMPTY_NODE,ri.__childrenNodeConstructor=qt,function Dd(n){Du=n}(Hl),function Fa(n){Ad=n}(Hl),function Md(n){vf=n}(tr);class xd extends ka{constructor(e){super(),this.indexPath_=e,(0,k.hu)(!Xt(e)&&".priority"!==Qt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?Ns(e.name,t.name):a}makePost(e,t){const r=tr(e),i=qt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Jt(t,i)}maxPost(){const e=qt.EMPTY_NODE.updateChild(this.indexPath_,Hl);return new Jt(Ki,e)}toString(){return Ll(this.indexPath_,0).join("/")}}const f=new class v extends ka{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?Ns(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Jt.MIN}maxPost(){return Jt.MAX}makePost(e,t){const r=tr(e);return new Jt(t,r)}toString(){return".value"}},m="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Q=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=m.charAt(t%64),t=Math.floor(t/64);(0,k.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=m.charAt(e[i]);return(0,k.hu)(20===l.length,"nextPushId: Length should be 20."),l}}(),me=function(n){if(n===""+xa)return"-";const e=mu(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let l=0;l<t.length;l++)t[l]=n.charAt(l);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return Ki;const a=m.charAt(m.indexOf(t[r])+1);return t[r]=a,t.slice(0,r+1).join("")},qe=function(n){if(n===""+hd)return Wr;const e=mu(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+xa:(delete t[t.length-1],t.join("")):(t[t.length-1]=m.charAt(m.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function ct(n){return{type:"value",snapshotNode:n}}function Dt(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function It(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function qn(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class Yo{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,k.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const d=e.getImmediateChild(t);return d.getChild(i).equals(r.getChild(i))&&d.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(It(t,d)):(0,k.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):d.isEmpty()?l.trackChildChange(Dt(t,r)):l.trackChildChange(qn(t,r,d))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(en,(i,a)=>{t.hasChild(i)||r.trackChildChange(It(i,a))}),t.isLeafNode()||t.forEachChild(en,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(qn(i,a,l))}else r.trackChildChange(Dt(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?qt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Au{constructor(e){this.indexedFilter_=new Yo(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Au.getStartPost_(e),this.endPost_=Au.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,a,l){return this.matches(new Jt(t,r))||(r=qt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=qt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(qt.EMPTY_NODE);const a=this;return t.forEachChild(en,(l,d)=>{a.matches(new Jt(l,d))||(i=i.updateImmediateChild(l,qt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class bf{constructor(e){this.rangedFilter_=new Au(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new Jt(t,r))||(r=qt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=qt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=qt.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const d=a.getNext();let p;if(p=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),d)<=0:this.index_.compare(d,this.rangedFilter_.getEndPost())<=0,!p)break;i=i.updateImmediateChild(d.name,d.node),l++}}else{let a,l,d,p;if(i=t.withIndex(this.index_),i=i.updatePriority(qt.EMPTY_NODE),this.reverse_){p=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();const T=this.index_.getCompare();d=(M,P)=>T(P,M)}else p=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),d=this.index_.getCompare();let y=0,b=!1;for(;p.hasNext();){const T=p.getNext();!b&&d(a,T)<=0&&(b=!0),b&&y<this.limit_&&d(T,l)<=0?y++:i=i.updateImmediateChild(T.name,qt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const T=this.index_.getCompare();l=(M,P)=>T(P,M)}else l=this.index_.getCompare();const d=e;(0,k.hu)(d.numChildren()===this.limit_,"");const p=new Jt(t,r),y=this.reverse_?d.getFirstChild(this.index_):d.getLastChild(this.index_),b=this.rangedFilter_.matches(p);if(d.hasChild(t)){const T=d.getImmediateChild(t);let M=i.getChildAfterChild(this.index_,y,this.reverse_);for(;null!=M&&(M.name===t||d.hasChild(M.name));)M=i.getChildAfterChild(this.index_,M,this.reverse_);const P=null==M?1:l(M,p);if(b&&!r.isEmpty()&&P>=0)return a?.trackChildChange(qn(t,r,T)),d.updateImmediateChild(t,r);{a?.trackChildChange(It(t,T));const ee=d.updateImmediateChild(t,qt.EMPTY_NODE);return null!=M&&this.rangedFilter_.matches(M)?(a?.trackChildChange(Dt(M.name,M.node)),ee.updateImmediateChild(M.name,M.node)):ee}}return r.isEmpty()?e:b&&l(y,p)>=0?(null!=a&&(a.trackChildChange(It(y.name,y.node)),a.trackChildChange(Dt(t,r))),d.updateImmediateChild(t,r).updateImmediateChild(y.name,qt.EMPTY_NODE)):e}}class La{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=en}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,k.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,k.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Wr}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,k.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,k.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ki}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,k.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===en}copy(){const e=new La;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Cf(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function Tf(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function Gl(n,e){const t=n.copy();return t.index_=e,t}function Gg(n){const e={};if(n.isDefault())return e;let t;return n.index_===en?t="$priority":n.index_===f?t="$value":n.index_===Fs?t="$key":((0,k.hu)(n.index_ instanceof xd,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,k.Pz)(t),n.startSet_&&(e.startAt=(0,k.Pz)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,k.Pz)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,k.Pz)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,k.Pz)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function py(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==en&&(e.i=n.index_.toString()),e}class Nd extends Cu{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Aa("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,k.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=Nd.getListenId_(e,r),d={};this.listens_[l]=d;const p=Gg(e._queryParams);this.restRequest_(a+".json",p,(y,b)=>{let T=b;if(404===y&&(T=null,y=null),null===y&&this.onDataUpdate_(a,T,!1,r),(0,k.DV)(this.listens_,l)===d){let M;M=y?401===y?"permission_denied":"rest_error:"+y:"ok",i(M,null)}})}unlisten(e,t){const r=Nd.getListenId_(e,t);delete this.listens_[r]}get(e){const t=Gg(e._queryParams),r=e._path.toString(),i=new k.BH;return this.restRequest_(r+".json",t,(a,l)=>{let d=l;404===a&&(d=null,a=null),null===a?(this.onDataUpdate_(r,d,!1,null),i.resolve(d)):i.reject(new Error(d))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,k.xO)(t);this.log_("Sending REST request for "+l);const d=new XMLHttpRequest;d.onreadystatechange=()=>{if(r&&4===d.readyState){this.log_("REST Response for "+l+" received. status:",d.status,"response:",d.responseText);let p=null;if(d.status>=200&&d.status<300){try{p=(0,k.cI)(d.responseText)}catch{ti("Failed to parse JSON response for "+l+": "+d.responseText)}r(null,p)}else 401!==d.status&&404!==d.status&&ti("Got unsuccessful REST response for "+l+" Status: "+d.status),r(d.status);r=null}},d.open("GET",l,!0),d.send()})}}class d0{constructor(){this.rootNode_=qt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Df(){return{value:null,children:new Map}}function Wl(n,e,t){if(Xt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=Qt(e);n.children.has(r)||n.children.set(r,Df()),Wl(n.children.get(r),e=Bn(e),t)}}function Sf(n,e){if(Xt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(en,(r,i)=>{Wl(n,new An(r),i)}),Sf(n,e)}}if(n.children.size>0){const t=Qt(e);return e=Bn(e),n.children.has(t)&&Sf(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function gy(n,e,t){null!==n.value?t(e,n.value):function my(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{gy(i,new An(e.toString()+"/"+r),t)})}class Af{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&zn(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class f0{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Af(e);const r=1e4+2e4*Math.random();uo(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;zn(e,(i,a)=>{a>0&&(0,k.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),uo(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Bs=(()=>{return(n=Bs||(Bs={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",Bs;var n})();function vy(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class kd{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Bs.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Xt(this.path)){if(null!=this.affectedTree.value)return(0,k.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new An(e));return new kd(Cn(),t,this.revert)}}return(0,k.hu)(Qt(this.path)===e,"operationForChild called for unrelated child."),new kd(Bn(this.path),this.affectedTree,this.revert)}}class Mf{constructor(e,t){this.source=e,this.path=t,this.type=Bs.LISTEN_COMPLETE}operationForChild(e){return Xt(this.path)?new Mf(this.source,Cn()):new Mf(this.source,Bn(this.path))}}class zl{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Bs.OVERWRITE}operationForChild(e){return Xt(this.path)?new zl(this.source,Cn(),this.snap.getImmediateChild(e)):new zl(this.source,Bn(this.path),this.snap)}}class Pd{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Bs.MERGE}operationForChild(e){if(Xt(this.path)){const t=this.children.subtree(new An(e));return t.isEmpty()?null:t.value?new zl(this.source,Cn(),t.value):new Pd(this.source,Cn(),t)}return(0,k.hu)(Qt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Pd(this.source,Bn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ua{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Xt(e))return this.isFullyInitialized()&&!this.filtered_;const t=Qt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class yD{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function qr(n,e,t,r,i,a){const l=r.filter(d=>d.type===t);l.sort((d,p)=>function p0(n,e,t){if(null==e.childName||null==t.childName)throw(0,k.g5)("Should only compare child_ events.");const r=new Jt(e.childName,e.snapshotNode),i=new Jt(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,d,p)),l.forEach(d=>{const p=function wy(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,d,a);i.forEach(y=>{y.respondsTo(d.type)&&e.push(y.createEvent(p,n.query_))})})}function Od(n,e){return{eventCache:n,serverCache:e}}function Pr(n,e,t,r){return Od(new Ua(e,t,r),n.serverCache)}function Fd(n,e,t,r){return Od(n.eventCache,new Ua(e,t,r))}function xf(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ql(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let Ey;class Kn{constructor(e,t=(()=>(Ey||(Ey=new zr(nf)),Ey))()){this.value=e,this.children=t}static fromObject(e){let t=new Kn(null);return zn(e,(r,i)=>{t=t.set(new An(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Cn(),value:this.value};if(Xt(e))return null;{const r=Qt(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(Bn(e),t);return null!=a?{path:Vn(new An(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Xt(e))return this;{const t=Qt(e),r=this.children.get(t);return null!==r?r.subtree(Bn(e)):new Kn(null)}}set(e,t){if(Xt(e))return new Kn(t,this.children);{const r=Qt(e),a=(this.children.get(r)||new Kn(null)).set(Bn(e),t),l=this.children.insert(r,a);return new Kn(this.value,l)}}remove(e){if(Xt(e))return this.children.isEmpty()?new Kn(null):new Kn(null,this.children);{const t=Qt(e),r=this.children.get(t);if(r){const i=r.remove(Bn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new Kn(null):new Kn(this.value,a)}return this}}get(e){if(Xt(e))return this.value;{const t=Qt(e),r=this.children.get(t);return r?r.get(Bn(e)):null}}setTree(e,t){if(Xt(e))return t;{const r=Qt(e),a=(this.children.get(r)||new Kn(null)).setTree(Bn(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new Kn(this.value,l)}}fold(e){return this.fold_(Cn(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(Vn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Cn(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(Xt(e))return null;{const a=Qt(e),l=this.children.get(a);return l?l.findOnPath_(Bn(e),Vn(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Cn(),t)}foreachOnPath_(e,t,r){if(Xt(e))return this;{this.value&&r(t,this.value);const i=Qt(e),a=this.children.get(i);return a?a.foreachOnPath_(Bn(e),Vn(t,i),r):new Kn(null)}}foreach(e){this.foreach_(Cn(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Vn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Vs{constructor(e){this.writeTree_=e}static empty(){return new Vs(new Kn(null))}}function Rf(n,e,t){if(Xt(e))return new Vs(new Kn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=ni(i,e);return a=a.updateChild(l,t),new Vs(n.writeTree_.set(i,a))}{const i=new Kn(t),a=n.writeTree_.setTree(e,i);return new Vs(a)}}}function Wg(n,e,t){let r=n;return zn(t,(i,a)=>{r=Rf(r,Vn(e,i),a)}),r}function m0(n,e){if(Xt(e))return Vs.empty();{const t=n.writeTree_.setTree(e,new Kn(null));return new Vs(t)}}function Iy(n,e){return null!=Kl(n,e)}function Kl(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(ni(t.path,e)):null}function _0(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(en,(r,i)=>{e.push(new Jt(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new Jt(r,i.value))}),e}function Mu(n,e){if(Xt(e))return n;{const t=Kl(n,e);return new Vs(null!=t?new Kn(t):n.writeTree_.subtree(e))}}function xu(n){return n.writeTree_.isEmpty()}function Xi(n,e){return y0(Cn(),n.writeTree_,e)}function y0(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,k.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=y0(Vn(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Vn(n,".priority"),r)),t}}function zg(n,e){return b0(e,n)}function Qo(n,e){if(n.snap)return _i(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&_i(Vn(n.path,t),e))return!0;return!1}function Cy(n){return n.visible}function w0(n,e,t){let r=Vs.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let d;if(a.snap)_i(t,l)?(d=ni(t,l),r=Rf(r,d,a.snap)):_i(l,t)&&(d=ni(l,t),r=Rf(r,Cn(),a.snap.getChild(d)));else{if(!a.children)throw(0,k.g5)("WriteRecord should have .snap or .children");if(_i(t,l))d=ni(t,l),r=Wg(r,d,a.children);else if(_i(l,t))if(d=ni(l,t),Xt(d))r=Wg(r,Cn(),a.children);else{const p=(0,k.DV)(a.children,Qt(d));if(p){const y=p.getChild(Bn(d));r=Rf(r,Cn(),y)}}}}}return r}function Ty(n,e,t,r,i){if(r||i){const a=Mu(n.visibleWrites,e);return!i&&xu(a)?t:i||null!=t||Iy(a,Cn())?Xi(w0(n.allWrites,function(y){return(y.visible||i)&&(!r||!~r.indexOf(y.writeId))&&(_i(y.path,e)||_i(e,y.path))},e),t||qt.EMPTY_NODE):null}{const a=Kl(n.visibleWrites,e);if(null!=a)return a;{const l=Mu(n.visibleWrites,e);return xu(l)?t:null!=t||Iy(l,Cn())?Xi(l,t||qt.EMPTY_NODE):null}}}function kf(n,e,t,r){return Ty(n.writeTree,n.treePath,e,t,r)}function E0(n,e){return function wD(n,e,t){let r=qt.EMPTY_NODE;const i=Kl(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(en,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=Mu(n.visibleWrites,e);return t.forEachChild(en,(l,d)=>{const p=Xi(Mu(a,new An(l)),d);r=r.updateImmediateChild(l,p)}),_0(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return _0(Mu(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function Zl(n,e,t,r){return function Nf(n,e,t,r,i){(0,k.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=Vn(e,t);if(Iy(n.visibleWrites,a))return null;{const l=Mu(n.visibleWrites,a);return xu(l)?i.getChild(t):Xi(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function Ld(n,e){return function ID(n,e){return Kl(n.visibleWrites,e)}(n.writeTree,Vn(n.treePath,e))}function Ay(n,e,t){return function ED(n,e,t,r){const i=Vn(e,t),a=Kl(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?Xi(Mu(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function qg(n,e){return b0(Vn(n.treePath,e),n.writeTree)}function b0(n,e){return{treePath:n,writeTree:e}}class bD{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,k.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,k.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,qn(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,It(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,Dt(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,k.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,qn(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const C0=new class CD{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class My{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Ua(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ay(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ql(this.viewCache_),a=function I0(n,e,t,r,i,a){return function Dy(n,e,t,r,i,a,l){let d;const p=Mu(n.visibleWrites,e),y=Kl(p,Cn());if(null!=y)d=y;else{if(null==t)return[];d=Xi(p,t)}if(d=d.withIndex(l),d.isEmpty()||d.isLeafNode())return[];{const b=[],T=l.getCompare(),M=a?d.getReverseIteratorFrom(r,l):d.getIteratorFrom(r,l);let P=M.getNext();for(;P&&b.length<i;)0!==T(P,r)&&b.push(P),P=M.getNext();return b}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function Kg(n,e,t,r,i,a){const l=e.eventCache;if(null!=Ld(r,t))return e;{let d,p;if(Xt(t))if((0,k.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const y=ql(e),T=E0(r,y instanceof qt?y:qt.EMPTY_NODE);d=n.filter.updateFullNode(e.eventCache.getNode(),T,a)}else{const y=kf(r,ql(e));d=n.filter.updateFullNode(e.eventCache.getNode(),y,a)}else{const y=Qt(t);if(".priority"===y){(0,k.hu)(1===Os(t),"Can't have a priority with additional path components");const b=l.getNode();p=e.serverCache.getNode();const T=Zl(r,t,b,p);d=null!=T?n.filter.updatePriority(b,T):l.getNode()}else{const b=Bn(t);let T;if(l.isCompleteForChild(y)){p=e.serverCache.getNode();const M=Zl(r,t,l.getNode(),p);T=null!=M?l.getNode().getImmediateChild(y).updateChild(b,M):l.getNode().getImmediateChild(y)}else T=Ay(r,y,e.serverCache);d=null!=T?n.filter.updateChild(l.getNode(),y,T,b,i,a):l.getNode()}}return Pr(e,d,l.isFullyInitialized()||Xt(t),n.filter.filtersNodes())}}function Zg(n,e,t,r,i,a,l,d){const p=e.serverCache;let y;const b=l?n.filter:n.filter.getIndexedFilter();if(Xt(t))y=b.updateFullNode(p.getNode(),r,null);else if(b.filtersNodes()&&!p.isFiltered()){const P=p.getNode().updateChild(t,r);y=b.updateFullNode(p.getNode(),P,null)}else{const P=Qt(t);if(!p.isCompleteForPath(t)&&Os(t)>1)return e;const U=Bn(t),oe=p.getNode().getImmediateChild(P).updateChild(U,r);y=".priority"===P?b.updatePriority(p.getNode(),oe):b.updateChild(p.getNode(),P,oe,U,C0,null)}const T=Fd(e,y,p.isFullyInitialized()||Xt(t),b.filtersNodes());return Kg(n,T,t,i,new My(i,T,a),d)}function Ry(n,e,t,r,i,a,l){const d=e.eventCache;let p,y;const b=new My(i,e,a);if(Xt(t))y=n.filter.updateFullNode(e.eventCache.getNode(),r,l),p=Pr(e,y,!0,n.filter.filtersNodes());else{const T=Qt(t);if(".priority"===T)y=n.filter.updatePriority(e.eventCache.getNode(),r),p=Pr(e,y,d.isFullyInitialized(),d.isFiltered());else{const M=Bn(t),P=d.getNode().getImmediateChild(T);let U;if(Xt(M))U=r;else{const ee=b.getCompleteChild(T);U=null!=ee?".priority"===_f(M)&&ee.getChild(Og(M)).isEmpty()?ee:ee.updateChild(M,r):qt.EMPTY_NODE}p=P.equals(U)?e:Pr(e,n.filter.updateChild(d.getNode(),T,U,M,b,l),d.isFullyInitialized(),n.filter.filtersNodes())}}return p}function Ny(n,e){return n.eventCache.isCompleteForChild(e)}function Ru(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Yg(n,e,t,r,i,a,l,d){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let y,p=e;y=Xt(t)?r:new Kn(null).setTree(t,r);const b=e.serverCache.getNode();return y.children.inorderTraversal((T,M)=>{if(b.hasChild(T)){const U=Ru(0,e.serverCache.getNode().getImmediateChild(T),M);p=Zg(n,p,new An(T),U,i,a,l,d)}}),y.children.inorderTraversal((T,M)=>{const P=!e.serverCache.isCompleteForChild(T)&&null===M.value;if(!b.hasChild(T)&&!P){const ee=Ru(0,e.serverCache.getNode().getImmediateChild(T),M);p=Zg(n,p,new An(T),ee,i,a,l,d)}}),p}class Qg{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new Yo(r.getIndex()),a=function fy(n){return n.loadsAllData()?new Yo(n.getIndex()):n.hasLimit()?new bf(n):new Au(n)}(r);this.processor_=function TD(n){return{filter:n}}(a);const l=t.serverCache,d=t.eventCache,p=i.updateFullNode(qt.EMPTY_NODE,l.getNode(),null),y=a.updateFullNode(qt.EMPTY_NODE,d.getNode(),null),b=new Ua(p,l.isFullyInitialized(),i.filtersNodes()),T=new Ua(y,d.isFullyInitialized(),a.filtersNodes());this.viewCache_=Od(T,b),this.eventGenerator_=new yD(this.query_)}get query(){return this.query_}}function x0(n,e){const t=ql(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Xt(e)&&!t.getImmediateChild(Qt(e)).isEmpty())?t.getChild(e):null}function ky(n){return 0===n.eventRegistrations_.length}function Oy(n,e,t){const r=[];if(t){(0,k.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function Pf(n,e,t,r){e.type===Bs.MERGE&&null!==e.source.queryId&&((0,k.hu)(ql(n.viewCache_),"We should always have a full cache before handling merges"),(0,k.hu)(xf(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function xy(n,e,t,r,i){const a=new bD;let l,d;if(t.type===Bs.OVERWRITE){const y=t;y.source.fromUser?l=Ry(n,e,y.path,y.snap,r,i,a):((0,k.hu)(y.source.fromServer,"Unknown source."),d=y.source.tagged||e.serverCache.isFiltered()&&!Xt(y.path),l=Zg(n,e,y.path,y.snap,r,i,d,a))}else if(t.type===Bs.MERGE){const y=t;y.source.fromUser?l=function S0(n,e,t,r,i,a,l){let d=e;return r.foreach((p,y)=>{const b=Vn(t,p);Ny(e,Qt(b))&&(d=Ry(n,d,b,y,i,a,l))}),r.foreach((p,y)=>{const b=Vn(t,p);Ny(e,Qt(b))||(d=Ry(n,d,b,y,i,a,l))}),d}(n,e,y.path,y.children,r,i,a):((0,k.hu)(y.source.fromServer,"Unknown source."),d=y.source.tagged||e.serverCache.isFiltered(),l=Yg(n,e,y.path,y.children,r,i,d,a))}else if(t.type===Bs.ACK_USER_WRITE){const y=t;l=y.revert?function qk(n,e,t,r,i,a){let l;if(null!=Ld(r,t))return e;{const d=new My(r,e,i),p=e.eventCache.getNode();let y;if(Xt(t)||".priority"===Qt(t)){let b;if(e.serverCache.isFullyInitialized())b=kf(r,ql(e));else{const T=e.serverCache.getNode();(0,k.hu)(T instanceof qt,"serverChildren would be complete if leaf node"),b=E0(r,T)}y=n.filter.updateFullNode(p,b,a)}else{const b=Qt(t);let T=Ay(r,b,e.serverCache);null==T&&e.serverCache.isCompleteForChild(b)&&(T=p.getImmediateChild(b)),y=null!=T?n.filter.updateChild(p,b,T,Bn(t),d,a):e.eventCache.getNode().hasChild(b)?n.filter.updateChild(p,b,qt.EMPTY_NODE,Bn(t),d,a):p,y.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=kf(r,ql(e)),l.isLeafNode()&&(y=n.filter.updateFullNode(y,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=Ld(r,Cn()),Pr(e,y,l,n.filter.filtersNodes())}}(n,e,y.path,r,i,a):function A0(n,e,t,r,i,a,l){if(null!=Ld(i,t))return e;const d=e.serverCache.isFiltered(),p=e.serverCache;if(null!=r.value){if(Xt(t)&&p.isFullyInitialized()||p.isCompleteForPath(t))return Zg(n,e,t,p.getNode().getChild(t),i,a,d,l);if(Xt(t)){let y=new Kn(null);return p.getNode().forEachChild(Fs,(b,T)=>{y=y.set(new An(b),T)}),Yg(n,e,t,y,i,a,d,l)}return e}{let y=new Kn(null);return r.foreach((b,T)=>{const M=Vn(t,b);p.isCompleteForPath(M)&&(y=y.set(b,p.getNode().getChild(M)))}),Yg(n,e,t,y,i,a,d,l)}}(n,e,y.path,y.affectedTree,r,i,a)}else{if(t.type!==Bs.LISTEN_COMPLETE)throw(0,k.g5)("Unknown operation type: "+t.type);l=function DD(n,e,t,r,i){const a=e.serverCache;return Kg(n,Fd(e,a.getNode(),a.isFullyInitialized()||Xt(t),a.isFiltered()),t,r,C0,i)}(n,e,t.path,r,a)}const p=a.getChanges();return function D0(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=xf(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(ct(xf(e)))}}(e,l,p),{viewCache:l,changes:p}}(n.processor_,i,e,t,r);return function T0(n,e){(0,k.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,k.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,k.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,Fy(n,a.changes,a.viewCache.eventCache.getNode(),null)}function Fy(n,e,t,r){return function vD(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function Qi(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),qr(n,i,"child_removed",e,r,t),qr(n,i,"child_added",e,r,t),qr(n,i,"child_moved",a,r,t),qr(n,i,"child_changed",e,r,t),qr(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let Ud,tm;class Ly{constructor(){this.views=new Map}}function Jg(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,k.hu)(null!=a,"SyncTree gave us an op for an invalid query."),Pf(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(Pf(l,e,t,r));return a}}function R0(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let d=kf(t,i?r:null),p=!1;d?p=!0:r instanceof qt?(d=E0(t,r),p=!1):(d=qt.EMPTY_NODE,p=!1);const y=Od(new Ua(d,p,!1),new Ua(r,i,!1));return new Qg(e,y)}return l}function em(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Ba(n,e){let t=null;for(const r of n.views.values())t=t||x0(r,e);return t}function xD(n,e){return e._queryParams.loadsAllData()?Ff(n):n.views.get(e._queryIdentifier)}function By(n,e){return null!=xD(n,e)}function Nu(n){return null!=Ff(n)}function Ff(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let ND=1;class Vy{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Kn(null),this.pendingWriteTree_=function Sy(){return{visibleWrites:Vs.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function jy(n,e,t,r,i){return function Gk(n,e,t,r,i){(0,k.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Rf(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?Bd(n,new zl({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function ku(n,e,t=!1){const r=function v0(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function zk(n,e){const t=n.allWrites.findIndex(d=>d.writeId===e);(0,k.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const d=n.allWrites[l];d.visible&&(l>=t&&Qo(d,r.path)?i=!1:_i(r.path,d.path)&&(a=!0)),l--}return!!i&&(a?(function by(n){n.visibleWrites=w0(n.allWrites,Cy,Cn()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=m0(n.visibleWrites,r.path):zn(r.children,p=>{n.visibleWrites=m0(n.visibleWrites,Vn(r.path,p))}),!0))}(n.pendingWriteTree_,e)){let a=new Kn(null);return null!=r.snap?a=a.set(Cn(),!0):zn(r.children,l=>{a=a.set(new An(l),!0)}),Bd(n,new kd(r.path,a,t))}return[]}function Lf(n,e,t){return Bd(n,new zl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function nm(n,e,t,r,i=!1){const a=e._path,l=n.syncPointTree_.get(a);let d=[];if(l&&("default"===e._queryIdentifier||By(l,e))){const p=function N0(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const d=Nu(n);if("default"===i)for(const[p,y]of n.views.entries())l=l.concat(Oy(y,t,r)),ky(y)&&(n.views.delete(p),y.query._queryParams.loadsAllData()||a.push(y.query));else{const p=n.views.get(i);p&&(l=l.concat(Oy(p,t,r)),ky(p)&&(n.views.delete(i),p.query._queryParams.loadsAllData()||a.push(p.query)))}return d&&!Nu(n)&&a.push(new(function Of(){return(0,k.hu)(Ud,"Reference.ts has not been loaded"),Ud}())(e._repo,e._path)),{removed:a,events:l}}(l,e,t,r);(function AD(n){return 0===n.views.size})(l)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const y=p.removed;if(d=p.events,!i){const b=-1!==y.findIndex(M=>M._queryParams.loadsAllData()),T=n.syncPointTree_.findOnPath(a,(M,P)=>Nu(P));if(b&&!T){const M=n.syncPointTree_.subtree(a);if(!M.isEmpty()){const P=function Yl(n){return n.fold((e,t,r)=>{if(t&&Nu(t))return[Ff(t)];{let i=[];return t&&(i=em(t)),zn(r,(a,l)=>{i=i.concat(l)}),i}})}(M);for(let U=0;U<P.length;++U){const ee=P[U],oe=ee.query,Ge=Hy(n,ee);n.listenProvider_.startListening(Vf(oe),Bf(n,oe),Ge.hashFn,Ge.onComplete)}}}!T&&y.length>0&&!r&&(b?n.listenProvider_.stopListening(Vf(e),null):y.forEach(M=>{const P=n.queryToTagMap.get(im(M));n.listenProvider_.stopListening(Vf(M),P)}))}!function Gy(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=im(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,y)}return d}function Kt(n,e,t,r){const i=F0(n,r);if(null!=i){const a=sm(i),l=a.path,d=a.queryId,p=ni(l,e);return om(n,l,new zl(vy(d),p,t))}return[]}function rm(n,e,t,r=!1){const i=e._path;let a=null,l=!1;n.syncPointTree_.foreachOnPath(i,(M,P)=>{const U=ni(M,i);a=a||Ba(P,U),l=l||Nu(P)});let p,d=n.syncPointTree_.get(i);d?(l=l||Nu(d),a=a||Ba(d,Cn())):(d=new Ly,n.syncPointTree_=n.syncPointTree_.set(i,d)),null!=a?p=!0:(p=!1,a=qt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((P,U)=>{const ee=Ba(U,Cn());ee&&(a=a.updateImmediateChild(P,ee))}));const y=By(d,e);if(!y&&!e._queryParams.loadsAllData()){const M=im(e);(0,k.hu)(!n.queryToTagMap.has(M),"View does not exist, but we have a tag");const P=function Wy(){return ND++}();n.queryToTagMap.set(M,P),n.tagToQueryMap.set(P,M)}let T=function MD(n,e,t,r,i,a){const l=R0(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function Py(n,e){n.eventRegistrations_.push(e)}(l,t),function Xg(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(en,(a,l)=>{r.push(Dt(a,l))}),t.isFullyInitialized()&&r.push(ct(t.getNode())),Fy(n,r,t.getNode(),e)}(l,t)}(d,e,t,zg(n.pendingWriteTree_,i),a,p);if(!y&&!l&&!r){const M=xD(d,e);T=T.concat(function LD(n,e,t){const r=e._path,i=Bf(n,e),a=Hy(n,t),l=n.listenProvider_.startListening(Vf(e),i,a.hashFn,a.onComplete),d=n.syncPointTree_.subtree(r);if(i)(0,k.hu)(!Nu(d.value),"If we're adding a query, it shouldn't be shadowed");else{const p=d.fold((y,b,T)=>{if(!Xt(y)&&b&&Nu(b))return[Ff(b).query];{let M=[];return b&&(M=M.concat(em(b).map(P=>P.query))),zn(T,(P,U)=>{M=M.concat(U)}),M}});for(let y=0;y<p.length;++y){const b=p[y];n.listenProvider_.stopListening(Vf(b),Bf(n,b))}}return l}(n,e,M))}return T}function Uf(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,d)=>{const y=Ba(d,ni(l,e));if(y)return y});return Ty(i,e,a,t,!0)}function Bd(n,e){return $y(e,n.syncPointTree_,null,zg(n.pendingWriteTree_,Cn()))}function $y(n,e,t,r){if(Xt(n.path))return O0(n,e,t,r);{const i=e.get(Cn());null==t&&null!=i&&(t=Ba(i,Cn()));let a=[];const l=Qt(n.path),d=n.operationForChild(l),p=e.children.get(l);if(p&&d){const y=t?t.getImmediateChild(l):null,b=qg(r,l);a=a.concat($y(d,p,y,b))}return i&&(a=a.concat(Jg(i,n,r,t))),a}}function O0(n,e,t,r){const i=e.get(Cn());null==t&&null!=i&&(t=Ba(i,Cn()));let a=[];return e.children.inorderTraversal((l,d)=>{const p=t?t.getImmediateChild(l):null,y=qg(r,l),b=n.operationForChild(l);b&&(a=a.concat(O0(b,d,p,y)))}),i&&(a=a.concat(Jg(i,n,r,t))),a}function Hy(n,e){const t=e.query,r=Bf(n,t);return{hashFn:()=>(function SD(n){return n.viewCache_.serverCache.getNode()}(e)||qt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function OD(n,e,t){const r=F0(n,t);if(r){const i=sm(r),a=i.path,l=i.queryId,d=ni(a,e);return om(n,a,new Mf(vy(l),d))}return[]}(n,t._path,r):function PD(n,e){return Bd(n,new Mf({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function Cg(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return nm(n,t,null,a)}}}}function Bf(n,e){const t=im(e);return n.queryToTagMap.get(t)}function im(n){return n._path.toString()+"$"+n._queryIdentifier}function F0(n,e){return n.tagToQueryMap.get(e)}function sm(n){const e=n.indexOf("$");return(0,k.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new An(n.substr(0,e))}}function om(n,e,t){const r=n.syncPointTree_.get(e);return(0,k.hu)(r,"Missing sync point for query tag that we're tracking"),Jg(r,t,zg(n.pendingWriteTree_,e),null)}function Vf(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function ho(){return(0,k.hu)(tm,"Reference.ts has not been loaded"),tm}())(n._repo,n._path):n}class L0{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new L0(t)}node(){return this.node_}}class U0{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Vn(this.path_,e);return new U0(this.syncTree_,t)}node(){return Uf(this.syncTree_,this.path_)}}const B0=function(n,e,t){return n&&"object"==typeof n?((0,k.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?V0(n[".sv"],e,t):"object"==typeof n[".sv"]?Zk(n[".sv"],e):void(0,k.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},V0=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,k.hu)(!1,"Unexpected server value: "+n)},Zk=function(n,e,t){n.hasOwnProperty("increment")||(0,k.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,k.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,k.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},j0=function(n,e,t,r){return zy(e,new U0(t,n),r)},Pu=function(n,e,t){return zy(n,new L0(e),t)};function zy(n,e,t){const r=n.getPriority().val(),i=B0(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,d=B0(l.getValue(),e,t);return d!==l.getValue()||i!==l.getPriority().val()?new ri(d,tr(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new ri(i))),l.forEachChild(en,(d,p)=>{const y=zy(p,e.getImmediateChild(d),t);y!==p&&(a=a.updateImmediateChild(d,y))}),a}}class am{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function Ql(n,e){let t=e instanceof An?e:new An(e),r=n,i=Qt(t);for(;null!==i;){const a=(0,k.DV)(r.node.children,i)||{children:{},childCount:0};r=new am(i,r,a),t=Bn(t),i=Qt(t)}return r}function Xl(n){return n.node.value}function um(n,e){n.node.value=e,qy(n)}function $0(n){return n.node.childCount>0}function lm(n,e){zn(n.node.children,(t,r)=>{e(new am(t,n,r))})}function H0(n,e,t,r){t&&!r&&e(n),lm(n,i=>{H0(i,e,!0,r)}),t&&r&&e(n)}function Vd(n){return new An(null===n.parent?n.name:Vd(n.parent)+"/"+n.name)}function qy(n){null!==n.parent&&function G0(n,e,t){const r=function UD(n){return void 0===Xl(n)&&!$0(n)}(t),i=(0,k.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,qy(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,qy(n))}(n.parent,n.name,n)}const W0=/[\[\].#$\/\u0000-\u001F\u007F]/,Ky=/[\[\].#$\u0000-\u001F\u007F]/,z0=10485760,jd=function(n){return"string"==typeof n&&0!==n.length&&!W0.test(n)},q0=function(n){return"string"==typeof n&&0!==n.length&&!Ky.test(n)},Xo=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!ao(n)||n&&"object"==typeof n&&(0,k.r3)(n,".sv")},fo=function(n,e,t,r){r&&void 0===e||$d((0,k.gK)(n,"value"),e,t)},$d=function(n,e,t){const r=t instanceof An?new cy(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+co(r));if("function"==typeof e)throw new Error(n+"contains a function "+co(r)+" with contents = "+e.toString());if(ao(e))throw new Error(n+"contains "+e.toString()+" "+co(r));if("string"==typeof e&&e.length>z0/3&&(0,k.ug)(e)>z0)throw new Error(n+"contains a string greater than "+z0+" utf8 bytes "+co(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(zn(e,(l,d)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!jd(l)))throw new Error(n+" contains an invalid key ("+l+") "+co(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function wr(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,k.ug)(e),Lg(n)})(r,l),$d(n,d,r),function Fg(n){const e=n.parts_.pop();n.byteLength_-=(0,k.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+co(r)+" in addition to actual children.")}},js=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,k.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];zn(e,(l,d)=>{const p=new An(l);if($d(i,d,Vn(t,p)),".priority"===_f(p)&&!Xo(d))throw new Error(i+"contains an invalid value for '"+p.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(p)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=Ll(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!jd(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(bd);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&_i(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},dm=function(n,e,t){if(!t||void 0!==e){if(ao(e))throw new Error((0,k.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Xo(e))throw new Error((0,k.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},jf=function(n,e,t,r){if(!(r&&void 0===t||jd(t)))throw new Error((0,k.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Jl=function(n,e,t,r){if(!(r&&void 0===t||q0(t)))throw new Error((0,k.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ji=function(n,e){if(".info"===Qt(e))throw new Error(n+" failed = Can't modify data under /.info/")},Zy=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!jd(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),q0(n)}(t))throw new Error((0,k.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Yy{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Qy(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!Tu(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function Xy(n,e,t){Qy(n,t),$f(n,r=>Tu(r,e))}function $s(n,e,t){Qy(n,t),$f(n,r=>_i(r,e)||_i(e,r))}function $f(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(hm(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function hm(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();Go&&kr("event: "+t.toString()),_u(r)}}}const fm="repo_interrupt";class ev{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Yy,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Df(),this.transactionQueueTree_=new am,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function K0(n){const t=n.infoData_.getNode(new An(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Hf(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:K0(n)})}function Z0(n,e,t,r,i){n.dataUpdateCount++;const a=new An(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const p=(0,k.UI)(t,y=>tr(y));l=function P0(n,e,t,r){const i=F0(n,r);if(i){const a=sm(i),l=a.path,d=a.queryId,p=ni(l,e),y=Kn.fromObject(t);return om(n,l,new Pd(vy(d),p,y))}return[]}(n.serverSyncTree_,a,p,i)}else{const p=tr(t);l=Kt(n.serverSyncTree_,a,p,i)}else if(r){const p=(0,k.UI)(t,y=>tr(y));l=function k0(n,e,t){const r=Kn.fromObject(t);return Bd(n,new Pd({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,p)}else{const p=tr(t);l=Lf(n.serverSyncTree_,a,p)}let d=a;l.length>0&&(d=tc(n,a)),$s(n.eventQueue_,d,l)}function Y0(n,e){X0(n,"connected",e),!1===e&&function VD(n){Gf(n,"onDisconnectEvents");const e=Hf(n),t=Df();gy(n.onDisconnect_,Cn(),(i,a)=>{const l=j0(i,a,n.serverSyncTree_,e);Wl(t,i,l)});let r=[];gy(t,Cn(),(i,a)=>{r=r.concat(Lf(n.serverSyncTree_,i,a));const l=_m(n,i);tc(n,l)}),n.onDisconnect_=Df(),$s(n.eventQueue_,Cn(),r)}(n)}function X0(n,e,t){const r=new An("/.info/"+e),i=tr(t);n.infoData_.updateSnapshot(r,i);const a=Lf(n.infoSyncTree_,r,i);$s(n.eventQueue_,r,a)}function pm(n){return n.nextWriteId_++}function gm(n,e,t,r,i){Gf(n,"set",{path:e.toString(),value:t,priority:r});const a=Hf(n),l=tr(t,r),d=Uf(n.serverSyncTree_,e),p=Pu(l,d,a),y=pm(n),b=jy(n.serverSyncTree_,e,p,y,!0);Qy(n.eventQueue_,b),n.server_.put(e.toString(),l.val(!0),(M,P)=>{const U="ok"===M;U||ti("set at "+e+" failed: "+M);const ee=ku(n.serverSyncTree_,y,!U);$s(n.eventQueue_,e,ee),ec(0,i,M,P)});const T=_m(n,e);tc(n,T),$s(n.eventQueue_,T,[])}function tv(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&Sf(n.onDisconnect_,e),ec(0,t,r,i)})}function jD(n,e,t,r){const i=tr(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&Wl(n.onDisconnect_,e,i),ec(0,r,a,l)})}function eI(n,e,t){let r;r=".info"===Qt(e._path)?nm(n.infoSyncTree_,e,t):nm(n.serverSyncTree_,e,t),Xy(n.eventQueue_,e._path,r)}function $D(n){n.persistentConnection_&&n.persistentConnection_.interrupt(fm)}function Gf(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),kr(t,...e)}function ec(n,e,t,r){e&&_u(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function Jo(n,e,t){return Uf(n.serverSyncTree_,e,t)||qt.EMPTY_NODE}function Hd(n,e=n.transactionQueueTree_){if(e||po(n,e),Xl(e)){const t=mm(n,e);(0,k.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function HD(n,e,t){const r=t.map(y=>y.currentWriteId),i=Jo(n,e,r);let a=i;const l=i.hash();for(let y=0;y<t.length;y++){const b=t[y];(0,k.hu)(0===b.status,"tryToSendTransactionQueue_: items in queue should all be run."),b.status=1,b.retryCount++;const T=ni(e,b.path);a=a.updateChild(T,b.currentOutputSnapshotRaw)}const d=a.val(!0),p=e;n.server_.put(p.toString(),d,y=>{Gf(n,"transaction put response",{path:p.toString(),status:y});let b=[];if("ok"===y){const T=[];for(let M=0;M<t.length;M++)t[M].status=2,b=b.concat(ku(n.serverSyncTree_,t[M].currentWriteId)),t[M].onComplete&&T.push(()=>t[M].onComplete(null,!0,t[M].currentOutputSnapshotResolved)),t[M].unwatcher();po(n,Ql(n.transactionQueueTree_,e)),Hd(n,n.transactionQueueTree_),$s(n.eventQueue_,e,b);for(let M=0;M<T.length;M++)_u(T[M])}else{if("datastale"===y)for(let T=0;T<t.length;T++)t[T].status=3===t[T].status?4:0;else{ti("transaction at "+p.toString()+" failed: "+y);for(let T=0;T<t.length;T++)t[T].status=4,t[T].abortReason=y}tc(n,e)}},l)}(n,Vd(e),t)}else $0(e)&&lm(e,t=>{Hd(n,t)})}function tc(n,e){const t=rv(n,e),r=Vd(t);return function nv(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(d=>0===d.status).map(d=>d.currentWriteId);for(let d=0;d<e.length;d++){const p=e[d],y=ni(t,p.path);let T,b=!1;if((0,k.hu)(null!==y,"rerunTransactionsUnderNode_: relativePath should not be null."),4===p.status)b=!0,T=p.abortReason,i=i.concat(ku(n.serverSyncTree_,p.currentWriteId,!0));else if(0===p.status)if(p.retryCount>=25)b=!0,T="maxretry",i=i.concat(ku(n.serverSyncTree_,p.currentWriteId,!0));else{const M=Jo(n,p.path,l);p.currentInputSnapshot=M;const P=e[d].update(M.val());if(void 0!==P){$d("transaction failed: Data returned ",P,p.path);let U=tr(P);"object"==typeof P&&null!=P&&(0,k.r3)(P,".priority")||(U=U.updatePriority(M.getPriority()));const oe=p.currentWriteId,Ge=Hf(n),Je=Pu(U,M,Ge);p.currentOutputSnapshotRaw=U,p.currentOutputSnapshotResolved=Je,p.currentWriteId=pm(n),l.splice(l.indexOf(oe),1),i=i.concat(jy(n.serverSyncTree_,p.path,Je,p.currentWriteId,p.applyLocally)),i=i.concat(ku(n.serverSyncTree_,oe,!0))}else b=!0,T="nodata",i=i.concat(ku(n.serverSyncTree_,p.currentWriteId,!0))}$s(n.eventQueue_,t,i),i=[],b&&(e[d].status=2,setTimeout(e[d].unwatcher,Math.floor(0)),e[d].onComplete&&r.push("nodata"===T?()=>e[d].onComplete(null,!1,e[d].currentInputSnapshot):()=>e[d].onComplete(new Error(T),!1,null)))}po(n,n.transactionQueueTree_);for(let d=0;d<r.length;d++)_u(r[d]);Hd(n,n.transactionQueueTree_)}(n,mm(n,t),r),r}function rv(n,e){let t,r=n.transactionQueueTree_;for(t=Qt(e);null!==t&&void 0===Xl(r);)r=Ql(r,t),t=Qt(e=Bn(e));return r}function mm(n,e){const t=[];return tI(n,e,t),t.sort((r,i)=>r.order-i.order),t}function tI(n,e,t){const r=Xl(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);lm(e,i=>{tI(n,i,t)})}function po(n,e){const t=Xl(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,um(e,t.length>0?t:void 0)}lm(e,r=>{po(n,r)})}function _m(n,e){const t=Vd(rv(n,e)),r=Ql(n.transactionQueueTree_,e);return function BD(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{iv(n,i)}),iv(n,r),H0(r,i=>{iv(n,i)}),t}function iv(n,e){const t=Xl(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,k.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,k.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(ku(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?um(e,void 0):t.length=a+1,$s(n.eventQueue_,Vd(e),i);for(let l=0;l<r.length;l++)_u(r[l])}}const sv=function(n,e){const t=WD(n),r=t.namespace;return"firebase.com"===t.domain&&qi(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&qi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ti("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new _d(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new An(t.pathString)}},WD=function(n){let e="",t="",r="",i="",a="",l=!0,d="https",p=443;if("string"==typeof n){let y=n.indexOf("//");y>=0&&(d=n.substring(0,y-1),n=n.substring(y+2));let b=n.indexOf("/");-1===b&&(b=n.length);let T=n.indexOf("?");-1===T&&(T=n.length),e=n.substring(0,Math.min(b,T)),b<T&&(i=function GD(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(b,T)));const M=function nI(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):ti(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,T)));y=e.indexOf(":"),y>=0?(l="https"===d||"wss"===d,p=parseInt(e.substring(y+1),10)):y=e.length;const P=e.slice(0,y);if("localhost"===P.toLowerCase())t="localhost";else if(P.split(".").length<=2)t=P;else{const U=e.indexOf(".");r=e.substring(0,U).toLowerCase(),t=e.substring(U+1),a=r}"ns"in M&&(a=M.ns)}return{host:e,port:p,domain:t,subdomain:r,secure:l,scheme:d,pathString:i,namespace:a}};class Wf{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,k.Pz)(this.snapshot.exportVal())}}class nc{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class zf{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,k.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class rc{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new k.BH;return tv(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Ji("OnDisconnect.remove",this._path);const e=new k.BH;return jD(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Ji("OnDisconnect.set",this._path),fo("OnDisconnect.set",e,this._path,!1);const t=new k.BH;return jD(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Ji("OnDisconnect.setWithPriority",this._path),fo("OnDisconnect.setWithPriority",e,this._path,!1),dm("OnDisconnect.setWithPriority",t,!1);const r=new k.BH;return function Jk(n,e,t,r,i){const a=tr(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,d)=>{"ok"===l&&Wl(n.onDisconnect_,e,a),ec(0,i,l,d)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Ji("OnDisconnect.update",this._path),js("OnDisconnect.update",e,this._path,!1);const t=new k.BH;return function eP(n,e,t,r){if((0,k.xb)(t))return kr("onDisconnect().update() called with empty data.  Don't do anything."),void ec(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&zn(t,(l,d)=>{const p=tr(d);Wl(n.onDisconnect_,Vn(e,l),p)}),ec(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class yi{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Xt(this._path)?null:_f(this._path)}get ref(){return new es(this._repo,this._path)}get _queryIdentifier(){const e=py(this._queryParams),t=Ml(e);return"{}"===t?"default":t}get _queryObject(){return py(this._queryParams)}isEqual(e){if(!((e=(0,k.m9)(e))instanceof yi))return!1;const t=this._repo===e._repo,r=Tu(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function Id(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function ic(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function ja(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Fs){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Wr)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Ki)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===en){if(null!=e&&!Xo(e)||null!=t&&!Xo(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,k.hu)(n.getIndex()instanceof xd||n.getIndex()===f,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function qf(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class es extends yi{constructor(e,t){super(e,t,new La,!1)}get parent(){const e=Og(this._path);return null===e?null:new es(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class $a{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new An(e),r=Ou(this.ref,e);return new $a(this._node.getChild(t),r,en)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new $a(i,Ou(this.ref,r),en)))}hasChild(e){const t=new An(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ym(n,e){return(n=(0,k.m9)(n))._checkNotDeleted("ref"),void 0!==e?Ou(n._root,e):n._root}function vm(n,e){(n=(0,k.m9)(n))._checkNotDeleted("refFromURL");const t=sv(e,n._repo.repoInfo_.nodeAdmin);Zy("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&qi("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),ym(n,t.path.toString())}function Ou(n,e){return null===Qt((n=(0,k.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Jl("child","path",t,!1)):Jl("child","path",e,!1),new es(n._repo,Vn(n._path,e));var t}function ov(n,e){n=(0,k.m9)(n),Ji("set",n._path),fo("set",e,n._path,!1);const t=new k.BH;return gm(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function qD(n,e){js("update",e,n._path,!1);const t=new k.BH;return function J0(n,e,t,r){Gf(n,"update",{path:e.toString(),value:t});let i=!0;const a=Hf(n),l={};if(zn(t,(d,p)=>{i=!1,l[d]=j0(Vn(e,d),tr(p),n.serverSyncTree_,a)}),i)kr("update() called with empty data.  Don't do anything."),ec(0,r,"ok",void 0);else{const d=pm(n),p=function kD(n,e,t,r){!function Wk(n,e,t,r){(0,k.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=Wg(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=Kn.fromObject(t);return Bd(n,new Pd({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,d);Qy(n.eventQueue_,p),n.server_.merge(e.toString(),t,(y,b)=>{const T="ok"===y;T||ti("update at "+e+" failed: "+y);const M=ku(n.serverSyncTree_,d,!T),P=M.length>0?tc(n,e):e;$s(n.eventQueue_,P,M),ec(0,r,y,b)}),zn(t,y=>{const b=_m(n,Vn(e,y));tc(n,b)}),$s(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function ts(n){n=(0,k.m9)(n);const e=new zf(()=>{}),t=new Gd(e);return function Xk(n,e,t){const r=function FD(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(y,b)=>{const T=ni(y,t);r=r||Ba(b,T)});let i=n.syncPointTree_.get(t);i?r=r||Ba(i,Cn()):(i=new Ly,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new Ua(r,!0,!1):null;return function M0(n){return xf(n.viewCache_)}(R0(i,e,zg(n.pendingWriteTree_,e._path),a?l.getNode():qt.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=tr(i).withIndex(e._queryParams.getIndex());let l;if(rm(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())l=Lf(n.serverSyncTree_,e._path,a);else{const d=Bf(n.serverSyncTree_,e);l=Kt(n.serverSyncTree_,e._path,a,d)}return $s(n.eventQueue_,e._path,l),nm(n.serverSyncTree_,e,t,null,!0),a},i=>(Gf(n,"get for query "+(0,k.Pz)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new $a(r,new es(n._repo,n._path),n._queryParams.getIndex()))}class Gd{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new Wf("value",this,new $a(e.snapshotNode,new es(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new nc(this,e,t):null}matches(e){return e instanceof Gd&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class wm{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new nc(this,e,t):null}createEvent(e,t){(0,k.hu)(null!=e.childName,"Child events should have a childName.");const r=Ou(new es(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new Wf(e.type,this,new $a(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof wm&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function Em(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const p=t,y=(b,T)=>{eI(n._repo,n,d),p(b,T)};y.userCallback=t.userCallback,y.context=t.context,t=y}const l=new zf(t,a||void 0),d="value"===e?new Gd(l):new wm(e,l);return function tP(n,e,t){let r;r=".info"===Qt(e._path)?rm(n.infoSyncTree_,e,t):rm(n.serverSyncTree_,e,t),Xy(n.eventQueue_,e._path,r)}(n._repo,n,d),()=>eI(n._repo,n,d)}function av(n,e,t,r){return Em(n,"value",e,t,r)}function Im(n,e,t,r){return Em(n,"child_added",e,t,r)}function uv(n,e,t,r){return Em(n,"child_changed",e,t,r)}function oI(n,e,t,r){return Em(n,"child_moved",e,t,r)}function aI(n,e,t,r){return Em(n,"child_removed",e,t,r)}function uI(n,e,t){let r=null;const i=t?new zf(t):null;"value"===e?r=new Gd(i):e&&(r=new wm(e,i)),eI(n._repo,n,r)}class Hs{}class lI extends Hs{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){fo("endAt",this._value,e._path,!0);const t=Tf(e._queryParams,this._value,this._key);if(qf(t),ja(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}class KD extends Hs{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){fo("endBefore",this._value,e._path,!1);const t=function c0(n,e,t){let r,i;return n.index_===Fs?("string"==typeof e&&(e=qe(e)),i=Tf(n,e,t)):(r=null==t?Wr:qe(t),i=Tf(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(qf(t),ja(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}class lv extends Hs{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){fo("startAt",this._value,e._path,!0);const t=Cf(e._queryParams,this._value,this._key);if(qf(t),ja(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}class YD extends Hs{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){fo("startAfter",this._value,e._path,!1);const t=function Hg(n,e,t){let r;if(n.index_===Fs)"string"==typeof e&&(e=me(e)),r=Cf(n,e,t);else{let i;i=null==t?Ki:me(t),r=Cf(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(qf(t),ja(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new yi(e._repo,e._path,t,e._orderByCalled)}}class cv extends Hs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new yi(e._repo,e._path,function $g(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class XD extends Hs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new yi(e._repo,e._path,function Rd(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class hI extends Hs{constructor(e){super(),this._path=e}_apply(e){ic(e,"orderByChild");const t=new An(this._path);if(Xt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new xd(t),i=Gl(e._queryParams,r);return ja(i),new yi(e._repo,e._path,i,!0)}}class eS extends Hs{_apply(e){ic(e,"orderByKey");const t=Gl(e._queryParams,Fs);return ja(t),new yi(e._repo,e._path,t,!0)}}class dv extends Hs{_apply(e){ic(e,"orderByPriority");const t=Gl(e._queryParams,en);return ja(t),new yi(e._repo,e._path,t,!0)}}class rS extends Hs{_apply(e){ic(e,"orderByValue");const t=Gl(e._queryParams,f);return ja(t),new yi(e._repo,e._path,t,!0)}}class hv extends Hs{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(fo("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new lI(this._value,this._key)._apply(new lv(this._value,this._key)._apply(e))}}function ta(n,...e){let t=(0,k.m9)(n);for(const r of e)t=r._apply(t);return t}(function Uy(n){(0,k.hu)(!Ud,"__referenceConstructor has already been defined"),Ud=n})(es),function RD(n){(0,k.hu)(!tm,"__referenceConstructor has already been defined"),tm=n}(es);const fI={};function gv(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||qi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),kr("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let p,y,l=sv(a,i),d=l.repoInfo;typeof process<"u"&&process.env&&(y=process.env.FIREBASE_DATABASE_EMULATOR_HOST),y?(p=!0,a=`http://${y}?ns=${d.namespace}`,l=sv(a,i),d=l.repoInfo):p=!l.repoInfo.secure;const b=i&&p?new Zi(Zi.OWNER):new fd(n.name,n.options,e);Zy("Invalid Firebase Database URL",l),Xt(l.path)||qi("Database URL must point to the root of a Firebase Database (not including a child path).");const T=function mv(n,e,t,r){let i=fI[e.name];i||(i={},fI[e.name]=i);let a=i[n.toURLString()];return a&&qi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new ev(n,false,t,r),i[n.toURLString()]=a,a}(d,n,b,new xl(n.name,t));return new Tm(T,n)}class Tm{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Qk(n,e,t){if(n.stats_=vu(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new Nd(n.repoInfo_,(r,i,a,l)=>{Z0(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Y0(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,k.Pz)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new cs(n.repoInfo_,e,(r,i,a,l)=>{Z0(n,r,i,a,l)},r=>{Y0(n,r)},r=>{!function Q0(n,e){zn(e,(t,r)=>{X0(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function Nl(n,e){const t=n.toString();return yd[t]||(yd[t]=e()),yd[t]}(n.repoInfo_,()=>new f0(n.stats_,n.server_)),n.infoData_=new d0,n.infoSyncTree_=new Vy({startListening:(r,i,a,l)=>{let d=[];const p=n.infoData_.getNode(r._path);return p.isEmpty()||(d=Lf(n.infoSyncTree_,r._path,p),setTimeout(()=>{l("ok")},0)),d},stopListening:()=>{}}),X0(n,"connected",!1),n.serverSyncTree_=new Vy({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(d,p)=>{const y=l(d,p);$s(n.eventQueue_,r._path,y)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new es(this._repo,Cn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function gI(n,e){const t=fI[e];(!t||t[n.key]!==n)&&qi(`Database ${e}(${n.repoInfo_}) has already been deleted.`),$D(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&qi("Cannot call "+e+" on a deleted database.")}}function Kf(){Mg.IS_TRANSPORT_INITIALIZED&&ti("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Zf(){Kf(),lo.forceDisallow()}function iS(){Kf(),Na.forceDisallow(),lo.forceAllow()}function Yf(n,e){Ig(n,e)}const sP={".sv":"timestamp"};class lS{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}cs.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},cs.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function aS(n){so(Jn.SDK_VERSION),(0,Jn._registerComponent)(new Ms.wA("database",(e,{instanceIdentifier:t})=>gv(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Jn.registerVersion)(zi,"0.13.6",n),(0,Jn.registerVersion)(zi,"0.13.6","esm2017")}();class yv{}var jn=F(8996),Fu=F(7669);function bt(...n){const e=(0,Fu.yG)(n);return(0,jn.D)(n,e)}var na=F(7579);class go extends na.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const Dm=(0,F(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});var mo=F(9751);const{isArray:Sm}=Array,{getPrototypeOf:sc,prototype:uP,keys:Qf}=Object;var Lu=F(4671),Nt=F(4004);const{isArray:ra}=Array;var dr=F(5403),Gs=F(9672);function Jf(...n){const e=(0,Fu.yG)(n),t=(0,Fu.jO)(n),{args:r,keys:i}=function fS(n){if(1===n.length){const e=n[0];if(Sm(e))return{args:e,keys:null};if(function pS(n){return n&&"object"==typeof n&&sc(n)===uP}(e)){const t=Qf(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}(n);if(0===r.length)return(0,jn.D)([],e);const a=new mo.y(function Wd(n,e,t=Lu.y){return r=>{ac(e,()=>{const{length:i}=n,a=new Array(i);let l=i,d=i;for(let p=0;p<i;p++)ac(e,()=>{const y=(0,jn.D)(n[p],e);let b=!1;y.subscribe((0,dr.x)(r,T=>{a[p]=T,b||(b=!0,d--),d||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>function oc(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}(i,l):Lu.y));return t?a.pipe(function vi(n){return(0,Nt.U)(e=>function Xf(n,e){return ra(e)?n(...e):n(e)}(n,e))}(t)):a}function ac(n,e,t){n?(0,Gs.f)(t,n,e):e()}var ia=F(8189);function Ga(...n){return function zd(){return(0,ia.J)(1)}()((0,jn.D)(n,(0,Fu.yG)(n)))}var sa=F(8421);function uc(n){return new mo.y(e=>{(0,sa.Xf)(n()).subscribe(e)})}var qd=F(9635),Uu=F(576);function Kd(n,e){const t=(0,Uu.m)(n)?n:()=>n,r=i=>i.error(t());return new mo.y(e?i=>e.schedule(r,0,i):r)}var Bu=F(515),vv=F(727),Or=F(4482);function Am(){return(0,Or.e)((n,e)=>{let t=null;n._refCount++;const r=(0,dr.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class wv extends mo.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,Or.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new vv.w0;const t=this.getSubject();e.add(this.source.subscribe((0,dr.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=vv.w0.EMPTY)}return e}refCount(){return Am()(this)}}function Er(n,e){return(0,Or.e)((t,r)=>{let i=null,a=0,l=!1;const d=()=>l&&!i&&r.complete();t.subscribe((0,dr.x)(r,p=>{i?.unsubscribe();let y=0;const b=a++;(0,sa.Xf)(n(p,b)).subscribe(i=(0,dr.x)(r,T=>r.next(e?e(p,T,b,y++):T),()=>{i=null,d()}))},()=>{l=!0,d()}))})}function lc(n){return n<=0?()=>Bu.E:(0,Or.e)((e,t)=>{let r=0;e.subscribe((0,dr.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Zd(...n){const e=(0,Fu.yG)(n);return(0,Or.e)((t,r)=>{(e?Ga(n,t,e):Ga(n,t)).subscribe(r)})}function Ws(n,e){return(0,Or.e)((t,r)=>{let i=0;t.subscribe((0,dr.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var Oi=F(5577);function ep(n){return(0,Or.e)((e,t)=>{let r=!1;e.subscribe((0,dr.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function _I(n=yI){return(0,Or.e)((e,t)=>{let r=!1;e.subscribe((0,dr.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function yI(){return new Dm}function _o(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Ws((i,a)=>n(i,a,r)):Lu.y,lc(1),t?ep(e):_I(()=>new Dm))}function Wa(n,e){return(0,Uu.m)(e)?(0,Oi.z)(n,e,1):(0,Oi.z)(n,1)}var wi=F(8505);function yo(n){return(0,Or.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,dr.x)(t,void 0,void 0,l=>{a=(0,sa.Xf)(n(l,yo(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}function Mm(n,e,t,r,i){return(a,l)=>{let d=t,p=e,y=0;a.subscribe((0,dr.x)(l,b=>{const T=y++;p=d?n(p,b,T):(d=!0,b),r&&l.next(p)},i&&(()=>{d&&l.next(p),l.complete()})))}}function za(n,e){return(0,Or.e)(Mm(n,e,arguments.length>=2,!0))}function Ev(n){return n<=0?()=>Bu.E:(0,Or.e)((e,t)=>{let r=[];e.subscribe((0,dr.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function xm(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Ws((i,a)=>n(i,a,r)):Lu.y,Ev(1),t?ep(e):_I(()=>new Dm))}function bv(n){return(0,Or.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const an="primary",Yd=Symbol("RouteTitle");class wI{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Vu(n){return new wI(n)}function EI(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],d=n[a];if(l.startsWith(":"))i[l.substring(1)]=d;else if(l!==d.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function vo(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Cv(n[i],e[i]))return!1;return!0}function Cv(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function Tv(n){return Array.prototype.concat.apply([],n)}function Dv(n){return n.length>0?n[n.length-1]:null}function si(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function qa(n){return(0,_.CqO)(n)?n:(0,_.QGY)(n)?(0,jn.D)(Promise.resolve(n)):bt(n)}const II={exact:function xv(n,e,t){if(!nr(n.segments,e.segments)||!kv(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!xv(n.children[r],e.children[r],t))return!1;return!0},subset:Rv},Av={exact:function bI(n,e){return vo(n,e)},subset:function CI(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Cv(n[t],e[t]))},ignored:()=>!0};function Mv(n,e,t){return II[t.paths](n.root,e.root,t.matrixParams)&&Av[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function Rv(n,e,t){return Nv(n,e,e.segments,t)}function Nv(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!nr(i,t)||e.hasChildren()||!kv(i,t,r))}if(n.segments.length===t.length){if(!nr(n.segments,t)||!kv(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!Rv(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(nr(n.segments,i)&&kv(n.segments,i,r)&&n.children[an])&&Nv(n.children[an],e,a,r)}}function kv(n,e,t){return e.every((r,i)=>Av[t](n[i].parameters,r.parameters))}class cc{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vu(this.queryParams)),this._queryParamMap}toString(){return SI.serialize(this)}}class gn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,si(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Nm(this)}}class Qd{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Vu(this.parameters)),this._parameterMap}toString(){return Lv(this)}}function nr(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let DI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return new Pv},providedIn:"root"}),n})();class Pv{parse(e){const t=new Eo(e);return new cc(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Xd(e.root,!0)}`,r=function MI(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${Ka(t)}=${Ka(i)}`).join("&"):`${Ka(t)}=${Ka(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function _S(n){return encodeURI(n)}(e.fragment)}`:""}`}}const SI=new Pv;function Nm(n){return n.segments.map(e=>Lv(e)).join("/")}function Xd(n,e){if(!n.hasChildren())return Nm(n);if(e){const t=n.children[an]?Xd(n.children[an],!1):"",r=[];return si(n.children,(i,a)=>{a!==an&&r.push(`${a}:${Xd(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function TI(n,e){let t=[];return si(n.children,(r,i)=>{i===an&&(t=t.concat(e(r,i)))}),si(n.children,(r,i)=>{i!==an&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===an?[Xd(n.children[an],!1)]:[`${i}:${Xd(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[an]?`${Nm(n)}/${t[0]}`:`${Nm(n)}/(${t.join("//")})`}}function Ov(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ka(n){return Ov(n).replace(/%3B/gi,";")}function Fv(n){return Ov(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function tp(n){return decodeURIComponent(n)}function AI(n){return tp(n.replace(/\+/g,"%20"))}function Lv(n){return`${Fv(n.path)}${function cP(n){return Object.keys(n).map(e=>`;${Fv(e)}=${Fv(n[e])}`).join("")}(n.parameters)}`}const Uv=/^[^\/()?;=#]+/;function ds(n){const e=n.match(Uv);return e?e[0]:""}const yS=/^[^=?&#]+/,oa=/^[^&#]+/;class Eo{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new gn([],{}):new gn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[an]=new gn(e,t)),r}parseSegment(){const e=ds(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new _.vHH(4009,!1);return this.capture(e),new Qd(tp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=ds(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=ds(this.remaining);i&&(r=i,this.capture(r))}e[tp(t)]=tp(r)}parseQueryParam(e){const t=function vS(n){const e=n.match(yS);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function wo(n){const e=n.match(oa);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=AI(t),a=AI(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=ds(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new _.vHH(4010,!1);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=an);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[an]:new gn([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new _.vHH(4011,!1)}}function km(n){return n.segments.length>0?new gn([],{[an]:n}):n}function np(n){const e={};for(const r of Object.keys(n.children)){const a=np(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function wS(n){if(1===n.numberOfChildren&&n.children[an]){const e=n.children[an];return new gn(n.segments.concat(e.segments),e.children)}return n}(new gn(n.segments,e))}function dc(n){return n instanceof cc}function ES(n,e,t,r,i){if(0===t.length)return hc(e.root,e.root,e.root,r,i);const a=function xI(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new sp(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const d={};return si(a.outlets,(p,y)=>{d[y]="string"==typeof p?p.split("/"):p}),[...i,{outlets:d}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((d,p)=>{0==p&&"."===d||(0==p&&""===d?t=!0:".."===d?e++:""!=d&&i.push(d))}),i):[...i,a]},[]);return new sp(t,e,r)}(t);return a.toRoot()?hc(e.root,e.root,new gn([],{}),r,i):function l(p){const y=function $v(n,e,t,r){if(n.isAbsolute)return new fc(e.root,!0,0);if(-1===r)return new fc(t,t===e.root,0);return function Pm(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new _.vHH(4005,!1);i=r.segments.length}return new fc(r,!1,i-a)}(t,r+(Jd(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,e,n.snapshot?._urlSegment,p),b=y.processChildren?pc(y.segmentGroup,y.index,a.commands):op(y.segmentGroup,y.index,a.commands);return hc(e.root,y.segmentGroup,b,r,i)}(n.snapshot?._lastPathIndex)}function Jd(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function ip(n){return"object"==typeof n&&null!=n&&n.outlets}function hc(n,e,t,r,i){let l,a={};r&&si(r,(p,y)=>{a[y]=Array.isArray(p)?p.map(b=>`${b}`):`${p}`}),l=n===e?t:jv(n,e,t);const d=km(np(l));return new cc(d,a,i)}function jv(n,e,t){const r={};return si(n.children,(i,a)=>{r[a]=i===e?t:jv(i,e,t)}),new gn(n.segments,r)}class sp{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Jd(r[0]))throw new _.vHH(4003,!1);const i=r.find(ip);if(i&&i!==Dv(r))throw new _.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class fc{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function op(n,e,t){if(n||(n=new gn([],{})),0===n.segments.length&&n.hasChildren())return pc(n,e,t);const r=function kI(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],d=t[r];if(ip(d))break;const p=`${d}`,y=r<t.length-1?t[r+1]:null;if(i>0&&void 0===p)break;if(p&&y&&"object"==typeof y&&void 0===y.outlets){if(!Gv(p,y,l))return a;r+=2}else{if(!Gv(p,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new gn(n.segments.slice(0,r.pathIndex),{});return a.children[an]=new gn(n.segments.slice(r.pathIndex),n.children),pc(a,0,i)}return r.match&&0===i.length?new gn(n.segments,{}):r.match&&!n.hasChildren()?Om(n,e,t):r.match?pc(n,0,i):Om(n,e,t)}function pc(n,e,t){if(0===t.length)return new gn(n.segments,{});{const r=function NI(n){return ip(n[0])?n[0].outlets:{[an]:n}}(t),i={};return si(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=op(n.children[l],e,a))}),si(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new gn(n.segments,i)}}function Om(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(ip(a)){const p=PI(a.outlets);return new gn(r,p)}if(0===i&&Jd(t[0])){r.push(new Qd(n.segments[e].path,Hv(t[0]))),i++;continue}const l=ip(a)?a.outlets[an]:`${a}`,d=i<t.length-1?t[i+1]:null;l&&d&&Jd(d)?(r.push(new Qd(l,Hv(d))),i+=2):(r.push(new Qd(l,{})),i++)}return new gn(r,{})}function PI(n){const e={};return si(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=Om(new gn([],{}),0,t))}),e}function Hv(n){const e={};return si(n,(t,r)=>e[r]=`${t}`),e}function Gv(n,e,t){return n==t.path&&vo(e,t.parameters)}class Za{constructor(e,t){this.id=e,this.url=t}}class Wv extends Za{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class gc extends Za{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Fm extends Za{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class OI extends Za{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class IS extends Za{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bS extends Za{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class CS extends Za{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class TS extends Za{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class DS extends Za{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class SS{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class AS{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class MS{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xS{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class RS{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class NS{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class FI{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class zv{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Lm(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=Lm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Um(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Um(e,this._root).map(t=>t.value)}}function Lm(n,e){if(n===e.value)return e;for(const t of e.children){const r=Lm(n,t);if(r)return r}return null}function Um(n,e){if(n===e.value)return[e];for(const t of e.children){const r=Um(n,t);if(r.length)return r.unshift(e),r}return[]}class aa{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function mc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class qv extends zv{constructor(e,t){super(e),this.snapshot=t,Yv(this,e)}toString(){return this.snapshot.toString()}}function Kv(n,e){const t=function LI(n,e){const l=new ua([],{},{},"",{},an,e,null,n.root,-1,{});return new BI("",new aa(l,[]))}(n,e),r=new go([new Qd("",{})]),i=new go({}),a=new go({}),l=new go({}),d=new go(""),p=new ju(r,i,l,d,a,an,e,t.root);return p.snapshot=t.root,new qv(new aa(p,[]),t)}class ju{constructor(e,t,r,i,a,l,d,p){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=d,this.title=this.data?.pipe((0,Nt.U)(y=>y[Yd]))??bt(void 0),this._futureSnapshot=p}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Nt.U)(e=>Vu(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Nt.U)(e=>Vu(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Zv(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function UI(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class ua{constructor(e,t,r,i,a,l,d,p,y,b,T,M){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=d,this.title=this.data?.[Yd],this.routeConfig=p,this._urlSegment=y,this._lastPathIndex=b,this._correctedLastPathIndex=M??b,this._resolve=T}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Vu(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Vu(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class BI extends zv{constructor(e,t){super(t),this.url=e,Yv(this,t)}toString(){return _c(this._root)}}function Yv(n,e){e.value._routerState=n,e.children.forEach(t=>Yv(n,t))}function _c(n){const e=n.children.length>0?` { ${n.children.map(_c).join(", ")} } `:"";return`${n.value}${e}`}function VI(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,vo(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),vo(e.params,t.params)||n.params.next(t.params),function gS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!vo(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),vo(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function ap(n,e){const t=vo(n.params,e.params)&&function mS(n,e){return nr(n,e)&&n.every((t,r)=>vo(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||ap(n.parent,e.parent))}function eh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function jI(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return eh(n,r,i);return eh(n,r)})}(n,e,t);return new aa(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(d=>eh(n,d)),l}}const r=function fP(n){return new ju(new go(n.url),new go(n.params),new go(n.queryParams),new go(n.fragment),new go(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>eh(n,a));return new aa(r,i)}}const kt="ngNavigationCancelingError";function $I(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=dc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=HI(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function HI(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[kt]=!0,r.cancellationCode=e,t&&(r.url=t),r}function GI(n){return yc(n)&&dc(n.url)}function yc(n){return n&&n[kt]}class PS{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new $u,this.attachRef=null}}let $u=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new PS,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const vc=!1;let sr=(()=>{class n{constructor(t,r,i,a,l){this.parentContexts=t,this.location=r,this.changeDetector=a,this.environmentInjector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new _.vpe,this.deactivateEvents=new _.vpe,this.attachEvents=new _.vpe,this.detachEvents=new _.vpe,this.name=i||an,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new _.vHH(4012,vc);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new _.vHH(4012,vc);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new _.vHH(4012,vc);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new _.vHH(4013,vc);this._activatedRoute=t;const i=this.location,l=t._futureSnapshot.component,d=this.parentContexts.getOrCreateContext(this.name).children,p=new pP(t,d,i.injector);if(r&&function WI(n){return!!n.resolveComponentFactory}(r)){const y=r.resolveComponentFactory(l);this.activated=i.createComponent(y,i.length,p)}else this.activated=i.createComponent(l,{index:i.length,injector:p,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(_.Y36($u),_.Y36(_.s_b),_.$8M("name"),_.Y36(_.sBO),_.Y36(_.lqb))},n.\u0275dir=_.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class pP{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ju?this.route:e===$u?this.childContexts:this.parent.get(e,t)}}let Bm=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[_.jDz],decls:1,vars:0,template:function(t,r){1&t&&_._UZ(0,"router-outlet")},dependencies:[sr],encapsulation:2}),n})();function zI(n,e){return n.providers&&!n._injector&&(n._injector=(0,_.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Xv(n){const e=n.children&&n.children.map(Xv),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==an&&(t.component=Bm),t}function zs(n){return n.outlet||an}function qI(n,e){const t=n.filter(r=>zs(r)===e);return t.push(...n.filter(r=>zs(r)!==e)),t}function Hu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class ZI{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),VI(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=mc(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),si(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=mc(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),d=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:d})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=mc(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=mc(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new NS(a.value.snapshot))}),e.children.length&&this.forwardEvent(new xS(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(VI(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const d=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(d.contexts),l.attachRef=d.componentRef,l.route=d.route.value,l.outlet&&l.outlet.attach(d.componentRef,d.route.value),VI(d.route.value),this.activateChildRoutes(e,null,l.children)}else{const d=Hu(i.snapshot),p=d?.get(_._Vd)??null;l.attachRef=null,l.route=i,l.resolver=p,l.injector=d,l.outlet&&l.outlet.activateWith(i,l.injector),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class Jv{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Vm{constructor(e,t){this.component=e,this.route=t}}function lp(n,e,t){const r=n._root;return dp(r,e?e._root:null,t,[r.value])}function th(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||(0,_.Z0I)(n)?e.get(n):n:r}function dp(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=mc(e);return n.children.forEach(l=>{(function jS(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,d=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const p=function YI(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!nr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!nr(n.url,e.url)||!vo(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ap(n,e)||!vo(n.queryParams,e.queryParams);default:return!ap(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);p?i.canActivateChecks.push(new Jv(r)):(a.data=l.data,a._resolvedData=l._resolvedData),dp(n,e,a.component?d?d.children:null:t,r,i),p&&d&&d.outlet&&d.outlet.isActivated&&i.canDeactivateChecks.push(new Vm(d.outlet.component,l))}else l&&nh(e,d,i),i.canActivateChecks.push(new Jv(r)),dp(n,null,a.component?d?d.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),si(a,(l,d)=>nh(l,t.getContext(d),i)),i}function nh(n,e,t){const r=mc(n),i=n.value;si(r,(a,l)=>{nh(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new Vm(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function rh(n){return"function"==typeof n}function jm(n){return n instanceof Dm||"EmptyError"===n?.name}const wc=Symbol("INITIAL_VALUE");function ih(){return Er(n=>Jf(n.map(e=>e.pipe(lc(1),Zd(wc)))).pipe((0,Nt.U)(e=>{for(const t of e)if(!0!==t){if(t===wc)return wc;if(!1===t||t instanceof cc)return t}return!0}),Ws(e=>e!==wc),lc(1)))}function eb(n){return(0,qd.z)((0,wi.b)(e=>{if(dc(e))throw $I(0,e)}),(0,Nt.U)(e=>!0===e))}const Ec={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function tb(n,e,t,r,i){const a=$m(n,e,t);return a.matched?function QS(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?bt(i.map(l=>{const d=th(l,n);return qa(function mP(n){return n&&rh(n.canMatch)}(d)?d.canMatch(e,t):n.runInContext(()=>d(e,t)))})).pipe(ih(),eb()):bt(!0)}(r=zI(e,r),e,t).pipe((0,Nt.U)(l=>!0===l?a:{...Ec})):bt(a)}function $m(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Ec}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||EI)(t,n,e);if(!i)return{...Ec};const a={};si(i.posParams,(d,p)=>{a[p]=d.path});const l=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:l,positionalParamSegments:i.posParams??{}}}function Hm(n,e,t,r,i="corrected"){if(t.length>0&&function rb(n,e,t){return t.some(r=>sh(n,e,r)&&zs(r)!==an)}(n,t,r)){const l=new gn(e,function XS(n,e,t,r){const i={};i[an]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&zs(a)!==an){const l=new gn([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[zs(a)]=l}return i}(n,e,r,new gn(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function JS(n,e,t){return t.some(r=>sh(n,e,r))}(n,t,r)){const l=new gn(n.segments,function nb(n,e,t,r,i,a){const l={};for(const d of r)if(sh(n,t,d)&&!i[zs(d)]){const p=new gn([],{});p._sourceSegment=n,p._segmentIndexShift="legacy"===a?n.segments.length:e.length,l[zs(d)]=p}return{...i,...l}}(n,e,t,r,n.children,i));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const a=new gn(n.segments,n.children);return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function sh(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function ib(n,e,t,r){return!!(zs(n)===r||r!==an&&sh(e,t,n))&&("**"===n.path||$m(e,n,t).matched)}function ew(n,e,t){return 0===e.length&&!n.children[t]}const fp=!1;class Gm{constructor(e){this.segmentGroup=e||null}}class sb{constructor(e){this.urlTree=e}}function pp(n){return Kd(new Gm(n))}function Wm(n){return Kd(new sb(n))}class nA{constructor(e,t,r,i,a){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0}apply(){const e=Hm(this.urlTree.root,[],[],this.config).segmentGroup,t=new gn(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,an).pipe((0,Nt.U)(a=>this.createUrlTree(np(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(yo(a=>{if(a instanceof sb)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof Gm?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,an).pipe((0,Nt.U)(i=>this.createUrlTree(np(i),e.queryParams,e.fragment))).pipe(yo(i=>{throw i instanceof Gm?this.noMatchError(i):i}))}noMatchError(e){return new _.vHH(4002,fp)}createUrlTree(e,t,r){const i=km(e);return new cc(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,Nt.U)(a=>new gn([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,jn.D)(i).pipe(Wa(a=>{const l=r.children[a],d=qI(t,a);return this.expandSegmentGroup(e,d,l,a).pipe((0,Nt.U)(p=>({segment:p,outlet:a})))}),za((a,l)=>(a[l.outlet]=l.segment,a),{}),xm())}expandSegment(e,t,r,i,a,l){return(0,jn.D)(r).pipe(Wa(d=>this.expandSegmentAgainstRoute(e,t,r,d,i,a,l).pipe(yo(y=>{if(y instanceof Gm)return bt(null);throw y}))),_o(d=>!!d),yo((d,p)=>{if(jm(d))return ew(t,i,a)?bt(new gn([],{})):pp(t);throw d}))}expandSegmentAgainstRoute(e,t,r,i,a,l,d){return ib(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):d&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):pp(t):pp(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Wm(a):this.lineralizeSegments(r,a).pipe((0,Oi.z)(l=>{const d=new gn(l,{});return this.expandSegment(e,d,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:d,consumedSegments:p,remainingSegments:y,positionalParamSegments:b}=$m(t,i,a);if(!d)return pp(t);const T=this.applyRedirectCommands(p,i.redirectTo,b);return i.redirectTo.startsWith("/")?Wm(T):this.lineralizeSegments(i,T).pipe((0,Oi.z)(M=>this.expandSegment(e,t,r,M.concat(y),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){return"**"===r.path?(e=zI(r,e),r.loadChildren?(r._loadedRoutes?bt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe((0,Nt.U)(d=>(r._loadedRoutes=d.routes,r._loadedInjector=d.injector,new gn(i,{})))):bt(new gn(i,{}))):tb(t,r,i,e).pipe(Er(({matched:l,consumedSegments:d,remainingSegments:p})=>l?this.getChildConfig(e=r._injector??e,r,i).pipe((0,Oi.z)(b=>{const T=b.injector??e,M=b.routes,{segmentGroup:P,slicedSegments:U}=Hm(t,d,p,M),ee=new gn(P.segments,P.children);if(0===U.length&&ee.hasChildren())return this.expandChildren(T,M,ee).pipe((0,Nt.U)(rt=>new gn(d,rt)));if(0===M.length&&0===U.length)return bt(new gn(d,{}));const oe=zs(r)===a;return this.expandSegment(T,ee,M,U,oe?an:a,!0).pipe((0,Nt.U)(Je=>new gn(d.concat(Je.segments),Je.children)))})):pp(t)))}getChildConfig(e,t,r){return t.children?bt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?bt({routes:t._loadedRoutes,injector:t._loadedInjector}):function JI(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?bt(!0):bt(i.map(l=>{const d=th(l,n);return qa(function QI(n){return n&&rh(n.canLoad)}(d)?d.canLoad(e,t):n.runInContext(()=>d(e,t)))})).pipe(ih(),eb())}(e,t,r).pipe((0,Oi.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,wi.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function ob(n){return Kd(HI(fp,3))}())):bt({routes:[],injector:e})}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return bt(r);if(i.numberOfChildren>1||!i.children[an])return Kd(new _.vHH(4e3,fp));i=i.children[an]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new cc(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return si(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const d=i.substring(1);r[a]=t[d]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return si(t.children,(d,p)=>{l[p]=this.createSegmentGroup(e,d,r,i)}),new gn(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new _.vHH(4001,fp);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}class iA{}class aA{constructor(e,t,r,i,a,l,d,p){this.injector=e,this.rootComponentType=t,this.config=r,this.urlTree=i,this.url=a,this.paramsInheritanceStrategy=l,this.relativeLinkResolution=d,this.urlSerializer=p}recognize(){const e=Hm(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,an).pipe((0,Nt.U)(t=>{if(null===t)return null;const r=new ua([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},an,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new aa(r,t),a=new BI(this.url,i);return this.inheritParamsAndData(a._root),a}))}inheritParamsAndData(e){const t=e.value,r=Zv(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i)}processChildren(e,t,r){return(0,jn.D)(Object.keys(r.children)).pipe(Wa(i=>{const a=r.children[i],l=qI(t,i);return this.processSegmentGroup(e,l,a,i)}),za((i,a)=>i&&a?(i.push(...a),i):null),function Iv(n,e=!1){return(0,Or.e)((t,r)=>{let i=0;t.subscribe((0,dr.x)(r,a=>{const l=n(a,i++);(l||e)&&r.next(a),!l&&r.complete()}))})}(i=>null!==i),ep(null),xm(),(0,Nt.U)(i=>{if(null===i)return null;const a=lb(i);return function ab(n){n.sort((e,t)=>e.value.outlet===an?-1:t.value.outlet===an?1:e.value.outlet.localeCompare(t.value.outlet))}(a),a}))}processSegment(e,t,r,i,a){return(0,jn.D)(t).pipe(Wa(l=>this.processSegmentAgainstRoute(l._injector??e,l,r,i,a)),_o(l=>!!l),yo(l=>{if(jm(l))return ew(r,i,a)?bt([]):bt(null);throw l}))}processSegmentAgainstRoute(e,t,r,i,a){if(t.redirectTo||!ib(t,r,i,a))return bt(null);let l;if("**"===t.path){const d=i.length>0?Dv(i).parameters:{},p=hb(r)+i.length;l=bt({snapshot:new ua(i,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qm(t),zs(t),t.component??t._loadedComponent??null,t,db(r),p,Km(t),p),consumedSegments:[],remainingSegments:[]})}else l=tb(r,t,i,e).pipe((0,Nt.U)(({matched:d,consumedSegments:p,remainingSegments:y,parameters:b})=>{if(!d)return null;const T=hb(r)+p.length;return{snapshot:new ua(p,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,qm(t),zs(t),t.component??t._loadedComponent??null,t,db(r),T,Km(t),T),consumedSegments:p,remainingSegments:y}}));return l.pipe(Er(d=>{if(null===d)return bt(null);const{snapshot:p,consumedSegments:y,remainingSegments:b}=d;e=t._injector??e;const T=t._loadedInjector??e,M=function ub(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:P,slicedSegments:U}=Hm(r,y,b,M.filter(oe=>void 0===oe.redirectTo),this.relativeLinkResolution);if(0===U.length&&P.hasChildren())return this.processChildren(T,M,P).pipe((0,Nt.U)(oe=>null===oe?null:[new aa(p,oe)]));if(0===M.length&&0===U.length)return bt([new aa(p,[])]);const ee=zs(t)===a;return this.processSegment(T,M,P,U,ee?an:a).pipe((0,Nt.U)(oe=>null===oe?null:[new aa(p,oe)]))}))}}function uA(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function lb(n){const e=[],t=new Set;for(const r of n){if(!uA(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=lb(r.children);e.push(new aa(r.value,i))}return e.filter(r=>!t.has(r))}function db(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function hb(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function qm(n){return n.data||{}}function Km(n){return n.resolve||{}}function rw(n){return"string"==typeof n.title||null===n.title}function Gu(n){return Er(e=>{const t=n(e);return t?(0,jn.D)(t).pipe((0,Nt.U)(()=>e)):bt(e)})}let iw=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(a=>a.outlet===an);return r}getResolvedTitleForRoute(t){return t.data[Yd]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:function(){return(0,_.f3M)(gb)},providedIn:"root"}),n})(),gb=(()=>{class n extends iw{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Da))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class mb{}class hA extends class sw{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Zm=new _.OlP("",{providedIn:"root",factory:()=>({})}),gp=new _.OlP("ROUTES");let Ym=(()=>{class n{constructor(t,r){this.injector=t,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return bt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=qa(t.loadComponent()).pipe((0,wi.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),bv(()=>{this.componentLoaders.delete(t)})),i=new wv(r,()=>new na.x).pipe(Am());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return bt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,Nt.U)(d=>{this.onLoadEndListener&&this.onLoadEndListener(r);let p,y,b=!1;Array.isArray(d)?y=d:(p=d.create(t).injector,y=Tv(p.get(gp,[],_.XFs.Self|_.XFs.Optional)));return{routes:y.map(Xv),injector:p}}),bv(()=>{this.childrenLoaders.delete(r)})),l=new wv(a,()=>new na.x).pipe(Am());return this.childrenLoaders.set(r,l),l}loadModuleFactoryOrRoutes(t){return qa(t()).pipe((0,Oi.z)(r=>r instanceof _.YKP||Array.isArray(r)?bt(r):(0,jn.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.zs3),_.LFG(_.Sil))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class _b{}class yb{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function fA(n){throw n}function pA(n,e,t){return e.parse("/")}const gA={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},mA={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function _A(){const n=(0,_.f3M)(DI),e=(0,_.f3M)($u),t=(0,_.f3M)(Pe),r=(0,_.f3M)(_.zs3),i=(0,_.f3M)(_.Sil),a=(0,_.f3M)(gp,{optional:!0})??[],l=(0,_.f3M)(Zm,{optional:!0})??{},d=(0,_.f3M)(gb),p=(0,_.f3M)(iw,{optional:!0}),y=(0,_.f3M)(_b,{optional:!0}),b=(0,_.f3M)(mb,{optional:!0}),T=new oi(null,n,e,t,r,i,Tv(a));return y&&(T.urlHandlingStrategy=y),b&&(T.routeReuseStrategy=b),T.titleStrategy=p??d,function vb(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(l,T),T}let oi=(()=>{class n{constructor(t,r,i,a,l,d,p){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=a,this.config=p,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new na.x,this.errorHandler=fA,this.malformedUriErrorHandler=pA,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>bt(void 0),this.urlHandlingStrategy=new yb,this.routeReuseStrategy=new hA,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=l.get(Ym),this.configLoader.onLoadEndListener=M=>this.triggerEvent(new AS(M)),this.configLoader.onLoadStartListener=M=>this.triggerEvent(new SS(M)),this.ngModule=l.get(_.h0i),this.console=l.get(_.c2e);const T=l.get(_.R0b);this.isNgZoneEnabled=T instanceof _.R0b&&_.R0b.isInAngularZone(),this.resetConfig(p),this.currentUrlTree=function Sv(){return new cc(new gn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Kv(this.currentUrlTree,this.rootComponentType),this.transitions=new go({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(Ws(i=>0!==i.id),(0,Nt.U)(i=>({...i,extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),Er(i=>{let a=!1,l=!1;return bt(i).pipe((0,wi.b)(d=>{this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Er(d=>{const p=this.browserUrlTree.toString(),y=!this.navigated||d.extractedUrl.toString()!==p||p!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||y)&&this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return wb(d.source)&&(this.browserUrlTree=d.extractedUrl),bt(d).pipe(Er(T=>{const M=this.transitions.getValue();return r.next(new Wv(T.id,this.serializeUrl(T.extractedUrl),T.source,T.restoredState)),M!==this.transitions.getValue()?Bu.E:Promise.resolve(T)}),function rA(n,e,t,r){return Er(i=>function tA(n,e,t,r,i){return new nA(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,Nt.U)(a=>({...i,urlAfterRedirects:a}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,wi.b)(T=>{this.currentNavigation={...this.currentNavigation,finalUrl:T.urlAfterRedirects},i.urlAfterRedirects=T.urlAfterRedirects}),function pb(n,e,t,r,i,a){return(0,Oi.z)(l=>function oA(n,e,t,r,i,a,l="emptyOnly",d="legacy"){return new aA(n,e,t,r,i,l,d,a).recognize().pipe(Er(p=>null===p?function sA(n){return new mo.y(e=>e.error(n))}(new iA):bt(p)))}(n,e,t,l.urlAfterRedirects,r.serialize(l.urlAfterRedirects),r,i,a).pipe((0,Nt.U)(d=>({...l,targetSnapshot:d}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,wi.b)(T=>{if(i.targetSnapshot=T.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!T.extras.skipLocationChange){const P=this.urlHandlingStrategy.merge(T.urlAfterRedirects,T.rawUrl);this.setBrowserUrl(P,T)}this.browserUrlTree=T.urlAfterRedirects}const M=new IS(T.id,this.serializeUrl(T.extractedUrl),this.serializeUrl(T.urlAfterRedirects),T.targetSnapshot);r.next(M)}));if(y&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:M,extractedUrl:P,source:U,restoredState:ee,extras:oe}=d,Ge=new Wv(M,this.serializeUrl(P),U,ee);r.next(Ge);const Je=Kv(P,this.rootComponentType).snapshot;return bt(i={...d,targetSnapshot:Je,urlAfterRedirects:P,extras:{...oe,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=d.rawUrl,d.resolve(null),Bu.E}),(0,wi.b)(d=>{const p=new bS(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);this.triggerEvent(p)}),(0,Nt.U)(d=>i={...d,guards:lp(d.targetSnapshot,d.currentSnapshot,this.rootContexts)}),function WS(n,e){return(0,Oi.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?bt({...t,guardsResult:!0}):function XI(n,e,t,r){return(0,jn.D)(n).pipe((0,Oi.z)(i=>function YS(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?bt(a.map(d=>{const p=Hu(e)??i,y=th(d,p);return qa(function gP(n){return n&&rh(n.canDeactivate)}(y)?y.canDeactivate(n,e,t,r):p.runInContext(()=>y(n,e,t,r))).pipe(_o())})).pipe(ih()):bt(!0)}(i.component,i.route,t,e,r)),_o(i=>!0!==i,!0))}(l,r,i,n).pipe((0,Oi.z)(d=>d&&function $S(n){return"boolean"==typeof n}(d)?function hp(n,e,t,r){return(0,jn.D)(e).pipe(Wa(i=>Ga(function qS(n,e){return null!==n&&e&&e(new MS(n)),bt(!0)}(i.route.parent,r),function zS(n,e){return null!==n&&e&&e(new RS(n)),bt(!0)}(i.route,r),function ZS(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function cp(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>uc(()=>bt(l.guards.map(p=>{const y=Hu(l.node)??t,b=th(p,y);return qa(function GS(n){return n&&rh(n.canActivateChild)}(b)?b.canActivateChild(r,n):y.runInContext(()=>b(r,n))).pipe(_o())})).pipe(ih())));return bt(a).pipe(ih())}(n,i.path,t),function KS(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return bt(!0);const i=r.map(a=>uc(()=>{const l=Hu(e)??t,d=th(a,l);return qa(function HS(n){return n&&rh(n.canActivate)}(d)?d.canActivate(e,n):l.runInContext(()=>d(e,n))).pipe(_o())}));return bt(i).pipe(ih())}(n,i.route,t))),_o(i=>!0!==i,!0))}(r,a,n,e):bt(d)),(0,Nt.U)(d=>({...t,guardsResult:d})))})}(this.ngModule.injector,d=>this.triggerEvent(d)),(0,wi.b)(d=>{if(i.guardsResult=d.guardsResult,dc(d.guardsResult))throw $I(0,d.guardsResult);const p=new CS(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.triggerEvent(p)}),Ws(d=>!!d.guardsResult||(this.restoreHistory(d),this.cancelNavigationTransition(d,"",3),!1)),Gu(d=>{if(d.guards.canActivateChecks.length)return bt(d).pipe((0,wi.b)(p=>{const y=new TS(p.id,this.serializeUrl(p.extractedUrl),this.serializeUrl(p.urlAfterRedirects),p.targetSnapshot);this.triggerEvent(y)}),Er(p=>{let y=!1;return bt(p).pipe(function tw(n,e){return(0,Oi.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return bt(t);let a=0;return(0,jn.D)(i).pipe(Wa(l=>function lA(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!rw(i)&&(a[Yd]=i.title),function cA(n,e,t,r){const i=function nw(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return bt({});const a={};return(0,jn.D)(i).pipe((0,Oi.z)(l=>function dA(n,e,t,r){const i=Hu(e)??r,a=th(n,i);return qa(a.resolve?a.resolve(e,t):i.runInContext(()=>a(e,t)))}(n[l],e,t,r).pipe(_o(),(0,wi.b)(d=>{a[l]=d}))),Ev(1),function vI(n){return(0,Nt.U)(()=>n)}(a),yo(l=>jm(l)?Bu.E:Kd(l)))}(a,n,e,r).pipe((0,Nt.U)(l=>(n._resolvedData=l,n.data=Zv(n,t).resolve,i&&rw(i)&&(n.data[Yd]=i.title),null)))}(l.route,r,n,e)),(0,wi.b)(()=>a++),Ev(1),(0,Oi.z)(l=>a===i.length?bt(t):Bu.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,wi.b)({next:()=>y=!0,complete:()=>{y||(this.restoreHistory(p),this.cancelNavigationTransition(p,"",2))}}))}),(0,wi.b)(p=>{const y=new DS(p.id,this.serializeUrl(p.extractedUrl),this.serializeUrl(p.urlAfterRedirects),p.targetSnapshot);this.triggerEvent(y)}))}),Gu(d=>{const p=y=>{const b=[];y.routeConfig?.loadComponent&&!y.routeConfig._loadedComponent&&b.push(this.configLoader.loadComponent(y.routeConfig).pipe((0,wi.b)(T=>{y.component=T}),(0,Nt.U)(()=>{})));for(const T of y.children)b.push(...p(T));return b};return Jf(p(d.targetSnapshot.root)).pipe(ep(),lc(1))}),Gu(()=>this.afterPreactivation()),(0,Nt.U)(d=>{const p=function hP(n,e,t){const r=eh(n,e._root,t?t._root:void 0);return new qv(r,e)}(this.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return i={...d,targetRouterState:p}}),(0,wi.b)(d=>{this.currentUrlTree=d.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl),this.routerState=d.targetRouterState,"deferred"===this.urlUpdateStrategy&&(d.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,d),this.browserUrlTree=d.urlAfterRedirects)}),((n,e,t)=>(0,Nt.U)(r=>(new ZI(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,d=>this.triggerEvent(d)),(0,wi.b)({next(){a=!0},complete(){a=!0}}),bv(()=>{a||l||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),yo(d=>{if(l=!0,yc(d)){GI(d)||(this.navigated=!0,this.restoreHistory(i,!0));const p=new Fm(i.id,this.serializeUrl(i.extractedUrl),d.message,d.cancellationCode);if(r.next(p),GI(d)){const y=this.urlHandlingStrategy.merge(d.url,this.rawUrlTree),b={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||wb(i.source)};this.scheduleNavigation(y,"imperative",null,b,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{this.restoreHistory(i,!0);const p=new OI(i.id,this.serializeUrl(i.extractedUrl),d,i.targetSnapshot??void 0);r.next(p);try{i.resolve(this.errorHandler(d))}catch(y){i.reject(y)}}return Bu.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},a=t.state?.navigationId?t.state:null;if(a){const d={...a};delete d.navigationId,delete d.\u0275routerPageId,0!==Object.keys(d).length&&(i.state=d)}const l=this.parseUrl(t.url);this.scheduleNavigation(l,r,a,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(Xv),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:d,preserveFragment:p}=r,y=i||this.routerState.root,b=p?this.currentUrlTree.fragment:l;let T=null;switch(d){case"merge":T={...this.currentUrlTree.queryParams,...a};break;case"preserve":T=this.currentUrlTree.queryParams;break;default:T=a||null}return null!==T&&(T=this.removeEmptyProps(T)),ES(y,this.currentUrlTree,t,T,b??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=dc(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function yA(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new _.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...gA}:!1===r?{...mA}:r,dc(t))return Mv(this.currentUrlTree,t,i);const a=this.parseUrl(t);return Mv(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new gc(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,a,l){if(this.disposed)return Promise.resolve(!1);let d,p,y;l?(d=l.resolve,p=l.reject,y=l.promise):y=new Promise((M,P)=>{d=M,p=P});const b=++this.navigationId;let T;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),T=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):T=0,this.setTransition({id:b,targetPageId:T,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:a,resolve:d,reject:p,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(M=>Promise.reject(M))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===i?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===i&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r,i){const a=new Fm(t.id,this.serializeUrl(t.extractedUrl),r,i);this.triggerEvent(a),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){_.$Z()},n.\u0275prov=_.Yz7({token:n,factory:function(){return _A()},providedIn:"root"}),n})();function wb(n){return"imperative"!==n}class bb{}let EA=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(Ws(t=>t instanceof gc),Wa(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,_.MMx)(a.providers,t,`Route: ${a.path}`));const l=a._injector??t,d=a._loadedInjector??l;a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent?i.push(this.preloadConfig(l,a)):(a.children||a._loadedRoutes)&&i.push(this.processRoutes(d,a.children??a._loadedRoutes))}return(0,jn.D)(i).pipe((0,ia.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):bt(null);const a=i.pipe((0,Oi.z)(l=>null===l?bt(void 0):(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,this.processRoutes(l.injector??t,l.routes))));if(r.loadComponent&&!r._loadedComponent){const l=this.loader.loadComponent(r);return(0,jn.D)([a,l]).pipe((0,ia.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(oi),_.LFG(_.Sil),_.LFG(_.lqb),_.LFG(bb),_.LFG(Ym))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const uw=new _.OlP("");let Cb=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Wv?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof gc&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof FI&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new FI(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){_.$Z()},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();function oh(n,e){return{\u0275kind:n,\u0275providers:e}}function Ic(n){return[{provide:gp,multi:!0,useValue:n}]}function lw(){const n=(0,_.f3M)(_.zs3);return e=>{const t=n.get(_.z2F);if(e!==t.components[0])return;const r=n.get(oi),i=n.get(cw);1===n.get(Xm)&&r.initialNavigation(),n.get(TA,null,_.XFs.Optional)?.setUpPreloading(),n.get(uw,null,_.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.next(),i.complete()}}const cw=new _.OlP("",{factory:()=>new na.x}),Xm=new _.OlP("",{providedIn:"root",factory:()=>1});const TA=new _.OlP("");function DA(n){return oh(0,[{provide:TA,useExisting:EA},{provide:bb,useExisting:n}])}const Sb=new _.OlP("ROUTER_FORROOT_GUARD"),_p=[Pe,{provide:DI,useClass:Pv},{provide:oi,useFactory:_A},$u,{provide:ju,useFactory:function Tb(n){return n.routerState.root},deps:[oi]},Ym];function SA(){return new _.PXZ("Router",oi)}let e_=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[_p,[],Ic(t),{provide:Sb,useFactory:yp,deps:[[oi,new _.FiY,new _.tp0]]},{provide:Zm,useValue:r||{}},r?.useHash?{provide:Ee,useClass:lt}:{provide:Ee,useClass:ft},{provide:uw,useFactory:()=>{const n=(0,_.f3M)(oi),e=(0,_.f3M)(ou),t=(0,_.f3M)(Zm);return t.scrollOffset&&e.setOffset(t.scrollOffset),new Cb(n,e,t)}},r?.preloadingStrategy?DA(r.preloadingStrategy).\u0275providers:[],{provide:_.PXZ,multi:!0,useFactory:SA},r?.initialNavigation?MA(r):[],[{provide:Ab,useFactory:lw},{provide:_.tb,multi:!0,useExisting:Ab}]]}}static forChild(t){return{ngModule:n,providers:[Ic(t)]}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Sb,8))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[Bm]}),n})();function yp(n){return"guarded"}function MA(n){return["disabled"===n.initialNavigation?oh(3,[{provide:_.ip1,multi:!0,useFactory:()=>{const e=(0,_.f3M)(oi);return()=>{e.setUpLocationChangeListener()}}},{provide:Xm,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?oh(2,[{provide:Xm,useValue:0},{provide:_.ip1,multi:!0,deps:[_.zs3],useFactory:e=>{const t=e.get($,Promise.resolve());let r=!1;return()=>t.then(()=>new Promise(a=>{const l=e.get(oi),d=e.get(cw);(function i(a){e.get(oi).events.pipe(Ws(d=>d instanceof gc||d instanceof Fm||d instanceof OI),(0,Nt.U)(d=>d instanceof gc||d instanceof Fm&&(0===d.code||1===d.code)&&null),Ws(d=>null!==d),lc(1)).subscribe(()=>{a()})})(()=>{a(!0),r=!0}),l.afterPreactivation=()=>(a(!0),r||d.closed?bt(void 0):d),l.initialNavigation()}))}}]).\u0275providers:[]]}const Ab=new _.OlP("");let ah;try{ah=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ah=!1}let Mb=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function ya(n){return n===ko}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!ah)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.Lbi))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Gb(n){return Array.isArray(n)?n:[n]}var Iw=F(4986);function bw(n,e=Iw.z){return(0,Or.e)((t,r)=>{let i=null,a=null,l=null;const d=()=>{if(i){i.unsubscribe(),i=null;const y=a;a=null,r.next(y)}};function p(){const y=l+n,b=e.now();if(b<y)return i=this.schedule(void 0,y-b),void r.add(i);d()}t.subscribe((0,dr.x)(r,y=>{a=y,l=e.now(),i||(i=e.schedule(p,n),r.add(i))},()=>{d(),r.complete()},void 0,()=>{a=i=null}))})}var vM=F(5032);function Wb(n){return(0,Or.e)((e,t)=>{(0,sa.Xf)(n).subscribe((0,dr.x)(t,()=>t.complete(),vM.Z)),!t.closed&&e.subscribe(t)})}const Cw=new Set;let Ip,Tw=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):qb}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function zb(n){if(!Cw.has(n))try{Ip||(Ip=document.createElement("style"),Ip.setAttribute("type","text/css"),document.head.appendChild(Ip)),Ip.sheet&&(Ip.sheet.insertRule(`@media ${n} {body{ }}`,0),Cw.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Mb))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function qb(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let Kb=(()=>{class n{constructor(t,r){this._mediaMatcher=t,this._zone=r,this._queries=new Map,this._destroySubject=new na.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return Dw(Gb(t)).some(i=>this._registerQuery(i).mql.matches)}observe(t){let a=Jf(Dw(Gb(t)).map(l=>this._registerQuery(l).observable));return a=Ga(a.pipe(lc(1)),a.pipe(function yM(n){return Ws((e,t)=>n<=t)}(1),bw(0))),a.pipe((0,Nt.U)(l=>{const d={matches:!1,breakpoints:{}};return l.forEach(({matches:p,query:y})=>{d.matches=d.matches||p,d.breakpoints[y]=p}),d}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const r=this._mediaMatcher.matchMedia(t),a={observable:new mo.y(l=>{const d=p=>this._zone.run(()=>l.next(p));return r.addListener(d),()=>{r.removeListener(d)}}).pipe(Zd(r),(0,Nt.U)(({matches:l})=>({query:t,matches:l})),Wb(this._destroySubject)),mql:r};return this._queries.set(t,a),a}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Tw),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Dw(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const rC="cdk-high-contrast-black-on-white",FM="cdk-high-contrast-white-on-black",iC="cdk-high-contrast-active";let LM=(()=>{class n{constructor(t,r){this._platform=t,this._document=r,this._breakpointSubscription=(0,_.f3M)(Kb).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(t):null,a=(i&&i.backgroundColor||"").replace(/ /g,"");switch(t.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(iC,rC,FM),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?t.add(iC,rC):2===r&&t.add(iC,FM)}}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(Mb),_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),sC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})();const h=new _.OlP("mat-sanity-checks",{providedIn:"root",factory:function c(){return!0}});let g=(()=>{class n{constructor(t,r,i){this._sanityChecks=r,this._document=i,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function kA(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(LM),_.LFG(h,8),_.LFG(ce))},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[sC,sC]}),n})();const Cj=["*",[["mat-card-footer"]]],Tj=["*","mat-card-footer"];let Dj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=_.lG2({type:n,selectors:[["mat-card-content"],["","mat-card-content",""],["","matCardContent",""]],hostAttrs:[1,"mat-card-content"]}),n})(),Sj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=_.lG2({type:n,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-card-title"]}),n})(),Aj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=_.lG2({type:n,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-card-subtitle"]}),n})(),kO=(()=>{class n{constructor(t){this._animationMode=t}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(_.QbO,8))},n.\u0275cmp=_.Xpm({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,r){2&t&&_.ekj("_mat-animation-noopable","NoopAnimations"===r._animationMode)},exportAs:["matCard"],ngContentSelectors:Tj,decls:2,vars:0,template:function(t,r){1&t&&(_.F$t(Cj),_.Hsn(0),_.Hsn(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}.mat-card._mat-animation-noopable{transition:none !important;animation:none !important}.mat-card>.mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card>.mat-divider-horizontal{left:auto;right:0}.mat-card>.mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card>.mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px;display:block;overflow:hidden}.mat-card-image img{width:100%}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions:not(.mat-card-actions-align-end) .mat-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-raised-button:first-child,.mat-card-actions:not(.mat-card-actions-align-end) .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-actions-align-end .mat-button:last-child,.mat-card-actions-align-end .mat-raised-button:last-child,.mat-card-actions-align-end .mat-stroked-button:last-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}"],encapsulation:2,changeDetection:0}),n})(),Mj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[g,g]}),n})();function xj(n,e){if(1&n&&(_.TgZ(0,"mat-card-subtitle"),_._uU(1),_.qZA()),2&n){const t=_.oxw();_.xp6(1),_.HOy(" ",t.aquarium.liters,"L (",t.aquarium.dimensions.width,"x",t.aquarium.dimensions.length,"x",t.aquarium.dimensions.height,") ")}}function Rj(n,e){if(1&n&&(_.TgZ(0,"mat-card-subtitle"),_._uU(1),_.qZA()),2&n){const t=_.oxw(2);_.xp6(1),_.lnq(" ",t.aquarium.dimensions.width,"x",t.aquarium.dimensions.length,"x",t.aquarium.dimensions.height," ")}}function Nj(n,e){if(1&n&&_.YNc(0,Rj,2,3,"mat-card-subtitle",5),2&n){const t=_.oxw();_.Q6J("ngIf",null!=t.aquarium.dimensions.width&&null!=t.aquarium.dimensions.length&&null!=t.aquarium.dimensions.height&&null!=t.aquarium.dimensions.width&&null!=t.aquarium.dimensions.length&&null!=t.aquarium.dimensions.height)}}function kj(n,e){1&n&&(_.TgZ(0,"p",6),_._uU(1,"Fish"),_.qZA())}function Pj(n,e){1&n&&(_.TgZ(0,"p",6),_._uU(1,"Snails"),_.qZA())}function Oj(n,e){1&n&&(_.TgZ(0,"p",6),_._uU(1,"Shrimp"),_.qZA())}function Fj(n,e){1&n&&(_.TgZ(0,"p",6),_._uU(1,"Plants"),_.qZA())}let Lj=(()=>{class n{constructor(t){this.aquariumFish="",this.aquariumSnails="",this.aquariumShrimps="",this.aquariumPlants="",this.aquarium=t}ngOnInit(){this.aquarium.fish&&null!=this.aquarium.fish&&Object.keys(this.aquarium.fish).forEach(t=>this.aquariumFish+=` ${t} (${this.aquarium.fish[t].quantity})\n`),this.aquarium.snails&&null!=this.aquarium.snails&&Object.keys(this.aquarium.snails).forEach(t=>{null!=this.aquarium.snails[t]&&(this.aquariumSnails+=` ${t} (${this.aquarium.snails[t].quantity})\n`)}),this.aquarium.shrimps&&null!=this.aquarium.shrimps&&Object.keys(this.aquarium.shrimps).forEach(t=>{this.aquarium.shrimps[t]&&(this.aquariumShrimps+=` ${t} (${this.aquarium.shrimps[t].quantity})\n`)}),this.aquarium.plants&&null!=this.aquarium.plants&&Object.keys(this.aquarium.plants).forEach(t=>{null!=this.aquarium.plants[t]&&(this.aquariumPlants+=` ${t} \n`)}),this.aquarium.dimensions.height&&this.aquarium.dimensions.width&&this.aquarium.dimensions.length&&(this.aquarium.liters=this.aquarium.dimensions.height*this.aquarium.dimensions.width*this.aquarium.dimensions.length/1e3),this.aquarium.dimensions.height&&this.aquarium.dimensions.width&&this.aquarium.dimensions.length&&(this.aquarium.liters=this.aquarium.dimensions.height*this.aquarium.dimensions.width*this.aquarium.dimensions.length/1e3)}}return n.\u0275fac=function(t){return new(t||n)(_.Y36(yv))},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-card"]],inputs:{aquarium:"aquarium"},decls:15,vars:11,consts:[[1,"card","scrollable-content"],[4,"ngIf","ngIfElse"],["elseBlock",""],["class","content-title",4,"ngIf"],[3,"innerText"],[4,"ngIf"],[1,"content-title"]],template:function(t,r){if(1&t&&(_.TgZ(0,"mat-card",0)(1,"mat-card-title"),_._uU(2),_.qZA(),_.YNc(3,xj,2,4,"mat-card-subtitle",1),_.YNc(4,Nj,1,1,"ng-template",null,2,_.W1O),_.TgZ(6,"mat-card-content"),_.YNc(7,kj,2,0,"p",3),_._UZ(8,"p",4),_.YNc(9,Pj,2,0,"p",3),_._UZ(10,"p",4),_.YNc(11,Oj,2,0,"p",3),_._UZ(12,"p",4),_.YNc(13,Fj,2,0,"p",3),_._UZ(14,"p",4),_.qZA()()),2&t){const i=_.MAs(5);_.xp6(2),_.Oqu(r.aquarium.name),_.xp6(1),_.Q6J("ngIf",null!=r.aquarium.liters)("ngIfElse",i),_.xp6(4),_.Q6J("ngIf",""!=r.aquariumFish),_.xp6(1),_.Q6J("innerText",r.aquariumFish),_.xp6(1),_.Q6J("ngIf",""!=r.aquariumSnails),_.xp6(1),_.Q6J("innerText",r.aquariumSnails),_.xp6(1),_.Q6J("ngIf",""!=r.aquariumShrimps),_.xp6(1),_.Q6J("innerText",r.aquariumShrimps),_.xp6(1),_.Q6J("ngIf",""!=r.aquariumPlants),_.xp6(1),_.Q6J("innerText",r.aquariumPlants)}},dependencies:[Sr,kO,Dj,Sj,Aj],styles:['@import"https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Varela+Round&display=swap";.card[_ngcontent-%COMP%]{width:20vw;height:20vw;max-width:250px;max-height:250px;min-width:160px;min-height:160px;margin:.4vw;font-family:Varela Round;background-color:#f0f0f0}.card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:110%;font-weight:700}.card[_ngcontent-%COMP%]   .content-title[_ngcontent-%COMP%]{font-weight:700}.mat-card.scrollable-content[_ngcontent-%COMP%]{overflow:hidden;display:flex;flex-direction:column}.mat-card.scrollable-content[_ngcontent-%COMP%] > .mat-card-content[_ngcontent-%COMP%]{overflow-y:auto}']}),n})(),Uj=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-card-add"]],decls:4,vars:0,consts:[["rel","stylesheet","href","https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"],[1,"card"],[1,"material-symbols-outlined"]],template:function(t,r){1&t&&(_._UZ(0,"link",0),_.TgZ(1,"mat-card",1)(2,"span",2),_._uU(3," add "),_.qZA()())},dependencies:[kO],styles:['.card[_ngcontent-%COMP%]{display:flex;width:20vw;height:20vw;max-width:250px;max-height:250px;min-width:160px;min-height:160px;margin:.4vw;font-family:Varela Round;background-color:#f0f0f0;justify-content:center;align-items:center}.card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:110%;font-weight:700}.card[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:20vw;height:20vw;max-width:250px;max-height:250px;min-width:160px;min-height:160px}.material-symbols-outlined[_ngcontent-%COMP%]{font-variation-settings:"FILL" 0,"wght" 400,"GRAD" 0,"opsz" 48;font-size:13vw}']}),n})();function Bj(n,e){1&n&&_._UZ(0,"app-card",3),2&n&&_.Q6J("aquarium",e.$implicit)}let jj=(()=>{class n{constructor(){this.title="aquarium-manager",this.aquariums=[]}ngOnInit(){const t=ym(function _v(n=(0,Jn.getApp)(),e){return(0,Jn._getProvider)(n,"database").getImmediate({identifier:e})}());ts(Ou(t,"/users/heQyO6VnDeazONcYLgBQVa6GfEJ2/aquariums")).then(r=>{r.exists()&&Object.entries(r.val()).forEach(i=>this.aquariums.push(i[1]))})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["app-root"]],features:[_._Bn([yv])],decls:7,vars:1,consts:[[1,"app"],[1,"cards"],[3,"aquarium",4,"ngFor","ngForOf"],[3,"aquarium"]],template:function(t,r){1&t&&(_.TgZ(0,"div",0)(1,"h1"),_._uU(2,"Aquarium Manager"),_.qZA(),_.TgZ(3,"div",1),_.YNc(4,Bj,1,1,"app-card",2),_._UZ(5,"app-card-add"),_.qZA()(),_._UZ(6,"router-outlet")),2&t&&(_.xp6(4),_.Q6J("ngForOf",r.aquariums))},dependencies:[ws,sr,Lj,Uj],styles:['@import"https://fonts.googleapis.com/css2?family=Bungee+Spice&family=Varela+Round&display=swap";.app[_ngcontent-%COMP%]{margin:1%}.cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.cards[_ngcontent-%COMP%]:hover{cursor:default}h1[_ngcontent-%COMP%]{font-family:Bungee Spice}h1[_ngcontent-%COMP%]:hover{cursor:pointer}@media screen and (max-width: 400px){.cards[_ngcontent-%COMP%]{justify-content:center}app-card[_ngcontent-%COMP%]{margin:.5%}}']}),n})();const $j=[];let Hj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[e_.forRoot($j),e_]}),n})();class PO{}const Dc="*";function OO(n,e=null){return{type:2,steps:n,options:e}}function FO(n){return{type:6,styles:n,offset:null}}function LO(n){Promise.resolve().then(n)}class Rw{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){LO(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class UO{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,r=0,i=0;const a=this.players.length;0==a?LO(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++t==a&&this._onFinish()}),l.onDestroy(()=>{++r==a&&this._onDestroy()}),l.onStart(()=>{++i==a&&this._onStart()})}),this.totalTime=this.players.reduce((l,d)=>Math.max(l,d.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(r=>{const i=r.totalTime?Math.min(1,t/r.totalTime):1;r.setPosition(i)})}getPosition(){const e=this.players.reduce((t,r)=>null===t||r.totalTime>t.totalTime?r:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}function BO(n){return new _.vHH(3e3,!1)}function T$(){return typeof window<"u"&&typeof window.document<"u"}function jM(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function dh(n){switch(n.length){case 0:return new Rw;case 1:return n[0];default:return new UO(n)}}function VO(n,e,t,r,i=new Map,a=new Map){const l=[],d=[];let p=-1,y=null;if(r.forEach(b=>{const T=b.get("offset"),M=T==p,P=M&&y||new Map;b.forEach((U,ee)=>{let oe=ee,Ge=U;if("offset"!==ee)switch(oe=e.normalizePropertyName(oe,l),Ge){case"!":Ge=i.get(ee);break;case Dc:Ge=a.get(ee);break;default:Ge=e.normalizeStyleValue(ee,oe,Ge,l)}P.set(oe,Ge)}),M||d.push(P),y=P,p=T}),l.length)throw function f$(n){return new _.vHH(3502,!1)}();return d}function $M(n,e,t,r){switch(e){case"start":n.onStart(()=>r(t&&HM(t,"start",n)));break;case"done":n.onDone(()=>r(t&&HM(t,"done",n)));break;case"destroy":n.onDestroy(()=>r(t&&HM(t,"destroy",n)))}}function HM(n,e,t){const a=GM(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),l=n._data;return null!=l&&(a._data=l),a}function GM(n,e,t,r,i="",a=0,l){return{element:n,triggerName:e,fromState:t,toState:r,phaseName:i,totalTime:a,disabled:!!l}}function bo(n,e,t){let r=n.get(e);return r||n.set(e,r=t),r}function jO(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let WM=(n,e)=>!1,$O=(n,e,t)=>[],HO=null;function zM(n){const e=n.parentNode||n.host;return e===HO?null:e}(jM()||typeof Element<"u")&&(T$()?(HO=(()=>document.documentElement)(),WM=(n,e)=>{for(;e;){if(e===n)return!0;e=zM(e)}return!1}):WM=(n,e)=>n.contains(e),$O=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const r=n.querySelector(e);return r?[r]:[]});let Cp=null,GO=!1;const WO=WM,zO=$O;let qO=(()=>{class n{validateStyleProperty(t){return function S$(n){Cp||(Cp=function A$(){return typeof document<"u"?document.body:null}()||{},GO=!!Cp.style&&"WebkitAppearance"in Cp.style);let e=!0;return Cp.style&&!function D$(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Cp.style,!e&&GO&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Cp.style)),e}(t)}matchesElement(t,r){return!1}containsElement(t,r){return WO(t,r)}getParentElement(t){return zM(t)}query(t,r,i){return zO(t,r,i)}computeStyle(t,r,i){return i||""}animate(t,r,i,a,l,d=[],p){return new Rw(i,a)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})(),qM=(()=>{class n{}return n.NOOP=new qO,n})();const KM="ng-enter",hC="ng-leave",fC="ng-trigger",pC=".ng-trigger",ZO="ng-animating",ZM=".ng-animating";function Sc(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:YM(parseFloat(e[1]),e[2])}function YM(n,e){return"s"===e?1e3*n:n}function gC(n,e,t){return n.hasOwnProperty("duration")?n:function R$(n,e,t){let i,a=0,l="";if("string"==typeof n){const d=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===d)return e.push(BO()),{duration:0,delay:0,easing:""};i=YM(parseFloat(d[1]),d[2]);const p=d[3];null!=p&&(a=YM(parseFloat(p),d[4]));const y=d[5];y&&(l=y)}else i=n;if(!t){let d=!1,p=e.length;i<0&&(e.push(function Wj(){return new _.vHH(3100,!1)}()),d=!0),a<0&&(e.push(function zj(){return new _.vHH(3101,!1)}()),d=!0),d&&e.splice(p,0,BO())}return{duration:i,delay:a,easing:l}}(n,e,t)}function Nw(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function YO(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function hh(n,e=new Map,t){if(t)for(let[r,i]of t)e.set(r,i);for(let[r,i]of n)e.set(r,i);return e}function XO(n,e,t){return t?e+":"+t+";":""}function JO(n){let e="";for(let t=0;t<n.style.length;t++){const r=n.style.item(t);e+=XO(0,r,n.style.getPropertyValue(r))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=XO(0,O$(t),n.style[t]));n.setAttribute("style",e)}function Wu(n,e,t){n.style&&(e.forEach((r,i)=>{const a=XM(i);t&&!t.has(i)&&t.set(i,n.style[a]),n.style[a]=r}),jM()&&JO(n))}function Tp(n,e){n.style&&(e.forEach((t,r)=>{const i=XM(r);n.style[i]=""}),jM()&&JO(n))}function kw(n){return Array.isArray(n)?1==n.length?n[0]:OO(n):n}const QM=new RegExp("{{\\s*(.+?)\\s*}}","g");function e1(n){let e=[];if("string"==typeof n){let t;for(;t=QM.exec(n);)e.push(t[1]);QM.lastIndex=0}return e}function Pw(n,e,t){const r=n.toString(),i=r.replace(QM,(a,l)=>{let d=e[l];return null==d&&(t.push(function Kj(n){return new _.vHH(3003,!1)}()),d=""),d.toString()});return i==r?n:i}function mC(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const P$=/-+([a-z0-9])/g;function XM(n){return n.replace(P$,(...e)=>e[1].toUpperCase())}function O$(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Co(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Zj(n){return new _.vHH(3004,!1)}()}}function t1(n,e){return window.getComputedStyle(n)[e]}function j$(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function $$(n,e,t){if(":"==n[0]){const p=function H$(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return e.push(function l$(n){return new _.vHH(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof p)return void e.push(p);n=p}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return t.push(function u$(n){return new _.vHH(3015,!1)}()),e;const i=r[1],a=r[2],l=r[3];e.push(n1(i,l));"<"==a[0]&&!("*"==i&&"*"==l)&&e.push(n1(l,i))}(r,t,e)):t.push(n),t}const wC=new Set(["true","1"]),EC=new Set(["false","0"]);function n1(n,e){const t=wC.has(n)||EC.has(n),r=wC.has(e)||EC.has(e);return(i,a)=>{let l="*"==n||n==i,d="*"==e||e==a;return!l&&t&&"boolean"==typeof i&&(l=i?wC.has(n):EC.has(n)),!d&&r&&"boolean"==typeof a&&(d=a?wC.has(e):EC.has(e)),l&&d}}const G$=new RegExp("s*:selfs*,?","g");function JM(n,e,t,r){return new W$(n).build(e,t,r)}class W${constructor(e){this._driver=e}build(e,t,r){const i=new K$(t);return this._resetContextStyleTimingState(i),Co(this,kw(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let r=t.queryCount=0,i=t.depCount=0;const a=[],l=[];return"@"==e.name.charAt(0)&&t.errors.push(function Qj(){return new _.vHH(3006,!1)}()),e.definitions.forEach(d=>{if(this._resetContextStyleTimingState(t),0==d.type){const p=d,y=p.name;y.toString().split(/\s*,\s*/).forEach(b=>{p.name=b,a.push(this.visitState(p,t))}),p.name=y}else if(1==d.type){const p=this.visitTransition(d,t);r+=p.queryCount,i+=p.depCount,l.push(p)}else t.errors.push(function Xj(){return new _.vHH(3007,!1)}())}),{type:7,name:e.name,states:a,transitions:l,queryCount:r,depCount:i,options:null}}visitState(e,t){const r=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){const a=new Set,l=i||{};r.styles.forEach(d=>{d instanceof Map&&d.forEach(p=>{e1(p).forEach(y=>{l.hasOwnProperty(y)||a.add(y)})})}),a.size&&(mC(a.values()),t.errors.push(function Jj(n,e){return new _.vHH(3008,!1)}()))}return{type:0,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const r=Co(this,kw(e.animation),t);return{type:1,matchers:j$(e.expr,t.errors),animation:r,queryCount:t.queryCount,depCount:t.depCount,options:Dp(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(r=>Co(this,r,t)),options:Dp(e.options)}}visitGroup(e,t){const r=t.currentTime;let i=0;const a=e.steps.map(l=>{t.currentTime=r;const d=Co(this,l,t);return i=Math.max(i,t.currentTime),d});return t.currentTime=i,{type:3,steps:a,options:Dp(e.options)}}visitAnimate(e,t){const r=function Y$(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return ex(gC(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(a=>"{"==a.charAt(0)&&"{"==a.charAt(1))){const a=ex(0,0,"");return a.dynamic=!0,a.strValue=t,a}const i=gC(t,e);return ex(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=r;let i,a=e.styles?e.styles:FO({});if(5==a.type)i=this.visitKeyframes(a,t);else{let l=e.styles,d=!1;if(!l){d=!0;const y={};r.easing&&(y.easing=r.easing),l=FO(y)}t.currentTime+=r.duration+r.delay;const p=this.visitStyle(l,t);p.isEmptyStep=d,i=p}return t.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(e,t){const r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}_makeStyleAst(e,t){const r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let d of i)"string"==typeof d?d===Dc?r.push(d):t.errors.push(new _.vHH(3002,!1)):r.push(YO(d));let a=!1,l=null;return r.forEach(d=>{if(d instanceof Map&&(d.has("easing")&&(l=d.get("easing"),d.delete("easing")),!a))for(let p of d.values())if(p.toString().indexOf("{{")>=0){a=!0;break}}),{type:6,styles:r,easing:l,offset:e.offset,containsDynamicStyles:a,options:null}}_validateStyleAst(e,t){const r=t.currentAnimateTimings;let i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(l=>{"string"!=typeof l&&l.forEach((d,p)=>{const y=t.collectedStyles.get(t.currentQuerySelector),b=y.get(p);let T=!0;b&&(a!=i&&a>=b.startTime&&i<=b.endTime&&(t.errors.push(function t$(n,e,t,r,i){return new _.vHH(3010,!1)}()),T=!1),a=b.startTime),T&&y.set(p,{startTime:a,endTime:i}),t.options&&function k$(n,e,t){const r=e.params||{},i=e1(n);i.length&&i.forEach(a=>{r.hasOwnProperty(a)||t.push(function qj(n){return new _.vHH(3001,!1)}())})}(d,t.options,t.errors)})})}visitKeyframes(e,t){const r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function n$(){return new _.vHH(3011,!1)}()),r;let a=0;const l=[];let d=!1,p=!1,y=0;const b=e.steps.map(Ge=>{const Je=this._makeStyleAst(Ge,t);let rt=null!=Je.offset?Je.offset:function Z$(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const r=t;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(Je.styles),et=0;return null!=rt&&(a++,et=Je.offset=rt),p=p||et<0||et>1,d=d||et<y,y=et,l.push(et),Je});p&&t.errors.push(function r$(){return new _.vHH(3012,!1)}()),d&&t.errors.push(function i$(){return new _.vHH(3200,!1)}());const T=e.steps.length;let M=0;a>0&&a<T?t.errors.push(function s$(){return new _.vHH(3202,!1)}()):0==a&&(M=1/(T-1));const P=T-1,U=t.currentTime,ee=t.currentAnimateTimings,oe=ee.duration;return b.forEach((Ge,Je)=>{const rt=M>0?Je==P?1:M*Je:l[Je],et=rt*oe;t.currentTime=U+ee.delay+et,ee.duration=et,this._validateStyleAst(Ge,t),Ge.offset=rt,r.styles.push(Ge)}),r}visitReference(e,t){return{type:8,animation:Co(this,kw(e.animation),t),options:Dp(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Dp(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Dp(e.options)}}visitQuery(e,t){const r=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[a,l]=function z$(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(G$,"")),n=n.replace(/@\*/g,pC).replace(/@\w+/g,t=>pC+"-"+t.slice(1)).replace(/:animating/g,ZM),[n,e]}(e.selector);t.currentQuerySelector=r.length?r+" "+a:a,bo(t.collectedStyles,t.currentQuerySelector,new Map);const d=Co(this,kw(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:11,selector:a,limit:i.limit||0,optional:!!i.optional,includeSelf:l,animation:d,originalSelector:e.selector,options:Dp(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function o$(){return new _.vHH(3013,!1)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:gC(e.timings,t.errors,!0);return{type:12,animation:Co(this,kw(e.animation),t),timings:r,options:null}}}class K${constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Dp(n){return n?(n=Nw(n)).params&&(n.params=function q$(n){return n?Nw(n):null}(n.params)):n={},n}function ex(n,e,t){return{duration:n,delay:e,easing:t}}function tx(n,e,t,r,i,a,l=null,d=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:l,subTimeline:d}}class IC{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const J$=new RegExp(":enter","g"),tH=new RegExp(":leave","g");function nx(n,e,t,r,i,a=new Map,l=new Map,d,p,y=[]){return(new nH).buildKeyframes(n,e,t,r,i,a,l,d,p,y)}class nH{buildKeyframes(e,t,r,i,a,l,d,p,y,b=[]){y=y||new IC;const T=new rx(e,t,y,i,a,b,[]);T.options=p;const M=p.delay?Sc(p.delay):0;T.currentTimeline.delayNextStep(M),T.currentTimeline.setStyles([l],null,T.errors,p),Co(this,r,T);const P=T.timelines.filter(U=>U.containsAnimation());if(P.length&&d.size){let U;for(let ee=P.length-1;ee>=0;ee--){const oe=P[ee];if(oe.element===t){U=oe;break}}U&&!U.allowOnlyTimelineStyles()&&U.setStyles([d],null,T.errors,p)}return P.length?P.map(U=>U.buildKeyframes()):[tx(t,[],[],[],0,M,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const r=t.subInstructions.get(t.element);if(r){const i=t.createSubContext(e.options),a=t.currentTimeline.currentTime,l=this._visitSubInstructions(r,i,i.options);a!=l&&t.transformIntoNewTimeline(l)}t.previousNode=e}visitAnimateRef(e,t){const r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimateRefDelay(e.animation,t,r),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}_applyAnimateRefDelay(e,t,r){const i=e.options?.delay;if(!i)return;let a;a="string"==typeof i?Sc(Pw(i,e.options?.params??{},t.errors)):i,r.delayNextStep(a)}_visitSubInstructions(e,t,r){let a=t.currentTimeline.currentTime;const l=null!=r.duration?Sc(r.duration):null,d=null!=r.delay?Sc(r.delay):null;return 0!==l&&e.forEach(p=>{const y=t.appendInstructionToTimeline(p,l,d);a=Math.max(a,y.duration+y.delay)}),a}visitReference(e,t){t.updateOptions(e.options,!0),Co(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const r=t.subContextCount;let i=t;const a=e.options;if(a&&(a.params||a.delay)&&(i=t.createSubContext(a),i.transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=bC);const l=Sc(a.delay);i.delayNextStep(l)}e.steps.length&&(e.steps.forEach(l=>Co(this,l,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const r=[];let i=t.currentTimeline.currentTime;const a=e.options&&e.options.delay?Sc(e.options.delay):0;e.steps.forEach(l=>{const d=t.createSubContext(e.options);a&&d.delayNextStep(a),Co(this,l,d),i=Math.max(i,d.currentTimeline.currentTime),r.push(d.currentTimeline)}),r.forEach(l=>t.currentTimeline.mergeTimelineCollectedStyles(l)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const r=e.strValue;return gC(t.params?Pw(r,t.params,t.errors):r,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const r=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),i.snapshotCurrentStyles());const a=e.style;5==a.type?this.visitKeyframes(a,t):(t.incrementTime(r.duration),this.visitStyle(a,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const r=t.currentTimeline,i=t.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();const a=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(a):r.setStyles(e.styles,a,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const r=t.currentAnimateTimings,i=t.currentTimeline.duration,a=r.duration,d=t.createSubContext().currentTimeline;d.easing=r.easing,e.styles.forEach(p=>{d.forwardTime((p.offset||0)*a),d.setStyles(p.styles,p.easing,t.errors,t.options),d.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(d),t.transformIntoNewTimeline(i+a),t.previousNode=e}visitQuery(e,t){const r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?Sc(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=bC);let l=r;const d=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=d.length;let p=null;d.forEach((y,b)=>{t.currentQueryIndex=b;const T=t.createSubContext(e.options,y);a&&T.delayNextStep(a),y===t.element&&(p=T.currentTimeline),Co(this,e.animation,T),T.currentTimeline.applyStylesToKeyframe(),l=Math.max(l,T.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(l),p&&(t.currentTimeline.mergeTimelineCollectedStyles(p),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const r=t.parentContext,i=t.currentTimeline,a=e.timings,l=Math.abs(a.duration),d=l*(t.currentQueryTotal-1);let p=l*t.currentQueryIndex;switch(a.duration<0?"reverse":a.easing){case"reverse":p=d-p;break;case"full":p=r.currentStaggerTime}const b=t.currentTimeline;p&&b.delayNextStep(p);const T=b.currentTime;Co(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=i.currentTime-T+(i.startTime-r.currentTimeline.startTime)}}const bC={};class rx{constructor(e,t,r,i,a,l,d,p){this._driver=e,this.element=t,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=l,this.timelines=d,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=bC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=p||new CC(this._driver,t,0),d.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const r=e;let i=this.options;null!=r.duration&&(i.duration=Sc(r.duration)),null!=r.delay&&(i.delay=Sc(r.delay));const a=r.params;if(a){let l=i.params;l||(l=this.options.params={}),Object.keys(a).forEach(d=>{(!t||!l.hasOwnProperty(d))&&(l[d]=Pw(a[d],l,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const r=e.params={};Object.keys(t).forEach(i=>{r[i]=t[i]})}}return e}createSubContext(e=null,t,r){const i=t||this.element,a=new rx(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(e),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}transformIntoNewTimeline(e){return this.previousNode=bC,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,r){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},a=new rH(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(a),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,r,i,a,l){let d=[];if(i&&d.push(this.element),e.length>0){e=(e=e.replace(J$,"."+this._enterClassName)).replace(tH,"."+this._leaveClassName);let y=this._driver.query(this.element,e,1!=r);0!==r&&(y=r<0?y.slice(y.length+r,y.length):y.slice(0,r)),d.push(...y)}return!a&&0==d.length&&l.push(function a$(n){return new _.vHH(3014,!1)}()),d}}class CC{constructor(e,t,r,i){this._driver=e,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new CC(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||Dc),this._currentKeyframe.set(t,Dc);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,r,i){t&&this._previousKeyframe.set("easing",t);const a=i&&i.params||{},l=function iH(n,e){const t=new Map;let r;return n.forEach(i=>{if("*"===i){r=r||e.keys();for(let a of r)t.set(a,Dc)}else hh(i,t)}),t}(e,this._globalTimelineStyles);for(let[d,p]of l){const y=Pw(p,a,r);this._pendingStyles.set(d,y),this._localTimelineStyles.has(d)||this._backFill.set(d,this._globalTimelineStyles.get(d)??Dc),this._updateStyle(d,y)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,r)=>{const i=this._styleSummary.get(r);(!i||t.time>i.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,r=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((d,p)=>{const y=hh(d,new Map,this._backFill);y.forEach((b,T)=>{"!"===b?e.add(T):b===Dc&&t.add(T)}),r||y.set("offset",p/this.duration),i.push(y)});const a=e.size?mC(e.values()):[],l=t.size?mC(t.values()):[];if(r){const d=i[0],p=new Map(d);d.set("offset",0),p.set("offset",1),i=[d,p]}return tx(this.element,i,a,l,this.duration,this.startTime,this.easing,!1)}}class rH extends CC{constructor(e,t,r,i,a,l,d=!1){super(e,t,l.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=a,this._stretchStartingKeyframe=d,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const a=[],l=r+t,d=t/l,p=hh(e[0]);p.set("offset",0),a.push(p);const y=hh(e[0]);y.set("offset",o1(d)),a.push(y);const b=e.length-1;for(let T=1;T<=b;T++){let M=hh(e[T]);const P=M.get("offset");M.set("offset",o1((t+P*r)/l)),a.push(M)}r=l,t=0,i="",e=a}return tx(this.element,e,this.preStyleProps,this.postStyleProps,r,t,i,!0)}}function o1(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class ix{}const sH=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class oH extends ix{normalizePropertyName(e,t){return XM(e)}normalizeStyleValue(e,t,r,i){let a="";const l=r.toString().trim();if(sH.has(t)&&0!==r&&"0"!==r)if("number"==typeof r)a="px";else{const d=r.match(/^[+-]?[\d\.]+([a-z]*)$/);d&&0==d[1].length&&i.push(function Yj(n,e){return new _.vHH(3005,!1)}())}return l+a}}function a1(n,e,t,r,i,a,l,d,p,y,b,T,M){return{type:0,element:n,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:a,toState:r,toStyles:l,timelines:d,queriedElements:p,preStyleProps:y,postStyleProps:b,totalTime:T,errors:M}}const sx={};class u1{constructor(e,t,r){this._triggerName=e,this.ast=t,this._stateStyles=r}match(e,t,r,i){return function aH(n,e,t,r,i){return n.some(a=>a(e,t,r,i))}(this.ast.matchers,e,t,r,i)}buildStyles(e,t,r){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,r):new Map}build(e,t,r,i,a,l,d,p,y,b){const T=[],M=this.ast.options&&this.ast.options.params||sx,U=this.buildStyles(r,d&&d.params||sx,T),ee=p&&p.params||sx,oe=this.buildStyles(i,ee,T),Ge=new Set,Je=new Map,rt=new Map,et="void"===i,xt={params:uH(ee,M),delay:this.ast.options?.delay},Pt=b?[]:nx(e,t,this.ast.animation,a,l,U,oe,xt,y,T);let _n=0;if(Pt.forEach(xo=>{_n=Math.max(xo.duration+xo.delay,_n)}),T.length)return a1(t,this._triggerName,r,i,et,U,oe,[],[],Je,rt,_n,T);Pt.forEach(xo=>{const Uc=xo.element,A2=bo(Je,Uc,new Set);xo.preStyleProps.forEach(ig=>A2.add(ig));const ZE=bo(rt,Uc,new Set);xo.postStyleProps.forEach(ig=>ZE.add(ig)),Uc!==t&&Ge.add(Uc)});const Zr=mC(Ge.values());return a1(t,this._triggerName,r,i,et,U,oe,Pt,Zr,Je,rt,_n)}}function uH(n,e){const t=Nw(e);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(t[r]=n[r]);return t}class lH{constructor(e,t,r){this.styles=e,this.defaultParams=t,this.normalizer=r}buildStyles(e,t){const r=new Map,i=Nw(this.defaultParams);return Object.keys(e).forEach(a=>{const l=e[a];null!==l&&(i[a]=l)}),this.styles.styles.forEach(a=>{"string"!=typeof a&&a.forEach((l,d)=>{l&&(l=Pw(l,i,t));const p=this.normalizer.normalizePropertyName(d,t);l=this.normalizer.normalizeStyleValue(d,p,l,t),r.set(p,l)})}),r}}class dH{constructor(e,t,r){this.name=e,this.ast=t,this._normalizer=r,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new lH(i.style,i.options&&i.options.params||{},r))}),l1(this.states,"true","1"),l1(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new u1(e,i,this.states))}),this.fallbackTransition=function hH(n,e,t){return new u1(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(l,d)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,r,i){return this.transitionFactories.find(l=>l.match(e,t,r,i))||null}matchStyles(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}}function l1(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const fH=new IC;class pH{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const r=[],a=JM(this._driver,t,r,[]);if(r.length)throw function p$(n){return new _.vHH(3503,!1)}();this._animations.set(e,a)}_buildPlayer(e,t,r){const i=e.element,a=VO(0,this._normalizer,0,e.keyframes,t,r);return this._driver.animate(i,a,e.duration,e.delay,e.easing,[],!0)}create(e,t,r={}){const i=[],a=this._animations.get(e);let l;const d=new Map;if(a?(l=nx(this._driver,t,a,KM,hC,new Map,new Map,r,fH,i),l.forEach(b=>{const T=bo(d,b.element,new Map);b.postStyleProps.forEach(M=>T.set(M,null))})):(i.push(function g$(){return new _.vHH(3300,!1)}()),l=[]),i.length)throw function m$(n){return new _.vHH(3504,!1)}();d.forEach((b,T)=>{b.forEach((M,P)=>{b.set(P,this._driver.computeStyle(T,P,Dc))})});const y=dh(l.map(b=>{const T=d.get(b.element);return this._buildPlayer(b,new Map,T)}));return this._playersById.set(e,y),y.onDestroy(()=>this.destroy(e)),this.players.push(y),y}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function _$(n){return new _.vHH(3301,!1)}();return t}listen(e,t,r,i){const a=GM(t,"","","");return $M(this._getPlayer(e),r,a,i),()=>{}}command(e,t,r,i){if("register"==r)return void this.register(e,i[0]);if("create"==r)return void this.create(e,t,i[0]||{});const a=this._getPlayer(e);switch(r){case"play":a.play();break;case"pause":a.pause();break;case"reset":a.reset();break;case"restart":a.restart();break;case"finish":a.finish();break;case"init":a.init();break;case"setPosition":a.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const c1="ng-animate-queued",ox="ng-animate-disabled",vH=[],d1={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},wH={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},da="__ng_removed";class ax{constructor(e,t=""){this.namespaceId=t;const r=e&&e.hasOwnProperty("value");if(this.value=function CH(n){return n??null}(r?e.value:e),r){const a=Nw(e);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const r=this.options.params;Object.keys(t).forEach(i=>{null==r[i]&&(r[i]=t[i])})}}}const Ow="void",ux=new ax(Ow);class EH{constructor(e,t,r){this.id=e,this.hostElement=t,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ha(t,this._hostClassName)}listen(e,t,r,i){if(!this._triggers.has(t))throw function y$(n,e){return new _.vHH(3302,!1)}();if(null==r||0==r.length)throw function v$(n){return new _.vHH(3303,!1)}();if(!function TH(n){return"start"==n||"done"==n}(r))throw function w$(n,e){return new _.vHH(3400,!1)}();const a=bo(this._elementListeners,e,[]),l={name:t,phase:r,callback:i};a.push(l);const d=bo(this._engine.statesByElement,e,new Map);return d.has(t)||(ha(e,fC),ha(e,fC+"-"+t),d.set(t,ux)),()=>{this._engine.afterFlush(()=>{const p=a.indexOf(l);p>=0&&a.splice(p,1),this._triggers.has(t)||d.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function E$(n){return new _.vHH(3401,!1)}();return t}trigger(e,t,r,i=!0){const a=this._getTrigger(t),l=new lx(this.id,t,e);let d=this._engine.statesByElement.get(e);d||(ha(e,fC),ha(e,fC+"-"+t),this._engine.statesByElement.set(e,d=new Map));let p=d.get(t);const y=new ax(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&p&&y.absorbOptions(p.options),d.set(t,y),p||(p=ux),y.value!==Ow&&p.value===y.value){if(!function AH(n,e){const t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let i=0;i<t.length;i++){const a=t[i];if(!e.hasOwnProperty(a)||n[a]!==e[a])return!1}return!0}(p.params,y.params)){const ee=[],oe=a.matchStyles(p.value,p.params,ee),Ge=a.matchStyles(y.value,y.params,ee);ee.length?this._engine.reportError(ee):this._engine.afterFlush(()=>{Tp(e,oe),Wu(e,Ge)})}return}const M=bo(this._engine.playersByElement,e,[]);M.forEach(ee=>{ee.namespaceId==this.id&&ee.triggerName==t&&ee.queued&&ee.destroy()});let P=a.matchTransition(p.value,y.value,e,y.params),U=!1;if(!P){if(!i)return;P=a.fallbackTransition,U=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:P,fromState:p,toState:y,player:l,isFallbackTransition:U}),U||(ha(e,c1),l.onStart(()=>{i_(e,c1)})),l.onDone(()=>{let ee=this.players.indexOf(l);ee>=0&&this.players.splice(ee,1);const oe=this._engine.playersByElement.get(e);if(oe){let Ge=oe.indexOf(l);Ge>=0&&oe.splice(Ge,1)}}),this.players.push(l),M.push(l),l}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const r=this._engine.driver.query(e,pC,!0);r.forEach(i=>{if(i[da])return;const a=this._engine.fetchNamespacesByElement(i);a.size?a.forEach(l=>l.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,r,i){const a=this._engine.statesByElement.get(e),l=new Map;if(a){const d=[];if(a.forEach((p,y)=>{if(l.set(y,p.value),this._triggers.has(y)){const b=this.trigger(e,y,Ow,i);b&&d.push(b)}}),d.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,l),r&&dh(d).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(t&&r){const i=new Set;t.forEach(a=>{const l=a.name;if(i.has(l))return;i.add(l);const p=this._triggers.get(l).fallbackTransition,y=r.get(l)||ux,b=new ax(Ow),T=new lx(this.id,l,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:l,transition:p,fromState:y,toState:b,player:T,isFallbackTransition:!0})})}}removeNode(e,t){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(r.totalAnimations){const a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else{let l=e;for(;l=l.parentNode;)if(r.statesByElement.get(l)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{const a=e[da];(!a||a===d1)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}insertNode(e,t){ha(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(r=>{const i=r.player;if(i.destroyed)return;const a=r.element,l=this._elementListeners.get(a);l&&l.forEach(d=>{if(d.name==r.triggerName){const p=GM(a,r.triggerName,r.fromState.value,r.toState.value);p._data=e,$M(r.player,d.phase,p,d.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(r)}),this._queue=[],t.sort((r,i)=>{const a=r.transition.ast.depCount,l=i.transition.ast.depCount;return 0==a||0==l?a-l:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(r=>r.element===e)||t,t}}class IH{constructor(e,t,r){this.bodyNode=e,this.driver=t,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,a)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,t){const r=new EH(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,t){const r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let l=!1,d=this.driver.getParentElement(t);for(;d;){const p=i.get(d);if(p){const y=r.indexOf(p);r.splice(y+1,0,e),l=!0;break}d=this.driver.getParentElement(d)}l||r.unshift(e)}else r.push(e);return i.set(t,e),e}register(e,t){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}registerTrigger(e,t,r){let i=this._namespaceLookup[e];i&&i.register(t,r)&&this.totalAnimations++}destroy(e,t){if(!e)return;const r=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[e];const i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1)}),this.afterFlushAnimationsDone(()=>r.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,r=this.statesByElement.get(e);if(r)for(let i of r.values())if(i.namespaceId){const a=this._fetchNamespace(i.namespaceId);a&&t.add(a)}return t}trigger(e,t,r,i){if(TC(t)){const a=this._fetchNamespace(e);if(a)return a.trigger(t,r,i),!0}return!1}insertNode(e,t,r,i){if(!TC(t))return;const a=t[da];if(a&&a.setForRemoval){a.setForRemoval=!1,a.setForMove=!0;const l=this.collectedLeaveElements.indexOf(t);l>=0&&this.collectedLeaveElements.splice(l,1)}if(e){const l=this._fetchNamespace(e);l&&l.insertNode(t,r)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ha(e,ox)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),i_(e,ox))}removeNode(e,t,r,i){if(TC(t)){const a=e?this._fetchNamespace(e):null;if(a?a.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i),r){const l=this.namespacesByHostElement.get(t);l&&l.id!==e&&l.removeNode(t,i)}}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,r,i,a){this.collectedLeaveElements.push(t),t[da]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:a}}listen(e,t,r,i,a){return TC(t)?this._fetchNamespace(e).listen(t,r,i,a):()=>{}}_buildInstruction(e,t,r,i,a){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,t,a)}destroyInnerAnimations(e){let t=this.driver.query(e,pC,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,ZM,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return dh(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[da];if(t&&t.setForRemoval){if(e[da]=d1,t.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(ox)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)ha(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{t=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],t.length?dh(t).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw function I$(n){return new _.vHH(3402,!1)}()}_flushAnimations(e,t){const r=new IC,i=[],a=new Map,l=[],d=new Map,p=new Map,y=new Map,b=new Set;this.disabledNodes.forEach(Ct=>{b.add(Ct);const Ut=this.driver.query(Ct,".ng-animate-queued",!0);for(let Wt=0;Wt<Ut.length;Wt++)b.add(Ut[Wt])});const T=this.bodyNode,M=Array.from(this.statesByElement.keys()),P=p1(M,this.collectedEnterElements),U=new Map;let ee=0;P.forEach((Ct,Ut)=>{const Wt=KM+ee++;U.set(Ut,Wt),Ct.forEach(Mn=>ha(Mn,Wt))});const oe=[],Ge=new Set,Je=new Set;for(let Ct=0;Ct<this.collectedLeaveElements.length;Ct++){const Ut=this.collectedLeaveElements[Ct],Wt=Ut[da];Wt&&Wt.setForRemoval&&(oe.push(Ut),Ge.add(Ut),Wt.hasAnimation?this.driver.query(Ut,".ng-star-inserted",!0).forEach(Mn=>Ge.add(Mn)):Je.add(Ut))}const rt=new Map,et=p1(M,Array.from(Ge));et.forEach((Ct,Ut)=>{const Wt=hC+ee++;rt.set(Ut,Wt),Ct.forEach(Mn=>ha(Mn,Wt))}),e.push(()=>{P.forEach((Ct,Ut)=>{const Wt=U.get(Ut);Ct.forEach(Mn=>i_(Mn,Wt))}),et.forEach((Ct,Ut)=>{const Wt=rt.get(Ut);Ct.forEach(Mn=>i_(Mn,Wt))}),oe.forEach(Ct=>{this.processLeaveNode(Ct)})});const xt=[],Pt=[];for(let Ct=this._namespaceList.length-1;Ct>=0;Ct--)this._namespaceList[Ct].drainQueuedTransitions(t).forEach(Wt=>{const Mn=Wt.player,Ai=Wt.element;if(xt.push(Mn),this.collectedEnterElements.length){const as=Ai[da];if(as&&as.setForMove){if(as.previousTriggersValues&&as.previousTriggersValues.has(Wt.triggerName)){const sg=as.previousTriggersValues.get(Wt.triggerName),pa=this.statesByElement.get(Wt.element);if(pa&&pa.has(Wt.triggerName)){const lD=pa.get(Wt.triggerName);lD.value=sg,pa.set(Wt.triggerName,lD)}}return void Mn.destroy()}}const nl=!T||!this.driver.containsElement(T,Ai),Ro=rt.get(Ai),Ph=U.get(Ai),Mr=this._buildInstruction(Wt,r,Ph,Ro,nl);if(Mr.errors&&Mr.errors.length)return void Pt.push(Mr);if(nl)return Mn.onStart(()=>Tp(Ai,Mr.fromStyles)),Mn.onDestroy(()=>Wu(Ai,Mr.toStyles)),void i.push(Mn);if(Wt.isFallbackTransition)return Mn.onStart(()=>Tp(Ai,Mr.fromStyles)),Mn.onDestroy(()=>Wu(Ai,Mr.toStyles)),void i.push(Mn);const R2=[];Mr.timelines.forEach(as=>{as.stretchStartingKeyframe=!0,this.disabledNodes.has(as.element)||R2.push(as)}),Mr.timelines=R2,r.append(Ai,Mr.timelines),l.push({instruction:Mr,player:Mn,element:Ai}),Mr.queriedElements.forEach(as=>bo(d,as,[]).push(Mn)),Mr.preStyleProps.forEach((as,sg)=>{if(as.size){let pa=p.get(sg);pa||p.set(sg,pa=new Set),as.forEach((lD,Hk)=>pa.add(Hk))}}),Mr.postStyleProps.forEach((as,sg)=>{let pa=y.get(sg);pa||y.set(sg,pa=new Set),as.forEach((lD,Hk)=>pa.add(Hk))})});if(Pt.length){const Ct=[];Pt.forEach(Ut=>{Ct.push(function b$(n,e){return new _.vHH(3505,!1)}())}),xt.forEach(Ut=>Ut.destroy()),this.reportError(Ct)}const _n=new Map,Zr=new Map;l.forEach(Ct=>{const Ut=Ct.element;r.has(Ut)&&(Zr.set(Ut,Ut),this._beforeAnimationBuild(Ct.player.namespaceId,Ct.instruction,_n))}),i.forEach(Ct=>{const Ut=Ct.element;this._getPreviousPlayers(Ut,!1,Ct.namespaceId,Ct.triggerName,null).forEach(Mn=>{bo(_n,Ut,[]).push(Mn),Mn.destroy()})});const xo=oe.filter(Ct=>m1(Ct,p,y)),Uc=new Map;f1(Uc,this.driver,Je,y,Dc).forEach(Ct=>{m1(Ct,p,y)&&xo.push(Ct)});const ZE=new Map;P.forEach((Ct,Ut)=>{f1(ZE,this.driver,new Set(Ct),p,"!")}),xo.forEach(Ct=>{const Ut=Uc.get(Ct),Wt=ZE.get(Ct);Uc.set(Ct,new Map([...Array.from(Ut?.entries()??[]),...Array.from(Wt?.entries()??[])]))});const ig=[],M2=[],x2={};l.forEach(Ct=>{const{element:Ut,player:Wt,instruction:Mn}=Ct;if(r.has(Ut)){if(b.has(Ut))return Wt.onDestroy(()=>Wu(Ut,Mn.toStyles)),Wt.disabled=!0,Wt.overrideTotalTime(Mn.totalTime),void i.push(Wt);let Ai=x2;if(Zr.size>1){let Ro=Ut;const Ph=[];for(;Ro=Ro.parentNode;){const Mr=Zr.get(Ro);if(Mr){Ai=Mr;break}Ph.push(Ro)}Ph.forEach(Mr=>Zr.set(Mr,Ai))}const nl=this._buildAnimation(Wt.namespaceId,Mn,_n,a,ZE,Uc);if(Wt.setRealPlayer(nl),Ai===x2)ig.push(Wt);else{const Ro=this.playersByElement.get(Ai);Ro&&Ro.length&&(Wt.parentPlayer=dh(Ro)),i.push(Wt)}}else Tp(Ut,Mn.fromStyles),Wt.onDestroy(()=>Wu(Ut,Mn.toStyles)),M2.push(Wt),b.has(Ut)&&i.push(Wt)}),M2.forEach(Ct=>{const Ut=a.get(Ct.element);if(Ut&&Ut.length){const Wt=dh(Ut);Ct.setRealPlayer(Wt)}}),i.forEach(Ct=>{Ct.parentPlayer?Ct.syncPlayerEvents(Ct.parentPlayer):Ct.destroy()});for(let Ct=0;Ct<oe.length;Ct++){const Ut=oe[Ct],Wt=Ut[da];if(i_(Ut,hC),Wt&&Wt.hasAnimation)continue;let Mn=[];if(d.size){let nl=d.get(Ut);nl&&nl.length&&Mn.push(...nl);let Ro=this.driver.query(Ut,ZM,!0);for(let Ph=0;Ph<Ro.length;Ph++){let Mr=d.get(Ro[Ph]);Mr&&Mr.length&&Mn.push(...Mr)}}const Ai=Mn.filter(nl=>!nl.destroyed);Ai.length?DH(this,Ut,Ai):this.processLeaveNode(Ut)}return oe.length=0,ig.forEach(Ct=>{this.players.push(Ct),Ct.onDone(()=>{Ct.destroy();const Ut=this.players.indexOf(Ct);this.players.splice(Ut,1)}),Ct.play()}),ig}elementContainsData(e,t){let r=!1;const i=t[da];return i&&i.setForRemoval&&(r=!0),this.playersByElement.has(t)&&(r=!0),this.playersByQueriedElement.has(t)&&(r=!0),this.statesByElement.has(t)&&(r=!0),this._fetchNamespace(e).elementContainsData(t)||r}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,r,i,a){let l=[];if(t){const d=this.playersByQueriedElement.get(e);d&&(l=d)}else{const d=this.playersByElement.get(e);if(d){const p=!a||a==Ow;d.forEach(y=>{y.queued||!p&&y.triggerName!=i||l.push(y)})}}return(r||i)&&(l=l.filter(d=>!(r&&r!=d.namespaceId||i&&i!=d.triggerName))),l}_beforeAnimationBuild(e,t,r){const a=t.element,l=t.isRemovalTransition?void 0:e,d=t.isRemovalTransition?void 0:t.triggerName;for(const p of t.timelines){const y=p.element,b=y!==a,T=bo(r,y,[]);this._getPreviousPlayers(y,b,l,d,t.toState).forEach(P=>{const U=P.getRealPlayer();U.beforeDestroy&&U.beforeDestroy(),P.destroy(),T.push(P)})}Tp(a,t.fromStyles)}_buildAnimation(e,t,r,i,a,l){const d=t.triggerName,p=t.element,y=[],b=new Set,T=new Set,M=t.timelines.map(U=>{const ee=U.element;b.add(ee);const oe=ee[da];if(oe&&oe.removedBeforeQueried)return new Rw(U.duration,U.delay);const Ge=ee!==p,Je=function SH(n){const e=[];return g1(n,e),e}((r.get(ee)||vH).map(_n=>_n.getRealPlayer())).filter(_n=>!!_n.element&&_n.element===ee),rt=a.get(ee),et=l.get(ee),xt=VO(0,this._normalizer,0,U.keyframes,rt,et),Pt=this._buildPlayer(U,xt,Je);if(U.subTimeline&&i&&T.add(ee),Ge){const _n=new lx(e,d,ee);_n.setRealPlayer(Pt),y.push(_n)}return Pt});y.forEach(U=>{bo(this.playersByQueriedElement,U.element,[]).push(U),U.onDone(()=>function bH(n,e,t){let r=n.get(e);if(r){if(r.length){const i=r.indexOf(t);r.splice(i,1)}0==r.length&&n.delete(e)}return r}(this.playersByQueriedElement,U.element,U))}),b.forEach(U=>ha(U,ZO));const P=dh(M);return P.onDestroy(()=>{b.forEach(U=>i_(U,ZO)),Wu(p,t.toStyles)}),T.forEach(U=>{bo(i,U,[]).push(P)}),P}_buildPlayer(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new Rw(e.duration,e.delay)}}class lx{constructor(e,t,r){this.namespaceId=e,this.triggerName=t,this.element=r,this._player=new Rw,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,r)=>{t.forEach(i=>$M(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){bo(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function TC(n){return n&&1===n.nodeType}function h1(n,e){const t=n.style.display;return n.style.display=e??"none",t}function f1(n,e,t,r,i){const a=[];t.forEach(p=>a.push(h1(p)));const l=[];r.forEach((p,y)=>{const b=new Map;p.forEach(T=>{const M=e.computeStyle(y,T,i);b.set(T,M),(!M||0==M.length)&&(y[da]=wH,l.push(y))}),n.set(y,b)});let d=0;return t.forEach(p=>h1(p,a[d++])),l}function p1(n,e){const t=new Map;if(n.forEach(d=>t.set(d,[])),0==e.length)return t;const i=new Set(e),a=new Map;function l(d){if(!d)return 1;let p=a.get(d);if(p)return p;const y=d.parentNode;return p=t.has(y)?y:i.has(y)?1:l(y),a.set(d,p),p}return e.forEach(d=>{const p=l(d);1!==p&&t.get(p).push(d)}),t}function ha(n,e){n.classList?.add(e)}function i_(n,e){n.classList?.remove(e)}function DH(n,e,t){dh(t).onDone(()=>n.processLeaveNode(e))}function g1(n,e){for(let t=0;t<n.length;t++){const r=n[t];r instanceof UO?g1(r.players,e):e.push(r)}}function m1(n,e,t){const r=t.get(n);if(!r)return!1;let i=e.get(n);return i?r.forEach(a=>i.add(a)):e.set(n,r),t.delete(n),!0}class DC{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,a)=>{},this._transitionEngine=new IH(e,t,r),this._timelineEngine=new pH(e,t,r),this._transitionEngine.onRemovalComplete=(i,a)=>this.onRemovalComplete(i,a)}registerTrigger(e,t,r,i,a){const l=e+"-"+i;let d=this._triggerCache[l];if(!d){const p=[],b=JM(this._driver,a,p,[]);if(p.length)throw function h$(n,e){return new _.vHH(3404,!1)}();d=function cH(n,e,t){return new dH(n,e,t)}(i,b,this._normalizer),this._triggerCache[l]=d}this._transitionEngine.registerTrigger(t,i,d)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,r,i){this._transitionEngine.insertNode(e,t,r,i)}onRemove(e,t,r,i){this._transitionEngine.removeNode(e,t,i||!1,r)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,r,i){if("@"==r.charAt(0)){const[a,l]=jO(r);this._timelineEngine.command(a,t,l,i)}else this._transitionEngine.trigger(e,t,r,i)}listen(e,t,r,i,a){if("@"==r.charAt(0)){const[l,d]=jO(r);return this._timelineEngine.listen(l,t,d,a)}return this._transitionEngine.listen(e,t,r,i,a)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let xH=(()=>{class n{constructor(t,r,i){this._element=t,this._startStyles=r,this._endStyles=i,this._state=0;let a=n.initialStylesByElement.get(t);a||n.initialStylesByElement.set(t,a=new Map),this._initialStyles=a}start(){this._state<1&&(this._startStyles&&Wu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Wu(this._element,this._initialStyles),this._endStyles&&(Wu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Tp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Tp(this._element,this._endStyles),this._endStyles=null),Wu(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function cx(n){let e=null;return n.forEach((t,r)=>{(function RH(n){return"display"===n||"position"===n})(r)&&(e=e||new Map,e.set(r,t))}),e}class _1{constructor(e,t,r,i){this.element=e,this.keyframes=t,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(e,t,r){return e.animate(this._convertKeyframesToObject(t),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{"offset"!==i&&e.set(i,this._finished?r:t1(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class NH{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return WO(e,t)}getParentElement(e){return zM(e)}query(e,t,r){return zO(e,t,r)}computeStyle(e,t,r){return window.getComputedStyle(e)[t]}animate(e,t,r,i,a,l=[]){const p={duration:r,delay:i,fill:0==i?"both":"forwards"};a&&(p.easing=a);const y=new Map,b=l.filter(P=>P instanceof _1);(function F$(n,e){return 0===n||0===e})(r,i)&&b.forEach(P=>{P.currentSnapshot.forEach((U,ee)=>y.set(ee,U))});let T=function N$(n){return n.length?n[0]instanceof Map?n:n.map(e=>YO(e)):[]}(t).map(P=>hh(P));T=function L$(n,e,t){if(t.size&&e.length){let r=e[0],i=[];if(t.forEach((a,l)=>{r.has(l)||i.push(l),r.set(l,a)}),i.length)for(let a=1;a<e.length;a++){let l=e[a];i.forEach(d=>l.set(d,t1(n,d)))}}return e}(e,T,y);const M=function MH(n,e){let t=null,r=null;return Array.isArray(e)&&e.length?(t=cx(e[0]),e.length>1&&(r=cx(e[e.length-1]))):e instanceof Map&&(t=cx(e)),t||r?new xH(n,t,r):null}(e,T);return new _1(e,T,p,M)}}let kH=(()=>{class n extends PO{constructor(t,r){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(r.body,{id:"0",encapsulation:_.ifc.None,styles:[],data:{animation:[]}})}build(t){const r=this._nextAnimationId.toString();this._nextAnimationId++;const i=Array.isArray(t)?OO(t):t;return y1(this._renderer,null,r,"register",[i]),new PH(r,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.FYo),_.LFG(ce))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class PH extends class Gj{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new OH(this._id,e,t||{},this._renderer)}}class OH{constructor(e,t,r,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return y1(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function y1(n,e,t,r,i){return n.setProperty(e,`@@${t}:${r}`,i)}const v1="@.disabled";let FH=(()=>{class n{constructor(t,r,i){this.delegate=t,this.engine=r,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(a,l)=>{const d=l?.parentNode(a);d&&l.removeChild(d,a)}}createRenderer(t,r){const a=this.delegate.createRenderer(t,r);if(!(t&&r&&r.data&&r.data.animation)){let b=this._rendererCache.get(a);return b||(b=new w1("",a,this.engine),this._rendererCache.set(a,b)),b}const l=r.id,d=r.id+"-"+this._currentId;this._currentId++,this.engine.register(d,t);const p=b=>{Array.isArray(b)?b.forEach(p):this.engine.registerTrigger(l,d,t,b.name,b)};return r.data.animation.forEach(p),new LH(this,d,a,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,r,i){t>=0&&t<this._microtaskId?this._zone.run(()=>r(i)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(a=>{const[l,d]=a;l(d)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,i]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(_.FYo),_.LFG(DC),_.LFG(_.R0b))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();class w1{constructor(e,t,r){this.namespaceId=e,this.delegate=t,this.engine=r,this.destroyNode=this.delegate.destroyNode?i=>t.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,r,i=!0){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,r){this.engine.onRemove(this.namespaceId,t,this.delegate,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){"@"==t.charAt(0)&&t==v1?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.delegate.listen(e,t,r)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class LH extends w1{constructor(e,t,r,i){super(t,r,i),this.factory=e,this.namespaceId=t}setProperty(e,t,r){"@"==t.charAt(0)?"."==t.charAt(1)&&t==v1?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,t.slice(1),r):this.delegate.setProperty(e,t,r)}listen(e,t,r){if("@"==t.charAt(0)){const i=function UH(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let a=t.slice(1),l="";return"@"!=a.charAt(0)&&([a,l]=function BH(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(a)),this.engine.listen(this.namespaceId,i,a,l,d=>{this.factory.scheduleListenerCallback(d._data||-1,r,d)})}return this.delegate.listen(e,t,r)}}let VH=(()=>{class n extends DC{constructor(t,r,i,a){super(t.body,r,i)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(ce),_.LFG(qM),_.LFG(ix),_.LFG(_.z2F))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac}),n})();const E1=[{provide:PO,useClass:kH},{provide:ix,useFactory:function jH(){return new oH}},{provide:DC,useClass:VH},{provide:_.FYo,useFactory:function $H(n,e,t){return new FH(n,e,t)},deps:[pl,DC,_.R0b]}],dx=[{provide:qM,useFactory:()=>new NH},{provide:_.QbO,useValue:"BrowserAnimations"},...E1],I1=[{provide:qM,useClass:qO},{provide:_.QbO,useValue:"NoopAnimations"},...E1];let HH=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?I1:dx}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:dx,imports:[rd]}),n})();var hx=F(5867),GH=F(6148);const fx_firebase={apiKey:"AIzaSyCYBzojhXDAwRe1Y1OIuixZLCJabgTIxT8",authDomain:"aquariummanager-6bf5b.firebaseapp.com",databaseURL:"https://aquariummanager-6bf5b-default-rtdb.europe-west1.firebasedatabase.app",projectId:"aquariummanager-6bf5b",storageBucket:"aquariummanager-6bf5b.appspot.com",messagingSenderId:"1047656954986",appId:"1:1047656954986:web:e093912c4356d7f5d99e13",measurementId:"G-TXPDPMG526"},WH=(0,hx.ZF)(fx_firebase);(0,GH.IH)(WH);var fi=F(2011),px=F(6451),AC=F(5363),zH=F(6063);class qH extends na.x{constructor(e=1/0,t=1/0,r=zH.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let d=0;for(let p=1;p<r.length&&r[p]<=l;p+=2)d=p;d&&r.splice(0,d+1)}}}var b1=F(3099);function C1(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,b1.B)({connector:()=>new qH(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function T1(n,e){return(0,Uu.m)(e)?Er(()=>n,e):Er(()=>n)}var gx=F(9468),kn=F(880);const D1=new Map,XH={activated:!1,tokenObservers:[]},JH={initialized:!1,enabled:!1};function Ei(n){return D1.get(n)||XH}function Xa(n,e){D1.set(n,e)}function xC(){return JH}class iG{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,be.Z)(function*(){t.stop();try{t.pending=new k.BH,yield function sG(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new k.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const hs=new k.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function A1(n){if(!Ei(n).activated)throw hs.create("use-before-activation",{appName:n.name})}function vx(n,e){return wx.apply(this,arguments)}function wx(){return(wx=(0,be.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const P=yield l.getHeartbeatsHeader();P&&(a["X-Firebase-Client"]=P)}const d={method:"POST",body:JSON.stringify(e),headers:a};let p,y;try{p=yield fetch(n,d)}catch(P){throw hs.create("fetch-network-error",{originalErrorMessage:null===(r=P)||void 0===r?void 0:r.message})}if(200!==p.status)throw hs.create("fetch-status-error",{httpStatus:p.status});try{y=yield p.json()}catch(P){throw hs.create("fetch-parse-error",{originalErrorMessage:null===(i=P)||void 0===i?void 0:i.message})}const b=y.ttl.match(/^([\d.]+)(s)$/);if(!b||!b[2]||isNaN(Number(b[1])))throw hs.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${y.ttl}`});const T=1e3*Number(b[1]),M=Date.now();return{token:y.token,expireTimeMillis:M+T,issuedAtTimeMillis:M}})).apply(this,arguments)}function lG(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const Fw="firebase-app-check-store";let kC=null;function x1(){return kC||(kC=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(hs.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Fw,{keyPath:"compositeKey"})}}catch(r){e(hs.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),kC)}function Ex(){return(Ex=(0,be.Z)(function*(n,e){const r=(yield x1()).transaction(Fw,"readwrite"),a=r.objectStore(Fw).put({compositeKey:n,value:e});return new Promise((l,d)=>{a.onsuccess=p=>{l()},r.onerror=p=>{var y;d(hs.create("storage-set",{originalErrorMessage:null===(y=p.target.error)||void 0===y?void 0:y.message}))}})})).apply(this,arguments)}const Lw=new er.Yd("@firebase/app-check");function P1(n,e){return(0,k.hl)()?function fG(n,e){return function R1(n,e){return Ex.apply(this,arguments)}(function k1(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{Lw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function O1(){return xC().enabled}function F1(){return Tx.apply(this,arguments)}function Tx(){return(Tx=(0,be.Z)(function*(){const n=xC();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const vG={error:"UNKNOWN_ERROR"};function wG(n){return k.US.encodeString(JSON.stringify(n),!1)}function PC(n){return Dx.apply(this,arguments)}function Dx(){return(Dx=(0,be.Z)(function*(n,e=!1){const t=n.app;A1(t);const r=Ei(t);let a,i=r.token;if(!i){const p=yield r.cachedTokenPromise;p&&OC(p)&&(i=p)}if(!e&&i&&OC(i))return{token:i.token};let d,l=!1;if(O1()){r.exchangeTokenPromise||(r.exchangeTokenPromise=vx(lG(t,yield F1()),n.heartbeatServiceProvider).then(y=>(r.exchangeTokenPromise=void 0,y)),l=!0);const p=yield r.exchangeTokenPromise;return yield P1(t,p),Xa(t,Object.assign(Object.assign({},r),{token:p})),{token:p.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().then(p=>(r.exchangeTokenPromise=void 0,p)),l=!0),i=yield r.exchangeTokenPromise}catch(p){"appCheck/throttled"===p.code?Lw.warn(p.message):Lw.error(p),a=p}return i?(d={token:i.token},Xa(t,Object.assign(Object.assign({},r),{token:i})),yield P1(t,i)):d=IG(a),l&&U1(t,d),d})).apply(this,arguments)}function Ax(n,e){const t=Ei(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Xa(n,Object.assign(Object.assign({},t),{tokenObservers:r}))}function L1(n){const{app:e}=n,t=Ei(e);let r=t.tokenRefresher;r||(r=function EG(n){const{app:e}=n;return new iG((0,be.Z)(function*(){let r;if(r=Ei(e).token?yield PC(n,!0):yield PC(n),r.error)throw r.error}),()=>!0,()=>{const t=Ei(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),Xa(e,Object.assign(Object.assign({},t),{tokenRefresher:r}))),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function U1(n,e){const t=Ei(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function OC(n){return n.expireTimeMillis-Date.now()>0}function IG(n){return{token:wG(vG),error:n}}class bG{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Ei(this.app);for(const t of e)Ax(this.app,t.next);return Promise.resolve()}}const z1="app-check-internal";!function LG(){(0,Jn._registerComponent)(new Ms.wA("app-check",n=>function CG(n,e){return new bG(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(z1).initialize()})),(0,Jn._registerComponent)(new Ms.wA(z1,n=>function TG(n){return{getToken:e=>PC(n,e),addTokenListener:e=>function Sx(n,e,t,r){const{app:i}=n,a=Ei(i),l={next:t,error:r,type:e};if(Xa(i,Object.assign(Object.assign({},a),{tokenObservers:[...a.tokenObservers,l]})),a.token&&OC(a.token)){const d=a.token;Promise.resolve().then(()=>{t({token:d.token}),L1(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>L1(n))}(n,"INTERNAL",e),removeTokenListener:e=>Ax(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Jn.registerVersion)("@firebase/app-check","0.5.12")}();class Uw{constructor(){return(0,kn.vb)("app-check")}}typeof window<"u"&&window;var LC=F(127);const kx=new _.OlP("angularfire2.auth.use-emulator"),Px=new _.OlP("angularfire2.auth.settings"),Ox=new _.OlP("angularfire2.auth.tenant-id"),Fx=new _.OlP("angularfire2.auth.langugage-code"),Lx=new _.OlP("angularfire2.auth.use-device-language"),Ux=new _.OlP("angularfire.auth.persistence"),Bx=(n,e,t,r,i,a,l,d)=>(0,fi.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const p=e.runOutsideAngular(()=>n.auth());if(t&&p.useEmulator(...t),r&&(p.tenantId=r),p.languageCode=i,a&&p.useDeviceLanguage(),l)for(const[y,b]of Object.entries(l))p.settings[y]=b;return d&&p.setPersistence(d),p},[t,r,i,a,l,d]);let UC=(()=>{class n{constructor(t,r,i,a,l,d,p,y,b,T,M,P){const U=new na.x,ee=bt(void 0).pipe((0,AC.Q)(l.outsideAngular),Er(()=>a.runOutsideAngular(()=>Promise.resolve().then(F.bind(F,2476)))),(0,Nt.U)(()=>(0,fi.on)(t,a,r)),(0,Nt.U)(oe=>Bx(oe,a,d,y,b,T,p,M)),C1({bufferSize:1,refCount:!1}));if(ei(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=bt(null);else{ee.pipe(_o()).subscribe();const Ge=ee.pipe(Er(et=>et.getRedirectResult().then(xt=>xt,()=>null)),kn.iC,C1({bufferSize:1,refCount:!1})),Je=ee.pipe(Er(et=>new mo.y(xt=>({unsubscribe:a.runOutsideAngular(()=>et.onAuthStateChanged(Pt=>xt.next(Pt),Pt=>xt.error(Pt),()=>xt.complete()))})))),rt=ee.pipe(Er(et=>new mo.y(xt=>({unsubscribe:a.runOutsideAngular(()=>et.onIdTokenChanged(Pt=>xt.next(Pt),Pt=>xt.error(Pt),()=>xt.complete()))}))));this.authState=Ge.pipe(T1(Je),(0,gx.R)(l.outsideAngular),(0,AC.Q)(l.insideAngular)),this.user=Ge.pipe(T1(rt),(0,gx.R)(l.outsideAngular),(0,AC.Q)(l.insideAngular)),this.idToken=this.user.pipe(Er(et=>et?(0,jn.D)(et.getIdToken()):bt(null))),this.idTokenResult=this.user.pipe(Er(et=>et?(0,jn.D)(et.getIdTokenResult()):bt(null))),this.credential=(0,px.T)(Ge,U,this.authState.pipe(Ws(et=>!et))).pipe((0,Nt.U)(et=>et?.user?et:null),(0,gx.R)(l.outsideAngular),(0,AC.Q)(l.insideAngular))}return(0,fi.pX)(this,ee,a,{spy:{apply:(oe,Ge,Je)=>{(oe.startsWith("signIn")||oe.startsWith("createUser"))&&Je.then(rt=>U.next(rt))}}})}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(fi.Dh),_.LFG(fi.xv,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(kn.HU),_.LFG(kx,8),_.LFG(Px,8),_.LFG(Ox,8),_.LFG(Fx,8),_.LFG(Lx,8),_.LFG(Ux,8),_.LFG(Uw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),HG=(()=>{class n{constructor(){LC.Z.registerVersion("angularfire",kn.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[UC]}),n})();var Vx=F(3942);const K1="firebasestorage.googleapis.com",Z1="storageBucket";class Fr extends k.ZR{constructor(e,t){super(jx(e),`Firebase Storage: ${t} (${jx(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fr.prototype)}_codeEquals(e){return jx(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function jx(n){return"storage/"+n}function $x(){return new Fr("unknown","An unknown error occurred, please check the error payload for server response.")}function Y1(){return new Fr("canceled","User canceled the upload/download.")}function Q1(){return new Fr("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function s_(n){return new Fr("invalid-argument",n)}function X1(){return new Fr("app-deleted","The Firebase app was deleted.")}function J1(n){return new Fr("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Bw(n,e){return new Fr("invalid-format","String does not match format '"+n+"': "+e)}function Vw(n){throw new Fr("internal-error","Internal error: "+n)}class rs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=rs.makeFromUrl(e,t)}catch{return new rs(e,"")}if(""===r.path)return r;throw function JG(n){return new Fr("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",d=new RegExp("^gs://"+i+"(/(.*))?$","i");function y(et){et.path_=decodeURIComponent(et.path)}const T=t.replace(/[.]/g,"\\."),rt=[{regex:d,indices:{bucket:1,path:3},postModify:function a(et){"/"===et.path.charAt(et.path.length-1)&&(et.path_=et.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${T}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:y},{regex:new RegExp(`^https?://${t===K1?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:y}];for(let et=0;et<rt.length;et++){const xt=rt[et],Pt=xt.regex.exec(e);if(Pt){let Zr=Pt[xt.indices.path];Zr||(Zr=""),r=new rs(Pt[xt.indices.bucket],Zr),xt.postModify(r);break}}if(null==r)throw function XG(n){return new Fr("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class rW{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function BC(n){return"string"==typeof n||n instanceof String}function eF(n){return Hx()&&n instanceof Blob}function Hx(){return typeof Blob<"u"}function Gx(n,e,t,r){if(r<e)throw s_(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw s_(`Invalid value for '${n}'. Expected ${t} or less.`)}function Ac(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function tF(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var fh=(()=>{return(n=fh||(fh={}))[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",fh;var n})();class lW{constructor(e,t,r,i,a,l,d,p,y,b,T){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=d,this.errorCallback_=p,this.timeout_=y,this.progressCallback_=b,this.connectionFactory_=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((M,P)=>{this.resolve_=M,this.reject_=P,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,d=i.connection;if(i.wasSuccessCode)try{const p=this.callback_(d,d.getResponse());!function oW(n){return void 0!==n}(p)?a():a(p)}catch(p){l(p)}else if(null!==d){const p=$x();p.serverResponse=d.getErrorText(),l(this.errorCallback_?this.errorCallback_(d,p):p)}else l(i.canceled?this.appDelete_?X1():Y1():function QG(){return new Fr("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new VC(!1,null,!0)):this.backoffId_=function iW(n,e,t){let r=1,i=null,a=null,l=!1,d=0;function p(){return 2===d}let y=!1;function b(...oe){y||(y=!0,e.apply(null,oe))}function T(oe){i=setTimeout(()=>{i=null,n(P,p())},oe)}function M(){a&&clearTimeout(a)}function P(oe,...Ge){if(y)return void M();if(oe)return M(),void b.call(null,oe,...Ge);if(p()||l)return M(),void b.call(null,oe,...Ge);let rt;r<64&&(r*=2),1===d?(d=2,rt=0):rt=1e3*(r+Math.random()),T(rt)}let U=!1;function ee(oe){U||(U=!0,M(),!y&&(null!==i?(oe||(d=2),clearTimeout(i),T(0)):oe||(d=1)))}return T(0),a=setTimeout(()=>{l=!0,ee(!0)},t),ee}((r,i)=>{if(i)return void r(!1,new VC(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=d=>{null!==this.progressCallback_&&this.progressCallback_(d.loaded,d.lengthComputable?d.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const d=a.getErrorCode()===fh.NO_ERROR,p=a.getStatus();if(!d||this.isRetryStatusCode_(p)){const b=a.getErrorCode()===fh.ABORT;return void r(!1,new VC(!1,null,b))}const y=-1!==this.successCodes_.indexOf(p);r(!0,new VC(y,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function sW(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,i=-1!==[408,429].indexOf(e),a=-1!==this.additionalRetryCodes_.indexOf(e);return t||i||a}}class VC{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function mW(...n){const e=function gW(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(Hx())return new Blob(n);throw new Fr("unsupported-environment","This browser doesn't seem to support creating Blobs")}const To={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Wx{constructor(e,t){this.data=e,this.contentType=t||null}}function zx(n,e){switch(n){case To.RAW:return new Wx(nF(e));case To.BASE64:case To.BASE64URL:return new Wx(rF(n,e));case To.DATA_URL:return new Wx(function wW(n){const e=new iF(n);return e.base64?rF(To.BASE64,e.rest):function vW(n){let e;try{e=decodeURIComponent(n)}catch{throw Bw(To.DATA_URL,"Malformed data URL.")}return nF(e)}(e.rest)}(e),function EW(n){return new iF(n).contentType}(e))}throw $x()}function nF(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function rF(n,e){switch(n){case To.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw Bw(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case To.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw Bw(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function yW(n){return atob(n)}(e)}catch{throw Bw(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class iF{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw Bw(To.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function IW(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class zu{constructor(e,t){let r=0,i="";eF(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(eF(this.data_)){const i=function _W(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new zu(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new zu(r,!0)}}static getBlob(...e){if(Hx()){const t=e.map(r=>r instanceof zu?r.data_:r);return new zu(mW.apply(null,t))}{const t=e.map(l=>BC(l)?zx(To.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let d=0;d<l.length;d++)i[a++]=l[d]}),new zu(i,!0)}}uploadData(){return this.data_}}function qx(n){let e;try{e=JSON.parse(n)}catch{return null}return function uW(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function sF(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function TW(n,e){return e}class fs{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||TW}}let jC=null;function jw(){if(jC)return jC;const n=[];n.push(new fs("bucket")),n.push(new fs("generation")),n.push(new fs("metageneration")),n.push(new fs("name","fullPath",!0));const t=new fs("name");t.xform=function e(a,l){return function DW(n){return!BC(n)||n.length<2?n:sF(n)}(l)},n.push(t);const i=new fs("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new fs("timeCreated")),n.push(new fs("updated")),n.push(new fs("md5Hash",null,!0)),n.push(new fs("cacheControl",null,!0)),n.push(new fs("contentDisposition",null,!0)),n.push(new fs("contentEncoding",null,!0)),n.push(new fs("contentLanguage",null,!0)),n.push(new fs("contentType",null,!0)),n.push(new fs("metadata","customMetadata",!0)),jC=n,jC}function oF(n,e,t){const r=qx(e);return null===r?null:function AW(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function SW(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new rs(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function Kx(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const aF="prefixes";class qu{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Ku(n){if(!n)throw $x()}function $C(n,e){return function t(r,i){const a=oF(n,i,e);return Ku(null!==a),a}}function o_(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function ZG(){return new Fr("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function KG(){return new Fr("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function qG(n){return new Fr("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function YG(n){return new Fr("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.serverResponse=r.serverResponse,i}}function $w(n){const e=o_(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function zG(n){return new Fr("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function lF(n,e,t){const i=Ac(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,d=new qu(i,"GET",$C(n,t),l);return d.errorHandler=$w(e),d}function PW(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const d=Ac(e.bucketOnlyServerUrl(),n.host,n._protocol),y=n.maxOperationRetryTime,b=new qu(d,"GET",function NW(n,e){return function t(r,i){const a=function RW(n,e,t){const r=qx(t);return null===r?null:function xW(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[aF])for(const i of t[aF]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new rs(e,a));r.prefixes.push(l)}if(t.items)for(const i of t.items){const a=n._makeStorageReference(new rs(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return Ku(null!==a),a}}(n,e.bucket),y);return b.urlParams=a,b.errorHandler=o_(e),b}function dF(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function UW(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class HC{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function Zx(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Ku(!1)}return Ku(!!t&&-1!==(e||["active"]).indexOf(t)),t}const $W={STATE_CHANGED:"state_changed"},ps={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Yx(n){switch(n){case"running":case"pausing":case"canceling":return ps.RUNNING;case"paused":return ps.PAUSED;case"success":return ps.SUCCESS;case"canceled":return ps.CANCELED;default:return ps.ERROR}}class HW{constructor(e,t,r){if(function aW(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function a_(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class WW extends class GW{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fh.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fh.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fh.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Vw("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Vw("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Vw("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Vw("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Vw("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function Ja(){return new WW}class gF{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=jw(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function BW(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=dF(e,r,i),d={name:l.fullPath},p=Ac(a,n.host,n._protocol),b={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},T=Kx(l,t),U=new qu(p,"POST",function P(ee){let oe;Zx(ee);try{oe=ee.getResponseHeader("X-Goog-Upload-URL")}catch{Ku(!1)}return Ku(BC(oe)),oe},n.maxUploadRetryTime);return U.urlParams=d,U.headers=b,U.body=T,U.errorHandler=o_(e),U}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ja,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function VW(n,e,t,r){const p=new qu(t,"POST",function a(y){const b=Zx(y,["active","final"]);let T=null;try{T=y.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Ku(!1)}T||Ku(!1);const M=Number(T);return Ku(!isNaN(M)),new HC(M,r.size(),"final"===b)},n.maxUploadRetryTime);return p.headers={"X-Goog-Upload-Command":"query"},p.errorHandler=o_(e),p}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,Ja,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new HC(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function jW(n,e,t,r,i,a,l,d){const p=new HC(0,0);if(l?(p.current=l.current,p.total=l.total):(p.current=0,p.total=r.size()),r.size()!==p.total)throw function tW(){return new Fr("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const y=p.total-p.current;let b=y;i>0&&(b=Math.min(b,i));const T=p.current,U={"X-Goog-Upload-Command":b===y?"upload, finalize":"upload","X-Goog-Upload-Offset":`${p.current}`},ee=r.slice(T,T+b);if(null===ee)throw Q1();const rt=new qu(t,"POST",function oe(et,xt){const Pt=Zx(et,["active","final"]),_n=p.current+b,Zr=r.size();let xo;return xo="final"===Pt?$C(e,a)(et,xt):null,new HC(_n,Zr,"final"===Pt,xo)},e.maxUploadRetryTime);return rt.headers=U,rt.body=ee.uploadData(),rt.progressCallback=d||null,rt.errorHandler=o_(n),rt}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(p){return this._error=p,void this._transition("error")}const d=this._ref.storage._makeRequest(l,Ja,i,a);this._request=d,d.getPromise().then(p=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(p.current),p.finalized?(this._metadata=p.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=lF(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Ja,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function hF(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},p=function d(){let rt="";for(let et=0;et<2;et++)rt+=Math.random().toString().slice(2);return rt}();l["Content-Type"]="multipart/related; boundary="+p;const y=dF(e,r,i),b=Kx(y,t),P=zu.getBlob("--"+p+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+b+"\r\n--"+p+"\r\nContent-Type: "+y.contentType+"\r\n\r\n",r,"\r\n--"+p+"--");if(null===P)throw Q1();const U={name:y.fullPath},ee=Ac(a,n.host,n._protocol),Ge=n.maxUploadRetryTime,Je=new qu(ee,"POST",$C(n,t),Ge);return Je.urlParams=U,Je.headers=l,Je.body=P.uploadData(),Je.errorHandler=o_(e),Je}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Ja,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Y1(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Yx(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new HW(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Yx(this._state)){case ps.SUCCESS:a_(this._resolve.bind(null,this.snapshot))();break;case ps.CANCELED:case ps.ERROR:a_(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Yx(this._state)){case ps.RUNNING:case ps.PAUSED:e.next&&a_(e.next.bind(e,this.snapshot))();break;case ps.SUCCESS:e.complete&&a_(e.complete.bind(e))();break;default:e.error&&a_(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Sp{constructor(e,t){this._service=e,this._location=t instanceof rs?t:rs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Sp(e,t)}get root(){const e=new rs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return sF(this._location.path)}get storage(){return this._service}get parent(){const e=function bW(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new rs(this._location.bucket,e);return new Sp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw J1(e)}}function _F(n,e,t){return Qx.apply(this,arguments)}function Qx(){return(Qx=(0,be.Z)(function*(n,e,t){const i=yield yF(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield _F(n,e,i.nextPageToken))})).apply(this,arguments)}function yF(n,e){null!=e&&"number"==typeof e.maxResults&&Gx("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=PW(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,Ja)}function rz(n){n._throwIfRoot("getDownloadURL");const e=function OW(n,e,t){const i=Ac(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,d=new qu(i,"GET",function kW(n,e){return function t(r,i){const a=oF(n,i,e);return Ku(null!==a),function MW(n,e,t,r){const i=qx(e);if(null===i||!BC(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(y=>{const T=n.fullPath;return Ac("/b/"+l(n.bucket)+"/o/"+l(T),t,r)+tF({alt:"media",token:y})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return d.errorHandler=$w(e),d}(n.storage,n._location,jw());return n.storage.makeRequestWithTokens(e,Ja).then(t=>{if(null===t)throw function nW(){return new Fr("no-download-url","The given file does not have any download URLs.")}();return t})}function vF(n,e){const t=function CW(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new rs(n._location.bucket,t);return new Sp(n.storage,r)}function wF(n,e){if(n instanceof Xx){const t=n;if(null==t._bucket)throw function eW(){return new Fr("no-default-bucket","No default bucket found. Did you set the '"+Z1+"' property when initializing the app?")}();const r=new Sp(t,t._bucket);return null!=e?wF(r,e):r}return void 0!==e?vF(n,e):n}function az(n,e){if(e&&function sz(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof Xx)return function oz(n,e){return new Sp(n,e)}(n,e);throw s_("To use ref(service, url), the first argument must be a Storage instance.")}return wF(n,e)}function EF(n,e){const t=e?.[Z1];return null==t?null:rs.makeFromBucketSpec(t,n)}class Xx{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=K1,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?rs.makeFromBucketSpec(i,this._host):EF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?rs.makeFromBucketSpec(this._url,e):EF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Gx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Gx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,be.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,be.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Sp(this,e)}_makeRequest(e,t,r,i){if(this._deleted)return new rW(X1());{const a=function pW(n,e,t,r,i,a){const l=tF(n.urlParams),d=n.url+l,p=Object.assign({},n.headers);return function hW(n,e){e&&(n["X-Firebase-GMPID"]=e)}(p,e),function cW(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(p,t),function dW(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(p,a),function fW(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(p,r),new lW(d,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i)}(e,this._appId,r,i,t,this._firebaseVersion);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){var r=this;return(0,be.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const IF="@firebase/storage";function TF(n,e){return az(n=(0,k.m9)(n),e)}function yz(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Xx(t,r,i,e,Jn.SDK_VERSION)}!function vz(){(0,Jn._registerComponent)(new Ms.wA("storage",yz,"PUBLIC").setMultipleInstances(!0)),(0,Jn.registerVersion)(IF,"0.9.9",""),(0,Jn.registerVersion)(IF,"0.9.9","esm2017")}();class GC{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class DF{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new GC(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new GC(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new GC(l,this,this._ref)):{next:t.next?l=>t.next(new GC(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class SF{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Mc(e,this._service))}get items(){return this._delegate.items.map(e=>new Mc(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Mc{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function mz(n,e){return vF(n,e)}(this._delegate,e);return new Mc(t,this.storage)}get root(){return new Mc(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new Mc(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new DF(function lz(n,e,t){return function XW(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new gF(n,new zu(e),t)}(n=(0,k.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=To.RAW,r){this._throwIfRoot("putString");const i=zx(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new DF(new gF(this._delegate,new zu(i.data,!0),a),this)}listAll(){return function fz(n){return function ez(n){const e={prefixes:[],items:[]};return _F(n,e).then(()=>e)}(n=(0,k.m9)(n))}(this._delegate).then(e=>new SF(e,this.storage))}list(e){return function hz(n,e){return yF(n=(0,k.m9)(n),e)}(this._delegate,e||void 0).then(t=>new SF(t,this.storage))}getMetadata(){return function cz(n){return function tz(n){n._throwIfRoot("getMetadata");const e=lF(n.storage,n._location,jw());return n.storage.makeRequestWithTokens(e,Ja)}(n=(0,k.m9)(n))}(this._delegate)}updateMetadata(e){return function dz(n,e){return function nz(n,e){n._throwIfRoot("updateMetadata");const t=function FW(n,e,t,r){const a=Ac(e.fullServerUrl(),n.host,n._protocol),d=Kx(t,r),y=n.maxOperationRetryTime,b=new qu(a,"PATCH",$C(n,r),y);return b.headers={"Content-Type":"application/json; charset=utf-8"},b.body=d,b.errorHandler=$w(e),b}(n.storage,n._location,e,jw());return n.storage.makeRequestWithTokens(t,Ja)}(n=(0,k.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function pz(n){return rz(n=(0,k.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function gz(n){return function iz(n){n._throwIfRoot("deleteObject");const e=function LW(n,e){const r=Ac(e.fullServerUrl(),n.host,n._protocol),d=new qu(r,"DELETE",function l(p,y){},n.maxOperationRetryTime);return d.successCodes=[200,204],d.errorHandler=$w(e),d}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ja)}(n=(0,k.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw J1(e)}}class AF{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(MF(e))throw s_("ref() expected a child path but got a URL, use refFromURL instead.");return new Mc(TF(this._delegate,e),this)}refFromURL(e){if(!MF(e))throw s_("refFromURL() expected a full URL but got a child path, use ref() instead.");try{rs.makeFromUrl(e,this._delegate.host)}catch{throw s_("refFromUrl() expected a valid full URL but got an invalid one.")}return new Mc(TF(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function _z(n,e,t,r={}){!function uz(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,k.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function MF(n){return/^[A-Za-z]+:\/\//.test(n)}function bz(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new AF(t,r)}function xF(n){const e=function Tz(n){return new mo.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(bw(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,Nt.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function WC(n){return{getDownloadURL:()=>bt(void 0).pipe(kn.fc,Er(()=>n.getDownloadURL()),kn.iC),getMetadata:()=>bt(void 0).pipe(kn.fc,Er(()=>n.getMetadata()),kn.iC),delete:()=>(0,jn.D)(n.delete()),child:e=>WC(n.child(e)),updateMetadata:e=>(0,jn.D)(n.updateMetadata(e)),put:(e,t)=>xF(n.put(e,t)),putString:(e,t,r)=>xF(n.putString(e,t,r)),list:e=>(0,jn.D)(n.list(e)),listAll:()=>(0,jn.D)(n.listAll())}}!function Cz(n){const e={TaskState:ps,TaskEvent:$W,StringFormat:To,Storage:AF,Reference:Mc};n.INTERNAL.registerComponent(new Ms.wA("storage-compat",bz,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.17")}(Vx.Z);const Dz=new _.OlP("angularfire2.storageBucket"),Sz=new _.OlP("angularfire2.storage.maxUploadRetryTime"),Az=new _.OlP("angularfire2.storage.maxOperationRetryTime"),Mz=new _.OlP("angularfire2.storage.use-emulator");let xz=(()=>{class n{constructor(t,r,i,a,l,d,p,y,b,T){const M=(0,fi.on)(t,l,r);this.storage=(0,fi.cc)(`${M.name}.storage.${i}`,"AngularFireStorage",M.name,()=>{const P=l.runOutsideAngular(()=>M.storage(i||void 0)),U=b;return U&&P.useEmulator(...U),p&&P.setMaxUploadRetryTime(p),y&&P.setMaxOperationRetryTime(y),P},[p,y])}ref(t){return WC(this.storage.ref(t))}refFromURL(t){return WC(this.storage.refFromURL(t))}upload(t,r,i){return WC(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(fi.Dh),_.LFG(fi.xv,8),_.LFG(Dz,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(kn.HU),_.LFG(Sz,8),_.LFG(Az,8),_.LFG(Mz,8),_.LFG(Uw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),Rz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({}),n})(),Nz=(()=>{class n{constructor(){LC.Z.registerVersion("angularfire",kn.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[xz],imports:[Rz]}),n})();function Jx(){return(0,Or.e)((n,e)=>{let t,r=!1;n.subscribe((0,dr.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function RF(n,e=Lu.y){return n=n??kz,(0,Or.e)((t,r)=>{let i,a=!0;t.subscribe((0,dr.x)(r,l=>{const d=e(l);(a||!n(i,d))&&(a=!1,i=d,r.next(l))}))})}function kz(n,e){return n===e}F(2476);var Mt,Pz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xc={},eR=eR||{},tn=Pz||self;function zC(){}function qC(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Hw(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var tR="closure_uid_"+(1e9*Math.random()>>>0),Fz=0;function Lz(n,e,t){return n.call.apply(n.bind,arguments)}function Uz(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function is(n,e,t){return(is=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Lz:Uz).apply(null,arguments)}function KC(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Fi(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(r,i,a){for(var l=Array(arguments.length-2),d=2;d<arguments.length;d++)l[d-2]=arguments[d];return e.prototype[i].apply(r,l)}}function ph(){this.s=this.s,this.o=this.o}var Vz={};ph.prototype.s=!1,ph.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function Oz(n){return Object.prototype.hasOwnProperty.call(n,tR)&&n[tR]||(n[tR]=++Fz)}(this);delete Vz[n]}},ph.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const NF=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function nR(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function kF(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(qC(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let l=0;l<a;l++)n[i+l]=r[l]}else n.push(r)}}function ss(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}ss.prototype.h=function(){this.defaultPrevented=!0};var jz=function(){if(!tn.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{tn.addEventListener("test",zC,e),tn.removeEventListener("test",zC,e)}catch{}return n}();function ZC(n){return/^[\s\xa0]*$/.test(n)}var PF=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function rR(n,e){return n<e?-1:n>e?1:0}function YC(){var n=tn.navigator;return n&&(n=n.userAgent)?n:""}function Zu(n){return-1!=YC().indexOf(n)}function iR(n){return iR[" "](n),n}iR[" "]=zC;var QC,n,Hz=Zu("Opera"),u_=Zu("Trident")||Zu("MSIE"),OF=Zu("Edge"),sR=OF||u_,FF=Zu("Gecko")&&!(-1!=YC().toLowerCase().indexOf("webkit")&&!Zu("Edge"))&&!(Zu("Trident")||Zu("MSIE"))&&!Zu("Edge"),Gz=-1!=YC().toLowerCase().indexOf("webkit")&&!Zu("Edge");function LF(){var n=tn.document;return n?n.documentMode:void 0}e:{var oR="",aR=(n=YC(),FF?/rv:([^\);]+)(\)|;)/.exec(n):OF?/Edge\/([\d\.]+)/.exec(n):u_?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Gz?/WebKit\/(\S+)/.exec(n):Hz?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(aR&&(oR=aR?aR[1]:""),u_){var uR=LF();if(null!=uR&&uR>parseFloat(oR)){QC=String(uR);break e}}QC=oR}var Wz={};var qz=tn.document&&u_&&(LF()||parseInt(QC,10))||void 0;function Gw(n,e){if(ss.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(FF){e:{try{iR(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Kz[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Gw.X.h.call(this)}}Fi(Gw,ss);var Kz={2:"touch",3:"pen",4:"mouse"};Gw.prototype.h=function(){Gw.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Ww="closure_listenable_"+(1e6*Math.random()|0),Zz=0;function Yz(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=i,this.key=++Zz,this.ba=this.ea=!1}function XC(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function cR(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function BF(n){const e={};for(const t in n)e[t]=n[t];return e}const VF="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function jF(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<VF.length;a++)t=VF[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function JC(n){this.src=n,this.g={},this.h=0}function dR(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=NF(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(XC(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function hR(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==r)return i}return-1}JC.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=hR(n,e,r,i);return-1<l?(e=n[l],t||(e.ea=!1)):((e=new Yz(e,this.src,a,!!r,i)).ea=t,n.push(e)),e};var fR="closure_lm_"+(1e6*Math.random()|0),pR={};function $F(n,e,t,r,i){if(r&&r.once)return GF(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)$F(n,e[a],t,r,i);return null}return t=yR(t),n&&n[Ww]?n.N(e,t,Hw(r)?!!r.capture:!!r,i):HF(n,e,t,!1,r,i)}function HF(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=Hw(i)?!!i.capture:!!i,d=mR(n);if(d||(n[fR]=d=new JC(n)),(t=d.add(e,t,r,l,a)).proxy)return t;if(r=function Qz(){const e=Xz;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)jz||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(zF(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function GF(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)GF(n,e[a],t,r,i);return null}return t=yR(t),n&&n[Ww]?n.O(e,t,Hw(r)?!!r.capture:!!r,i):HF(n,e,t,!0,r,i)}function WF(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)WF(n,e[a],t,r,i);else r=Hw(r)?!!r.capture:!!r,t=yR(t),n&&n[Ww]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=hR(a=n.g[e],t,r,i))&&(XC(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=mR(n))&&(e=n.g[e.toString()],n=-1,e&&(n=hR(e,t,r,i)),(t=-1<n?e[n]:null)&&gR(t))}function gR(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[Ww])dR(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(zF(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=mR(e))?(dR(t,n),0==t.h&&(t.src=null,e[fR]=null)):XC(n)}}}function zF(n){return n in pR?pR[n]:pR[n]="on"+n}function Xz(n,e){if(n.ba)n=!0;else{e=new Gw(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&gR(n),n=t.call(r,e)}return n}function mR(n){return(n=n[fR])instanceof JC?n:null}var _R="__closure_events_fn_"+(1e9*Math.random()>>>0);function yR(n){return"function"==typeof n?n:(n[_R]||(n[_R]=function(e){return n.handleEvent(e)}),n[_R])}function Ii(){ph.call(this),this.i=new JC(this),this.P=this,this.I=null}function Li(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new ss(e,n);else if(e instanceof ss)e.target=e.target||n;else{var i=e;jF(e=new ss(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=eT(l,r,!0,e)&&i}if(i=eT(l=e.g=n,r,!0,e)&&i,i=eT(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=eT(l=e.g=t[a],r,!1,e)&&i}function eT(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ba&&l.capture==t){var d=l.listener,p=l.ha||l.src;l.ea&&dR(n.i,l),i=!1!==d.call(p,r)&&i}}return i&&!r.defaultPrevented}Fi(Ii,ph),Ii.prototype[Ww]=!0,Ii.prototype.removeEventListener=function(n,e,t,r){WF(this,n,e,t,r)},Ii.prototype.M=function(){if(Ii.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)XC(t[r]);delete n.g[e],n.h--}}this.I=null},Ii.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},Ii.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var vR=tn.JSON.stringify;function Jz(){var n=ZF;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var wR,qF=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new tq,n=>n.reset());class tq{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function nq(n){tn.setTimeout(()=>{throw n},0)}function KF(n,e){wR||function rq(){var n=tn.Promise.resolve(void 0);wR=function(){n.then(iq)}}(),ER||(wR(),ER=!0),ZF.add(n,e)}var ER=!1,ZF=new class eq{constructor(){this.h=this.g=null}add(e,t){const r=qF.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function iq(){for(var n;n=Jz();){try{n.h.call(n.g)}catch(t){nq(t)}var e=qF;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}ER=!1}function tT(n,e){Ii.call(this),this.h=n||1,this.g=e||tn,this.j=is(this.kb,this),this.l=Date.now()}function IR(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function bR(n,e,t){if("function"==typeof n)t&&(n=is(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=is(n.handleEvent,n)}return 2147483647<Number(e)?-1:tn.setTimeout(n,e||0)}function YF(n){n.g=bR(()=>{n.g=null,n.i&&(n.i=!1,YF(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Fi(tT,Ii),(Mt=tT.prototype).ca=!1,Mt.R=null,Mt.kb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Li(this,"tick"),this.ca&&(IR(this),this.start()))}},Mt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Mt.M=function(){tT.X.M.call(this),IR(this),delete this.g};class sq extends ph{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:YF(this)}M(){super.M(),this.g&&(tn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function zw(n){ph.call(this),this.h=n,this.g={}}Fi(zw,ph);var QF=[];function XF(n,e,t,r){Array.isArray(t)||(t&&(QF[0]=t.toString()),t=QF);for(var i=0;i<t.length;i++){var a=$F(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function JF(n){cR(n.g,function(e,t){this.g.hasOwnProperty(t)&&gR(e)},n),n.g={}}function nT(){this.g=!0}function l_(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function lq(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return vR(t)}catch{return e}}(n,t)+(r?" "+r:"")})}zw.prototype.M=function(){zw.X.M.call(this),JF(this)},zw.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},nT.prototype.Aa=function(){this.g=!1},nT.prototype.info=function(){};var Ap={},eL=null;function rT(){return eL=eL||new Ii}function tL(n){ss.call(this,Ap.Oa,n)}function qw(n){const e=rT();Li(e,new tL(e,n))}function nL(n,e){ss.call(this,Ap.STAT_EVENT,n),this.stat=e}function gs(n){const e=rT();Li(e,new nL(e,n))}function rL(n,e){ss.call(this,Ap.Pa,n),this.size=e}function Kw(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return tn.setTimeout(function(){n()},e)}Ap.Oa="serverreachability",Fi(tL,ss),Ap.STAT_EVENT="statevent",Fi(nL,ss),Ap.Pa="timingevent",Fi(rL,ss);var iT={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,La:7,TIMEOUT:8,Cb:9},iL={qb:"complete",Mb:"success",Ma:"error",La:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function CR(){}function oL(){}CR.prototype.h=null;var SR,Zw={OPEN:"a",pb:"b",Ma:"c",Bb:"d"};function TR(){ss.call(this,"d")}function DR(){ss.call(this,"c")}function sT(){}function Yw(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new zw(this),this.O=cq,this.T=new tT(n=sR?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new aL}function aL(){this.i=null,this.g="",this.h=!1}Fi(TR,ss),Fi(DR,ss),Fi(sT,CR),sT.prototype.g=function(){return new XMLHttpRequest},sT.prototype.i=function(){return{}},SR=new sT;var cq=45e3,AR={},oT={};function MR(n,e,t){n.K=1,n.v=cT(Rc(e)),n.s=t,n.P=!0,uL(n,null)}function uL(n,e){n.F=Date.now(),Qw(n),n.A=Rc(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),yL(t.i,"t",r),n.C=0,t=n.l.H,n.h=new aL,n.g=$L(n.l,t?e:null,!n.s),0<n.N&&(n.L=new sq(is(n.Ka,n,n.g),n.N)),XF(n.S,n.g,"readystatechange",n.hb),e=n.H?BF(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),qw(1),function oq(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",d=a.split("&"),p=0;p<d.length;p++){var y=d[p].split("=");if(1<y.length){var b=y[0];y=y[1];var T=b.split("_");l=2<=T.length&&"type"==T[1]?l+(b+"=")+y+"&":l+(b+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.U,n.s)}function lL(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function cL(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=dq(n,t),i==oT){4==e&&(n.o=4,gs(14),r=!1),l_(n.j,n.m,null,"[Incomplete Response]");break}if(i==AR){n.o=4,gs(15),l_(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}l_(n.j,n.m,i,null),xR(n,i)}lL(n)&&i!=oT&&i!=AR&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,gs(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),UR(e),e.K=!0,gs(11))):(l_(n.j,n.m,t,"[Invalid Chunked Response]"),Mp(n),Xw(n))}function dq(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?oT:(t=Number(e.substring(t,r)),isNaN(t)?AR:(r+=1)+t>e.length?oT:(e=e.substr(r,t),n.C=r+t,e))}function Qw(n){n.V=Date.now()+n.O,dL(n,n.O)}function dL(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Kw(is(n.fb,n),e)}function aT(n){n.B&&(tn.clearTimeout(n.B),n.B=null)}function Xw(n){0==n.l.G||n.I||UL(n.l,n)}function Mp(n){aT(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,IR(n.T),JF(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function xR(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||RR(t.h,n)))if(!n.J&&RR(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;mT(t),pT(t)}LR(t),gs(18)}}else t.Ba=i[1],0<t.Ba-t.T&&37500>i[2]&&t.L&&0==t.A&&!t.v&&(t.v=Kw(is(t.bb,t),6e3));if(1>=EL(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else Rp(t,11)}else if((n.J||t.g==n)&&mT(t),!ZC(e))for(i=t.Fa.g.parse(e),e=0;e<i.length;e++){let y=i[e];if(t.T=y[0],y=y[1],2==t.G)if("c"==y[0]){t.I=y[1],t.ka=y[2];const b=y[3];null!=b&&(t.ma=b,t.j.info("VER="+t.ma));const T=y[4];null!=T&&(t.Ca=T,t.j.info("SVER="+t.Ca));const M=y[5];null!=M&&"number"==typeof M&&0<M&&(t.J=r=1.5*M,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const P=n.g;if(P){const U=P.g?P.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(U){var a=r.h;a.g||-1==U.indexOf("spdy")&&-1==U.indexOf("quic")&&-1==U.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(NR(a,a.h),a.h=null))}if(r.D){const ee=P.g?P.g.getResponseHeader("X-HTTP-Session-Id"):null;ee&&(r.za=ee,Ir(r.F,r.D,ee))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var l=n;if((r=t).sa=jL(r,r.H?r.ka:null,r.V),l.J){IL(r.h,l);var d=l,p=r.J;p&&d.setTimeout(p),d.B&&(aT(d),Qw(d)),r.g=l}else FL(r);0<t.i.length&&gT(t)}else"stop"!=y[0]&&"close"!=y[0]||Rp(t,7);else 3==t.G&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?Rp(t,7):FR(t):"noop"!=y[0]&&t.l&&t.l.wa(y),t.A=0)}qw(4)}catch{}}function hL(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(qC(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function fq(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(qC(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function hq(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(qC(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(Mt=Yw.prototype).setTimeout=function(n){this.O=n},Mt.hb=function(n){n=n.target;const e=this.L;e&&3==Nc(n)?e.l():this.Ka(n)},Mt.Ka=function(n){try{if(n==this.g)e:{const b=Nc(this.g);var e=this.g.Ea();const T=this.g.aa();if(!(3>b)&&(3!=b||sR||this.g&&(this.h.h||this.g.fa()||xL(this.g)))){this.I||4!=b||7==e||qw(8==e||0>=T?3:2),aT(this);var t=this.g.aa();this.Y=t;t:if(lL(this)){var r=xL(this.g);n="";var i=r.length,a=4==Nc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){Mp(this),Xw(this);var l="";break t}this.h.i=new tn.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.fa();if(this.i=200==t,function aq(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.U,b,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var d,p=this.g;if((d=p.g?p.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ZC(d)){var y=d;break t}}y=null}if(!(t=y)){this.i=!1,this.o=3,gs(12),Mp(this),Xw(this);break e}l_(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,xR(this,t)}this.P?(cL(this,b,l),sR&&this.i&&3==b&&(XF(this.S,this.T,"tick",this.gb),this.T.start())):(l_(this.j,this.m,l,null),xR(this,l)),4==b&&Mp(this),this.i&&!this.I&&(4==b?UL(this.l,this):(this.i=!1,Qw(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,gs(12)):(this.o=0,gs(13)),Mp(this),Xw(this)}}}catch{}},Mt.gb=function(){if(this.g){var n=Nc(this.g),e=this.g.fa();this.C<e.length&&(aT(this),cL(this,n,e),this.i&&4!=n&&Qw(this))}},Mt.cancel=function(){this.I=!0,Mp(this)},Mt.fb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function uq(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(qw(3),gs(17)),Mp(this),this.o=2,Xw(this)):dL(this,this.V-n)};var fL=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xp(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof xp){this.h=void 0!==e?e:n.h,uT(this,n.j),this.s=n.s,this.g=n.g,lT(this,n.m),this.l=n.l,e=n.i;var t=new tE;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),pL(this,t),this.o=n.o}else n&&(t=String(n).match(fL))?(this.h=!!e,uT(this,t[1]||"",!0),this.s=Jw(t[2]||""),this.g=Jw(t[3]||"",!0),lT(this,t[4]),this.l=Jw(t[5]||"",!0),pL(this,t[6]||"",!0),this.o=Jw(t[7]||"")):(this.h=!!e,this.i=new tE(null,this.h))}function Rc(n){return new xp(n)}function uT(n,e,t){n.j=t?Jw(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function lT(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function pL(n,e,t){e instanceof tE?(n.i=e,function wq(n,e){e&&!n.j&&(gh(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(mL(this,r),yL(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=eE(e,yq)),n.i=new tE(e,n.h))}function Ir(n,e,t){n.i.set(e,t)}function cT(n){return Ir(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function Jw(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function eE(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,gq),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function gq(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}xp.prototype.toString=function(){var n=[],e=this.j;e&&n.push(eE(e,gL,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(eE(e,gL,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(eE(t,"/"==t.charAt(0)?_q:mq,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",eE(t,vq)),n.join("")};var gL=/[#\/\?@]/g,mq=/[#\?:]/g,_q=/[#\?]/g,yq=/[#\?@]/g,vq=/#/g;function tE(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function gh(n){n.g||(n.g=new Map,n.h=0,n.i&&function pq(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function mL(n,e){gh(n),e=c_(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function _L(n,e){return gh(n),e=c_(n,e),n.g.has(e)}function yL(n,e,t){mL(n,e),0<t.length&&(n.i=null,n.g.set(c_(n,e),nR(t)),n.h+=t.length)}function c_(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function vL(n){this.l=n||Iq,n=tn.PerformanceNavigationTiming?0<(n=tn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(tn.g&&tn.g.Ga&&tn.g.Ga()&&tn.g.Ga().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Mt=tE.prototype).add=function(n,e){gh(this),this.i=null,n=c_(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},Mt.forEach=function(n,e){gh(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},Mt.oa=function(){gh(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},Mt.W=function(n){gh(this);let e=[];if("string"==typeof n)_L(this,n)&&(e=e.concat(this.g.get(c_(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},Mt.set=function(n,e){return gh(this),this.i=null,_L(this,n=c_(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},Mt.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},Mt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),l=this.W(r);for(r=0;r<l.length;r++){var i=a;""!==l[r]&&(i+="="+encodeURIComponent(String(l[r]))),n.push(i)}}return this.i=n.join("&")};var Iq=10;function wL(n){return!!n.h||!!n.g&&n.g.size>=n.j}function EL(n){return n.h?1:n.g?n.g.size:0}function RR(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function NR(n,e){n.g?n.g.add(e):n.h=e}function IL(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function bL(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return nR(n.i)}function kR(){}function bq(){this.g=new kR}function Cq(n,e,t){const r=t||"";try{hL(n,function(i,a){let l=i;Hw(i)&&(l=vR(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function dT(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function nE(n){this.l=n.$b||null,this.j=n.ib||!1}function hT(n,e){Ii.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=PR,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}vL.prototype.cancel=function(){if(this.i=bL(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},kR.prototype.stringify=function(n){return tn.JSON.stringify(n,void 0)},kR.prototype.parse=function(n){return tn.JSON.parse(n,void 0)},Fi(nE,CR),nE.prototype.g=function(){return new hT(this.l,this.j)},nE.prototype.i=function(n){return function(){return n}}({}),Fi(hT,Ii);var PR=0;function CL(n){n.j.read().then(n.Sa.bind(n)).catch(n.ga.bind(n))}function rE(n){n.readyState=4,n.l=null,n.j=null,n.A=null,iE(n)}function iE(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Mt=hT.prototype).open=function(n,e){if(this.readyState!=PR)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,iE(this)},Mt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||tn).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ga.bind(this))},Mt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,rE(this)),this.readyState=PR},Mt.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,iE(this)),this.g&&(this.readyState=3,iE(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ga.bind(this));else if(typeof tn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;CL(this)}else n.text().then(this.Ua.bind(this),this.ga.bind(this))},Mt.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?rE(this):iE(this),3==this.readyState&&CL(this)}},Mt.Ua=function(n){this.g&&(this.response=this.responseText=n,rE(this))},Mt.Ta=function(n){this.g&&(this.response=n,rE(this))},Mt.ga=function(){this.g&&rE(this)},Mt.setRequestHeader=function(n,e){this.v.append(n,e)},Mt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Mt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(hT.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var Dq=tn.JSON.parse;function ai(n){Ii.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=TL,this.K=this.L=!1}Fi(ai,Ii);var TL="",Sq=/^https?$/i,Aq=["POST","PUT"];function DL(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,SL(n),fT(n)}function SL(n){n.D||(n.D=!0,Li(n,"complete"),Li(n,"error"))}function AL(n){if(n.h&&typeof eR<"u"&&(!n.C[1]||4!=Nc(n)||2!=n.aa()))if(n.v&&4==Nc(n))bR(n.Ha,0,n);else if(Li(n,"readystatechange"),4==Nc(n)){n.h=!1;try{const d=n.aa();e:switch(d){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===d){var i=String(n.H).match(fL)[1]||null;if(!i&&tn.self&&tn.self.location){var a=tn.self.location.protocol;i=a.substr(0,a.length-1)}r=!Sq.test(i?i.toLowerCase():"")}t=r}if(t)Li(n,"complete"),Li(n,"success");else{n.m=6;try{var l=2<Nc(n)?n.g.statusText:""}catch{l=""}n.j=l+" ["+n.aa()+"]",SL(n)}}finally{fT(n)}}}function fT(n,e){if(n.g){ML(n);const t=n.g,r=n.C[0]?zC:null;n.g=null,n.C=null,e||Li(n,"ready");try{t.onreadystatechange=r}catch{}}}function ML(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(tn.clearTimeout(n.A),n.A=null)}function Nc(n){return n.g?n.g.readyState:0}function xL(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case TL:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function RL(n){let e="";return cR(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function OR(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=RL(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Ir(n,e,t))}function sE(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function NL(n){this.Ca=0,this.i=[],this.j=new nT,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.$a=this.U=0,this.Ya=sE("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Wa=sE("baseRetryDelayMs",5e3,n),this.ab=sE("retryDelaySeedMs",1e4,n),this.Za=sE("forwardChannelMaxRetries",2,n),this.ta=sE("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Yb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new vL(n&&n.concurrentRequestLimit),this.Fa=new bq,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Xa=n&&n.Wb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function FR(n){if(kL(n),3==n.G){var e=n.U++,t=Rc(n.F);Ir(t,"SID",n.I),Ir(t,"RID",e),Ir(t,"TYPE","terminate"),oE(n,t),(e=new Yw(n,n.j,e,void 0)).K=2,e.v=cT(Rc(t)),t=!1,tn.navigator&&tn.navigator.sendBeacon&&(t=tn.navigator.sendBeacon(e.v.toString(),"")),!t&&tn.Image&&((new Image).src=e.v,t=!0),t||(e.g=$L(e.l,null),e.g.da(e.v)),e.F=Date.now(),Qw(e)}VL(n)}function pT(n){n.g&&(UR(n),n.g.cancel(),n.g=null)}function kL(n){pT(n),n.u&&(tn.clearTimeout(n.u),n.u=null),mT(n),n.h.cancel(),n.m&&("number"==typeof n.m&&tn.clearTimeout(n.m),n.m=null)}function gT(n){wL(n.h)||n.m||(n.m=!0,KF(n.Ja,n),n.C=0)}function PL(n,e){var t;t=e?e.m:n.U++;const r=Rc(n.F);Ir(r,"SID",n.I),Ir(r,"RID",t),Ir(r,"AID",n.T),oE(n,r),n.o&&n.s&&OR(r,n.o,n.s),t=new Yw(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=OL(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),NR(n.h,t),MR(t,r,e)}function oE(n,e){n.ia&&cR(n.ia,function(t,r){Ir(e,r,t)}),n.l&&hL({},function(t,r){Ir(e,r,t)})}function OL(n,e,t){t=Math.min(n.i.length,t);var r=n.l?is(n.l.Qa,n.l,n):null;e:{var i=n.i;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let d=!0;for(let p=0;p<t;p++){let y=i[p].h;const b=i[p].g;if(y-=a,0>y)a=Math.max(0,i[p].h-100),d=!1;else try{Cq(b,l,"req"+y+"_")}catch{r&&r(b)}}if(d){r=l.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function FL(n){n.g||n.u||(n.Z=1,KF(n.Ia,n),n.A=0)}function LR(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Kw(is(n.Ia,n),BL(n,n.A)),n.A++,0))}function UR(n){null!=n.B&&(tn.clearTimeout(n.B),n.B=null)}function LL(n){n.g=new Yw(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=Rc(n.sa);Ir(e,"RID","rpc"),Ir(e,"SID",n.I),Ir(e,"CI",n.L?"0":"1"),Ir(e,"AID",n.T),Ir(e,"TYPE","xmlhttp"),oE(n,e),n.o&&n.s&&OR(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=cT(Rc(e)),t.s=null,t.P=!0,uL(t,n)}function mT(n){null!=n.v&&(tn.clearTimeout(n.v),n.v=null)}function UL(n,e){var t=null;if(n.g==e){mT(n),UR(n),n.g=null;var r=2}else{if(!RR(n.h,e))return;t=e.D,IL(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;Li(r=rT(),new rL(r,t,e,i)),gT(n)}else FL(n);else if(3==(i=e.o)||0==i&&0<n.pa||!(1==r&&function xq(n,e){return!(EL(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Ya?0:n.Za)||(n.m=Kw(is(n.Ja,n,e),BL(n,n.C)),n.C++,0)))}(n,e)||2==r&&LR(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:Rp(n,5);break;case 4:Rp(n,10);break;case 3:Rp(n,6);break;default:Rp(n,2)}}function BL(n,e){let t=n.Wa+Math.floor(Math.random()*n.ab);return n.l||(t*=2),t*e}function Rp(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=is(n.jb,n);t||(t=new xp("//www.google.com/images/cleardot.gif"),tn.location&&"http"==tn.location.protocol||uT(t,"https"),cT(t)),function Tq(n,e){const t=new nT;if(tn.Image){const r=new Image;r.onload=KC(dT,t,r,"TestLoadImage: loaded",!0,e),r.onerror=KC(dT,t,r,"TestLoadImage: error",!1,e),r.onabort=KC(dT,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=KC(dT,t,r,"TestLoadImage: timeout",!1,e),tn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else gs(2);n.G=0,n.l&&n.l.va(e),VL(n),kL(n)}function VL(n){if(n.G=0,n.la=[],n.l){const e=bL(n.h);(0!=e.length||0!=n.i.length)&&(kF(n.la,e),kF(n.la,n.i),n.h.i.length=0,nR(n.i),n.i.length=0),n.l.ua()}}function jL(n,e,t){var r=t instanceof xp?Rc(t):new xp(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),lT(r,r.m);else{var i=tn.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new xp(null,void 0);r&&uT(a,r),e&&(a.g=e),i&&lT(a,i),t&&(a.l=t),r=a}return e=n.za,(t=n.D)&&e&&Ir(r,t,e),Ir(r,"VER",n.ma),oE(n,r),r}function $L(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new ai(t&&n.Da&&!n.ra?new nE({ib:!0}):n.ra)).L=n.H,e}function HL(){}function _T(){if(u_&&!(10<=Number(qz)))throw Error("Environmental error: no available transport.")}function Do(n,e){Ii.call(this),this.g=new NL(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Xb)&&!ZC(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ZC(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new d_(this)}function GL(n){TR.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function WL(){DR.call(this),this.status=1}function d_(n){this.g=n}(Mt=ai.prototype).da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():SR.g(),this.C=function sL(n){return n.h||(n.h=n.i())}(this.u?this.u:SR),this.g.onreadystatechange=is(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void DL(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=tn.FormData&&n instanceof tn.FormData,!(0<=NF(Aq,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of t)this.g.setRequestHeader(a,l);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{ML(this),0<this.B&&((this.K=function Mq(n){return u_&&function zz(){return function $z(n){var e=Wz;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=PF(String(QC)).split("."),t=PF("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=rR(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||rR(0==i[2].length,0==a[2].length)||rR(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=is(this.qa,this)):this.A=bR(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){DL(this,a)}},Mt.qa=function(){typeof eR<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Li(this,"timeout"),this.abort(8))},Mt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Li(this,"complete"),Li(this,"abort"),fT(this))},Mt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),fT(this,!0)),ai.X.M.call(this)},Mt.Ha=function(){this.s||(this.F||this.v||this.l?AL(this):this.eb())},Mt.eb=function(){AL(this)},Mt.aa=function(){try{return 2<Nc(this)?this.g.status:-1}catch{return-1}},Mt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},Mt.Ra=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),Dq(e)}},Mt.Ea=function(){return this.m},Mt.Na=function(){return"string"==typeof this.j?this.j:String(this.j)},(Mt=NL.prototype).ma=8,Mt.G=1,Mt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const i=new Yw(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=BF(a),jF(a,this.S)):a=this.S),null!==this.o||this.N||(i.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=OL(this,i,e),Ir(t=Rc(this.F),"RID",n),Ir(t,"CVER",22),this.D&&Ir(t,"X-HTTP-Session-Id",this.D),oE(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(RL(a)))+"&"+e:this.o&&OR(t,this.o,a)),NR(this.h,i),this.Xa&&Ir(t,"TYPE","init"),this.O?(Ir(t,"$req",e),Ir(t,"SID","null"),i.Z=!0,MR(i,t,null)):MR(i,t,e),this.G=2}}else 3==this.G&&(n?PL(this,n):0==this.i.length||wL(this.h)||PL(this))},Mt.Ia=function(){if(this.u=null,LL(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Kw(is(this.cb,this),n)}},Mt.cb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,gs(10),pT(this),LL(this))},Mt.bb=function(){null!=this.v&&(this.v=null,pT(this),LR(this),gs(19))},Mt.jb=function(n){n?(this.j.info("Successfully pinged google.com"),gs(2)):(this.j.info("Failed to ping google.com"),gs(1))},(Mt=HL.prototype).xa=function(){},Mt.wa=function(){},Mt.va=function(){},Mt.ua=function(){},Mt.Qa=function(){},_T.prototype.g=function(n,e){return new Do(n,e)},Fi(Do,Ii),Do.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;gs(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=jL(n,null,n.V),gT(n)},Do.prototype.close=function(){FR(this.g)},Do.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=vR(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.$a++,n)),3==e.G&&gT(e)},Do.prototype.M=function(){this.g.l=null,delete this.j,FR(this.g),delete this.g,Do.X.M.call(this)},Fi(GL,TR),Fi(WL,DR),Fi(d_,HL),d_.prototype.xa=function(){Li(this.g,"a")},d_.prototype.wa=function(n){Li(this.g,new GL(n))},d_.prototype.va=function(n){Li(this.g,new WL(n))},d_.prototype.ua=function(){Li(this.g,"b")},_T.prototype.createWebChannel=_T.prototype.g,Do.prototype.send=Do.prototype.u,Do.prototype.open=Do.prototype.m,Do.prototype.close=Do.prototype.close,iT.NO_ERROR=0,iT.TIMEOUT=8,iT.HTTP_ERROR=6,iL.COMPLETE="complete",oL.EventType=Zw,Zw.OPEN="a",Zw.CLOSE="b",Zw.ERROR="c",Zw.MESSAGE="d",Ii.prototype.listen=Ii.prototype.N,ai.prototype.listenOnce=ai.prototype.O,ai.prototype.getLastError=ai.prototype.Na,ai.prototype.getLastErrorCode=ai.prototype.Ea,ai.prototype.getStatus=ai.prototype.aa,ai.prototype.getResponseJson=ai.prototype.Ra,ai.prototype.getResponseText=ai.prototype.fa,ai.prototype.send=ai.prototype.da;var Rq=xc.createWebChannelTransport=function(){return new _T},Nq=xc.getStatEventTarget=function(){return rT()},BR=xc.ErrorCode=iT,kq=xc.EventType=iL,Pq=xc.Event=Ap,zL=xc.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Oq=xc.FetchXmlHttpFactory=nE,yT=xc.WebChannel=oL,Fq=xc.XhrIo=ai;const qL="@firebase/firestore";class bi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bi.UNAUTHENTICATED=new bi(null),bi.GOOGLE_CREDENTIALS=new bi("google-credentials-uid"),bi.FIRST_PARTY=new bi("first-party-uid"),bi.MOCK_USER=new bi("mock-user");let h_="9.10.0";const mh=new er.Yd("@firebase/firestore");function VR(){return mh.logLevel}function ze(n,...e){if(mh.logLevel<=er.in.DEBUG){const t=e.map(jR);mh.debug(`Firestore (${h_}): ${n}`,...t)}}function Kr(n,...e){if(mh.logLevel<=er.in.ERROR){const t=e.map(jR);mh.error(`Firestore (${h_}): ${n}`,...t)}}function Np(n,...e){if(mh.logLevel<=er.in.WARN){const t=e.map(jR);mh.warn(`Firestore (${h_}): ${n}`,...t)}}function jR(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function wt(n="Unexpected state"){const e=`FIRESTORE (${h_}) INTERNAL ASSERTION FAILED: `+n;throw Kr(e),new Error(e)}function zt(n,e){n||wt()}function ut(n,e){return n}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends k.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ci{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class KL{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bq{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(bi.UNAUTHENTICATED))}shutdown(){}}class Vq{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class jq{constructor(e){this.t=e,this.currentUser=bi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=y=>this.i!==i?(i=this.i,t(y)):Promise.resolve();let l=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ci,e.enqueueRetryable(()=>a(this.currentUser))};const d=()=>{const y=l;e.enqueueRetryable((0,be.Z)(function*(){yield y.promise,yield a(r.currentUser)}))},p=y=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(y=>p(y)),setTimeout(()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?p(y):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ci)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(zt("string"==typeof r.accessToken),new KL(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return zt(null===e||"string"==typeof e),new bi(e)}}class $q{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=bi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(zt(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Hq{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new $q(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(bi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ZL{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Gq{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,ze("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(zt("string"==typeof t.token),this.A=t.token,new ZL(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Wq(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class YL{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=Wq(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function nn(n,e){return n<e?-1:n>e?1:0}function f_(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function QL(n){return n+"\0"}class br{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ve(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return br.fromMillis(Date.now())}static fromDate(e){return br.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new br(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?nn(this.nanoseconds,e.nanoseconds):nn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ht{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ht(e)}static min(){return new Ht(new br(0,0))}static max(){return new Ht(new br(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class aE{constructor(e,t,r){void 0===t?t=0:t>e.length&&wt(),void 0===r?r=e.length-t:r>e.length-t&&wt(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===aE.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof aE?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Dn extends aE{construct(e,t,r){return new Dn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ve(ve.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Dn(t)}static emptyPath(){return new Dn([])}}const zq=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Lr extends aE{construct(e,t,r){return new Lr(e,t,r)}static isValidIdentifier(e){return zq.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Lr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Lr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Ve(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const d=e[i];if("\\"===d){if(i+1===e.length)throw new Ve(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[i+1];if("\\"!==p&&"."!==p&&"`"!==p)throw new Ve(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=p,i+=2}else"`"===d?(l=!l,i++):"."!==d||l?(r+=d,i++):(a(),i++)}if(a(),l)throw new Ve(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Lr(t)}static emptyPath(){return new Lr([])}}class ot{constructor(e){this.path=e}static fromPath(e){return new ot(Dn.fromString(e))}static fromName(e){return new ot(Dn.fromString(e).popFirst(5))}static empty(){return new ot(Dn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Dn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Dn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ot(new Dn(e.slice()))}}class vT{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function $R(n){return n.fields.find(e=>2===e.kind)}function kp(n){return n.fields.filter(e=>2!==e.kind)}vT.UNKNOWN_ID=-1;class wT{constructor(e,t){this.fieldPath=e,this.kind=t}}class uE{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new uE(0,So.min())}}function XL(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ht.fromTimestamp(1e9===r?new br(t+1,0):new br(t,r));return new So(i,ot.empty(),e)}function JL(n){return new So(n.readTime,n.key,-1)}class So{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new So(Ht.min(),ot.empty(),-1)}static max(){return new So(Ht.max(),ot.empty(),-1)}}function HR(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=ot.comparator(n.documentKey,e.documentKey),0!==t?t:nn(n.largestBatchId,e.largestBatchId))}const eU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function _h(n){return GR.apply(this,arguments)}function GR(){return GR=(0,be.Z)(function*(n){if(n.code!==ve.FAILED_PRECONDITION||n.message!==eU)throw n;ze("LocalStore","Unexpectedly lost primary lease")}),GR.apply(this,arguments)}class he{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&wt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new he((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof he?t:he.resolve(t)}catch(t){return he.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):he.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):he.reject(t)}static resolve(e){return new he((t,r)=>{t(e)})}static reject(e){return new he((t,r)=>{r(e)})}static waitFor(e){return new he((t,r)=>{let i=0,a=0,l=!1;e.forEach(d=>{++i,d.next(()=>{++a,l&&a===i&&t()},p=>r(p))}),l=!0,a===i&&t()})}static or(e){let t=he.resolve(!1);for(const r of e)t=t.next(i=>i?he.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new he((r,i)=>{const a=e.length,l=new Array(a);let d=0;for(let p=0;p<a;p++){const y=p;t(e[y]).next(b=>{l[y]=b,++d,d===a&&r(l)},b=>i(b))}})}static doWhile(e,t){return new he((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class ET{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new Ci,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new lE(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=WR(r.target.error);this.P.reject(new lE(e,i))}}static open(e,t,r,i){try{return new ET(t,e.transaction(i,r))}catch(a){throw new lE(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(ze("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Yq(t)}}class eu{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===eu.D((0,k.z$)())&&Kr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ze("SimpleDb","Removing database:",e),Pp(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,k.hl)())return!1;if(eu.N())return!0;const e=(0,k.z$)(),t=eu.D(e),r=0<t&&t<10,i=eu.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.M)}static O(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,be.Z)(function*(){return t.db||(ze("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new lE(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const d=l.target.error;i("VersionError"===d.name?new Ve(ve.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===d.name?new Ve(ve.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d):new lE(e,d))},a.onupgradeneeded=l=>{ze("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.S.$(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{ze("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,be.Z)(function*(){const l="readonly"===t;let d=0;for(;;){++d;try{a.db=yield a.F(e);const p=ET.open(a.db,e,l?"readonly":"readwrite",r),y=i(p).next(b=>(p.V(),b)).catch(b=>(p.abort(b),he.reject(b))).toPromise();return y.catch(()=>{}),yield p.v,y}catch(p){const y=p,b="FirebaseError"!==y.name&&d<3;if(ze("SimpleDb","Transaction failed with error:",y.message,"Retrying:",b),a.close(),!b)return Promise.reject(y)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Zq{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return Pp(this.U.delete())}}class lE extends Ve{constructor(e,t){super(ve.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function yh(n){return"IndexedDbTransactionError"===n.name}class Yq{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(ze("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(ze("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Pp(r)}add(e){return ze("SimpleDb","ADD",this.store.name,e,e),Pp(this.store.add(e))}get(e){return Pp(this.store.get(e)).next(t=>(void 0===t&&(t=null),ze("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return ze("SimpleDb","DELETE",this.store.name,e),Pp(this.store.delete(e))}count(){return ze("SimpleDb","COUNT",this.store.name),Pp(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(l,d)=>{a.push(d)}).next(()=>a)}{const i=this.store.getAll(r.range);return new he((a,l)=>{i.onerror=d=>{l(d.target.error)},i.onsuccess=d=>{a(d.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new he((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}Y(e,t){ze("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,(a,l,d)=>d.delete())}Z(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new he((r,i)=>{t.onerror=a=>{const l=WR(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(d=>{d?l.continue():r()}):r()}})}H(e,t){const r=[];return new he((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void i();const p=new Zq(d),y=t(d.primaryKey,d.value,p);if(y instanceof he){const b=y.catch(T=>(p.done(),he.reject(T)));r.push(b)}p.isDone?i():null===p.G?d.continue():d.continue(p.G)}}).next(()=>he.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Pp(n){return new he((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=WR(r.target.error);t(i)}})}let nU=!1;function WR(n){const e=eu.D((0,k.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ve("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return nU||(nU=!0,setTimeout(()=>{throw r},0)),r}}return n}class Qq{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;ze("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,be.Z)(function*(){t.task=null;try{ze("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){yh(r)?ze("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield _h(r)}yield t.nt(6e4)}))}}class Xq{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,be.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return he.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return ze("IndexBackiller",`Processing collection: ${l}`),this.rt(e,l,i).next(d=>{i-=d,r.add(l)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.ot(i,a)).next(d=>(ze("IndexBackiller",`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>l.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=JL(a);HR(l,r)>0&&(r=l)}),new So(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class qs{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>t.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function rU(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Op(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function iU(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}qs.at=-1;class Ur{constructor(e,t){this.comparator=e,this.root=t||Ui.EMPTY}insert(e,t){return new Ur(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ui.BLACK,null,null))}remove(e){return new Ur(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ui.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new IT(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new IT(this.root,e,this.comparator,!1)}getReverseIterator(){return new IT(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new IT(this.root,e,this.comparator,!0)}}class IT{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ui{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??Ui.RED,this.left=i??Ui.EMPTY,this.right=a??Ui.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new Ui(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ui.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return Ui.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ui.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ui.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw wt();const e=this.left.check();if(e!==this.right.check())throw wt();return e+(this.isRed()?0:1)}}Ui.EMPTY=null,Ui.RED=!0,Ui.BLACK=!1,Ui.EMPTY=new class{constructor(){this.size=0}get key(){throw wt()}get value(){throw wt()}get color(){throw wt()}get left(){throw wt()}get right(){throw wt()}copy(n,e,t,r,i){return this}insert(n,e,t){return new Ui(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zn{constructor(e){this.comparator=e,this.data=new Ur(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new sU(this.data.getIterator())}getIteratorFrom(e){return new sU(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Zn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Zn(this.comparator);return t.data=e,t}}class sU{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function p_(n){return n.hasNext()?n.getNext():void 0}class Ao{constructor(e){this.fields=e,e.sort(Lr.comparator)}static empty(){return new Ao([])}unionWith(e){let t=new Zn(Lr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ao(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return f_(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class pi{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new pi(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new pi(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pi.EMPTY_BYTE_STRING=new pi("");const e3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vh(n){if(zt(!!n),"string"==typeof n){let e=0;const t=e3.exec(n);if(zt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Br(n.seconds),nanos:Br(n.nanos)}}function Br(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Fp(n){return"string"==typeof n?pi.fromBase64String(n):pi.fromUint8Array(n)}function zR(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function oU(n){const e=n.mapValue.fields.__previous_value__;return zR(e)?oU(e):e}function cE(n){const e=vh(n.mapValue.fields.__local_write_time__.timestampValue);return new br(e.seconds,e.nanos)}class t3{constructor(e,t,r,i,a,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.useFetchStreams=p}}class wh{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new wh("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof wh&&e.projectId===this.projectId&&e.database===this.database}}function dE(n){return null==n}function hE(n){return 0===n&&1/n==-1/0}function aU(n){return"number"==typeof n&&Number.isInteger(n)&&!hE(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Eh={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},bT={nullValue:"NULL_VALUE"};function Lp(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?zR(n)?4:dU(n)?9007199254740991:10:wt()}function Yu(n,e){if(n===e)return!0;const t=Lp(n);if(t!==Lp(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cE(n).isEqual(cE(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=vh(r.timestampValue),l=vh(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Fp(n.bytesValue).isEqual(Fp(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Br(r.geoPointValue.latitude)===Br(i.geoPointValue.latitude)&&Br(r.geoPointValue.longitude)===Br(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Br(r.integerValue)===Br(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=Br(r.doubleValue),l=Br(i.doubleValue);return a===l?hE(a)===hE(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return f_(n.arrayValue.values||[],e.arrayValue.values||[],Yu);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(rU(a)!==rU(l))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(void 0===l[d]||!Yu(a[d],l[d])))return!1;return!0}(n,e);default:return wt()}var i}function fE(n,e){return void 0!==(n.values||[]).find(t=>Yu(t,e))}function Ih(n,e){if(n===e)return 0;const t=Lp(n),r=Lp(e);if(t!==r)return nn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return nn(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Br(i.integerValue||i.doubleValue),d=Br(a.integerValue||a.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(n,e);case 3:return uU(n.timestampValue,e.timestampValue);case 4:return uU(cE(n),cE(e));case 5:return nn(n.stringValue,e.stringValue);case 6:return function(i,a){const l=Fp(i),d=Fp(a);return l.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),d=a.split("/");for(let p=0;p<l.length&&p<d.length;p++){const y=nn(l[p],d[p]);if(0!==y)return y}return nn(l.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=nn(Br(i.latitude),Br(a.latitude));return 0!==l?l:nn(Br(i.longitude),Br(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],d=a.values||[];for(let p=0;p<l.length&&p<d.length;++p){const y=Ih(l[p],d[p]);if(y)return y}return nn(l.length,d.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===Eh.mapValue&&a===Eh.mapValue)return 0;if(i===Eh.mapValue)return 1;if(a===Eh.mapValue)return-1;const l=i.fields||{},d=Object.keys(l),p=a.fields||{},y=Object.keys(p);d.sort(),y.sort();for(let b=0;b<d.length&&b<y.length;++b){const T=nn(d[b],y[b]);if(0!==T)return T;const M=Ih(l[d[b]],p[y[b]]);if(0!==M)return M}return nn(d.length,y.length)}(n.mapValue,e.mapValue);default:throw wt()}}function uU(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return nn(n,e);const t=vh(n),r=vh(e),i=nn(t.seconds,r.seconds);return 0!==i?i:nn(t.nanos,r.nanos)}function g_(n){return qR(n)}function qR(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=vh(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Fp(n.bytesValue).toBase64():"referenceValue"in n?ot.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=qR(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const d of i)l?l=!1:a+=",",a+=`${d}:${qR(r.fields[d])}`;return a+"}"}(n.mapValue):wt();var e}function Up(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function KR(n){return!!n&&"integerValue"in n}function pE(n){return!!n&&"arrayValue"in n}function lU(n){return!!n&&"nullValue"in n}function cU(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function CT(n){return!!n&&"mapValue"in n}function gE(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Op(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=gE(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gE(n.arrayValue.values[t]);return e}return Object.assign({},n)}function dU(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function n3(n){return"nullValue"in n?bT:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Up(wh.empty(),ot.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:wt()}function r3(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Up(wh.empty(),ot.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Eh:wt()}function hU(n,e){const t=Ih(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function fU(n,e){const t=Ih(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class Bi{constructor(e){this.value=e}static empty(){return new Bi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!CT(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gE(t)}setAll(e){let t=Lr.emptyPath(),r={},i=[];e.forEach((l,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,r,i),r={},i=[],t=d.popLast()}l?r[d.lastSegment()]=gE(l):i.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());CT(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Yu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];CT(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Op(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new Bi(gE(this.value))}}function pU(n){const e=[];return Op(n.fields,(t,r)=>{const i=new Lr([t]);if(CT(r)){const a=pU(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new Ao(e)}class or{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new or(e,0,Ht.min(),Ht.min(),Bi.empty(),0)}static newFoundDocument(e,t,r){return new or(e,1,t,Ht.min(),r,0)}static newNoDocument(e,t){return new or(e,2,t,Ht.min(),Bi.empty(),0)}static newUnknownDocument(e,t){return new or(e,3,t,Ht.min(),Bi.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ht.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new or(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class s3{constructor(e,t=null,r=[],i=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=d,this.ht=null}}function gU(n,e=null,t=[],r=[],i=null,a=null,l=null){return new s3(n,e,t,r,i,a,l)}function Bp(n){const e=ut(n);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+g_(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),dE(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>g_(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>g_(r)).join(",")),e.ht=t}return e.ht}function mE(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!p3(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Yu(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!wU(n.startAt,e.startAt)&&wU(n.endAt,e.endAt)}function TT(n){return ot.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function DT(n,e){return n.filters.filter(t=>t instanceof Vi&&t.field.isEqual(e))}function mU(n,e,t){let r=bT,i=!0;for(const a of DT(n,e)){let l=bT,d=!0;switch(a.op){case"<":case"<=":l=n3(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=bT}hU({value:r,inclusive:i},{value:l,inclusive:d})<0&&(r=l,i=d)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];hU({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function _U(n,e,t){let r=Eh,i=!0;for(const a of DT(n,e)){let l=Eh,d=!0;switch(a.op){case">=":case">":l=r3(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Eh}fU({value:r,inclusive:i},{value:l,inclusive:d})>0&&(r=l,i=d)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];fU({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class Vi extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new a3(e,t,r):"array-contains"===t?new c3(e,r):"in"===t?new d3(e,r):"not-in"===t?new h3(e,r):"array-contains-any"===t?new f3(e,r):new Vi(e,t,r)}static lt(e,t,r){return"in"===t?new u3(e,r):new l3(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(Ih(t,this.value)):null!==t&&Lp(this.value)===Lp(t)&&this.ft(Ih(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return wt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class a3 extends Vi{constructor(e,t,r){super(e,t,r),this.key=ot.fromName(r.referenceValue)}matches(e){const t=ot.comparator(e.key,this.key);return this.ft(t)}}class u3 extends Vi{constructor(e,t){super(e,"in",t),this.keys=yU(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class l3 extends Vi{constructor(e,t){super(e,"not-in",t),this.keys=yU(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function yU(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>ot.fromName(r.referenceValue))}class c3 extends Vi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return pE(t)&&fE(t.arrayValue,this.value)}}class d3 extends Vi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&fE(this.value.arrayValue,t)}}class h3 extends Vi{constructor(e,t){super(e,"not-in",t)}matches(e){if(fE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!fE(this.value.arrayValue,t)}}class f3 extends Vi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!pE(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>fE(this.value.arrayValue,r))}}class bh{constructor(e,t){this.position=e,this.inclusive=t}}class m_{constructor(e,t="asc"){this.field=e,this.dir=t}}function p3(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function vU(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?ot.comparator(ot.fromName(l.referenceValue),t.key):Ih(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function wU(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Yu(n.position[t],e.position[t]))return!1;return!0}class kc{constructor(e,t=null,r=[],i=[],a=null,l="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=p,this._t=null,this.wt=null}}function EU(n,e,t,r,i,a,l,d){return new kc(n,e,t,r,i,a,l,d)}function __(n){return new kc(n)}function IU(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function ZR(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function YR(n){for(const e of n.filters)if(e.dt())return e.field;return null}function QR(n){return null!==n.collectionGroup}function y_(n){const e=ut(n);if(null===e._t){e._t=[];const t=YR(e),r=ZR(e);if(null!==t&&null===r)t.isKeyField()||e._t.push(new m_(t)),e._t.push(new m_(Lr.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e._t.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new m_(Lr.keyField(),a))}}}return e._t}function Ks(n){const e=ut(n);if(!e.wt)if("F"===e.limitType)e.wt=gU(e.path,e.collectionGroup,y_(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of y_(e))t.push(new m_(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new bh(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new bh(e.startAt.position,e.startAt.inclusive):null;e.wt=gU(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.wt}function ST(n,e,t){return new kc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _E(n,e){return mE(Ks(n),Ks(e))&&n.limitType===e.limitType}function bU(n){return`${Bp(Ks(n))}|lt:${n.limitType}`}function XR(n){return`Query(target=${function o3(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${g_(r.value)}`;var r}).join(", ")}]`),dE(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>g_(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>g_(t)).join(",")),`Target(${e})`}(Ks(n))}; limitType=${n.limitType})`}function JR(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):ot.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const d=vU(i,a,l);return i.inclusive?d<=0:d<0}(t.startAt,y_(t),r)||t.endAt&&!function(i,a,l){const d=vU(i,a,l);return i.inclusive?d>=0:d>0}(t.endAt,y_(t),r)));var t,r}function CU(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function TU(n){return(e,t)=>{let r=!1;for(const i of y_(n)){const a=g3(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function g3(n,e,t){const r=n.field.isKeyField()?ot.comparator(e.key,t.key):function(i,a,l){const d=a.data.field(i),p=l.data.field(i);return null!==d&&null!==p?Ih(d,p):wt()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return wt()}}function DU(n,e){if(n.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hE(e)?"-0":e}}function SU(n){return{integerValue:""+n}}function AU(n,e){return aU(e)?SU(e):DU(n,e)}class AT{constructor(){this._=void 0}}function m3(n,e,t){return n instanceof v_?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof Vp?xU(n,e):n instanceof jp?RU(n,e):function(r,i){const a=MU(r,i),l=NU(a)+NU(r.yt);return KR(a)&&KR(r.yt)?SU(l):DU(r.It,l)}(n,e)}function _3(n,e,t){return n instanceof Vp?xU(n,e):n instanceof jp?RU(n,e):t}function MU(n,e){return n instanceof w_?KR(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class v_ extends AT{}class Vp extends AT{constructor(e){super(),this.elements=e}}function xU(n,e){const t=kU(e);for(const r of n.elements)t.some(i=>Yu(i,r))||t.push(r);return{arrayValue:{values:t}}}class jp extends AT{constructor(e){super(),this.elements=e}}function RU(n,e){let t=kU(e);for(const r of n.elements)t=t.filter(i=>!Yu(i,r));return{arrayValue:{values:t}}}class w_ extends AT{constructor(e,t){super(),this.It=e,this.yt=t}}function NU(n){return Br(n.integerValue||n.doubleValue)}function kU(n){return pE(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class yE{constructor(e,t){this.field=e,this.transform=t}}class v3{constructor(e,t){this.version=e,this.transformResults=t}}class Cr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cr}static exists(e){return new Cr(void 0,e)}static updateTime(e){return new Cr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function MT(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class xT{}function PU(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new I_(n.key,Cr.none()):new E_(n.key,n.data,Cr.none());{const t=n.data,r=Bi.empty();let i=new Zn(Lr.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new Pc(n.key,r,new Ao(i.toArray()),Cr.none())}}function w3(n,e,t){n instanceof E_?function(r,i,a){const l=r.value.clone(),d=LU(r.fieldTransforms,i,a.transformResults);l.setAll(d),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Pc?function(r,i,a){if(!MT(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=LU(r.fieldTransforms,i,a.transformResults),d=i.data;d.setAll(FU(r)),d.setAll(l),i.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function vE(n,e,t,r){return n instanceof E_?function(i,a,l,d){if(!MT(i.precondition,a))return l;const p=i.value.clone(),y=UU(i.fieldTransforms,d,a);return p.setAll(y),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),null}(n,e,t,r):n instanceof Pc?function(i,a,l,d){if(!MT(i.precondition,a))return l;const p=UU(i.fieldTransforms,d,a),y=a.data;return y.setAll(FU(i)),y.setAll(p),a.convertToFoundDocument(a.version,y).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(b=>b.field))}(n,e,t,r):(l=t,MT(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function E3(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=MU(r.transform,i||null);null!=a&&(null===t&&(t=Bi.empty()),t.set(r.field,a))}return t||null}function OU(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&f_(t,r,(i,a)=>function y3(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Vp&&r instanceof Vp||t instanceof jp&&r instanceof jp?f_(t.elements,r.elements,Yu):t instanceof w_&&r instanceof w_?Yu(t.yt,r.yt):t instanceof v_&&r instanceof v_);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class E_ extends xT{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Pc extends xT{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function FU(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function LU(n,e,t){const r=new Map;zt(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,d=e.data.field(a.field);r.set(a.field,_3(l,d,t[i]))}return r}function UU(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,m3(a,l,e))}return r}class I_ extends xT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eN extends xT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class I3{constructor(e){this.count=e}}var ui,Sn;function BU(n){switch(n){default:return wt();case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0}}function VU(n){if(void 0===n)return Kr("GRPC error has no .code"),ve.UNKNOWN;switch(n){case ui.OK:return ve.OK;case ui.CANCELLED:return ve.CANCELLED;case ui.UNKNOWN:return ve.UNKNOWN;case ui.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case ui.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case ui.INTERNAL:return ve.INTERNAL;case ui.UNAVAILABLE:return ve.UNAVAILABLE;case ui.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case ui.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case ui.NOT_FOUND:return ve.NOT_FOUND;case ui.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case ui.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case ui.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case ui.ABORTED:return ve.ABORTED;case ui.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case ui.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case ui.DATA_LOSS:return ve.DATA_LOSS;default:return wt()}}(Sn=ui||(ui={}))[Sn.OK=0]="OK",Sn[Sn.CANCELLED=1]="CANCELLED",Sn[Sn.UNKNOWN=2]="UNKNOWN",Sn[Sn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Sn[Sn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Sn[Sn.NOT_FOUND=5]="NOT_FOUND",Sn[Sn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Sn[Sn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Sn[Sn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Sn[Sn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Sn[Sn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Sn[Sn.ABORTED=10]="ABORTED",Sn[Sn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Sn[Sn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Sn[Sn.INTERNAL=13]="INTERNAL",Sn[Sn.UNAVAILABLE=14]="UNAVAILABLE",Sn[Sn.DATA_LOSS=15]="DATA_LOSS";class Ch{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Op(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return iU(this.inner)}size(){return this.innerSize}}const b3=new Ur(ot.comparator);function Zs(){return b3}const jU=new Ur(ot.comparator);function wE(...n){let e=jU;for(const t of n)e=e.insert(t.key,t);return e}function $U(n){let e=jU;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Qu(){return EE()}function HU(){return EE()}function EE(){return new Ch(n=>n.toString(),(n,e)=>n.isEqual(e))}const C3=new Ur(ot.comparator),T3=new Zn(ot.comparator);function cn(...n){let e=T3;for(const t of n)e=e.add(t);return e}const D3=new Zn(nn);function RT(){return D3}class IE{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t){const r=new Map;return r.set(e,bE.createSynthesizedTargetChangeForCurrentChange(e,t)),new IE(Ht.min(),r,RT(),Zs(),cn())}}class bE{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t){return new bE(pi.EMPTY_BYTE_STRING,t,cn(),cn(),cn())}}class NT{constructor(e,t,r,i){this.Tt=e,this.removedTargetIds=t,this.key=r,this.Et=i}}class GU{constructor(e,t){this.targetId=e,this.At=t}}class WU{constructor(e,t,r=pi.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class zU{constructor(){this.Rt=0,this.bt=KU(),this.Pt=pi.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=cn(),t=cn(),r=cn();return this.bt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:wt()}}),new bE(this.Pt,this.vt,e,t,r)}Nt(){this.Vt=!1,this.bt=KU()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Mt(e){this.Vt=!0,this.bt=this.bt.remove(e)}Ot(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class S3{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=Zs(),this.qt=qU(),this.Kt=new Zn(nn)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const r=this.zt(t);switch(e.state){case 0:this.Ht(t)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),r.Ct(e.resumeToken));break;default:wt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((r,i)=>{this.Ht(i)&&t(i)})}Yt(e){const t=e.targetId,r=e.At.count,i=this.Xt(t);if(i){const a=i.target;if(TT(a))if(0===r){const l=new ot(a.path);this.jt(t,l,or.newNoDocument(l,Ht.min()))}else zt(1===r);else this.Zt(t)!==r&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((a,l)=>{const d=this.Xt(l);if(d){if(a.current&&TT(d.target)){const p=new ot(d.target.path);null!==this.Ut.get(p)||this.ee(l,p)||this.jt(l,p,or.newNoDocument(p,e))}a.Dt&&(t.set(l,a.xt()),a.Nt())}});let r=cn();this.qt.forEach((a,l)=>{let d=!0;l.forEachWhile(p=>{const y=this.Xt(p);return!y||2===y.purpose||(d=!1,!1)}),d&&(r=r.add(a))}),this.Ut.forEach((a,l)=>l.setReadTime(e));const i=new IE(e,t,this.Kt,this.Ut,r);return this.Ut=Zs(),this.qt=qU(),this.Kt=new Zn(nn),i}Qt(e,t){if(!this.Ht(e))return;const r=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,r){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,t)?i.kt(t,1):i.Mt(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ot(e){this.zt(e).Ot()}zt(e){let t=this.Lt.get(e);return t||(t=new zU,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new Zn(nn),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||ze("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new zU),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function qU(){return new Ur(ot.comparator)}function KU(){return new Ur(ot.comparator)}const A3={asc:"ASCENDING",desc:"DESCENDING"},M3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class x3{constructor(e,t){this.databaseId=e,this.gt=t}}function CE(n,e){return n.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZU(n,e){return n.gt?e.toBase64():e.toUint8Array()}function R3(n,e){return CE(n,e.toTimestamp())}function Ti(n){return zt(!!n),Ht.fromTimestamp(function(e){const t=vh(e);return new br(t.seconds,t.nanos)}(n))}function tN(n,e){return(t=n,new Dn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function YU(n){const e=Dn.fromString(n);return zt(sB(e)),e}function TE(n,e){return tN(n.databaseId,e.path)}function Xu(n,e){const t=YU(e);if(t.get(1)!==n.databaseId.projectId)throw new Ve(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ve(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ot(XU(t))}function nN(n,e){return tN(n.databaseId,e)}function QU(n){const e=YU(n);return 4===e.length?Dn.emptyPath():XU(e)}function DE(n){return new Dn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function XU(n){return zt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function JU(n,e,t){return{name:TE(n,e),fields:t.value.mapValue.fields}}function eB(n,e,t){const r=Xu(n,e.name),i=Ti(e.updateTime),a=new Bi({mapValue:{fields:e.fields}}),l=or.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function SE(n,e){let t;if(e instanceof E_)t={update:JU(n,e.key,e.value)};else if(e instanceof I_)t={delete:TE(n,e.key)};else if(e instanceof Pc)t={update:JU(n,e.key,e.data),updateMask:V3(e.fieldMask)};else{if(!(e instanceof eN))return wt();t={verify:TE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof v_)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Vp)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof jp)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof w_)return{fieldPath:a.field.canonicalString(),increment:l.yt};throw wt()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:R3(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:wt()),t;var i}function rN(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?Cr.updateTime(Ti(i.updateTime)):void 0!==i.exists?Cr.exists(i.exists):Cr.none():Cr.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let d=null;"setToServerValue"in l?(zt("REQUEST_TIME"===l.setToServerValue),d=new v_):"appendMissingElements"in l?d=new Vp(l.appendMissingElements.values||[]):"removeAllFromArray"in l?d=new jp(l.removeAllFromArray.values||[]):"increment"in l?d=new w_(a,l.increment):wt();const p=Lr.fromServerFormat(l.fieldPath);return new yE(p,d)}(n,i)):[];var i;if(e.update){const i=Xu(n,e.update.name),a=new Bi({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new Ao((e.updateMask.fieldPaths||[]).map(y=>Lr.fromServerFormat(y)));return new Pc(i,a,l,t,r)}return new E_(i,a,t,r)}if(e.delete){const i=Xu(n,e.delete);return new I_(i,t)}if(e.verify){const i=Xu(n,e.verify);return new eN(i,t)}return wt()}function tB(n,e){return{documents:[nN(n,e.path)]}}function nB(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=nN(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=nN(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(p){if(0===p.length)return;const y=p.map(b=>function(T){if("=="===T.op){if(cU(T.value))return{unaryFilter:{field:b_(T.field),op:"IS_NAN"}};if(lU(T.value))return{unaryFilter:{field:b_(T.field),op:"IS_NULL"}}}else if("!="===T.op){if(cU(T.value))return{unaryFilter:{field:b_(T.field),op:"IS_NOT_NAN"}};if(lU(T.value))return{unaryFilter:{field:b_(T.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:b_(T.field),op:L3(T.op),value:T.value}}}(b));return 1===y.length?y[0]:{compositeFilter:{op:"AND",filters:y}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(p){if(0!==p.length)return p.map(y=>{return{field:b_((b=y).field),direction:F3(b.dir)};var b})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(y=e.limit,n.gt||dE(y)?y:{value:y});var y,d,p;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt={before:!(p=e.endAt).inclusive,values:p.position}),t}function rB(n){let e=QU(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){zt(1===r);const b=t.from[0];b.allDescendants?i=b.collectionId:e=e.child(b.collectionId)}let a=[];t.where&&(a=iB(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(b=>{return new m_(C_((T=b).field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction));var T}));let d=null;t.limit&&(d=function(b){let T;return T="object"==typeof b?b.value:b,dE(T)?null:T}(t.limit));let p=null;var b;t.startAt&&(p=new bh((b=t.startAt).values||[],!!b.before));let y=null;return t.endAt&&(y=function(b){return new bh(b.values||[],!b.before)}(t.endAt)),EU(e,i,l,a,d,"F",p,y)}function iB(n){return n?void 0!==n.unaryFilter?[B3(n)]:void 0!==n.fieldFilter?[U3(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>iB(e)).reduce((e,t)=>e.concat(t)):wt():[]}function F3(n){return A3[n]}function L3(n){return M3[n]}function b_(n){return{fieldPath:n.canonicalString()}}function C_(n){return Lr.fromServerFormat(n.fieldPath)}function U3(n){return Vi.create(C_(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wt()}}(n.fieldFilter.op),n.fieldFilter.value)}function B3(n){switch(n.unaryFilter.op){case"IS_NAN":const e=C_(n.unaryFilter.field);return Vi.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=C_(n.unaryFilter.field);return Vi.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=C_(n.unaryFilter.field);return Vi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=C_(n.unaryFilter.field);return Vi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return wt()}}function V3(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function sB(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function ms(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=oB(e)),e=j3(n.get(t),e);return oB(e)}function j3(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function oB(n){return n+"\x01\x01"}function Ju(n){const e=n.length;if(zt(e>=2),2===e)return zt("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Dn.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&wt(),n.charAt(l+1)){case"\x01":const d=n.substring(a,l);let p;0===i.length?p=d:(i+=d,p=i,i=""),r.push(p);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:wt()}a=l+2}return new Dn(r)}const aB=["userId","batchId"];function kT(n,e){return[n,ms(e)]}function uB(n,e,t){return[n,ms(e),t]}const $3={},H3=["prefixPath","collectionGroup","readTime","documentId"],G3=["prefixPath","collectionGroup","documentId"],W3=["collectionGroup","readTime","prefixPath","documentId"],z3=["canonicalId","targetId"],q3=["targetId","path"],K3=["path","targetId"],Z3=["collectionId","parent"],Y3=["indexId","uid"],Q3=["uid","sequenceNumber"],X3=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],J3=["indexId","uid","orderedDocumentKey"],eK=["userId","collectionPath","documentId"],tK=["userId","collectionPath","largestBatchId"],nK=["userId","collectionGroup","largestBatchId"],lB=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],rK=[...lB,"documentOverlays"],cB=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],dB=cB,iK=[...dB,"indexConfiguration","indexState","indexEntries"];class iN extends tU{constructor(e,t){super(),this.ie=e,this.currentSequenceNumber=t}}function Di(n,e){const t=ut(n);return eu.O(t.ie,e)}class sN{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&w3(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=vE(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=vE(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=HU();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(i.key)?null:d;const p=PU(l,d);null!==p&&r.set(i.key,p),l.isValidDocument()||l.convertToNoDocument(Ht.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),cn())}isEqual(e){return this.batchId===e.batchId&&f_(this.mutations,e.mutations,(t,r)=>OU(t,r))&&f_(this.baseMutations,e.baseMutations,(t,r)=>OU(t,r))}}class oN{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){zt(e.mutations.length===r.length);let i=C3;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new oN(e,t,r,i)}}class aN{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Th{constructor(e,t,r,i,a=Ht.min(),l=Ht.min(),d=pi.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d}withSequenceNumber(e){return new Th(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Th(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Th(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class hB{constructor(e){this.re=e}}function fB(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:PT(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:TE(i=n.re,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:CE(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:$p(e.version)};else{if(!e.isUnknownDocument())return wt();r.unknownDocument={path:t.path.toArray(),version:$p(e.version)}}var i,a;return r}function PT(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function $p(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Hp(n){const e=new br(n.seconds,n.nanoseconds);return Ht.fromTimestamp(e)}function Gp(n,e){const t=(e.baseMutations||[]).map(a=>rN(n.re,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>rN(n.re,a)),i=br.fromMillis(e.localWriteTimeMs);return new sN(e.batchId,i,t,r)}function AE(n){const e=Hp(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Hp(n.lastLimboFreeSnapshotVersion):Ht.min();let r;var i;return void 0!==n.query.documents?(zt(1===(i=n.query).documents.length),r=Ks(__(QU(i.documents[0])))):r=Ks(rB(n.query)),new Th(r,n.targetId,0,n.lastListenSequenceNumber,e,t,pi.fromBase64String(n.resumeToken))}function pB(n,e){const t=$p(e.snapshotVersion),r=$p(e.lastLimboFreeSnapshotVersion);let i;i=TT(e.target)?tB(n.re,e.target):nB(n.re,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Bp(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function uN(n){const e=rB({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?ST(e,e.limit,"L"):e}function lN(n,e){return new aN(e.largestBatchId,rN(n.re,e.overlayMutation))}function gB(n,e){const t=e.path.lastSegment();return[n,ms(e.path.popLast()),t]}function mB(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:$p(r.readTime),documentKey:ms(r.documentKey.path),largestBatchId:r.largestBatchId}}class oK{getBundleMetadata(e,t){return _B(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:Hp(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return _B(e).put({bundleId:(r=t).id,createTime:$p(Ti(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return yB(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:uN(i.bundledQuery),readTime:Hp(i.readTime)};var i})}saveNamedQuery(e,t){return yB(e).put({name:(r=t).name,readTime:$p(Ti(r.readTime)),bundledQuery:r.bundledQuery});var r}}function _B(n){return Di(n,"bundles")}function yB(n){return Di(n,"namedQueries")}class OT{constructor(e,t){this.It=e,this.userId=t}static oe(e,t){return new OT(e,t.uid||"")}getOverlay(e,t){return ME(e).get(gB(this.userId,t)).next(r=>r?lN(this.It,r):null)}getOverlays(e,t){const r=Qu();return he.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const d=new aN(t,l);i.push(this.ue(e,d))}),he.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(ms(l.getCollectionPath())));const a=[];return i.forEach(l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(ME(e).Y("collectionPathOverlayIndex",d))}),he.waitFor(a)}getOverlaysForCollection(e,t,r){const i=Qu(),a=ms(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ME(e).W("collectionPathOverlayIndex",l).next(d=>{for(const p of d){const y=lN(this.It,p);i.set(y.getKey(),y)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=Qu();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ME(e).Z({index:"collectionGroupOverlayIndex",range:d},(p,y,b)=>{const T=lN(this.It,y);a.size()<i||T.largestBatchId===l?(a.set(T.getKey(),T),l=T.largestBatchId):b.done()}).next(()=>a)}ue(e,t){return ME(e).put(function(r,i,a){const[l,d,p]=gB(i,a.mutation.key);return{userId:i,collectionPath:d,documentId:p,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:SE(r.re,a.mutation)}}(this.It,this.userId,t))}}function ME(n){return Di(n,"documentOverlays")}class Wp{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(Br(e.integerValue));else if("doubleValue"in e){const r=Br(e.doubleValue);isNaN(r)?this.le(t,13):(this.le(t,15),hE(r)?t.fe(0):t.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de(`${r.seconds||""}`),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(Fp(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(t,45),t.fe(r.latitude||0),t.fe(r.longitude||0)}else"mapValue"in e?dU(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):wt()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const r=e.fields||{};this.le(t,55);for(const i of Object.keys(r))this._e(i,t),this.ae(r[i],t)}pe(e,t){const r=e.values||[];this.le(t,50);for(const i of r)this.ae(i,t)}ge(e,t){this.le(t,37),ot.fromName(e).path.forEach(r=>{this.le(t,60),this.Ie(r,t)})}le(e,t){e.fe(t)}we(e){e.fe(2)}}function aK(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function vB(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=aK(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Wp.Te=new Wp;class uK{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Pe(r.value),r=t.next();this.ve()}Ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const i=t.codePointAt(0);this.Pe(240|i>>>18),this.Pe(128|63&i>>>12),this.Pe(128|63&i>>>6),this.Pe(128|63&i)}}this.ve()}De(e){const t=this.Ce(e),r=vB(t);this.xe(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ne(e){const t=this.Ce(e),r=vB(t);this.xe(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}ke(){this.Me(255),this.Me(255)}Oe(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ae(e){const t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}Pe(e){const t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Me(0),this.Me(1)}ve(){this.Fe(0),this.Fe(1)}Me(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class lK{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class cK{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Oe()}}class xE{constructor(){this.Be=new uK,this.Le=new lK(this.Be),this.Ue=new cK(this.Be)}seed(e){this.Be.seed(e)}qe(e){return 0===e?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}class zp{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ke(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new zp(this.indexId,this.documentKey,this.arrayValue,r)}}function qp(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=wB(n.arrayValue,e.arrayValue),0!==t?t:(t=wB(n.directionalValue,e.directionalValue),0!==t?t:ot.comparator(n.documentKey,e.documentKey)))}function wB(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class dK{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const t of e.filters){const r=t;r.dt()?this.je=r:this.Qe.push(r)}}We(e){const t=$R(e);if(void 0!==t&&!this.ze(t))return!1;const r=kp(e);let i=0,a=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.je){const l=r[i];if(!this.He(this.je,l)||!this.Je(this.Ge[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ge.length||!this.Je(this.Ge[a++],l))return!1}return!0}ze(e){for(const t of this.Qe)if(this.He(t,e))return!0;return!1}He(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Je(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class hK{constructor(){this.Ye=new cN}addToCollectionParentIndex(e,t){return this.Ye.add(t),he.resolve()}getCollectionParents(e,t){return he.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return he.resolve()}deleteFieldIndex(e,t){return he.resolve()}getDocumentsMatchingTarget(e,t){return he.resolve(null)}getIndexType(e,t){return he.resolve(0)}getFieldIndexes(e,t){return he.resolve([])}getNextCollectionGroupToUpdate(e){return he.resolve(null)}getMinOffset(e,t){return he.resolve(So.min())}getMinOffsetFromCollectionGroup(e,t){return he.resolve(So.min())}updateCollectionGroup(e,t,r){return he.resolve()}updateIndexEntries(e,t){return he.resolve()}}class cN{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Zn(Dn.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Zn(Dn.comparator)).toArray()}}const FT=new Uint8Array(0);class fK{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new cN,this.Ze=new Ch(r=>Bp(r),(r,i)=>mE(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const a={collectionId:r,parent:ms(i)};return EB(e).put(a)}return he.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[QL(t),""],!1,!0);return EB(e).W(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Ju(l.parent))}return r})}addFieldIndex(e,t){const r=LT(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=NE(e);return a.next(d=>{l.put(mB(d,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=LT(e),i=NE(e),a=RE(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=RE(e);let i=!0;const a=new Map;return he.forEach(this.tn(t),l=>this.en(e,l).next(d=>{i&&(i=!!d),a.set(l,d)})).next(()=>{if(i){let l=cn();const d=[];return he.forEach(a,(p,y)=>{var b;ze("IndexedDbIndexManager",`Using index ${b=p,`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(rt=>`${rt.fieldPath}:${rt.kind}`).join(",")}`} to execute ${Bp(t)}`);const T=function(rt,et){const xt=$R(et);if(void 0===xt)return null;for(const Pt of DT(rt,xt.fieldPath))switch(Pt.op){case"array-contains-any":return Pt.value.arrayValue.values||[];case"array-contains":return[Pt.value]}return null}(y,p),M=function(rt,et){const xt=new Map;for(const Pt of kp(et))for(const _n of DT(rt,Pt.fieldPath))switch(_n.op){case"==":case"in":xt.set(Pt.fieldPath.canonicalString(),_n.value);break;case"not-in":case"!=":return xt.set(Pt.fieldPath.canonicalString(),_n.value),Array.from(xt.values())}return null}(y,p),P=function(rt,et){const xt=[];let Pt=!0;for(const _n of kp(et)){const Zr=0===_n.kind?mU(rt,_n.fieldPath,rt.startAt):_U(rt,_n.fieldPath,rt.startAt);xt.push(Zr.value),Pt&&(Pt=Zr.inclusive)}return new bh(xt,Pt)}(y,p),U=function(rt,et){const xt=[];let Pt=!0;for(const _n of kp(et)){const Zr=0===_n.kind?_U(rt,_n.fieldPath,rt.endAt):mU(rt,_n.fieldPath,rt.endAt);xt.push(Zr.value),Pt&&(Pt=Zr.inclusive)}return new bh(xt,Pt)}(y,p),ee=this.nn(p,y,P),oe=this.nn(p,y,U),Ge=this.sn(p,y,M),Je=this.rn(p.indexId,T,ee,P.inclusive,oe,U.inclusive,Ge);return he.forEach(Je,rt=>r.J(rt,t.limit).next(et=>{et.forEach(xt=>{const Pt=ot.fromSegments(xt.documentKey);l.has(Pt)||(l=l.add(Pt),d.push(Pt))})}))}).next(()=>d)}return he.resolve(null)})}tn(e){let t=this.Ze.get(e);return t||(t=[e],this.Ze.set(e,t),t)}rn(e,t,r,i,a,l,d){const p=(null!=t?t.length:1)*Math.max(r.length,a.length),y=p/(null!=t?t.length:1),b=[];for(let T=0;T<p;++T){const M=t?this.on(t[T/y]):FT,P=this.un(e,M,r[T%y],i),U=this.cn(e,M,a[T%y],l),ee=d.map(oe=>this.un(e,M,oe,!0));b.push(...this.createRange(P,U,ee))}return b}un(e,t,r,i){const a=new zp(e,ot.empty(),t,r);return i?a:a.Ke()}cn(e,t,r,i){const a=new zp(e,ot.empty(),t,r);return i?a.Ke():a}en(e,t){const r=new dK(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const d of a)r.We(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l})}getIndexType(e,t){let r=2;return he.forEach(this.tn(t),i=>this.en(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let d=new Zn(Lr.comparator),p=!1;for(const y of l.filters){const b=y;b.field.isKeyField()||("array-contains"===b.op||"array-contains-any"===b.op?p=!0:d=d.add(b.field))}for(const y of l.orderBy)y.field.isKeyField()||(d=d.add(y.field));return d.size+(p?1:0)}(i)&&(r=1):r=0})).next(()=>r)}an(e,t){const r=new xE;for(const i of kp(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.qe(i.kind);Wp.Te.ce(a,l)}return r.$e()}on(e){const t=new xE;return Wp.Te.ce(e,t.qe(0)),t.$e()}hn(e,t){const r=new xE;return Wp.Te.ce(Up(this.databaseId,t),r.qe(function(i){const a=kp(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.$e()}sn(e,t,r){if(null===r)return[];let i=[];i.push(new xE);let a=0;for(const l of kp(e)){const d=r[a++];for(const p of i)if(this.ln(t,l.fieldPath)&&pE(d))i=this.fn(i,l,d);else{const y=p.qe(l.kind);Wp.Te.ce(d,y)}}return this.dn(i)}nn(e,t,r){return this.sn(e,t,r.position)}dn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].$e();return t}fn(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of i){const p=new xE;p.seed(d.$e()),Wp.Te.ce(l,p.qe(t.kind)),a.push(p)}return a}ln(e,t){return!!e.filters.find(r=>r instanceof Vi&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=LT(e),i=NE(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const l=[];return he.forEach(a,d=>i.get([d.indexId,this.uid]).next(p=>{l.push(function(y,b){const T=b?new uE(b.sequenceNumber,new So(Hp(b.readTime),new ot(Ju(b.documentKey)),b.largestBatchId)):uE.empty(),M=y.fields.map(([P,U])=>new wT(Lr.fromServerFormat(P),U));return new vT(y.indexId,y.collectionGroup,M,T)}(d,p))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:nn(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=LT(e),a=NE(e);return this._n(e).next(l=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(d=>he.forEach(d,p=>a.put(mB(p.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return he.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?he.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(d=>(r.set(i.collectionGroup,d),he.forEach(d,p=>this.wn(e,i,p).next(y=>{const b=this.mn(a,p);return y.isEqual(b)?he.resolve():this.gn(e,a,p,y,b)}))))})}yn(e,t,r,i){return RE(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.hn(r,t.key),documentKey:t.key.path.toArray()})}pn(e,t,r,i){return RE(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.hn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=RE(e);let a=new Zn(qp);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.hn(r,t)])},(l,d)=>{a=a.add(new zp(r.indexId,t,d.arrayValue,d.directionalValue))}).next(()=>a)}mn(e,t){let r=new Zn(qp);const i=this.an(t,e);if(null==i)return r;const a=$R(t);if(null!=a){const l=e.data.field(a.fieldPath);if(pE(l))for(const d of l.arrayValue.values||[])r=r.add(new zp(t.indexId,e.key,this.on(d),i))}else r=r.add(new zp(t.indexId,e.key,FT,i));return r}gn(e,t,r,i,a){ze("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(d,p,y,b,T){const M=d.getIterator(),P=p.getIterator();let U=p_(M),ee=p_(P);for(;U||ee;){let oe=!1,Ge=!1;if(U&&ee){const Je=y(U,ee);Je<0?Ge=!0:Je>0&&(oe=!0)}else null!=U?Ge=!0:oe=!0;oe?(b(ee),ee=p_(P)):Ge?(T(U),U=p_(M)):(U=p_(M),ee=p_(P))}}(i,a,qp,d=>{l.push(this.yn(e,t,r,d))},d=>{l.push(this.pn(e,t,r,d))}),he.waitFor(l)}_n(e){let t=1;return NE(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,d)=>qp(l,d)).filter((l,d,p)=>!d||0!==qp(l,p[d-1]));const i=[];i.push(e);for(const l of r){const d=qp(l,e),p=qp(l,t);if(0===d)i[0]=e.Ke();else if(d>0&&p<0)i.push(l),i.push(l.Ke());else if(p>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,FT,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,FT,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(IB)}getMinOffset(e,t){return he.mapArray(this.tn(t),r=>this.en(e,r).next(i=>i||wt())).next(IB)}}function EB(n){return Di(n,"collectionParents")}function RE(n){return Di(n,"indexEntries")}function LT(n){return Di(n,"indexConfiguration")}function NE(n){return Di(n,"indexState")}function IB(n){zt(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;HR(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new So(e.readTime,e.documentKey,t)}const bB={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ys{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ys(e,Ys.DEFAULT_COLLECTION_PERCENTILE,Ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function CB(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const p=r.Z({range:l},(b,T,M)=>(d++,M.delete()));a.push(p.next(()=>{zt(1===d)}));const y=[];for(const b of t.mutations){const T=uB(e,b.key.path,t.batchId);a.push(i.delete(T)),y.push(b.key)}return he.waitFor(a).next(()=>y)}function UT(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw wt();e=n.noDocument}return JSON.stringify(e).length}Ys.DEFAULT_COLLECTION_PERCENTILE=10,Ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ys.DEFAULT=new Ys(41943040,Ys.DEFAULT_COLLECTION_PERCENTILE,Ys.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ys.DISABLED=new Ys(-1,0,0);class BT{constructor(e,t,r,i){this.userId=e,this.It=t,this.indexManager=r,this.referenceDelegate=i,this.In={}}static oe(e,t,r,i){zt(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new BT(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dh(e).Z({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=T_(e),l=Dh(e);return l.add({}).next(d=>{zt("number"==typeof d);const p=new sN(d,t,r,i),y=function(M,P,U){const ee=U.baseMutations.map(Ge=>SE(M.re,Ge)),oe=U.mutations.map(Ge=>SE(M.re,Ge));return{userId:P,batchId:U.batchId,localWriteTimeMs:U.localWriteTime.toMillis(),baseMutations:ee,mutations:oe}}(this.It,this.userId,p),b=[];let T=new Zn((M,P)=>nn(M.canonicalString(),P.canonicalString()));for(const M of i){const P=uB(this.userId,M.key.path,d);T=T.add(M.key.path.popLast()),b.push(l.put(y)),b.push(a.put(P,$3))}return T.forEach(M=>{b.push(this.indexManager.addToCollectionParentIndex(e,M))}),e.addOnCommittedListener(()=>{this.In[d]=p.keys()}),he.waitFor(b).next(()=>p)})}lookupMutationBatch(e,t){return Dh(e).get(t).next(r=>r?(zt(r.userId===this.userId),Gp(this.It,r)):null)}Tn(e,t){return this.In[t]?he.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.In[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Dh(e).Z({index:"userMutationsIndex",range:i},(l,d,p)=>{d.userId===this.userId&&(zt(d.batchId>=r),a=Gp(this.It,d)),p.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Dh(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dh(e).W("userMutationsIndex",t).next(r=>r.map(i=>Gp(this.It,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=kT(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return T_(e).Z({range:i},(l,d,p)=>{const[y,b,T]=l,M=Ju(b);if(y===this.userId&&t.path.isEqual(M))return Dh(e).get(T).next(P=>{if(!P)throw wt();zt(P.userId===this.userId),a.push(Gp(this.It,P))});p.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(nn);const i=[];return t.forEach(a=>{const l=kT(this.userId,a.path),d=IDBKeyRange.lowerBound(l),p=T_(e).Z({range:d},(y,b,T)=>{const[M,P,U]=y,ee=Ju(P);M===this.userId&&a.path.isEqual(ee)?r=r.add(U):T.done()});i.push(p)}),he.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=kT(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new Zn(nn);return T_(e).Z({range:l},(p,y,b)=>{const[T,M,P]=p,U=Ju(M);T===this.userId&&r.isPrefixOf(U)?U.length===i&&(d=d.add(P)):b.done()}).next(()=>this.En(e,d))}En(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Dh(e).get(a).next(l=>{if(null===l)throw wt();zt(l.userId===this.userId),r.push(Gp(this.It,l))}))}),he.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return CB(e.ie,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),he.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return he.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return T_(e).Z({range:r},(a,l,d)=>{if(a[0]===this.userId){const p=Ju(a[1]);i.push(p)}else d.done()}).next(()=>{zt(0===i.length)})})}containsKey(e,t){return TB(e,this.userId,t)}Rn(e){return DB(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function TB(n,e,t){const r=kT(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return T_(n).Z({range:a,X:!0},(d,p,y)=>{const[b,T,M]=d;b===e&&T===i&&(l=!0),y.done()}).next(()=>l)}function Dh(n){return Di(n,"mutations")}function T_(n){return Di(n,"documentMutations")}function DB(n){return Di(n,"mutationQueues")}class Kp{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Kp(0)}static vn(){return new Kp(-1)}}class pK{constructor(e,t){this.referenceDelegate=e,this.It=t}allocateTargetId(e){return this.Vn(e).next(t=>{const r=new Kp(t.highestTargetId);return t.highestTargetId=r.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>Ht.fromTimestamp(new br(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Sn(e,i)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(t,r),this.Sn(e,r))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>D_(e).delete(t.targetId)).next(()=>this.Vn(e)).next(r=>(zt(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return D_(e).Z((l,d)=>{const p=AE(d);p.sequenceNumber<=t&&null===r.get(p.targetId)&&(i++,a.push(this.removeTargetData(e,p)))}).next(()=>he.waitFor(a)).next(()=>i)}forEachTarget(e,t){return D_(e).Z((r,i)=>{const a=AE(i);t(a)})}Vn(e){return SB(e).get("targetGlobalKey").next(t=>(zt(null!==t),t))}Sn(e,t){return SB(e).put("targetGlobalKey",t)}Dn(e,t){return D_(e).put(pB(this.It,t))}Cn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Bp(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return D_(e).Z({range:i,index:"queryTargetsIndex"},(l,d,p)=>{const y=AE(d);mE(t,y.target)&&(a=y,p.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=Sh(e);return t.forEach(l=>{const d=ms(l.path);i.push(a.put({targetId:r,path:d})),i.push(this.referenceDelegate.addReference(e,r,l))}),he.waitFor(i)}removeMatchingKeys(e,t,r){const i=Sh(e);return he.forEach(t,a=>{const l=ms(a.path);return he.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=Sh(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Sh(e);let a=cn();return i.Z({range:r,X:!0},(l,d,p)=>{const y=Ju(l[1]),b=new ot(y);a=a.add(b)}).next(()=>a)}containsKey(e,t){const r=ms(t.path),i=IDBKeyRange.bound([r],[QL(r)],!1,!0);let a=0;return Sh(e).Z({index:"documentTargetsIndex",X:!0,range:i},([l,d],p,y)=>{0!==l&&(a++,y.done())}).next(()=>a>0)}se(e,t){return D_(e).get(t).next(r=>r?AE(r):null)}}function D_(n){return Di(n,"targets")}function SB(n){return Di(n,"targetGlobal")}function Sh(n){return Di(n,"targetDocuments")}function AB([n,e],[t,r]){const i=nn(n,t);return 0===i?nn(e,r):i}class gK{constructor(e){this.xn=e,this.buffer=new Zn(AB),this.Nn=0}kn(){return++this.Nn}Mn(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();AB(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mK{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.On=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.On&&(this.On.cancel(),this.On=null)}get started(){return null!==this.On}Fn(e){var t=this;ze("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,be.Z)(function*(){t.On=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){yh(r)?ze("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield _h(r)}yield t.Fn(3e5)}))}}class _K{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return he.resolve(qs.at);const r=new gK(t);return this.$n.forEachTarget(e,i=>r.Mn(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.Mn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.$n.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),he.resolve(bB)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bB):this.Un(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,t){let r,i,a,l,d,p,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(T=>(T>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),i=this.params.maximumSequenceNumbersToCollect):i=T,l=Date.now(),this.nthSequenceNumber(e,i))).next(T=>(r=T,d=Date.now(),this.removeTargets(e,r,t))).next(T=>(a=T,p=Date.now(),this.removeOrphanedDocuments(e,r))).next(T=>(y=Date.now(),VR()<=er.in.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-b}ms\n\tDetermined least recently used ${i} in `+(d-l)+`ms\n\tRemoved ${a} targets in `+(p-d)+`ms\n\tRemoved ${T} documents in `+(y-p)+`ms\nTotal Duration: ${y-b}ms`),he.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:T})))}}class yK{constructor(e,t){this.db=e,this.garbageCollector=new _K(this,t)}Bn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}qn(e){let t=0;return this.Ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(r,i)=>t(i))}addReference(e,t,r){return VT(e,r)}removeReference(e,t,r){return VT(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return VT(e,t)}Gn(e,t){return function(r,i){let a=!1;return DB(r).tt(l=>TB(r,l,i).next(d=>(d&&(a=!0),he.resolve(!d)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Kn(e,(l,d)=>{if(d<=t){const p=this.Gn(e,l).next(y=>{if(!y)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Ht.min()),Sh(e).delete([0,ms(l.path)])))});i.push(p)}}).next(()=>he.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return VT(e,t)}Kn(e,t){const r=Sh(e);let i,a=qs.at;return r.Z({index:"documentTargetsIndex"},([l,d],{path:p,sequenceNumber:y})=>{0===l?(a!==qs.at&&t(new ot(Ju(i)),a),a=y,i=p):a=qs.at}).next(()=>{a!==qs.at&&t(new ot(Ju(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function VT(n,e){return Sh(n).put((r=n.currentSequenceNumber,{targetId:0,path:ms(e.path),sequenceNumber:r}));var r}class MB{constructor(){this.changes=new Ch(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?he.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vK{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Zp(e).put(r)}removeEntry(e,t,r){return Zp(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],PT(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Qn(e,r)))}getEntry(e,t){let r=or.newInvalidDocument(t);return Zp(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(kE(t))},(i,a)=>{r=this.jn(t,a)}).next(()=>r)}Wn(e,t){let r={size:0,document:or.newInvalidDocument(t)};return Zp(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(kE(t))},(i,a)=>{r={document:this.jn(t,a),size:UT(a)}}).next(()=>r)}getEntries(e,t){let r=Zs();return this.zn(e,t,(i,a)=>{const l=this.jn(i,a);r=r.insert(i,l)}).next(()=>r)}Hn(e,t){let r=Zs(),i=new Ur(ot.comparator);return this.zn(e,t,(a,l)=>{const d=this.jn(a,l);r=r.insert(a,d),i=i.insert(a,UT(l))}).next(()=>({documents:r,Jn:i}))}zn(e,t,r){if(t.isEmpty())return he.resolve();let i=new Zn(kB);t.forEach(p=>i=i.add(p));const a=IDBKeyRange.bound(kE(i.first()),kE(i.last())),l=i.getIterator();let d=l.getNext();return Zp(e).Z({index:"documentKeyIndex",range:a},(p,y,b)=>{const T=ot.fromSegments([...y.prefixPath,y.collectionGroup,y.documentId]);for(;d&&kB(d,T)<0;)r(d,null),d=l.getNext();d&&d.isEqual(T)&&(r(d,y),d=l.hasNext()?l.getNext():null),d?b.j(kE(d)):b.done()}).next(()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),PT(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zp(e).W(IDBKeyRange.bound(i,a,!0)).next(l=>{let d=Zs();for(const p of l){const y=this.jn(ot.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);d=d.insert(y.key,y)}return d})}getAllFromCollectionGroup(e,t,r,i){let a=Zs();const l=NB(t,r),d=NB(t,So.max());return Zp(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,d,!0)},(p,y,b)=>{const T=this.jn(ot.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);a=a.insert(T.key,T),a.size===i&&b.done()}).next(()=>a)}newChangeBuffer(e){return new wK(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return RB(e).get("remoteDocumentGlobalKey").next(t=>(zt(!!t),t))}Qn(e,t){return RB(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const r=function sK(n,e){let t;if(e.document)t=eB(n.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ot.fromSegments(e.noDocument.path),i=Hp(e.noDocument.readTime);t=or.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return wt();{const r=ot.fromSegments(e.unknownDocument.path),i=Hp(e.unknownDocument.version);t=or.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new br(r[0],r[1]);return Ht.fromTimestamp(i)}(e.readTime)),t}(this.It,t);if(!r.isNoDocument()||!r.version.isEqual(Ht.min()))return r}return or.newInvalidDocument(e)}}function xB(n){return new vK(n)}class wK extends MB{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new Ch(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Zn((a,l)=>nn(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const d=this.Xn.get(a);if(t.push(this.Yn.removeEntry(e,a,d.readTime)),l.isValidDocument()){const p=fB(this.Yn.It,l);i=i.add(a.path.popLast()),r+=UT(p)-d.size,t.push(this.Yn.addEntry(e,a,p))}else if(r-=d.size,this.trackRemovals){const p=fB(this.Yn.It,l.convertToNoDocument(Ht.min()));t.push(this.Yn.addEntry(e,a,p))}}),i.forEach(a=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Yn.updateMetadata(e,r)),he.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(r=>(this.Xn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:r,Jn:i})=>(i.forEach((a,l)=>{this.Xn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function RB(n){return Di(n,"remoteDocumentGlobal")}function Zp(n){return Di(n,"remoteDocumentsV14")}function kE(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function NB(n,e){const t=e.documentKey.path.toArray();return[n,PT(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function kB(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=nn(t[a],r[a]),i)return i;return i=nn(t.length,r.length),i||(i=nn(t[t.length-2],r[r.length-2]),i||nn(t[t.length-1],r[r.length-1]))}class EK{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class PB{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&vE(r.mutation,i,Ao.empty(),br.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,cn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=cn()){const i=Qu();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=wE();return a.forEach((d,p)=>{l=l.insert(d,p.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=Qu();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,cn()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,d)=>{t.set(l,d)})})}computeViews(e,t,r,i){let a=Zs();const l=EE(),d=EE();return t.forEach((p,y)=>{const b=r.get(y.key);i.has(y.key)&&(void 0===b||b.mutation instanceof Pc)?a=a.insert(y.key,y):void 0!==b&&(l.set(y.key,b.mutation.getFieldMask()),vE(b.mutation,y,b.mutation.getFieldMask(),br.now()))}),this.recalculateAndSaveOverlays(e,a).next(p=>(p.forEach((y,b)=>l.set(y,b)),t.forEach((y,b)=>{var T;return d.set(y,new EK(b,null!==(T=l.get(y))&&void 0!==T?T:null))}),d))}recalculateAndSaveOverlays(e,t){const r=EE();let i=new Ur((l,d)=>l-d),a=cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const d of l)d.keys().forEach(p=>{const y=t.get(p);if(null===y)return;let b=r.get(p)||Ao.empty();b=d.applyToLocalView(y,b),r.set(p,b);const T=(i.get(d.batchId)||cn()).add(p);i=i.insert(d.batchId,T)})}).next(()=>{const l=[],d=i.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),y=p.key,b=p.value,T=HU();b.forEach(M=>{if(!a.has(M)){const P=PU(t.get(M),r.get(M));null!==P&&T.set(M,P),a=a.add(M)}}),l.push(this.documentOverlayCache.saveOverlays(e,y,T))}return he.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return ot.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):QR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):he.resolve(Qu());let d=-1,p=a;return l.next(y=>he.forEach(y,(b,T)=>(d<T.largestBatchId&&(d=T.largestBatchId),a.get(b)?he.resolve():this.getBaseDocument(e,b,T).next(M=>{p=p.insert(b,M)}))).next(()=>this.populateOverlays(e,y,a)).next(()=>this.computeViews(e,p,y,cn())).next(b=>({batchId:d,changes:$U(b)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ot(t)).next(r=>{let i=wE();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=wE();return this.indexManager.getCollectionParents(e,i).next(l=>he.forEach(l,d=>{const p=(y=t,b=d.child(i),new kc(b,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt));var y,b;return this.getDocumentsMatchingCollectionQuery(e,p,r).next(y=>{y.forEach((b,T)=>{a=a.insert(b,T)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((d,p)=>{const y=p.getKey();null===i.get(y)&&(i=i.insert(y,or.newInvalidDocument(y)))});let l=wE();return i.forEach((d,p)=>{const y=a.get(d);void 0!==y&&vE(y.mutation,p,Ao.empty(),br.now()),JR(t,p)&&(l=l.insert(d,p))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):he.resolve(or.newInvalidDocument(t))}}class IK{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return he.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:Ti(r.createTime)}),he.resolve()}getNamedQuery(e,t){return he.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:uN(r.bundledQuery),readTime:Ti(r.readTime)}),he.resolve();var r}}class bK{constructor(){this.overlays=new Ur(ot.comparator),this.es=new Map}getOverlay(e,t){return he.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Qu();return he.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ue(e,t,a)}),he.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.es.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(r)),he.resolve()}getOverlaysForCollection(e,t,r){const i=Qu(),a=t.length+1,l=new ot(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const p=d.getNext().value,y=p.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===a&&p.largestBatchId>r&&i.set(p.getKey(),p)}return he.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Ur((y,b)=>y-b);const l=this.overlays.getIterator();for(;l.hasNext();){const y=l.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let b=a.get(y.largestBatchId);null===b&&(b=Qu(),a=a.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const d=Qu(),p=a.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((y,b)=>d.set(y,b)),!(d.size()>=i)););return he.resolve(d)}ue(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new aN(t,r));let a=this.es.get(t);void 0===a&&(a=cn(),this.es.set(t,a)),this.es.set(t,a.add(r.key))}}class dN{constructor(){this.ns=new Zn(Si.ss),this.rs=new Zn(Si.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new Si(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new Si(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new ot(new Dn([])),r=new Si(t,e),i=new Si(t,e+1),a=[];return this.rs.forEachInRange([r,i],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new ot(new Dn([])),r=new Si(t,e),i=new Si(t,e+1);let a=cn();return this.rs.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new Si(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Si{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return ot.comparator(e.key,t.key)||nn(e._s,t._s)}static os(e,t){return nn(e._s,t._s)||ot.comparator(e.key,t.key)}}class CK{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new Zn(Si.ss)}checkEmpty(e){return he.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ws;this.ws++;const l=new sN(a,t,r,i);this.mutationQueue.push(l);for(const d of i)this.gs=this.gs.add(new Si(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return he.resolve(l)}lookupMutationBatch(e,t){return he.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ps(t+1),a=i<0?0:i;return he.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return he.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return he.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Si(t,0),i=new Si(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],l=>{const d=this.ys(l._s);a.push(d)}),he.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Zn(nn);return t.forEach(i=>{const a=new Si(i,0),l=new Si(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],d=>{r=r.add(d._s)})}),he.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;ot.isDocumentKey(a)||(a=a.child(""));const l=new Si(new ot(a),0);let d=new Zn(nn);return this.gs.forEachWhile(p=>{const y=p.key.path;return!!r.isPrefixOf(y)&&(y.length===i&&(d=d.add(p._s)),!0)},l),he.resolve(this.Is(d))}Is(e){const t=[];return e.forEach(r=>{const i=this.ys(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){zt(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return he.forEach(t.mutations,i=>{const a=new Si(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new Si(t,0),i=this.gs.firstAfterOrEqual(r);return he.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return he.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class TK{constructor(e){this.Es=e,this.docs=new Ur(ot.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return he.resolve(r?r.document.mutableCopy():or.newInvalidDocument(t))}getEntries(e,t){let r=Zs();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():or.newInvalidDocument(i))}),he.resolve(r)}getAllFromCollection(e,t,r){let i=Zs();const a=new ot(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:p}}=l.getNext();if(!t.isPrefixOf(d.path))break;d.path.length>t.length+1||HR(JL(p),r)<=0||(i=i.insert(p.key,p.mutableCopy()))}return he.resolve(i)}getAllFromCollectionGroup(e,t,r,i){wt()}As(e,t){return he.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new DK(this)}getSize(e){return he.resolve(this.size)}}class DK extends MB{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),he.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class SK{constructor(e){this.persistence=e,this.Rs=new Ch(t=>Bp(t),mE),this.lastRemoteSnapshotVersion=Ht.min(),this.highestTargetId=0,this.bs=0,this.Ps=new dN,this.targetCount=0,this.vs=Kp.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,i)=>t(i)),he.resolve()}getLastRemoteSnapshotVersion(e){return he.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return he.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),he.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),he.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Kp(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,he.resolve()}updateTargetData(e,t){return this.Dn(t),he.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,he.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Rs.forEach((l,d)=>{d.sequenceNumber<=t&&null===r.get(d.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),i++)}),he.waitFor(a).next(()=>i)}getTargetCount(e){return he.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return he.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),he.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),he.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),he.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return he.resolve(r)}containsKey(e,t){return he.resolve(this.Ps.containsKey(t))}}class OB{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new qs(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new SK(this),this.indexManager=new hK,this.remoteDocumentCache=new TK(r=>this.referenceDelegate.xs(r)),this.It=new hB(t),this.Ns=new IK(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bK,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new CK(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){ze("MemoryPersistence","Starting transaction:",e);const i=new AK(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(a=>this.referenceDelegate.Ms(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Os(e,t){return he.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class AK extends tU{constructor(e){super(),this.currentSequenceNumber=e}}class jT{constructor(e){this.persistence=e,this.Fs=new dN,this.$s=null}static Bs(e){return new jT(e)}get Ls(){if(this.$s)return this.$s;throw wt()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),he.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),he.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),he.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ls.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Ms(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return he.forEach(this.Ls,r=>{const i=ot.fromPath(r);return this.Us(e,i).next(a=>{a||t.removeEntry(i,Ht.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return he.or([()=>he.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Os(e,t)])}}class MK{constructor(e){this.It=e}$(e,t,r,i){const a=new ET("createOrUpgrade",t);var d;r<1&&i>=1&&(e.createObjectStore("owner"),(d=e).createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",aB,{unique:!0}),d.createObjectStore("documentMutations"),FB(e),function(d){d.createObjectStore("remoteDocuments")}(e));let l=he.resolve();return r<3&&i>=3&&(0!==r&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),FB(e)),l=l.next(()=>function(d){const p=d.store("targetGlobal"),y={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ht.min().toTimestamp(),targetCount:0};return p.put("targetGlobalKey",y)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(d,p){return p.store("mutations").W().next(y=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",aB,{unique:!0});const b=p.store("mutations"),T=y.map(M=>b.put(M));return he.waitFor(T)})}(e,a))),l=l.next(()=>{!function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.qs(a))),r<6&&i>=6&&(l=l.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(a)))),r<7&&i>=7&&(l=l.next(()=>this.Gs(a))),r<8&&i>=8&&(l=l.next(()=>this.Qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.js(a))),r<11&&i>=11&&(l=l.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(d){const p=d.createObjectStore("documentOverlays",{keyPath:eK});p.createIndex("collectionPathOverlayIndex",tK,{unique:!1}),p.createIndex("collectionGroupOverlayIndex",nK,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(d){const p=d.createObjectStore("remoteDocumentsV14",{keyPath:H3});p.createIndex("documentKeyIndex",G3),p.createIndex("collectionGroupIndex",W3)}(e)).next(()=>this.Ws(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.zs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:Y3}).createIndex("sequenceNumberIndex",Q3,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:X3}).createIndex("documentKeyIndex",J3,{unique:!1})}(e))),l}Ks(e){let t=0;return e.store("remoteDocuments").Z((r,i)=>{t+=UT(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>he.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",l).next(d=>he.forEach(d,p=>{zt(p.userId===a.userId);const y=Gp(this.It,p);return CB(e,a.userId,y).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.Z((l,d)=>{const p=new Dn(l),y=[0,ms(p)];a.push(t.get(y).next(b=>b?he.resolve():t.put({targetId:0,path:ms(p),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>he.waitFor(a))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:Z3});const r=t.store("collectionParents"),i=new cN,a=l=>{if(i.add(l)){const d=l.lastSegment(),p=l.popLast();return r.put({collectionId:d,parent:ms(p)})}};return t.store("remoteDocuments").Z({X:!0},(l,d)=>{const p=new Dn(l);return a(p.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([l,d,p],y)=>{const b=Ju(d);return a(b.popLast())}))}js(e){const t=e.store("targets");return t.Z((r,i)=>{const a=AE(i),l=pB(this.It,a);return t.put(l)})}Ws(e,t){const r=t.store("remoteDocuments"),i=[];return r.Z((a,l)=>{const d=t.store("remoteDocumentsV14"),p=(y=l,y.document?new ot(Dn.fromString(y.document.name).popFirst(5)):y.noDocument?ot.fromSegments(y.noDocument.path):y.unknownDocument?ot.fromSegments(y.unknownDocument.path):wt()).path.toArray();var y;const b={prefixPath:p.slice(0,p.length-2),collectionGroup:p[p.length-2],documentId:p[p.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(d.put(b))}).next(()=>he.waitFor(i))}zs(e,t){const r=t.store("mutations"),i=xB(this.It),a=new OB(jT.Bs,this.It.re);return r.W().next(l=>{const d=new Map;return l.forEach(p=>{var y;let b=null!==(y=d.get(p.userId))&&void 0!==y?y:cn();Gp(this.It,p).keys().forEach(T=>b=b.add(T)),d.set(p.userId,b)}),he.forEach(d,(p,y)=>{const b=new bi(y),T=OT.oe(this.It,b),M=a.getIndexManager(b),P=BT.oe(b,this.It,M,a.referenceDelegate);return new PB(i,P,T,M).recalculateAndSaveOverlaysForDocumentKeys(new iN(t,qs.at),p).next()})})}}function FB(n){n.createObjectStore("targetDocuments",{keyPath:q3}).createIndex("documentTargetsIndex",K3,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",z3,{unique:!0}),n.createObjectStore("targetGlobal")}const hN="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class fN{constructor(e,t,r,i,a,l,d,p,y,b,T=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Hs=a,this.window=l,this.document=d,this.Js=y,this.Ys=b,this.Xs=T,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=M=>Promise.resolve(),!fN.C())throw new Ve(ve.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new yK(this,i),this.ii=t+"main",this.It=new hB(p),this.ri=new eu(this.ii,this.Xs,new MK(this.It)),this.Cs=new pK(this.referenceDelegate,this.It),this.remoteDocumentCache=xB(this.It),this.Ns=new oK,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===b&&Kr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ve(ve.FAILED_PRECONDITION,hN);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new qs(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var r=(0,be.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,be.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,be.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$T(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(yh(e))return ze("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ze("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return PE(e).get("owner").next(t=>he.resolve(this.mi(t)))}gi(e){return $T(e).delete(this.clientId)}yi(){var e=this;return(0,be.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Di(r,"clientMetadata");return i.W().next(a=>{const l=e.Ii(a,18e5),d=a.filter(p=>-1===l.indexOf(p));return he.forEach(d,p=>i.delete(p.clientId)).next(()=>d)})}).catch(()=>[]);if(e.oi)for(const r of t)e.oi.removeItem(e.Ti(r.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?he.resolve(!0):PE(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new Ve(ve.FAILED_PRECONDITION,hN);return!1}}return!(!this.networkEnabled||!this.inForeground)||$T(e).W().next(r=>void 0===this.Ii(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,d=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&d)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&ze("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,be.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new iN(t,qs.at);return e._i(r).next(()=>e.gi(r))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(r=>this.pi(r.updateTimeMs,t)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>$T(e).W().next(t=>this.Ii(t,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return BT.oe(e,this.It,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fK(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return OT.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,t,r){ze("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Xs)?iK:14===l?dB:13===l?cB:12===l?rK:11===l?lB:void wt();var l;let d;return this.ri.runTransaction(e,i,a,p=>(d=new iN(p,this.Ss?this.Ss.next():qs.at),"readwrite-primary"===t?this.fi(d).next(y=>!!y||this.di(d)).next(y=>{if(!y)throw Kr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new Ve(ve.FAILED_PRECONDITION,eU);return r(d)}).next(y=>this.wi(d).next(()=>y)):this.Vi(d).next(()=>r(d)))).then(p=>(d.raiseOnCommittedEvent(),p))}Vi(e){return PE(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ve(ve.FAILED_PRECONDITION,hN)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return PE(e).put("owner",t)}static C(){return eu.C()}_i(e){const t=PE(e);return t.get("owner").next(r=>this.mi(r)?(ze("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):he.resolve())}pi(e,t){const r=Date.now();return!(e<r-t||e>r&&(Kr(`Detected an update time that is in the future: ${e} > ${r}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,k.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const r=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return ze("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Kr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Kr("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function PE(n){return Di(n,"owner")}function $T(n){return Di(n,"clientMetadata")}function pN(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class gN{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=i}static Ci(e,t){let r=cn(),i=cn();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new gN(e,t.fromCache,r,i)}}class LB{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.ki(e,t).next(a=>a||this.Mi(e,t,i,r)).next(a=>a||this.Oi(e,t))}ki(e,t){if(IU(t))return he.resolve(null);let r=Ks(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=ST(t,null,"F"),r=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=cn(...a);return this.Ni.getDocuments(e,l).next(d=>this.indexManager.getMinOffset(e,r).next(p=>{const y=this.Fi(t,d);return this.$i(t,y,l,p.readTime)?this.ki(e,ST(t,null,"F")):this.Bi(e,y,t,p)}))})))}Mi(e,t,r,i){return IU(t)||i.isEqual(Ht.min())?this.Oi(e,t):this.Ni.getDocuments(e,r).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,r,i)?this.Oi(e,t):(VR()<=er.in.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),XR(t)),this.Bi(e,l,t,XL(i,-1)))})}Fi(e,t){let r=new Zn(TU(e));return t.forEach((i,a)=>{JR(e,a)&&(r=r.add(a))}),r}$i(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Oi(e,t){return VR()<=er.in.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",XR(t)),this.Ni.getDocumentsMatchingQuery(e,t,So.min())}Bi(e,t,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class xK{constructor(e,t,r,i){this.persistence=e,this.Li=t,this.It=i,this.Ui=new Ur(nn),this.qi=new Ch(a=>Bp(a),mE),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PB(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}function UB(n,e,t,r){return new xK(n,e,t,r)}function BB(n,e){return mN.apply(this,arguments)}function mN(){return mN=(0,be.Z)(function*(n,e){const t=ut(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],d=[];let p=cn();for(const y of i){l.push(y.batchId);for(const b of y.mutations)p=p.add(b.key)}for(const y of a){d.push(y.batchId);for(const b of y.mutations)p=p.add(b.key)}return t.localDocuments.getDocuments(r,p).next(y=>({ji:y,removedBatchIds:l,addedBatchIds:d}))})})}),mN.apply(this,arguments)}function RK(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,d,p,y){const b=p.batch,T=b.keys();let M=he.resolve();return T.forEach(P=>{M=M.next(()=>y.getEntry(d,P)).next(U=>{const ee=p.docVersions.get(P);zt(null!==ee),U.version.compareTo(ee)<0&&(b.applyToRemoteDocument(U,p),U.isValidDocument()&&(U.setReadTime(p.commitVersion),y.addEntry(U)))})}),M.next(()=>l.mutationQueue.removeMutationBatch(d,b))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let d=cn();for(let p=0;p<l.mutationResults.length;++p)l.mutationResults[p].transformResults.length>0&&(d=d.add(l.batch.mutations[p].key));return d}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function VB(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function NK(n,e){const t=ut(n),r=e.snapshotVersion;let i=t.Ui;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});i=t.Ui;const d=[];e.targetChanges.forEach((b,T)=>{const M=i.get(T);if(!M)return;d.push(t.Cs.removeMatchingKeys(a,b.removedDocuments,T).next(()=>t.Cs.addMatchingKeys(a,b.addedDocuments,T)));let P=M.withSequenceNumber(a.currentSequenceNumber);var U,ee,oe;e.targetMismatches.has(T)?P=P.withResumeToken(pi.EMPTY_BYTE_STRING,Ht.min()).withLastLimboFreeSnapshotVersion(Ht.min()):b.resumeToken.approximateByteSize()>0&&(P=P.withResumeToken(b.resumeToken,r)),i=i.insert(T,P),ee=P,oe=b,(0===(U=M).resumeToken.approximateByteSize()||ee.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=3e8||oe.addedDocuments.size+oe.modifiedDocuments.size+oe.removedDocuments.size>0)&&d.push(t.Cs.updateTargetData(a,P))});let p=Zs(),y=cn();if(e.documentUpdates.forEach(b=>{e.resolvedLimboDocuments.has(b)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,b))}),d.push(jB(a,l,e.documentUpdates).next(b=>{p=b.Wi,y=b.zi})),!r.isEqual(Ht.min())){const b=t.Cs.getLastRemoteSnapshotVersion(a).next(T=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,r));d.push(b)}return he.waitFor(d).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,p,y)).next(()=>p)}).then(a=>(t.Ui=i,a))}function jB(n,e,t){let r=cn(),i=cn();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Zs();return t.forEach((d,p)=>{const y=a.get(d);p.isFoundDocument()!==y.isFoundDocument()&&(i=i.add(d)),p.isNoDocument()&&p.version.isEqual(Ht.min())?(e.removeEntry(d,p.readTime),l=l.insert(d,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||0===p.version.compareTo(y.version)&&y.hasPendingWrites?(e.addEntry(p),l=l.insert(d,p)):ze("LocalStore","Ignoring outdated watch update for ",d,". Current version:",y.version," Watch version:",p.version)}),{Wi:l,zi:i}})}function kK(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function S_(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Cs.getTargetData(r,e).next(a=>a?(i=a,he.resolve(i)):t.Cs.allocateTargetId(r).next(l=>(i=new Th(e,l,0,r.currentSequenceNumber),t.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ui.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ui=t.Ui.insert(r.targetId,r),t.qi.set(e,r.targetId)),r})}function A_(n,e,t){return _N.apply(this,arguments)}function _N(){return _N=(0,be.Z)(function*(n,e,t){const r=ut(n),i=r.Ui.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!yh(l))throw l;ze("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ui=r.Ui.remove(e),r.qi.delete(i.target)}),_N.apply(this,arguments)}function HT(n,e,t){const r=ut(n);let i=Ht.min(),a=cn();return r.persistence.runTransaction("Execute query","readonly",l=>function(d,p,y){const b=ut(d),T=b.qi.get(y);return void 0!==T?he.resolve(b.Ui.get(T)):b.Cs.getTargetData(p,y)}(r,l,Ks(e)).next(d=>{if(d)return i=d.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(l,d.targetId).next(p=>{a=p})}).next(()=>r.Li.getDocumentsMatchingQuery(l,e,t?i:Ht.min(),t?a:cn())).next(d=>(GB(r,CU(e),d),{documents:d,Hi:a})))}function $B(n,e){const t=ut(n),r=ut(t.Cs),i=t.Ui.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.se(a,e).next(l=>l?l.target:null))}function HB(n,e){const t=ut(n),r=t.Ki.get(e)||Ht.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Gi.getAllFromCollectionGroup(i,e,XL(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(GB(t,e,i),i))}function GB(n,e,t){let r=Ht.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ki.set(e,r)}function yN(){return yN=(0,be.Z)(function*(n,e,t,r){const i=ut(n);let a=cn(),l=Zs();for(const y of t){const b=e.Ji(y.metadata.name);y.document&&(a=a.add(b));const T=e.Yi(y);T.setReadTime(e.Xi(y.metadata.readTime)),l=l.insert(b,T)}const d=i.Gi.newChangeBuffer({trackRemovals:!0}),p=yield S_(i,(y=r,Ks(__(Dn.fromString(`__bundle__/docs/${y}`)))));var y;return i.persistence.runTransaction("Apply bundle documents","readwrite",y=>jB(y,d,l).next(b=>(d.apply(y),b)).next(b=>i.Cs.removeMatchingKeysForTargetId(y,p.targetId).next(()=>i.Cs.addMatchingKeys(y,a,p.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(y,b.Wi,b.zi)).next(()=>b.Wi)))}),yN.apply(this,arguments)}function OK(n,e){return vN.apply(this,arguments)}function vN(){return vN=(0,be.Z)(function*(n,e,t=cn()){const r=yield S_(n,Ks(uN(e.bundledQuery))),i=ut(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=Ti(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ns.saveNamedQuery(a,e);const d=r.withResumeToken(pi.EMPTY_BYTE_STRING,l);return i.Ui=i.Ui.insert(d.targetId,d),i.Cs.updateTargetData(a,d).next(()=>i.Cs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Cs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ns.saveNamedQuery(a,e))})}),vN.apply(this,arguments)}function WB(n,e){return`firestore_clients_${n}_${e}`}function zB(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function wN(n,e){return`firestore_targets_${n}_${e}`}class GT{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Zi(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Ve(i.error.code,i.error.message))),l?new GT(e,t,i.state,a):(Kr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class OE{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Zi(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Ve(r.error.code,r.error.message))),a?new OE(e,r.state,i):(Kr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class WT{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=RT();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=aU(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new WT(e,a):(Kr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class EN{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new EN(t.clientId,t.onlineState):(Kr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class IN{constructor(){this.activeTargetIds=RT()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bN{constructor(e,t,r,i,a){this.window=e,this.Hs=t,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Ur(nn),this.started=!1,this.cr=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=WB(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new IN),this.lr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,be.Z)(function*(){const t=yield e.syncEngine.vi();for(const i of t){if(i===e.sr)continue;const a=e.getItem(WB(e.persistenceKey,i));if(a){const l=WT.Zi(i,a);l&&(e.ur=e.ur.insert(l.clientId,l))}}e.gr();const r=e.storage.getItem(e.wr);if(r){const i=e.yr(r);i&&e.pr(i)}for(const i of e.cr)e.rr(i);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,r){this.Tr(e,t,r),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(wN(this.persistenceKey,e));if(r){const i=OE.Zi(e,r);i&&(t=i.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(wN(this.persistenceKey,e))}updateQueryState(e,t,r){this.Rr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Er(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ze("SharedClientState","READ",e,t),t}setItem(e,t){ze("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){ze("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(ze("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ar)return void Kr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,be.Z)(function*(){if(t.started){if(null!==r.key)if(t.lr.test(r.key)){if(null==r.newValue){const i=t.vr(r.key);return t.Vr(i,null)}{const i=t.Sr(r.key,r.newValue);if(i)return t.Vr(i.clientId,i)}}else if(t.dr.test(r.key)){if(null!==r.newValue){const i=t.Dr(r.key,r.newValue);if(i)return t.Cr(i)}}else if(t._r.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(r.key===t.wr){if(null!==r.newValue){const i=t.yr(r.newValue);if(i)return t.pr(i)}}else if(r.key===t.hr){const i=function(a){let l=qs.at;if(null!=a)try{const d=JSON.parse(a);zt("number"==typeof d),l=d}catch(d){Kr("SharedClientState","Failed to read sequence number from WebStorage",d)}return l}(r.newValue);i!==qs.at&&t.sequenceNumberHandler(i)}else if(r.key===t.mr){const i=t.Mr(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Or(a)))}}else t.cr.push(r)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,r){const i=new GT(this.currentUser,e,t,r),a=zB(this.persistenceKey,this.currentUser,e);this.setItem(a,i.tr())}Er(e){const t=zB(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,r){const i=wN(this.persistenceKey,e),a=new OE(e,t,r);this.setItem(i,a.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const r=this.vr(e);return WT.Zi(r,t)}Dr(e,t){const r=this.dr.exec(e),i=Number(r[1]);return GT.Zi(new bi(void 0!==r[2]?r[2]:null),i,t)}Nr(e,t){const r=this._r.exec(e),i=Number(r[1]);return OE.Zi(i,t)}yr(e){return EN.Zi(e)}Mr(e){return JSON.parse(e)}Cr(e){var t=this;return(0,be.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);ze("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),l=[],d=[];return a.forEach(p=>{i.has(p)||l.push(p)}),i.forEach(p=>{a.has(p)||d.push(p)}),this.syncEngine.Br(l,d).then(()=>{this.ur=r})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=RT();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class qB{constructor(){this.Lr=new IN,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,r){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new IN,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class FK{qr(e){}shutdown(){}}class KB{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const LK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class UK{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class BK extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(e,t,r,i,a){const l=this.ao(e,t);ze("RestConnection","Sending: ",l,r);const d={};return this.ho(d,i,a),this.lo(e,l,d,r).then(p=>(ze("RestConnection","Received: ",p),p),p=>{throw Np("RestConnection",`${e} failed with error: `,p,"url: ",l,"request:",r),p})}fo(e,t,r,i,a,l){return this.co(e,t,r,i,a)}ho(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+h_,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}ao(e,t){return`${this.oo}/v1/${t}:${LK[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,t,r,i){return new Promise((a,l)=>{const d=new Fq;d.listenOnce(kq.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case BR.NO_ERROR:const y=d.getResponseJson();ze("Connection","XHR received:",JSON.stringify(y)),a(y);break;case BR.TIMEOUT:ze("Connection",'RPC "'+e+'" timed out'),l(new Ve(ve.DEADLINE_EXCEEDED,"Request time out"));break;case BR.HTTP_ERROR:const b=d.getStatus();if(ze("Connection",'RPC "'+e+'" failed with status:',b,"response text:",d.getResponseText()),b>0){const T=d.getResponseJson().error;if(T&&T.status&&T.message){const M=function(P){const U=P.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(U)>=0?U:ve.UNKNOWN}(T.status);l(new Ve(M,T.message))}else l(new Ve(ve.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new Ve(ve.UNAVAILABLE,"Connection failed."));break;default:wt()}}finally{ze("Connection",'RPC "'+e+'" completed.')}});const p=JSON.stringify(i);d.send(t,"POST",p,r,15)})}_o(e,t,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Rq(),l=Nq(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(d.xmlHttpFactory=new Oq({})),this.ho(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const p=i.join("");ze("Connection","Creating WebChannel: "+p,d);const y=a.createWebChannel(p,d);let b=!1,T=!1;const M=new UK({Hr:U=>{T?ze("Connection","Not sending because WebChannel is closed:",U):(b||(ze("Connection","Opening WebChannel transport."),y.open(),b=!0),ze("Connection","WebChannel sending:",U),y.send(U))},Jr:()=>y.close()}),P=(U,ee,oe)=>{U.listen(ee,Ge=>{try{oe(Ge)}catch(Je){setTimeout(()=>{throw Je},0)}})};return P(y,yT.EventType.OPEN,()=>{T||ze("Connection","WebChannel transport opened.")}),P(y,yT.EventType.CLOSE,()=>{T||(T=!0,ze("Connection","WebChannel transport closed"),M.io())}),P(y,yT.EventType.ERROR,U=>{T||(T=!0,Np("Connection","WebChannel transport errored:",U),M.io(new Ve(ve.UNAVAILABLE,"The operation could not be completed")))}),P(y,yT.EventType.MESSAGE,U=>{var ee;if(!T){const oe=U.data[0];zt(!!oe);const Ge=oe,Je=Ge.error||(null===(ee=Ge[0])||void 0===ee?void 0:ee.error);if(Je){ze("Connection","WebChannel received error:",Je);const rt=Je.status;let et=function(Pt){const _n=ui[Pt];if(void 0!==_n)return VU(_n)}(rt),xt=Je.message;void 0===et&&(et=ve.INTERNAL,xt="Unknown error status: "+rt+" with message "+Je.message),T=!0,M.io(new Ve(et,xt)),y.close()}else ze("Connection","WebChannel received:",oe),M.ro(oe)}}),P(l,Pq.STAT_EVENT,U=>{U.stat===zL.PROXY?ze("Connection","Detected buffering proxy"):U.stat===zL.NOPROXY&&ze("Connection","Detected no buffering proxy")}),setTimeout(()=>{M.so()},0),M}}function ZB(){return typeof window<"u"?window:null}function zT(){return typeof document<"u"?document:null}function FE(n){return new x3(n,!0)}class CN{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Hs=e,this.timerId=t,this.wo=r,this.mo=i,this.yo=a,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const t=Math.floor(this.po+this.Ro()),r=Math.max(0,Date.now()-this.To),i=Math.max(0,t-r);i>0&&ze("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.po} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Io=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo)}bo(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}cancel(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}class YB{constructor(e,t,r,i,a,l,d,p){this.Hs=e,this.Po=r,this.vo=i,this.Vo=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new CN(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Mo()}stop(){var e=this;return(0,be.Z)(function*(){e.No()&&(yield e.close(0))})()}Oo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.Po,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,be.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var r=this;return(0,be.Z)(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==e?r.xo.reset():t&&t.code===ve.RESOURCE_EXHAUSTED?(Kr(t.toString()),Kr("Using maximum backoff delay to prevent overloading the backend."),r.xo.Eo()):t&&t.code===ve.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.So===t&&this.Go(r,i)},r=>{e(()=>{const i=new Ve(ve.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(i)})})}Go(e,t){const r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.Qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Mo(){var e=this;this.state=5,this.xo.Ao((0,be.Z)(function*(){e.state=0,e.start()}))}Qo(e){return ze("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class VK extends YB{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.It=a}jo(e,t){return this.Vo._o("Listen",e,t)}onMessage(e){this.xo.reset();const t=function k3(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(p=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===p?1:"REMOVE"===p?2:"CURRENT"===p?3:"RESET"===p?4:wt(),i=e.targetChange.targetIds||[],a=function(p,y){return p.gt?(zt(void 0===y||"string"==typeof y),pi.fromBase64String(y||"")):(zt(void 0===y||y instanceof Uint8Array),pi.fromUint8Array(y||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&function(p){const y=void 0===p.code?ve.UNKNOWN:VU(p.code);return new Ve(y,p.message||"")}(l);t=new WU(r,i,a,d||null)}else if("documentChange"in e){const r=e.documentChange,i=Xu(n,r.document.name),a=Ti(r.document.updateTime),l=new Bi({mapValue:{fields:r.document.fields}}),d=or.newFoundDocument(i,a,l);t=new NT(r.targetIds||[],r.removedTargetIds||[],d.key,d)}else if("documentDelete"in e){const r=e.documentDelete,i=Xu(n,r.document),a=r.readTime?Ti(r.readTime):Ht.min(),l=or.newNoDocument(i,a);t=new NT([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=Xu(n,r.document);t=new NT([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return wt();{const r=e.filter,a=new I3(r.count||0);t=new GU(r.targetId,a)}}var p;return t}(this.It,e),r=function(i){if(!("targetChange"in i))return Ht.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ht.min():a.readTime?Ti(a.readTime):Ht.min()}(e);return this.listener.Wo(t,r)}zo(e){const t={};t.database=DE(this.It),t.addTarget=function(i,a){let l;const d=a.target;return l=TT(d)?{documents:tB(i,d)}:{query:nB(i,d)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=ZU(i,a.resumeToken):a.snapshotVersion.compareTo(Ht.min())>0&&(l.readTime=CE(i,a.snapshotVersion.toTimestamp())),l}(this.It,e);const r=function O3(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return wt()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Bo(t)}Ho(e){const t={};t.database=DE(this.It),t.removeTarget=e,this.Bo(t)}}class jK extends YB{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.It=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,t){return this.Vo._o("Write",e,t)}onMessage(e){if(zt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function P3(n,e){return n&&n.length>0?(zt(void 0!==e),n.map(t=>function(r,i){let a=Ti(r.updateTime?r.updateTime:i);return a.isEqual(Ht.min())&&(a=Ti(i)),new v3(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Ti(e.commitTime);return this.listener.Zo(r,t)}return zt(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=DE(this.It),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>SE(this.It,r))};this.Bo(t)}}class $K extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.Vo=r,this.It=i,this.nu=!1}su(){if(this.nu)throw new Ve(ve.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,t,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.Vo.co(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ve(ve.UNKNOWN,i.toString())})}fo(e,t,r,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.Vo.fo(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ve(ve.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class HK{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Kr(t),this.ou=!1):ze("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class GK{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.qr(d=>{r.enqueueAndForget((0,be.Z)(function*(){var p;Ah(l)&&(ze("RemoteStore","Restarting streams for network reachability change."),yield(p=(0,be.Z)(function*(y){const b=ut(y);b._u.add(4),yield M_(b),b.gu.set("Unknown"),b._u.delete(4),yield LE(b)}),function(y){return p.apply(this,arguments)})(l))}))}),this.gu=new HK(r,i)}}function LE(n){return TN.apply(this,arguments)}function TN(){return TN=(0,be.Z)(function*(n){if(Ah(n))for(const e of n.wu)yield e(!0)}),TN.apply(this,arguments)}function M_(n){return DN.apply(this,arguments)}function DN(){return DN=(0,be.Z)(function*(n){for(const e of n.wu)yield e(!1)}),DN.apply(this,arguments)}function qT(n,e){const t=ut(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),MN(t)?AN(t):R_(t).ko()&&SN(t,e))}function UE(n,e){const t=ut(n),r=R_(t);t.du.delete(e),r.ko()&&QB(t,e),0===t.du.size&&(r.ko()?r.Fo():Ah(t)&&t.gu.set("Unknown"))}function SN(n,e){n.yu.Ot(e.targetId),R_(n).zo(e)}function QB(n,e){n.yu.Ot(e),R_(n).Ho(e)}function AN(n){n.yu=new S3({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),se:e=>n.du.get(e)||null}),R_(n).start(),n.gu.uu()}function MN(n){return Ah(n)&&!R_(n).No()&&n.du.size>0}function Ah(n){return 0===ut(n)._u.size}function XB(n){n.yu=void 0}function WK(n){return xN.apply(this,arguments)}function xN(){return xN=(0,be.Z)(function*(n){n.du.forEach((e,t)=>{SN(n,e)})}),xN.apply(this,arguments)}function zK(n,e){return RN.apply(this,arguments)}function RN(){return RN=(0,be.Z)(function*(n,e){XB(n),MN(n)?(n.gu.hu(e),AN(n)):n.gu.set("Unknown")}),RN.apply(this,arguments)}function qK(n,e,t){return NN.apply(this,arguments)}function NN(){return NN=(0,be.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof WU&&2===e.state&&e.cause)try{yield(r=(0,be.Z)(function*(i,a){const l=a.cause;for(const d of a.targetIds)i.du.has(d)&&(yield i.remoteSyncer.rejectListen(d,l),i.du.delete(d),i.yu.removeTarget(d))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){ze("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield KT(n,r)}else if(e instanceof NT?n.yu.Gt(e):e instanceof GU?n.yu.Yt(e):n.yu.Wt(e),!t.isEqual(Ht.min()))try{const r=yield VB(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.yu.te(a);return l.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const y=i.du.get(p);y&&i.du.set(p,y.withResumeToken(d.resumeToken,a))}}),l.targetMismatches.forEach(d=>{const p=i.du.get(d);if(!p)return;i.du.set(d,p.withResumeToken(pi.EMPTY_BYTE_STRING,p.snapshotVersion)),QB(i,d);const y=new Th(p.target,d,1,p.sequenceNumber);SN(i,y)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){ze("RemoteStore","Failed to raise snapshot:",r),yield KT(n,r)}var r}),NN.apply(this,arguments)}function KT(n,e,t){return kN.apply(this,arguments)}function kN(){return kN=(0,be.Z)(function*(n,e,t){if(!yh(e))throw e;n._u.add(1),yield M_(n),n.gu.set("Offline"),t||(t=()=>VB(n.localStore)),n.asyncQueue.enqueueRetryable((0,be.Z)(function*(){ze("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield LE(n)}))}),kN.apply(this,arguments)}function JB(n,e){return e().catch(t=>KT(n,t,e))}function x_(n){return PN.apply(this,arguments)}function PN(){return PN=(0,be.Z)(function*(n){const e=ut(n),t=Mh(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;KK(e);)try{const i=yield kK(e.localStore,r);if(null===i){0===e.fu.length&&t.Fo();break}r=i.batchId,ZK(e,i)}catch(i){yield KT(e,i)}eV(e)&&tV(e)}),PN.apply(this,arguments)}function KK(n){return Ah(n)&&n.fu.length<10}function ZK(n,e){n.fu.push(e);const t=Mh(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function eV(n){return Ah(n)&&!Mh(n).No()&&n.fu.length>0}function tV(n){Mh(n).start()}function YK(n){return ON.apply(this,arguments)}function ON(){return ON=(0,be.Z)(function*(n){Mh(n).eu()}),ON.apply(this,arguments)}function QK(n){return FN.apply(this,arguments)}function FN(){return FN=(0,be.Z)(function*(n){const e=Mh(n);for(const t of n.fu)e.Xo(t.mutations)}),FN.apply(this,arguments)}function XK(n,e,t){return LN.apply(this,arguments)}function LN(){return LN=(0,be.Z)(function*(n,e,t){const r=n.fu.shift(),i=oN.from(r,e,t);yield JB(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield x_(n)}),LN.apply(this,arguments)}function JK(n,e){return UN.apply(this,arguments)}function UN(){return UN=(0,be.Z)(function*(n,e){var t;e&&Mh(n).Yo&&(yield(t=(0,be.Z)(function*(r,i){if(BU(a=i.code)&&a!==ve.ABORTED){const l=r.fu.shift();Mh(r).Oo(),yield JB(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield x_(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),eV(n)&&tV(n)}),UN.apply(this,arguments)}function nV(n,e){return BN.apply(this,arguments)}function BN(){return BN=(0,be.Z)(function*(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),ze("RemoteStore","RemoteStore received new credentials");const r=Ah(t);t._u.add(3),yield M_(t),r&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield LE(t)}),BN.apply(this,arguments)}function VN(n,e){return jN.apply(this,arguments)}function jN(){return jN=(0,be.Z)(function*(n,e){const t=ut(n);e?(t._u.delete(2),yield LE(t)):e||(t._u.add(2),yield M_(t),t.gu.set("Unknown"))}),jN.apply(this,arguments)}function R_(n){return n.pu||(n.pu=function(e,t,r){const i=ut(e);return i.su(),new VK(t,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:WK.bind(null,n),Zr:zK.bind(null,n),Wo:qK.bind(null,n)}),n.wu.push(function(){var e=(0,be.Z)(function*(t){t?(n.pu.Oo(),MN(n)?AN(n):n.gu.set("Unknown")):(yield n.pu.stop(),XB(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function Mh(n){return n.Iu||(n.Iu=function(e,t,r){const i=ut(e);return i.su(),new jK(t,i.Vo,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:YK.bind(null,n),Zr:JK.bind(null,n),tu:QK.bind(null,n),Zo:XK.bind(null,n)}),n.wu.push(function(){var e=(0,be.Z)(function*(t){t?(n.Iu.Oo(),yield x_(n)):(yield n.Iu.stop(),n.fu.length>0&&(ze("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class $N{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,d=new $N(e,t,l,i,a);return d.start(r),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ve(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N_(n,e){if(Kr("AsyncQueue",`${e}: ${n}`),yh(n))return new Ve(ve.UNAVAILABLE,`${e}: ${n}`);throw n}class k_{constructor(e){this.comparator=e?(t,r)=>e(t,r)||ot.comparator(t.key,r.key):(t,r)=>ot.comparator(t.key,r.key),this.keyedMap=wE(),this.sortedSet=new Ur(this.comparator)}static emptySet(e){return new k_(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof k_)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new k_;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class rV{constructor(){this.Tu=new Ur(ot.comparator)}track(e){const t=e.doc.key,r=this.Tu.get(t);r?0!==e.type&&3===r.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==r.type?this.Tu=this.Tu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Tu=this.Tu.remove(t):1===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):wt():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,r)=>{e.push(r)}),e}}class P_{constructor(e,t,r,i,a,l,d,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=p}static fromInitialDocuments(e,t,r,i){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new P_(e,t,k_.emptySet(t),a,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_E(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class e6{constructor(){this.Au=void 0,this.listeners=[]}}class t6{constructor(){this.queries=new Ch(e=>bU(e),_E),this.onlineState="Unknown",this.Ru=new Set}}function HN(n,e){return GN.apply(this,arguments)}function GN(){return GN=(0,be.Z)(function*(n,e){const t=ut(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new e6),i)try{a.Au=yield t.onListen(r)}catch(l){const d=N_(l,`Initialization of query '${XR(e.query)}' failed`);return void e.onError(d)}t.queries.set(r,a),a.listeners.push(e),e.bu(t.onlineState),a.Au&&e.Pu(a.Au)&&qN(t)}),GN.apply(this,arguments)}function WN(n,e){return zN.apply(this,arguments)}function zN(){return zN=(0,be.Z)(function*(n,e){const t=ut(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),zN.apply(this,arguments)}function n6(n,e){const t=ut(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const d of l.listeners)d.Pu(i)&&(r=!0);l.Au=i}}r&&qN(t)}function r6(n,e,t){const r=ut(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function qN(n){n.Ru.forEach(e=>{e.next()})}class KN{constructor(e,t,r){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new P_(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||!(this.options.Nu&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=P_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Vu=!0,this.vu.next(e)}}class i6{constructor(e,t){this.payload=e,this.byteLength=t}ku(){return"metadata"in this.payload}}class iV{constructor(e){this.It=e}Ji(e){return Xu(this.It,e)}Yi(e){return e.metadata.exists?eB(this.It,e.document,!1):or.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return Ti(e)}}class s6{constructor(e,t,r){this.Mu=e,this.localStore=t,this.It=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=sV(e)}Ou(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const r=Dn.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Fu(e){const t=new Map,r=new iV(this.It);for(const i of e)if(i.metadata.queries){const a=r.Ji(i.metadata.name);for(const l of i.metadata.queries){const d=(t.get(l)||cn()).add(a);t.set(l,d)}}return t}complete(){var e=this;return(0,be.Z)(function*(){const t=yield function PK(n,e,t,r){return yN.apply(this,arguments)}(e.localStore,new iV(e.It),e.documents,e.Mu.id),r=e.Fu(e.documents);for(const i of e.queries)yield OK(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,$u:e.collectionGroups,Bu:t}})()}}function sV(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class oV{constructor(e){this.key=e}}class aV{constructor(e){this.key=e}}class uV{constructor(e,t){this.query=e,this.Lu=t,this.Uu=null,this.current=!1,this.qu=cn(),this.mutatedKeys=cn(),this.Ku=TU(e),this.Gu=new k_(this.Ku)}get Qu(){return this.Lu}ju(e,t){const r=t?t.Wu:new rV,i=t?t.Gu:this.Gu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,d=!1;const p="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,y="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((b,T)=>{const M=i.get(b),P=JR(this.query,T)?T:null,U=!!M&&this.mutatedKeys.has(M.key),ee=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations);let oe=!1;M&&P?M.data.isEqual(P.data)?U!==ee&&(r.track({type:3,doc:P}),oe=!0):this.zu(M,P)||(r.track({type:2,doc:P}),oe=!0,(p&&this.Ku(P,p)>0||y&&this.Ku(P,y)<0)&&(d=!0)):!M&&P?(r.track({type:0,doc:P}),oe=!0):M&&!P&&(r.track({type:1,doc:M}),oe=!0,(p||y)&&(d=!0)),oe&&(P?(l=l.add(P),a=ee?a.add(b):a.delete(b)):(l=l.delete(b),a=a.delete(b)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const b="F"===this.query.limitType?l.last():l.first();l=l.delete(b.key),a=a.delete(b.key),r.track({type:1,doc:b})}return{Gu:l,Wu:r,$i:d,mutatedKeys:a}}zu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const a=e.Wu.Eu();a.sort((y,b)=>function(T,M){const P=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt()}};return P(T)-P(M)}(y.type,b.type)||this.Ku(y.doc,b.doc)),this.Hu(r);const l=t?this.Ju():[],d=0===this.qu.size&&this.current?1:0,p=d!==this.Uu;return this.Uu=d,0!==a.length||p?{snapshot:new P_(this.query,e.Gu,i,a,e.mutatedKeys,0===d,p,!1),Yu:l}:{Yu:l}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,Wu:new rV,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Yu:[]}}Xu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach(t=>this.Lu=this.Lu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Lu=this.Lu.delete(t)),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.qu;this.qu=cn(),this.Gu.forEach(r=>{this.Xu(r.key)&&(this.qu=this.qu.add(r.key))});const t=[];return e.forEach(r=>{this.qu.has(r)||t.push(new aV(r))}),this.qu.forEach(r=>{e.has(r)||t.push(new oV(r))}),t}Zu(e){this.Lu=e.Hi,this.qu=cn();const t=this.ju(e.documents);return this.applyChanges(t,!0)}tc(){return P_.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.Uu)}}class o6{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class a6{constructor(e){this.key=e,this.ec=!1}}class u6{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.nc={},this.sc=new Ch(d=>bU(d),_E),this.ic=new Map,this.rc=new Set,this.oc=new Ur(ot.comparator),this.uc=new Map,this.cc=new dN,this.ac={},this.hc=new Map,this.lc=Kp.vn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return!0===this.fc}}function l6(n,e){return ZN.apply(this,arguments)}function ZN(){return ZN=(0,be.Z)(function*(n,e){const t=yk(n);let r,i;const a=t.sc.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.tc();else{const l=yield S_(t.localStore,Ks(e));t.isPrimaryClient&&qT(t.remoteStore,l);const d=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield YN(t,e,r,"current"===d)}return i}),ZN.apply(this,arguments)}function YN(n,e,t,r){return QN.apply(this,arguments)}function QN(){return QN=(0,be.Z)(function*(n,e,t,r){n.dc=(b,T,M)=>{return(P=(0,be.Z)(function*(U,ee,oe,Ge){let Je=ee.view.ju(oe);Je.$i&&(Je=yield HT(U.localStore,ee.query,!1).then(({documents:xt})=>ee.view.ju(xt,Je)));const rt=Ge&&Ge.targetChanges.get(ee.targetId),et=ee.view.applyChanges(Je,U.isPrimaryClient,rt);return ak(U,ee.targetId,et.Yu),et.snapshot}),function(U,ee,oe,Ge){return P.apply(this,arguments)})(n,b,T,M);var P};const i=yield HT(n.localStore,e,!0),a=new uV(e,i.Hi),l=a.ju(i.documents),d=bE.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState),p=a.applyChanges(l,n.isPrimaryClient,d);ak(n,t,p.Yu);const y=new o6(e,t,a);return n.sc.set(e,y),n.ic.has(t)?n.ic.get(t).push(e):n.ic.set(t,[e]),p.snapshot}),QN.apply(this,arguments)}function c6(n,e){return XN.apply(this,arguments)}function XN(){return XN=(0,be.Z)(function*(n,e){const t=ut(n),r=t.sc.get(e),i=t.ic.get(r.targetId);if(i.length>1)return t.ic.set(r.targetId,i.filter(a=>!_E(a,e))),void t.sc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield A_(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),UE(t.remoteStore,r.targetId),O_(t,r.targetId)}).catch(_h))):(O_(t,r.targetId),yield A_(t.localStore,r.targetId,!0))}),XN.apply(this,arguments)}function JN(){return JN=(0,be.Z)(function*(n,e,t){const r=vk(n);try{const i=yield function(a,l){const d=ut(a),p=br.now(),y=l.reduce((M,P)=>M.add(P.key),cn());let b,T;return d.persistence.runTransaction("Locally write mutations","readwrite",M=>{let P=Zs(),U=cn();return d.Gi.getEntries(M,y).next(ee=>{P=ee,P.forEach((oe,Ge)=>{Ge.isValidDocument()||(U=U.add(oe))})}).next(()=>d.localDocuments.getOverlayedDocuments(M,P)).next(ee=>{b=ee;const oe=[];for(const Ge of l){const Je=E3(Ge,b.get(Ge.key).overlayedDocument);null!=Je&&oe.push(new Pc(Ge.key,Je,pU(Je.value.mapValue),Cr.exists(!0)))}return d.mutationQueue.addMutationBatch(M,p,oe,l)}).next(ee=>{T=ee;const oe=ee.applyToLocalDocumentSet(b,U);return d.documentOverlayCache.saveOverlays(M,ee.batchId,oe)})}).then(()=>({batchId:T.batchId,changes:$U(b)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,d){let p=a.ac[a.currentUser.toKey()];p||(p=new Ur(nn)),p=p.insert(l,d),a.ac[a.currentUser.toKey()]=p}(r,i.batchId,t),yield Oc(r,i.changes),yield x_(r.remoteStore)}catch(i){const a=N_(i,"Failed to persist write");t.reject(a)}}),JN.apply(this,arguments)}function lV(n,e){return ek.apply(this,arguments)}function ek(){return ek=(0,be.Z)(function*(n,e){const t=ut(n);try{const r=yield NK(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.uc.get(a);l&&(zt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.ec=!0:i.modifiedDocuments.size>0?zt(l.ec):i.removedDocuments.size>0&&(zt(l.ec),l.ec=!1))}),yield Oc(t,r,e)}catch(r){yield _h(r)}}),ek.apply(this,arguments)}function cV(n,e,t){const r=ut(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.sc.forEach((a,l)=>{const d=l.view.bu(e);d.snapshot&&i.push(d.snapshot)}),function(a,l){const d=ut(a);d.onlineState=l;let p=!1;d.queries.forEach((y,b)=>{for(const T of b.listeners)T.bu(l)&&(p=!0)}),p&&qN(d)}(r.eventManager,e),i.length&&r.nc.Wo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function h6(n,e,t){return tk.apply(this,arguments)}function tk(){return tk=(0,be.Z)(function*(n,e,t){const r=ut(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.uc.get(e),a=i&&i.key;if(a){let l=new Ur(ot.comparator);l=l.insert(a,or.newNoDocument(a,Ht.min()));const d=cn().add(a),p=new IE(Ht.min(),new Map,new Zn(nn),l,d);yield lV(r,p),r.oc=r.oc.remove(a),r.uc.delete(e),uk(r)}else yield A_(r.localStore,e,!1).then(()=>O_(r,e,t)).catch(_h)}),tk.apply(this,arguments)}function f6(n,e){return nk.apply(this,arguments)}function nk(){return nk=(0,be.Z)(function*(n,e){const t=ut(n),r=e.batch.batchId;try{const i=yield RK(t.localStore,e);ok(t,r,null),sk(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Oc(t,i)}catch(i){yield _h(i)}}),nk.apply(this,arguments)}function p6(n,e,t){return rk.apply(this,arguments)}function rk(){return rk=(0,be.Z)(function*(n,e,t){const r=ut(n);try{const i=yield function(a,l){const d=ut(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let y;return d.mutationQueue.lookupMutationBatch(p,l).next(b=>(zt(null!==b),y=b.keys(),d.mutationQueue.removeMutationBatch(p,b))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,y,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,y)).next(()=>d.localDocuments.getDocuments(p,y))})}(r.localStore,e);ok(r,e,t),sk(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Oc(r,i)}catch(i){yield _h(i)}}),rk.apply(this,arguments)}function ik(){return ik=(0,be.Z)(function*(n,e){const t=ut(n);Ah(t.remoteStore)||ze("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=ut(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",d=>l.mutationQueue.getHighestUnacknowledgedBatchId(d))}(t.localStore);if(-1===r)return void e.resolve();const i=t.hc.get(r)||[];i.push(e),t.hc.set(r,i)}catch(r){const i=N_(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),ik.apply(this,arguments)}function sk(n,e){(n.hc.get(e)||[]).forEach(t=>{t.resolve()}),n.hc.delete(e)}function ok(n,e,t){const r=ut(n);let i=r.ac[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.ac[r.currentUser.toKey()]=i}}function O_(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.ic.get(e))n.sc.delete(r),t&&n.nc._c(r,t);n.ic.delete(e),n.isPrimaryClient&&n.cc.ls(e).forEach(r=>{n.cc.containsKey(r)||dV(n,r)})}function dV(n,e){n.rc.delete(e.path.canonicalString());const t=n.oc.get(e);null!==t&&(UE(n.remoteStore,t),n.oc=n.oc.remove(e),n.uc.delete(t),uk(n))}function ak(n,e,t){for(const r of t)r instanceof oV?(n.cc.addReference(r.key,e),m6(n,r)):r instanceof aV?(ze("SyncEngine","Document no longer in limbo: "+r.key),n.cc.removeReference(r.key,e),n.cc.containsKey(r.key)||dV(n,r.key)):wt()}function m6(n,e){const t=e.key,r=t.path.canonicalString();n.oc.get(t)||n.rc.has(r)||(ze("SyncEngine","New document in limbo: "+t),n.rc.add(r),uk(n))}function uk(n){for(;n.rc.size>0&&n.oc.size<n.maxConcurrentLimboResolutions;){const e=n.rc.values().next().value;n.rc.delete(e);const t=new ot(Dn.fromString(e)),r=n.lc.next();n.uc.set(r,new a6(t)),n.oc=n.oc.insert(t,r),qT(n.remoteStore,new Th(Ks(__(t.path)),r,2,qs.at))}}function Oc(n,e,t){return lk.apply(this,arguments)}function lk(){return lk=(0,be.Z)(function*(n,e,t){const r=ut(n),i=[],a=[],l=[];var d;r.sc.isEmpty()||(r.sc.forEach((d,p)=>{l.push(r.dc(p,e,t).then(y=>{if(y){r.isPrimaryClient&&r.sharedClientState.updateQueryState(p.targetId,y.fromCache?"not-current":"current"),i.push(y);const b=gN.Ci(p.targetId,y);a.push(b)}}))}),yield Promise.all(l),r.nc.Wo(i),yield(d=(0,be.Z)(function*(p,y){const b=ut(p);try{yield b.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>he.forEach(y,M=>he.forEach(M.Si,P=>b.persistence.referenceDelegate.addReference(T,M.targetId,P)).next(()=>he.forEach(M.Di,P=>b.persistence.referenceDelegate.removeReference(T,M.targetId,P)))))}catch(T){if(!yh(T))throw T;ze("LocalStore","Failed to update sequence numbers: "+T)}for(const T of y){const M=T.targetId;if(!T.fromCache){const P=b.Ui.get(M),ee=P.withLastLimboFreeSnapshotVersion(P.snapshotVersion);b.Ui=b.Ui.insert(M,ee)}}}),function(p,y){return d.apply(this,arguments)})(r.localStore,a))}),lk.apply(this,arguments)}function _6(n,e){return ck.apply(this,arguments)}function ck(){return ck=(0,be.Z)(function*(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){ze("SyncEngine","User change. New user:",e.toKey());const r=yield BB(t.localStore,e);t.currentUser=e,(i=t).hc.forEach(l=>{l.forEach(d=>{d.reject(new Ve(ve.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.hc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Oc(t,r.ji)}var i}),ck.apply(this,arguments)}function y6(n,e){const t=ut(n),r=t.uc.get(e);if(r&&r.ec)return cn().add(r.key);{let i=cn();const a=t.ic.get(e);if(!a)return i;for(const l of a){const d=t.sc.get(l);i=i.unionWith(d.view.Qu)}return i}}function v6(n,e){return dk.apply(this,arguments)}function dk(){return dk=(0,be.Z)(function*(n,e){const t=ut(n),r=yield HT(t.localStore,e.query,!0),i=e.view.Zu(r);return t.isPrimaryClient&&ak(t,e.targetId,i.Yu),i}),dk.apply(this,arguments)}function w6(n,e){return hk.apply(this,arguments)}function hk(){return hk=(0,be.Z)(function*(n,e){const t=ut(n);return HB(t.localStore,e).then(r=>Oc(t,r))}),hk.apply(this,arguments)}function E6(n,e,t,r){return fk.apply(this,arguments)}function fk(){return fk=(0,be.Z)(function*(n,e,t,r){const i=ut(n),a=yield function(l,d){const p=ut(l),y=ut(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",b=>y.Tn(b,d).next(T=>T?p.localDocuments.getDocuments(b,T):he.resolve(null)))}(i.localStore,e);var d;null!==a?("pending"===t?yield x_(i.remoteStore):"acknowledged"===t||"rejected"===t?(ok(i,e,r||null),sk(i,e),d=e,ut(ut(i.localStore).mutationQueue).An(d)):wt(),yield Oc(i,a)):ze("SyncEngine","Cannot apply mutation batch with id: "+e)}),fk.apply(this,arguments)}function pk(){return pk=(0,be.Z)(function*(n,e){const t=ut(n);if(yk(t),vk(t),!0===e&&!0!==t.fc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield hV(t,r.toArray());t.fc=!0,yield VN(t.remoteStore,!0);for(const a of i)qT(t.remoteStore,a)}else if(!1===e&&!1!==t.fc){const r=[];let i=Promise.resolve();t.ic.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(O_(t,l),A_(t.localStore,l,!0))),UE(t.remoteStore,l)}),yield i,yield hV(t,r),function(a){const l=ut(a);l.uc.forEach((d,p)=>{UE(l.remoteStore,p)}),l.cc.fs(),l.uc=new Map,l.oc=new Ur(ot.comparator)}(t),t.fc=!1,yield VN(t.remoteStore,!1)}}),pk.apply(this,arguments)}function hV(n,e,t){return gk.apply(this,arguments)}function gk(){return gk=(0,be.Z)(function*(n,e,t){const r=ut(n),i=[],a=[];for(const l of e){let d;const p=r.ic.get(l);if(p&&0!==p.length){d=yield S_(r.localStore,Ks(p[0]));for(const y of p){const b=r.sc.get(y),T=yield v6(r,b);T.snapshot&&a.push(T.snapshot)}}else{const y=yield $B(r.localStore,l);d=yield S_(r.localStore,y),yield YN(r,fV(y),l,!1)}i.push(d)}return r.nc.Wo(a),i}),gk.apply(this,arguments)}function fV(n){return EU(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function b6(n){const e=ut(n);return ut(ut(e.localStore).persistence).vi()}function C6(n,e,t,r){return mk.apply(this,arguments)}function mk(){return mk=(0,be.Z)(function*(n,e,t,r){const i=ut(n);if(i.fc)return void ze("SyncEngine","Ignoring unexpected query state notification.");const a=i.ic.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield HB(i.localStore,CU(a[0])),d=IE.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield Oc(i,l,d);break}case"rejected":yield A_(i.localStore,e,!0),O_(i,e,r);break;default:wt()}}),mk.apply(this,arguments)}function T6(n,e,t){return _k.apply(this,arguments)}function _k(){return _k=(0,be.Z)(function*(n,e,t){const r=yk(n);if(r.fc){for(const i of e){if(r.ic.has(i)){ze("SyncEngine","Adding an already active target "+i);continue}const a=yield $B(r.localStore,i),l=yield S_(r.localStore,a);yield YN(r,fV(a),l.targetId,!1),qT(r.remoteStore,l)}for(const i of t)r.ic.has(i)&&(yield A_(r.localStore,i,!1).then(()=>{UE(r.remoteStore,i),O_(r,i)}).catch(_h))}}),_k.apply(this,arguments)}function yk(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=lV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=y6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=h6.bind(null,e),e.nc.Wo=n6.bind(null,e.eventManager),e.nc._c=r6.bind(null,e.eventManager),e}function vk(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p6.bind(null,e),e}class pV{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,be.Z)(function*(){t.It=FE(e.databaseInfo.databaseId),t.sharedClientState=t.mc(e),t.persistence=t.gc(e),yield t.persistence.start(),t.localStore=t.yc(e),t.gcScheduler=t.Ic(e,t.localStore),t.indexBackfillerScheduler=t.Tc(e,t.localStore)})()}Ic(e,t){return null}Tc(e,t){return null}yc(e){return UB(this.persistence,new LB,e.initialUser,this.It)}gc(e){return new OB(jT.Bs,this.It)}mc(e){return new qB}terminate(){var e=this;return(0,be.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class gV extends pV{constructor(e,t,r){super(),this.Ec=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,be.Z)(function*(){yield t().call(r,e),yield r.Ec.initialize(r,e),yield vk(r.Ec.syncEngine),yield x_(r.Ec.remoteStore),yield r.persistence.li(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}yc(e){return UB(this.persistence,new LB,e.initialUser,this.It)}Ic(e,t){return new mK(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Tc(e,t){const r=new Xq(t,this.persistence);return new Qq(e.asyncQueue,r)}gc(e){const t=pN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Ys.withCacheSize(this.cacheSizeBytes):Ys.DEFAULT;return new fN(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,ZB(),zT(),this.It,this.sharedClientState,!!this.forceOwnership)}mc(e){return new qB}}class S6 extends gV{constructor(e,t){super(e,t,!1),this.Ec=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,be.Z)(function*(){yield t().call(r,e);const i=r.Ec.syncEngine;r.sharedClientState instanceof bN&&(r.sharedClientState.syncEngine={Fr:E6.bind(null,i),$r:C6.bind(null,i),Br:T6.bind(null,i),vi:b6.bind(null,i),Or:w6.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.li(function(){var a=(0,be.Z)(function*(l){yield function I6(n,e){return pk.apply(this,arguments)}(r.Ec.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}mc(e){const t=ZB();if(!bN.C(t))throw new Ve(ve.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=pN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new bN(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class wk{initialize(e,t){var r=this;return(0,be.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>cV(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=_6.bind(null,r.syncEngine),yield VN(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new t6}createDatastore(e){const t=FE(e.databaseInfo.databaseId),r=new BK(e.databaseInfo);return new $K(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=d=>cV(this.syncEngine,d,0),l=KB.C()?new KB:new FK,new GK(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,d,p,y){const b=new u6(r,i,a,l,d,p);return y&&(b.fc=!0),b}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,be.Z)(function*(t){const r=ut(t);ze("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield M_(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function mV(n,e=10240){let t=0;return{read:()=>(0,be.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,be.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class ZT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ac(this.observer.next,e)}error(e){this.observer.error?this.Ac(this.observer.error,e):Kr("Uncaught Error in snapshot listener:",e)}Rc(){this.muted=!0}Ac(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class A6{constructor(e,t){this.bc=e,this.It=t,this.metadata=new Ci,this.buffer=new Uint8Array,this.Pc=new TextDecoder("utf-8"),this.vc().then(r=>{r&&r.ku()?this.metadata.resolve(r.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.payload)}`))},r=>this.metadata.reject(r))}close(){return this.bc.cancel()}getMetadata(){var e=this;return(0,be.Z)(function*(){return e.metadata.promise})()}wc(){var e=this;return(0,be.Z)(function*(){return yield e.getMetadata(),e.vc()})()}vc(){var e=this;return(0,be.Z)(function*(){const t=yield e.Vc();if(null===t)return null;const r=e.Pc.decode(t),i=Number(r);isNaN(i)&&e.Sc(`length string (${r}) is not valid number`);const a=yield e.Dc(i);return new i6(JSON.parse(a),t.length+i)})()}Cc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Vc(){var e=this;return(0,be.Z)(function*(){for(;e.Cc()<0&&!(yield e.xc()););if(0===e.buffer.length)return null;const t=e.Cc();t<0&&e.Sc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Dc(e){var t=this;return(0,be.Z)(function*(){for(;t.buffer.length<e;)(yield t.xc())&&t.Sc("Reached the end of bundle when more is expected.");const r=t.Pc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Sc(e){throw this.bc.cancel(),new Error(`Invalid bundle format: ${e}`)}xc(){var e=this;return(0,be.Z)(function*(){const t=yield e.bc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class M6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,be.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Ve(ve.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,be.Z)(function*(a,l){const d=ut(a),p=DE(d.It)+"/documents",y={documents:l.map(P=>TE(d.It,P))},b=yield d.fo("BatchGetDocuments",p,y,l.length),T=new Map;b.forEach(P=>{const U=function N3(n,e){return"found"in e?function(t,r){zt(!!r.found);const i=Xu(t,r.found.name),a=Ti(r.found.updateTime),l=new Bi({mapValue:{fields:r.found.fields}});return or.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){zt(!!r.missing),zt(!!r.readTime);const i=Xu(t,r.missing),a=Ti(r.readTime);return or.newNoDocument(i,a)}(n,e):wt()}(d.It,P);T.set(U.key.toString(),U)});const M=[];return l.forEach(P=>{const U=T.get(P.toString());zt(!!U),M.push(U)}),M}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new I_(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,be.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=ot.fromPath(i);e.mutations.push(new eN(a,e.precondition(a)))}),yield(r=(0,be.Z)(function*(i,a){const l=ut(i),d=DE(l.It)+"/documents",p={writes:a.map(y=>SE(l.It,y))};yield l.co("Commit",d,p)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw wt();t=Ht.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Ve(ve.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ht.min())?Cr.exists(!1):Cr.updateTime(t):Cr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ht.min()))throw new Ve(ve.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cr.updateTime(t)}return Cr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class x6{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.Nc=r.maxAttempts,this.xo=new CN(this.asyncQueue,"transaction_retry")}run(){this.Nc-=1,this.kc()}kc(){var e=this;this.xo.Ao((0,be.Z)(function*(){const t=new M6(e.datastore),r=e.Mc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Oc(a)}))}).catch(i=>{e.Oc(i)})}))}Mc(e){try{const t=this.updateFunction(e);return!dE(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Oc(e){this.Nc>0&&this.Fc(e)?(this.Nc-=1,this.asyncQueue.enqueueAndForget(()=>(this.kc(),Promise.resolve()))):this.deferred.reject(e)}Fc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!BU(t)}return!1}}class R6{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=bi.UNAUTHENTICATED,this.clientId=YL.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,be.Z)(function*(d){ze("FirestoreClient","Received user=",d.uid),yield a.authCredentialListener(d),a.user=d});return function(d){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(ze("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,be.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ve(ve.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,be.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=N_(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function _V(n,e){return Ek.apply(this,arguments)}function Ek(){return Ek=(0,be.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),ze("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,be.Z)(function*(a){r.isEqual(a)||(yield BB(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Ek.apply(this,arguments)}function yV(n,e){return Ik.apply(this,arguments)}function Ik(){return Ik=(0,be.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield bk(n);ze("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>nV(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>nV(e.remoteStore,a)),n.onlineComponents=e}),Ik.apply(this,arguments)}function bk(n){return Ck.apply(this,arguments)}function Ck(){return Ck=(0,be.Z)(function*(n){return n.offlineComponents||(ze("FirestoreClient","Using default OfflineComponentProvider"),yield _V(n,new pV)),n.offlineComponents}),Ck.apply(this,arguments)}function YT(n){return Tk.apply(this,arguments)}function Tk(){return Tk=(0,be.Z)(function*(n){return n.onlineComponents||(ze("FirestoreClient","Using default OnlineComponentProvider"),yield yV(n,new wk)),n.onlineComponents}),Tk.apply(this,arguments)}function vV(n){return bk(n).then(e=>e.persistence)}function QT(n){return bk(n).then(e=>e.localStore)}function wV(n){return YT(n).then(e=>e.remoteStore)}function Dk(n){return YT(n).then(e=>e.syncEngine)}function F_(n){return Sk.apply(this,arguments)}function Sk(){return Sk=(0,be.Z)(function*(n){const e=yield YT(n),t=e.eventManager;return t.onListen=l6.bind(null,e.syncEngine),t.onUnlisten=c6.bind(null,e.syncEngine),t}),Sk.apply(this,arguments)}function EV(n,e,t={}){const r=new Ci;return n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return function(i,a,l,d,p){const y=new ZT({next:T=>{a.enqueueAndForget(()=>WN(i,b));const M=T.docs.has(l);!M&&T.fromCache?p.reject(new Ve(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&T.fromCache&&d&&"server"===d.source?p.reject(new Ve(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(T)},error:T=>p.reject(T)}),b=new KN(__(l.path),y,{includeMetadataChanges:!0,Nu:!0});return HN(i,b)}(yield F_(n),n.asyncQueue,e,t,r)})),r.promise}function IV(n,e,t={}){const r=new Ci;return n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return function(i,a,l,d,p){const y=new ZT({next:T=>{a.enqueueAndForget(()=>WN(i,b)),T.fromCache&&"server"===d.source?p.reject(new Ve(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),b=new KN(l,y,{includeMetadataChanges:!0,Nu:!0});return HN(i,b)}(yield F_(n),n.asyncQueue,e,t,r)})),r.promise}const bV=new Map;function Ak(n,e,t){if(!t)throw new Ve(ve.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function CV(n,e,t,r){if(!0===e&&!0===r)throw new Ve(ve.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function TV(n){if(!ot.isDocumentKey(n))throw new Ve(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function DV(n){if(ot.isDocumentKey(n))throw new Ve(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function XT(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":wt()}function Tn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ve(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=XT(n);throw new Ve(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function SV(n,e){if(e<=0)throw new Ve(ve.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class AV{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Ve(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ve(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,CV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class BE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AV({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ve(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ve(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AV(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new Bq;switch(t.type){case"gapi":return new Hq(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ve(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=bV.get(e);t&&(ze("ComponentProvider","Removing Datastore"),bV.delete(e),t.terminate())}(this),Promise.resolve()}}class fr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new el(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fr(this.firestore,e,this._key)}}class os{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new os(this.firestore,e,this._query)}}class el extends os{constructor(e,t,r){super(e,t,__(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fr(this.firestore,null,new ot(e))}withConverter(e){return new el(this.firestore,e,this._path)}}function MV(n,e,...t){if(n=(0,k.m9)(n),Ak("collection","path",e),n instanceof BE){const r=Dn.fromString(e,...t);return DV(r),new el(n,null,r)}{if(!(n instanceof fr||n instanceof el))throw new Ve(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Dn.fromString(e,...t));return DV(r),new el(n.firestore,null,r)}}function JT(n,e,...t){if(n=(0,k.m9)(n),1===arguments.length&&(e=YL.R()),Ak("doc","path",e),n instanceof BE){const r=Dn.fromString(e,...t);return TV(r),new fr(n,null,new ot(r))}{if(!(n instanceof fr||n instanceof el))throw new Ve(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Dn.fromString(e,...t));return TV(r),new fr(n.firestore,n instanceof el?n.converter:null,new ot(r))}}function xV(n,e){return n=(0,k.m9)(n),e=(0,k.m9)(e),(n instanceof fr||n instanceof el)&&(e instanceof fr||e instanceof el)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function RV(n,e){return n=(0,k.m9)(n),e=(0,k.m9)(e),n instanceof os&&e instanceof os&&n.firestore===e.firestore&&_E(n._query,e._query)&&n.converter===e.converter}class $6{constructor(){this.$c=Promise.resolve(),this.Bc=[],this.Lc=!1,this.Uc=[],this.qc=null,this.Kc=!1,this.Gc=!1,this.Qc=[],this.xo=new CN(this,"async_queue_retry"),this.jc=()=>{const t=zT();t&&ze("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.bo()};const e=zT();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.jc)}get isShuttingDown(){return this.Lc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Wc(),this.zc(e)}enterRestrictedMode(e){if(!this.Lc){this.Lc=!0,this.Gc=e||!1;const t=zT();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.jc)}}enqueue(e){if(this.Wc(),this.Lc)return new Promise(()=>{});const t=new Ci;return this.zc(()=>this.Lc&&this.Gc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Bc.push(e),this.Hc()))}Hc(){var e=this;return(0,be.Z)(function*(){if(0!==e.Bc.length){try{yield e.Bc[0](),e.Bc.shift(),e.xo.reset()}catch(t){if(!yh(t))throw t;ze("AsyncQueue","Operation failed with retryable error: "+t)}e.Bc.length>0&&e.xo.Ao(()=>e.Hc())}})()}zc(e){const t=this.$c.then(()=>(this.Kc=!0,e().catch(r=>{throw this.qc=r,this.Kc=!1,Kr("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Kc=!1,r))));return this.$c=t,t}enqueueAfterDelay(e,t,r){this.Wc(),this.Qc.indexOf(e)>-1&&(t=0);const i=$N.createAndSchedule(this,e,t,r,a=>this.Jc(a));return this.Uc.push(i),i}Wc(){this.qc&&wt()}verifyOperationInProgress(){}Yc(){var e=this;return(0,be.Z)(function*(){let t;do{t=e.$c,yield t}while(t!==e.$c)})()}Xc(e){for(const t of this.Uc)if(t.timerId===e)return!0;return!1}Zc(e){return this.Yc().then(()=>{this.Uc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Uc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Yc()})}ta(e){this.Qc.push(e)}Jc(e){const t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}function Mk(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class H6{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ci,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Tr extends BE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new $6,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||NV(this),this._firestoreClient.terminate()}}function li(n){return n._firestoreClient||NV(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function NV(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new t3(n._databaseId,a,n._persistenceKey,(d=t).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,d.useFetchStreams));var a,d;n._firestoreClient=new R6(n._authCredentials,n._appCheckCredentials,n._queue,r)}function kV(n,e,t){const r=new Ci;return n.asyncQueue.enqueue((0,be.Z)(function*(){try{yield _V(n,t),yield yV(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===ve.FAILED_PRECONDITION||l.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;Np("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function PV(n){if(n._initialized||n._terminated)throw new Ve(ve.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Fc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ve(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Lr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new tl(pi.fromBase64String(e))}catch(t){throw new Ve(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new tl(pi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Yp{constructor(e){this._methodName=e}}class eD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return nn(this._lat,e._lat)||nn(this._long,e._long)}}const J6=/^__.*__$/;class e4{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Pc(e,this.data,this.fieldMask,t,this.fieldTransforms):new E_(e,this.data,t,this.fieldTransforms)}}class OV{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Pc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function FV(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt()}}class tD{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.It=r,this.ignoreUndefinedProperties=i,void 0===a&&this.ea(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get na(){return this.settings.na}sa(e){return new tD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ia(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.sa({path:r,ra:!1});return i.oa(e),i}ua(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.sa({path:r,ra:!1});return i.ea(),i}ca(e){return this.sa({path:void 0,ra:!0})}aa(e){return iD(e,this.settings.methodName,this.settings.ha||!1,this.path,this.settings.la)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ea(){if(this.path)for(let e=0;e<this.path.length;e++)this.oa(this.path.get(e))}oa(e){if(0===e.length)throw this.aa("Document fields must not be empty");if(FV(this.na)&&J6.test(e))throw this.aa('Document fields cannot begin and end with "__"')}}class t4{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=r||FE(e)}fa(e,t,r,i=!1){return new tD({na:e,methodName:t,la:r,path:Lr.emptyPath(),ra:!1,ha:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Qp(n){const e=n._freezeSettings(),t=FE(n._databaseId);return new t4(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nD(n,e,t,r,i,a={}){const l=n.fa(a.merge||a.mergeFields?2:0,e,t,i);kk("Data must be an object, but it was:",l,r);const d=BV(r,l);let p,y;if(a.merge)p=new Ao(l.fieldMask),y=l.fieldTransforms;else if(a.mergeFields){const b=[];for(const T of a.mergeFields){const M=Pk(e,T,t);if(!l.contains(M))throw new Ve(ve.INVALID_ARGUMENT,`Field '${M}' is specified in your field mask but missing from your input data.`);jV(b,M)||b.push(M)}p=new Ao(b),y=l.fieldTransforms.filter(T=>p.covers(T.field))}else p=null,y=l.fieldTransforms;return new e4(new Bi(d),p,y)}class VE extends Yp{_toFieldTransform(e){if(2!==e.na)throw e.aa(1===e.na?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof VE}}function LV(n,e,t){return new tD({na:3,la:e.settings.la,methodName:n._methodName,ra:t},e.databaseId,e.It,e.ignoreUndefinedProperties)}class xk extends Yp{_toFieldTransform(e){return new yE(e.path,new v_)}isEqual(e){return e instanceof xk}}class n4 extends Yp{constructor(e,t){super(e),this.da=t}_toFieldTransform(e){const t=LV(this,e,!0),r=this.da.map(a=>Xp(a,t)),i=new Vp(r);return new yE(e.path,i)}isEqual(e){return this===e}}class r4 extends Yp{constructor(e,t){super(e),this.da=t}_toFieldTransform(e){const t=LV(this,e,!0),r=this.da.map(a=>Xp(a,t)),i=new jp(r);return new yE(e.path,i)}isEqual(e){return this===e}}class i4 extends Yp{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=new w_(e.It,AU(e.It,this._a));return new yE(e.path,t)}isEqual(e){return this===e}}function Rk(n,e,t,r){const i=n.fa(1,e,t);kk("Data must be an object, but it was:",i,r);const a=[],l=Bi.empty();Op(r,(p,y)=>{const b=rD(e,p,t);y=(0,k.m9)(y);const T=i.ua(b);if(y instanceof VE)a.push(b);else{const M=Xp(y,T);null!=M&&(a.push(b),l.set(b,M))}});const d=new Ao(a);return new OV(l,d,i.fieldTransforms)}function Nk(n,e,t,r,i,a){const l=n.fa(1,e,t),d=[Pk(e,r,t)],p=[i];if(a.length%2!=0)throw new Ve(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let M=0;M<a.length;M+=2)d.push(Pk(e,a[M])),p.push(a[M+1]);const y=[],b=Bi.empty();for(let M=d.length-1;M>=0;--M)if(!jV(y,d[M])){const P=d[M];let U=p[M];U=(0,k.m9)(U);const ee=l.ua(P);if(U instanceof VE)y.push(P);else{const oe=Xp(U,ee);null!=oe&&(y.push(P),b.set(P,oe))}}const T=new Ao(y);return new OV(b,T,l.fieldTransforms)}function UV(n,e,t,r=!1){return Xp(t,n.fa(r?4:3,e))}function Xp(n,e){if(VV(n=(0,k.m9)(n)))return kk("Unsupported field value:",e,n),BV(n,e);if(n instanceof Yp)return function(t,r){if(!FV(r.na))throw r.aa(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.aa(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.ra&&4!==e.na)throw e.aa("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let d=Xp(l,r.ca(a));null==d&&(d={nullValue:"NULL_VALUE"}),i.push(d),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,k.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return AU(r.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=br.fromDate(t);return{timestampValue:CE(r.It,i)}}if(t instanceof br){const i=new br(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:CE(r.It,i)}}if(t instanceof eD)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof tl)return{bytesValue:ZU(r.It,t._byteString)};if(t instanceof fr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.aa(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:tN(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.aa(`Unsupported field value: ${XT(t)}`)}(n,e)}function BV(n,e){const t={};return iU(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Op(n,(r,i)=>{const a=Xp(i,e.ia(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function VV(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof br||n instanceof eD||n instanceof tl||n instanceof fr||n instanceof Yp)}function kk(n,e,t){if(!VV(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=XT(t);throw e.aa("an object"===r?n+" a custom object":n+" "+r)}var r}function Pk(n,e,t){if((e=(0,k.m9)(e))instanceof Fc)return e._internalPath;if("string"==typeof e)return rD(n,e);throw iD("Field path arguments must be of type string or ",n,!1,void 0,t)}const s4=new RegExp("[~\\*/\\[\\]]");function rD(n,e,t){if(e.search(s4)>=0)throw iD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fc(...e.split("."))._internalPath}catch{throw iD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function iD(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(a||l)&&(p+=" (found",a&&(p+=` in field ${r}`),l&&(p+=` in document ${i}`),p+=")"),new Ve(ve.INVALID_ARGUMENT,d+n+p)}function jV(n,e){return n.some(t=>t.isEqual(e))}class jE{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new fr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new o4(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(sD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class o4 extends jE{data(){return super.data()}}function sD(n,e){return"string"==typeof e?rD(n,e):e instanceof Fc?e._internalPath:e._delegate._internalPath}class Jp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Lc extends jE{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $E(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(sD("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class $E extends Lc{data(e={}){return super.data(e)}}class xh{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Jp(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new $E(this._firestore,this._userDataWriter,r.key,r,new Jp(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new $E(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Jp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const d=new $E(r._firestore,r._userDataWriter,l.doc.key,l.doc,new Jp(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,y=-1;return 0!==l.type&&(p=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),y=a.indexOf(l.doc.key)),{type:a4(l.type),doc:d,oldIndex:p,newIndex:y}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function a4(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt()}}function $V(n,e){return n instanceof Lc&&e instanceof Lc?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof xh&&e instanceof xh&&n._firestore===e._firestore&&RV(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function HV(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ve(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class HE{}function Rh(n,...e){for(const t of e)n=t._apply(n);return n}class u4 extends HE{constructor(e,t,r){super(),this.wa=e,this.ma=t,this.ga=r,this.type="where"}_apply(e){const t=Qp(e.firestore),r=function(i,a,l,d,p,y,b){let T;if(p.isKeyField()){if("array-contains"===y||"array-contains-any"===y)throw new Ve(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${y}' queries on documentId().`);if("in"===y||"not-in"===y){ZV(b,y);const P=[];for(const U of b)P.push(KV(d,i,U));T={arrayValue:{values:P}}}else T=KV(d,i,b)}else"in"!==y&&"not-in"!==y&&"array-contains-any"!==y||ZV(b,y),T=UV(l,"where",b,"in"===y||"not-in"===y);const M=Vi.create(p,y,T);return function(P,U){if(U.dt()){const oe=YR(P);if(null!==oe&&!oe.isEqual(U.field))throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${oe.toString()}' and '${U.field.toString()}'`);const Ge=ZR(P);null!==Ge&&YV(0,U.field,Ge)}const ee=function(oe,Ge){for(const Je of oe.filters)if(Ge.indexOf(Je.op)>=0)return Je.op;return null}(P,function(oe){switch(oe){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(U.op));if(null!==ee)throw new Ve(ve.INVALID_ARGUMENT,ee===U.op?`Invalid query. You cannot use more than one '${U.op.toString()}' filter.`:`Invalid query. You cannot use '${U.op.toString()}' filters with '${ee.toString()}' filters.`)}(i,M),M}(e._query,0,t,e.firestore._databaseId,this.wa,this.ma,this.ga);return new os(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new kc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class c4 extends HE{constructor(e,t){super(),this.wa=e,this.ya=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Ve(ve.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ve(ve.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new m_(i,a);return function(d,p){if(null===ZR(d)){const y=YR(d);null!==y&&YV(0,y,p.field)}}(r,l),l}(e._query,this.wa,this.ya);return new os(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new kc(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class GV extends HE{constructor(e,t,r){super(),this.type=e,this.pa=t,this.Ia=r}_apply(e){return new os(e.firestore,e.converter,ST(e._query,this.pa,this.Ia))}}class WV extends HE{constructor(e,t,r){super(),this.type=e,this.Ta=t,this.Ea=r}_apply(e){const t=qV(e,this.type,this.Ta,this.Ea);return new os(e.firestore,e.converter,(i=t,new kc((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class zV extends HE{constructor(e,t,r){super(),this.type=e,this.Ta=t,this.Ea=r}_apply(e){const t=qV(e,this.type,this.Ta,this.Ea);return new os(e.firestore,e.converter,(i=t,new kc((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function qV(n,e,t,r){if(t[0]=(0,k.m9)(t[0]),t[0]instanceof jE)return function(i,a,l,d,p){if(!d)throw new Ve(ve.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const y=[];for(const b of y_(i))if(b.field.isKeyField())y.push(Up(a,d.key));else{const T=d.data.field(b.field);if(zR(T))throw new Ve(ve.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+b.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===T){const M=b.field.canonicalString();throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${M}' (used as the orderBy) does not exist.`)}y.push(T)}return new bh(y,p)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Qp(n.firestore);return function(a,l,d,p,y,b){const T=a.explicitOrderBy;if(y.length>T.length)throw new Ve(ve.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const M=[];for(let P=0;P<y.length;P++){const U=y[P];if(T[P].field.isKeyField()){if("string"!=typeof U)throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof U}`);if(!QR(a)&&-1!==U.indexOf("/"))throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${U}' contains a slash.`);const ee=a.path.child(Dn.fromString(U));if(!ot.isDocumentKey(ee))throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${ee}' is not because it contains an odd number of segments.`);const oe=new ot(ee);M.push(Up(l,oe))}else{const ee=UV(d,p,U);M.push(ee)}}return new bh(M,b)}(n._query,n.firestore._databaseId,i,e,t,r)}}function KV(n,e,t){if("string"==typeof(t=(0,k.m9)(t))){if(""===t)throw new Ve(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!QR(e)&&-1!==t.indexOf("/"))throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Dn.fromString(t));if(!ot.isDocumentKey(r))throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Up(n,new ot(r))}if(t instanceof fr)return Up(n,t._key);throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${XT(t)}.`)}function ZV(n,e){if(!Array.isArray(n)||0===n.length)throw new Ve(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Ve(ve.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function YV(n,e,t){if(!t.isEqual(e))throw new Ve(ve.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const y4={maxAttempts:5};class Ok{convertValue(e,t="none"){switch(Lp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw wt()}}convertObject(e,t){const r={};return Op(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new eD(Br(e.latitude),Br(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=oU(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(cE(e));default:return null}}convertTimestamp(e){const t=vh(e);return new br(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Dn.fromString(e);zt(sB(r));const i=new wh(r.get(1),r.get(3)),a=new ot(r.popFirst(5));return i.isEqual(t)||Kr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function oD(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class v4 extends Ok{constructor(e){super(),this.firestore=e}convertBytes(e){return new tl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new fr(this.firestore,null,t)}}class QV{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Qp(e)}set(e,t,r){this._verifyNotCommitted();const i=Nh(e,this._firestore),a=oD(i.converter,t,r),l=nD(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,Cr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=Nh(e,this._firestore);let l;return l="string"==typeof(t=(0,k.m9)(t))||t instanceof Fc?Nk(this._dataReader,"WriteBatch.update",a._key,t,r,i):Rk(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,Cr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Nh(e,this._firestore);return this._mutations=this._mutations.concat(new I_(t._key,Cr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ve(ve.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Nh(n,e){if((n=(0,k.m9)(n)).firestore!==e)throw new Ve(ve.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class eg extends Ok{constructor(e){super(),this.firestore=e}convertBytes(e){return new tl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new fr(this.firestore,null,t)}}function XV(n,e,t){n=Tn(n,fr);const r=Tn(n.firestore,Tr),i=oD(n.converter,e,t);return L_(r,[nD(Qp(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Cr.none())])}function JV(n,e,t,...r){n=Tn(n,fr);const i=Tn(n.firestore,Tr),a=Qp(i);let l;return l="string"==typeof(e=(0,k.m9)(e))||e instanceof Fc?Nk(a,"updateDoc",n._key,e,t,r):Rk(a,"updateDoc",n._key,e),L_(i,[l.toMutation(n._key,Cr.exists(!0))])}function e2(n,...e){var t,r,i;n=(0,k.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||Mk(e[l])||(a=e[l],l++);const d={includeMetadataChanges:a.includeMetadataChanges};if(Mk(e[l])){const T=e[l];e[l]=null===(t=T.next)||void 0===t?void 0:t.bind(T),e[l+1]=null===(r=T.error)||void 0===r?void 0:r.bind(T),e[l+2]=null===(i=T.complete)||void 0===i?void 0:i.bind(T)}let p,y,b;if(n instanceof fr)y=Tn(n.firestore,Tr),b=__(n._key.path),p={next:T=>{e[l]&&e[l](Fk(y,n,T))},error:e[l+1],complete:e[l+2]};else{const T=Tn(n,os);y=Tn(T.firestore,Tr),b=T._query;const M=new eg(y);p={next:P=>{e[l]&&e[l](new xh(y,M,T,P))},error:e[l+1],complete:e[l+2]},HV(n._query)}return function(T,M,P,U){const ee=new ZT(U),oe=new KN(M,ee,P);return T.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return HN(yield F_(T),oe)})),()=>{ee.Rc(),T.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return WN(yield F_(T),oe)}))}}(li(y),b,d,p)}function L_(n,e){return function(t,r){const i=new Ci;return t.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return function d6(n,e,t){return JN.apply(this,arguments)}(yield Dk(t),r,i)})),i.promise}(li(n),e)}function Fk(n,e,t){const r=t.docs.get(e._key),i=new eg(n);return new Lc(n,i,e._key,r,new Jp(t.hasPendingWrites,t.fromCache),e.converter)}class M4 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Qp(e)}get(e){const t=Nh(e,this._firestore),r=new v4(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return wt();const a=i[0];if(a.isFoundDocument())return new jE(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new jE(this._firestore,r,t._key,null,t.converter);throw wt()})}set(e,t,r){const i=Nh(e,this._firestore),a=oD(i.converter,t,r),l=nD(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=Nh(e,this._firestore);let l;return l="string"==typeof(t=(0,k.m9)(t))||t instanceof Fc?Nk(this._dataReader,"Transaction.update",a._key,t,r,i):Rk(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=Nh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Nh(e,this._firestore),r=new eg(this._firestore);return super.get(e).then(i=>new Lc(this._firestore,r,t._key,i._document,new Jp(!1,!1),t.converter))}}function Lk(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ve("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function n2(){if(typeof Uint8Array>"u")throw new Ve("unimplemented","Uint8Arrays are not available in this environment.")}function r2(){if(!function Jq(){return typeof atob<"u"}())throw new Ve("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){h_=Jn.SDK_VERSION,(0,Jn._registerComponent)(new Ms.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),l=new Tr(new jq(t.getProvider("auth-internal")),new Gq(t.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ve(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wh(d.options.projectId,p)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),(0,Jn.registerVersion)(qL,"3.5.0",n),(0,Jn.registerVersion)(qL,"3.5.0","esm2017")}();class GE{constructor(e){this._delegate=e}static fromBase64String(e){return r2(),new GE(tl.fromBase64String(e))}static fromUint8Array(e){return n2(),new GE(tl.fromUint8Array(e))}toBase64(){return r2(),this._delegate.toBase64()}toUint8Array(){return n2(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Uk(n){return function U4(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class B4{enableIndexedDbPersistence(e,t){return function W6(n,e){PV(n=Tn(n,Tr));const t=li(n),r=n._freezeSettings(),i=new wk;return kV(t,i,new gV(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function z6(n){PV(n=Tn(n,Tr));const e=li(n),t=n._freezeSettings(),r=new wk;return kV(e,r,new S6(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function q6(n){if(n._initialized&&!n._terminated)throw new Ve(ve.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Ci;return n._queue.enqueueAndForgetEvenWhileRestricted((0,be.Z)(function*(){try{yield(t=(0,be.Z)(function*(r){if(!eu.C())return Promise.resolve();const i=r+"main";yield eu.delete(i)}),function(r){return t.apply(this,arguments)})(pN(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class i2{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof wh||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Np("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function V6(n,e,t,r={}){var i;const a=(n=Tn(n,BE))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&Np("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,d;if("string"==typeof r.mockUserToken)l=r.mockUserToken,d=bi.MOCK_USER;else{l=(0,k.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new Ve(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new bi(p)}n._authCredentials=new Vq(new KL(l,d))}}(this._delegate,e,t,r)}enableNetwork(){return function Z6(n){return function N6(n){return n.asyncQueue.enqueue((0,be.Z)(function*(){const e=yield vV(n),t=yield wV(n);return e.setNetworkEnabled(!0),function(r){const i=ut(r);return i._u.delete(0),LE(i)}(t)}))}(li(n=Tn(n,Tr)))}(this._delegate)}disableNetwork(){return function Y6(n){return function k6(n){return n.asyncQueue.enqueue((0,be.Z)(function*(){const e=yield vV(n),t=yield wV(n);return e.setNetworkEnabled(!1),(r=(0,be.Z)(function*(i){const a=ut(i);a._u.add(0),yield M_(a),a.gu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(li(n=Tn(n,Tr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,CV("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function K6(n){return function(e){const t=new Ci;return e.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return function g6(n,e){return ik.apply(this,arguments)}(yield Dk(e),t)})),t.promise}(li(n=Tn(n,Tr)))}(this._delegate)}onSnapshotsInSync(e){return function A4(n,e){return function F6(n,e){const t=new ZT(e);return n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return r=yield F_(n),i=t,ut(r).Ru.add(i),void i.next();var r,i})),()=>{t.Rc(),n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return r=yield F_(n),i=t,void ut(r).Ru.delete(i);var r,i}))}}(li(n=Tn(n,Tr)),Mk(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Ve("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new U_(this,MV(this._delegate,e))}catch(t){throw _s(t,"collection()","Firestore.collection()")}}doc(e){try{return new fa(this,JT(this._delegate,e))}catch(t){throw _s(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ys(this,function j6(n,e){if(n=Tn(n,BE),Ak("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ve(ve.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new os(n,null,(t=e,new kc(Dn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw _s(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function x4(n,e,t){n=Tn(n,Tr);const r=Object.assign(Object.assign({},y4),t);return function(i){if(i.maxAttempts<1)throw new Ve(ve.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function L6(n,e,t){const r=new Ci;return n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){const i=yield(a=n,YT(a).then(l=>l.datastore));var a;new x6(n.asyncQueue,i,t,e,r).run()})),r.promise}(li(n),i=>e(new M4(n,i)),r)}(this._delegate,t=>e(new s2(this,t)))}batch(){return li(this._delegate),new o2(new QV(this._delegate,e=>L_(this._delegate,e)))}loadBundle(e){return function Q6(n,e){const t=li(n=Tn(n,Tr)),r=new H6;return function U6(n,e,t,r){const i=function(a,l){let d;return d="string"==typeof a?(new TextEncoder).encode(a):a,p=function(p,y){if(p instanceof Uint8Array)return mV(p,y);if(p instanceof ArrayBuffer)return mV(new Uint8Array(p),y);if(p instanceof ReadableStream)return p.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(d),new A6(p,l);var p}(t,FE(e));n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){!function D6(n,e,t){const r=ut(n);var i;(i=(0,be.Z)(function*(a,l,d){try{const p=yield l.getMetadata();if(yield function(M,P){const U=ut(M),ee=Ti(P.createTime);return U.persistence.runTransaction("hasNewerBundle","readonly",oe=>U.Ns.getBundleMetadata(oe,P.id)).then(oe=>!!oe&&oe.createTime.compareTo(ee)>=0)}(a.localStore,p))return yield l.close(),d._completeWith({taskState:"Success",documentsLoaded:(M=p).totalDocuments,bytesLoaded:M.totalBytes,totalDocuments:M.totalDocuments,totalBytes:M.totalBytes}),Promise.resolve(new Set);d._updateProgress(sV(p));const y=new s6(p,a.localStore,l.It);let b=yield l.wc();for(;b;){const M=yield y.Ou(b);M&&d._updateProgress(M),b=yield l.wc()}const T=yield y.complete();return yield Oc(a,T.Bu,void 0),yield function(M,P){const U=ut(M);return U.persistence.runTransaction("Save bundle","readwrite",ee=>U.Ns.saveBundleMetadata(ee,P))}(a.localStore,p),d._completeWith(T.progress),Promise.resolve(T.$u)}catch(p){return Np("SyncEngine",`Loading bundle failed with ${p}`),d._failWith(p),Promise.resolve(new Set)}var M}),function(a,l,d){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield Dk(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function X6(n,e){return function B6(n,e){return n.asyncQueue.enqueue((0,be.Z)(function*(){return function(t,r){const i=ut(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ns.getNamedQuery(a,r))}(yield QT(n),e)}))}(li(n=Tn(n,Tr)),e).then(t=>t?new os(n,null,t.query):null)}(this._delegate,e).then(t=>t?new ys(this,t):null)}}class aD extends Ok{constructor(e){super(),this.firestore=e}convertBytes(e){return new GE(new tl(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return fa.forKey(t,this.firestore,null)}}class s2{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new aD(e)}get(e){const t=ng(e);return this._delegate.get(t).then(r=>new WE(this._firestore,new Lc(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=ng(e);return r?(Lk("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=ng(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=ng(e);return this._delegate.delete(t),this}}class o2{constructor(e){this._delegate=e}set(e,t,r){const i=ng(e);return r?(Lk("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=ng(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=ng(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class tg{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new $E(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zE(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=tg.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new tg(e,new aD(e),t),i.set(t,a)),a}}tg.INSTANCES=new WeakMap;class fa{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new aD(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Ve("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new fa(t,new fr(t._delegate,r,new ot(e)))}static forKey(e,t,r){return new fa(t,new fr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new U_(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new U_(this.firestore,MV(this._delegate,e))}catch(t){throw _s(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,k.m9)(e))instanceof fr&&xV(this._delegate,e)}set(e,t){t=Lk("DocumentReference.set",t);try{return t?XV(this._delegate,e,t):XV(this._delegate,e)}catch(r){throw _s(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?JV(this._delegate,e):JV(this._delegate,e,t,...r)}catch(i){throw _s(i,"updateDoc()","DocumentReference.update()")}}delete(){return function D4(n){return L_(Tn(n.firestore,Tr),[new I_(n._key,Cr.none())])}(this._delegate)}onSnapshot(...e){const t=a2(e),r=u2(e,i=>new WE(this.firestore,new Lc(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return e2(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function E4(n){n=Tn(n,fr);const e=Tn(n.firestore,Tr),t=li(e),r=new eg(e);return function P6(n,e){const t=new Ci;return n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return(r=(0,be.Z)(function*(i,a,l){try{const d=yield function(p,y){const b=ut(p);return b.persistence.runTransaction("read document","readonly",T=>b.localDocuments.getDocument(T,y))}(i,a);d.isFoundDocument()?l.resolve(d):d.isNoDocument()?l.resolve(null):l.reject(new Ve(ve.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const p=N_(d,`Failed to get document '${a} from cache`);l.reject(p)}}),function(i,a,l){return r.apply(this,arguments)})(yield QT(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Lc(e,r,n._key,i,new Jp(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function I4(n){n=Tn(n,fr);const e=Tn(n.firestore,Tr);return EV(li(e),n._key,{source:"server"}).then(t=>Fk(e,n,t))}(this._delegate):function w4(n){n=Tn(n,fr);const e=Tn(n.firestore,Tr);return EV(li(e),n._key).then(t=>Fk(e,n,t))}(this._delegate),t.then(r=>new WE(this.firestore,new Lc(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new fa(this.firestore,this._delegate.withConverter(e?tg.getInstance(this.firestore,e):null))}}function _s(n,e,t){return n.message=n.message.replace(e,t),n}function a2(n){for(const e of n)if("object"==typeof e&&!Uk(e))return e;return{}}function u2(n,e){var t,r;let i;return i=Uk(n[0])?n[0]:Uk(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class WE{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new fa(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return $V(this._delegate,e._delegate)}}class zE extends WE{data(e){const t=this._delegate.data(e);return function Uq(n,e){n||wt()}(void 0!==t),t}}class ys{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new aD(e)}where(e,t,r){try{return new ys(this.firestore,Rh(this._delegate,function l4(n,e,t){const r=e,i=sD("where",n);return new u4(i,r,t)}(e,t,r)))}catch(i){throw _s(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new ys(this.firestore,Rh(this._delegate,function d4(n,e="asc"){const t=e,r=sD("orderBy",n);return new c4(r,t)}(e,t)))}catch(r){throw _s(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new ys(this.firestore,Rh(this._delegate,function h4(n){return SV("limit",n),new GV("limit",n,"F")}(e)))}catch(t){throw _s(t,"limit()","Query.limit()")}}limitToLast(e){try{return new ys(this.firestore,Rh(this._delegate,function f4(n){return SV("limitToLast",n),new GV("limitToLast",n,"L")}(e)))}catch(t){throw _s(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new ys(this.firestore,Rh(this._delegate,function p4(...n){return new WV("startAt",n,!0)}(...e)))}catch(t){throw _s(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new ys(this.firestore,Rh(this._delegate,function g4(...n){return new WV("startAfter",n,!1)}(...e)))}catch(t){throw _s(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new ys(this.firestore,Rh(this._delegate,function m4(...n){return new zV("endBefore",n,!1)}(...e)))}catch(t){throw _s(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new ys(this.firestore,Rh(this._delegate,function _4(...n){return new zV("endAt",n,!0)}(...e)))}catch(t){throw _s(t,"endAt()","Query.endAt()")}}isEqual(e){return RV(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function C4(n){n=Tn(n,os);const e=Tn(n.firestore,Tr),t=li(e),r=new eg(e);return function O6(n,e){const t=new Ci;return n.asyncQueue.enqueueAndForget((0,be.Z)(function*(){return(r=(0,be.Z)(function*(i,a,l){try{const d=yield HT(i,a,!0),p=new uV(a,d.Hi),y=p.ju(d.documents),b=p.applyChanges(y,!1);l.resolve(b.snapshot)}catch(d){const p=N_(d,`Failed to execute query '${a} against cache`);l.reject(p)}}),function(i,a,l){return r.apply(this,arguments)})(yield QT(n),e,t);var r})),t.promise}(t,n._query).then(i=>new xh(e,r,n,i))}(this._delegate):"server"===e?.source?function T4(n){n=Tn(n,os);const e=Tn(n.firestore,Tr),t=li(e),r=new eg(e);return IV(t,n._query,{source:"server"}).then(i=>new xh(e,r,n,i))}(this._delegate):function b4(n){n=Tn(n,os);const e=Tn(n.firestore,Tr),t=li(e),r=new eg(e);return HV(n._query),IV(t,n._query).then(i=>new xh(e,r,n,i))}(this._delegate),t.then(r=>new Bk(this.firestore,new xh(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=a2(e),r=u2(e,i=>new Bk(this.firestore,new xh(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return e2(this._delegate,t,r)}withConverter(e){return new ys(this.firestore,this._delegate.withConverter(e?tg.getInstance(this.firestore,e):null))}}class j4{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new zE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Bk{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new ys(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new zE(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new j4(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new zE(this._firestore,r))})}isEqual(e){return $V(this._delegate,e._delegate)}}class U_ extends ys{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new fa(this.firestore,e):null}doc(e){try{return new fa(this.firestore,void 0===e?JT(this._delegate):JT(this._delegate,e))}catch(t){throw _s(t,"doc()","CollectionReference.doc()")}}add(e){return function S4(n,e){const t=Tn(n.firestore,Tr),r=JT(n),i=oD(n.converter,e);return L_(t,[nD(Qp(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Cr.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new fa(this.firestore,t))}isEqual(e){return xV(this._delegate,e._delegate)}withConverter(e){return new U_(this.firestore,this._delegate.withConverter(e?tg.getInstance(this.firestore,e):null))}}function ng(n){return Tn(n,fr)}class Vk{constructor(...e){this._delegate=new Fc(...e)}static documentId(){return new Vk(Lr.keyField().canonicalString())}isEqual(e){return(e=(0,k.m9)(e))instanceof Fc&&this._delegate._internalPath.isEqual(e._internalPath)}}class rg{constructor(e){this._delegate=e}static serverTimestamp(){const e=function N4(){return new xk("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new rg(e)}static delete(){const e=function R4(){return new VE("deleteField")}();return e._methodName="FieldValue.delete",new rg(e)}static arrayUnion(...e){const t=function k4(...n){return new n4("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new rg(t)}static arrayRemove(...e){const t=function P4(...n){return new r4("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new rg(t)}static increment(e){const t=function O4(n){return new i4("increment",n)}(e);return t._methodName="FieldValue.increment",new rg(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const $4={Firestore:i2,GeoPoint:eD,Timestamp:br,Blob:GE,Transaction:s2,WriteBatch:o2,DocumentReference:fa,DocumentSnapshot:WE,Query:ys,QueryDocumentSnapshot:zE,QuerySnapshot:Bk,CollectionReference:U_,FieldPath:Vk,FieldValue:rg,setLogLevel:function V4(n){!function Lq(n){mh.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function l2(n,e){return function W4(n,e=Iw.z){return new mo.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function jk(n,e){return l2(n,e).pipe((0,Nt.U)(t=>({payload:t,type:"query"})))}function uD(n,e){return jk(n,e).pipe(Zd(void 0),Jx(),(0,Nt.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,d)=>{const p=i.find(b=>b.doc.ref.isEqual(l.ref)),y=t?.payload.docs.find(b=>b.ref.isEqual(l.ref));p&&JSON.stringify(p.doc.metadata)===JSON.stringify(l.metadata)||!p&&y&&JSON.stringify(y.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:d,newIndex:d,type:"modified",doc:l}})}),a}))}function c2(n,e,t){return uD(n,t).pipe(za((r,i)=>function q4(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function K4(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return $k(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return $k(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return $k(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),RF(),(0,Nt.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function $k(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function d2(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}!function G4(n){(function H4(n,e){n.INTERNAL.registerComponent(new Ms.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},$4)))})(n,(e,t)=>new i2(e,t,new B4)),n.registerVersion("@firebase/firestore-compat","0.1.25")}(Vx.Z);class h2{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=uD(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,Nt.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(Zd(void 0),Jx(),Ws(([r,i])=>i.length>0||!r),(0,Nt.U)(([r,i])=>i),kn.iC)}auditTrail(e){return this.stateChanges(e).pipe(za((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=d2(e);return c2(this.query,t,this.afs.schedulers.outsideAngular).pipe(kn.iC)}valueChanges(e={}){return jk(this.query,this.afs.schedulers.outsideAngular).pipe((0,Nt.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),kn.iC)}get(e){return(0,jn.D)(this.query.get(e)).pipe(kn.iC)}add(e){return this.ref.add(e)}doc(e){return new f2(this.ref.doc(e),this.afs)}}class f2{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=m2(r,t);return new h2(i,a,this.afs)}snapshotChanges(){return function z4(n,e){return l2(n,e).pipe(Zd(void 0),Jx(),(0,Nt.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(kn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,Nt.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,jn.D)(this.ref.get(e)).pipe(kn.iC)}}class Z4{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?uD(this.query,this.afs.schedulers.outsideAngular).pipe((0,Nt.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),Ws(t=>t.length>0),kn.iC):uD(this.query,this.afs.schedulers.outsideAngular).pipe(kn.iC)}auditTrail(e){return this.stateChanges(e).pipe(za((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=d2(e);return c2(this.query,t,this.afs.schedulers.outsideAngular).pipe(kn.iC)}valueChanges(e={}){return jk(this.query,this.afs.schedulers.outsideAngular).pipe((0,Nt.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),kn.iC)}get(e){return(0,jn.D)(this.query.get(e)).pipe(kn.iC)}}const p2=new _.OlP("angularfire2.enableFirestorePersistence"),g2=new _.OlP("angularfire2.firestore.persistenceSettings"),Y4=new _.OlP("angularfire2.firestore.settings"),Q4=new _.OlP("angularfire2.firestore.use-emulator");function m2(n,e=(t=>t)){return{query:e(n),ref:n}}let X4=(()=>{class n{constructor(t,r,i,a,l,d,p,y,b,T,M,P,U,ee,oe,Ge,Je){this.schedulers=p;const rt=(0,fi.on)(t,d,r),et=b;T&&Bx(rt,d,M,U,ee,oe,P,Ge),[this.firestore,this.persistenceEnabled$]=(0,fi.cc)(`${rt.name}.firestore`,"AngularFirestore",rt.name,()=>{const xt=d.runOutsideAngular(()=>rt.firestore());if(a&&xt.settings(a),et&&xt.useEmulator(...et),i&&!ei(l)){const Pt=()=>{try{return(0,jn.D)(xt.enablePersistence(y||void 0).then(()=>!0,()=>!1))}catch(_n){return typeof console<"u"&&console.warn(_n),bt(!1)}};return[xt,d.runOutsideAngular(Pt)]}return[xt,bt(!1)]},[a,et,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=m2(i,r),d=this.schedulers.ngZone.run(()=>a);return new h2(d,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new Z4(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new f2(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(fi.Dh),_.LFG(fi.xv,8),_.LFG(p2,8),_.LFG(Y4,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(kn.HU),_.LFG(g2,8),_.LFG(Q4,8),_.LFG(UC,8),_.LFG(kx,8),_.LFG(Px,8),_.LFG(Ox,8),_.LFG(Fx,8),_.LFG(Lx,8),_.LFG(Ux,8),_.LFG(Uw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),J4=(()=>{class n{constructor(){LC.Z.registerVersion("angularfire",kn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:p2,useValue:!0},{provide:g2,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[X4]}),n})();const i8=new er.Yd("@firebase/database-compat"),_2=function(n){i8.warn("FIREBASE WARNING: "+n)};class a8{constructor(e){this._delegate=e}cancel(e){(0,k.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,k.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,k.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,k.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,k.Dv)("OnDisconnect.set",1,2,arguments.length),(0,k.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,k.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,k.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,k.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,_2("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,k.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class u8{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,k.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class kh{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,k.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,k.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,k.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,k.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,k.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Jl("DataSnapshot.child","path",e,!1),new kh(this._database,this._delegate.child(e))}hasChild(e){return(0,k.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Jl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,k.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,k.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,k.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new kh(this._database,t)))}hasChildren(){return(0,k.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,k.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,k.Dv)("DataSnapshot.ref",0,0,arguments.length),new Mo(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ji{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,k.Dv)("Query.on",2,4,arguments.length),(0,k.Wj)("Query.on","callback",t,!1);const l=ji.getCancelAndContextArgs_("Query.on",r,i),d=(y,b)=>{t.call(l.context,new kh(this.database,y),b)};d.userCallback=t,d.context=l.context;const p=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return av(this._delegate,d,p),t;case"child_added":return Im(this._delegate,d,p),t;case"child_removed":return aI(this._delegate,d,p),t;case"child_changed":return uv(this._delegate,d,p),t;case"child_moved":return oI(this._delegate,d,p),t;default:throw new Error((0,k.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,k.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,k.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,k.Wj)("Query.off","callback",t,!0),(0,k.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,uI(this._delegate,e,i)}else uI(this._delegate,e)}get(){return ts(this._delegate).then(e=>new kh(this.database,e))}once(e,t,r,i){(0,k.Dv)("Query.once",1,4,arguments.length),(0,k.Wj)("Query.once","callback",t,!0);const a=ji.getCancelAndContextArgs_("Query.once",r,i),l=new k.BH,d=(y,b)=>{const T=new kh(this.database,y);t&&t.call(a.context,T,b),l.resolve(T)};d.userCallback=t,d.context=a.context;const p=y=>{a.cancel&&a.cancel.call(a.context,y),l.reject(y)};switch(e){case"value":av(this._delegate,d,p,{onlyOnce:!0});break;case"child_added":Im(this._delegate,d,p,{onlyOnce:!0});break;case"child_removed":aI(this._delegate,d,p,{onlyOnce:!0});break;case"child_changed":uv(this._delegate,d,p,{onlyOnce:!0});break;case"child_moved":oI(this._delegate,d,p,{onlyOnce:!0});break;default:throw new Error((0,k.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,k.Dv)("Query.limitToFirst",1,1,arguments.length),new ji(this.database,ta(this._delegate,function QD(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new cv(n)}(e)))}limitToLast(e){return(0,k.Dv)("Query.limitToLast",1,1,arguments.length),new ji(this.database,ta(this._delegate,function iP(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new XD(n)}(e)))}orderByChild(e){return(0,k.Dv)("Query.orderByChild",1,1,arguments.length),new ji(this.database,ta(this._delegate,function JD(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Jl("orderByChild","path",n,!1),new hI(n)}(e)))}orderByKey(){return(0,k.Dv)("Query.orderByKey",0,0,arguments.length),new ji(this.database,ta(this._delegate,function tS(){return new eS}()))}orderByPriority(){return(0,k.Dv)("Query.orderByPriority",0,0,arguments.length),new ji(this.database,ta(this._delegate,function nS(){return new dv}()))}orderByValue(){return(0,k.Dv)("Query.orderByValue",0,0,arguments.length),new ji(this.database,ta(this._delegate,function bm(){return new rS}()))}startAt(e=null,t){return(0,k.Dv)("Query.startAt",0,2,arguments.length),new ji(this.database,ta(this._delegate,function dI(n=null,e){return jf("startAt","key",e,!0),new lv(n,e)}(e,t)))}startAfter(e=null,t){return(0,k.Dv)("Query.startAfter",0,2,arguments.length),new ji(this.database,ta(this._delegate,function ea(n,e){return jf("startAfter","key",e,!0),new YD(n,e)}(e,t)))}endAt(e=null,t){return(0,k.Dv)("Query.endAt",0,2,arguments.length),new ji(this.database,ta(this._delegate,function cI(n,e){return jf("endAt","key",e,!0),new lI(n,e)}(e,t)))}endBefore(e=null,t){return(0,k.Dv)("Query.endBefore",0,2,arguments.length),new ji(this.database,ta(this._delegate,function ZD(n,e){return jf("endBefore","key",e,!0),new KD(n,e)}(e,t)))}equalTo(e,t){return(0,k.Dv)("Query.equalTo",1,2,arguments.length),new ji(this.database,ta(this._delegate,function Cm(n,e){return jf("equalTo","key",e,!0),new hv(n,e)}(e,t)))}toString(){return(0,k.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,k.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,k.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof ji))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,k.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,k.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,k.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new Mo(this.database,new es(this._delegate._repo,this._delegate._path))}}class Mo extends ji{constructor(e,t){super(e,new yi(t._repo,t._path,new La,!1)),this.database=e,this._delegate=t}getKey(){return(0,k.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,k.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Mo(this.database,Ou(this._delegate,e))}getParent(){(0,k.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Mo(this.database,e):null}getRoot(){return(0,k.Dv)("Reference.root",0,0,arguments.length),new Mo(this.database,this._delegate.root)}set(e,t){(0,k.Dv)("Reference.set",1,2,arguments.length),(0,k.Wj)("Reference.set","onComplete",t,!0);const r=ov(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,k.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,_2("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ji("Reference.update",this._delegate._path),(0,k.Wj)("Reference.update","onComplete",t,!0);const r=qD(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,k.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,k.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function sI(n,e,t){if(Ji("setWithPriority",n._path),fo("setWithPriority",e,n._path,!1),dm("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new k.BH;return gm(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,k.Dv)("Reference.remove",0,1,arguments.length),(0,k.Wj)("Reference.remove","onComplete",e,!0);const t=function rI(n){return Ji("remove",n._path),ov(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,k.Dv)("Reference.transaction",1,3,arguments.length),(0,k.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,k.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,k.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function cS(n,e,t){var r;if(n=(0,k.m9)(n),Ji("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new k.BH,d=av(n,()=>{});return function rP(n,e,t,r,i,a){Gf(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:mi(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},d=Jo(n,e,void 0);l.currentInputSnapshot=d;const p=l.update(d.val());if(void 0===p)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{$d("transaction failed: Data returned ",p,l.path),l.status=0;const y=Ql(n.transactionQueueTree_,e),b=Xl(y)||[];let T;b.push(l),um(y,b),"object"==typeof p&&null!==p&&(0,k.r3)(p,".priority")?(T=(0,k.DV)(p,".priority"),(0,k.hu)(Xo(T),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):T=(Uf(n.serverSyncTree_,e)||qt.EMPTY_NODE).getPriority().val();const M=Hf(n),P=tr(p,T),U=Pu(P,d,M);l.currentOutputSnapshotRaw=P,l.currentOutputSnapshotResolved=U,l.currentWriteId=pm(n);const ee=jy(n.serverSyncTree_,e,U,l.currentWriteId,l.applyLocally);$s(n.eventQueue_,e,ee),Hd(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(p,y,b)=>{let T=null;p?a.reject(p):(T=new $a(b,new es(n._repo,n._path),en),a.resolve(new lS(y,T)))},d,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new u8(a.committed,new kh(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,k.Dv)("Reference.setPriority",1,2,arguments.length),(0,k.Wj)("Reference.setPriority","onComplete",t,!0);const r=function iI(n,e){n=(0,k.m9)(n),Ji("setPriority",n._path),dm("setPriority",e,!1);const t=new k.BH;return gm(n._repo,Vn(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,k.Dv)("Reference.push",0,2,arguments.length),(0,k.Wj)("Reference.push","onComplete",t,!0);const r=function zD(n,e){n=(0,k.m9)(n),Ji("push",n._path),fo("push",e,n._path,!0);const t=K0(n._repo),r=Q(t),i=Ou(n,r),a=Ou(n,r);let l;return l=null!=e?ov(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new Mo(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new Mo(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return Ji("Reference.onDisconnect",this._delegate._path),new a8(new rc(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class qE{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Zf,forceLongPolling:iS}}useEmulator(e,t,r={}){!function mI(n,e,t,r={}){(n=(0,k.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&qi("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&qi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Zi(Zi.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,k.Sg)(r.mockUserToken,n.app.options.projectId);a=new Zi(l)}!function pI(n,e,t,r){n.repoInfo_=new _d(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,k.Dv)("database.ref",0,1,arguments.length),e instanceof Mo){const t=vm(this._delegate,e.toString());return new Mo(this,t)}{const t=ym(this._delegate,e);return new Mo(this,t)}}refFromURL(e){(0,k.Dv)("database.refFromURL",1,1,arguments.length);const r=vm(this._delegate,e);return new Mo(this,r)}goOffline(){return(0,k.Dv)("database.goOffline",0,0,arguments.length),function sS(n){(n=(0,k.m9)(n))._checkNotDeleted("goOffline"),$D(n._repo)}(this._delegate)}goOnline(){return(0,k.Dv)("database.goOnline",0,0,arguments.length),function oS(n){(n=(0,k.m9)(n))._checkNotDeleted("goOnline"),function nP(n){n.persistentConnection_&&n.persistentConnection_.resume(fm)}(n._repo)}(this._delegate)}}qE.ServerValue={TIMESTAMP:function uS(){return sP}(),increment:n=>function oP(n){return{".sv":{increment:n}}}(n)};var c8=Object.freeze({__proto__:null,initStandalone:function l8({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){so(t);const l=new Ms.zt("auth-internal",new Ms.H0("database-standalone"));return l.setComponent(new Ms.wA("auth-internal",()=>r,"PRIVATE")),{instance:new qE(gv(n,l,void 0,e,a),n),namespace:i}}});const d8=qE.ServerValue;function y2(n){return null==n}function v2(n){return"function"==typeof n.set}function w2(n,e){return v2(e)?e:n.ref(e)}function E2(n,e){if(function f8(n){return"string"==typeof n}(n))return e.stringCase();if(v2(n))return e.firebaseCase();if(function p8(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function KE(n,e,t="on",r=Iw.z){return new mo.y(i=>{let a=null;return a=n[t](e,(l,d)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:d})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,Nt.U)(i=>{const{snapshot:a,prevKey:l}=i;let d=null;return a.exists()&&(d=a.key),{type:e,payload:a,prevKey:l,key:d}}),(0,b1.B)())}function I2(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function _8(n,e){const{payload:t,prevKey:r,key:i}=e,a=I2(n,i),l=function m8(n,e){if(y2(e))return 0;{const t=I2(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let d=null;e.payload.forEach(p=>{const y={payload:p,type:"value",prevKey:d,key:p.key};return d=p.key,n=[...n,y],!1})}return n;case"child_added":if(a>-1){const d=n[a-1];(d&&d.key||null)!==r&&(n=n.filter(p=>p.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(d=>d.payload.key!==t.key);case"child_changed":return n.map(d=>d.payload.key===i?e:d);case"child_moved":if(a>-1){const d=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,d),n}return n;default:return n}}function b2(n){return(y2(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function C2(n,e,t){return function g8(n,e,t){return KE(n,"value","once",t).pipe(Er(r=>{const i=[bt(r)];return e.forEach(a=>i.push(KE(n,a,"on",t))),(0,px.T)(...i).pipe(za(_8,[]))}),RF())}(n,e=b2(e),t)}function T2(n,e,t){const r=(e=b2(e)).map(i=>KE(n,i,"on",t));return(0,px.T)(...r)}function D2(n,e){return function(r,i){return E2(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function E8(n){return function(t){return t?E2(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function S2(n,e){return function(){return KE(n,"value","on",e)}}!function h8(n){n.INTERNAL.registerComponent(new Ms.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new qE(i,r)},"PUBLIC").setServiceProps({Reference:Mo,Query:ji,Database:qE,DataSnapshot:kh,enableLogging:Yf,INTERNAL:c8,ServerValue:d8}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.2.6")}(Vx.Z);const C8=new _.OlP("angularfire2.realtimeDatabaseURL"),T8=new _.OlP("angularfire2.database.use-emulator");let D8=(()=>{class n{constructor(t,r,i,a,l,d,p,y,b,T,M,P,U,ee,oe){this.schedulers=d;const Ge=p,Je=(0,fi.on)(t,l,r);y&&Bx(Je,l,b,M,P,U,T,ee),this.database=(0,fi.cc)(`${Je.name}.database.${i}`,"AngularFireDatabase",Je.name,()=>{const rt=l.runOutsideAngular(()=>Je.database(i||void 0));return Ge&&rt.useEmulator(...Ge),rt},[Ge])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>w2(this.database,t));let a=i;return r&&(a=r(i)),function I8(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:D2(r,"update"),set:D2(r,"set"),push:i=>r.push(i),remove:E8(r),snapshotChanges:i=>C2(n,i,t).pipe(kn.iC),stateChanges:i=>T2(n,i,t).pipe(kn.iC),auditTrail:i=>function y8(n,e,t){return function w8(n,e,t){return function v8(n,e){return KE(n,"value","on",e).pipe((0,Nt.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function e8(...n){const e=(0,Fu.jO)(n);return(0,Or.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),d=!1;for(let p=0;p<i;p++)(0,sa.Xf)(n[p]).subscribe((0,dr.x)(r,y=>{a[p]=y,!d&&!l[p]&&(l[p]=!0,(d=l.every(Lu.y))&&(l=null))},vM.Z));t.subscribe((0,dr.x)(r,p=>{if(d){const y=[p,...a];r.next(e?e(...y):y)}}))})}(e),(0,Nt.U)(([i,a])=>{const l=i.lastKeyToLoad,d=a.map(p=>p.key);return{actions:a,lastKeyToLoad:l,loadedKeys:d}}),function t8(n){return(0,Or.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,dr.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,Nt.U)(i=>i.actions))}(n,T2(n,e).pipe(za((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(kn.iC),valueChanges:(i,a)=>C2(n,i,t).pipe((0,Nt.U)(d=>d.map(p=>a&&a.idField?Object.assign(Object.assign({},p.payload.val()),{[a.idField]:p.key}):p.payload.val())),kn.iC)}}(a,this)}object(t){return function b8(n,e){return{query:n,snapshotChanges:()=>S2(n,e.schedulers.outsideAngular)().pipe(kn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>S2(n,e.schedulers.outsideAngular)().pipe(kn.iC,(0,Nt.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>w2(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(_.LFG(fi.Dh),_.LFG(fi.xv,8),_.LFG(C8,8),_.LFG(_.Lbi),_.LFG(_.R0b),_.LFG(kn.HU),_.LFG(T8,8),_.LFG(UC,8),_.LFG(kx,8),_.LFG(Px,8),_.LFG(Ox,8),_.LFG(Fx,8),_.LFG(Lx,8),_.LFG(Ux,8),_.LFG(Uw,8))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),S8=(()=>{class n{constructor(){LC.Z.registerVersion("angularfire",kn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({providers:[D8]}),n})(),A8=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=_.oAB({type:n,bootstrap:[jj]}),n.\u0275inj=_.cJS({imports:[rd,Hj,HH,Mj,fi.hO.initializeApp(fx_firebase),HG,J4,Nz,S8]}),n})();(0,_.G48)(),nd().bootstrapModule(A8).catch(n=>console.error(n))},6148:(_t,ke,F)=>{F.d(ke,{IH:()=>Qr,Gb:()=>Dr});var _=F(5861),ne=F(9681),B=F(1877),ue=F(2090),ge=F(4859);F(2833);const ce="analytics",we="firebase_id",W="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",te="https://www.googletagmanager.com/gtag/js",Le=new B.Yd("@firebase/analytics");function Ae(ae){return Promise.all(ae.map(pe=>pe.catch(Se=>Se)))}function De(ae,pe){const Se=document.createElement("script");Se.src=`${te}?l=${ae}&id=${pe}`,Se.async=!0,document.head.appendChild(Se)}function Ee(ae,pe,Se,Be,Qe,Tt){return fe.apply(this,arguments)}function fe(){return(fe=(0,_.Z)(function*(ae,pe,Se,Be,Qe,Tt){const At=Be[Qe];try{if(At)yield pe[At];else{const Oe=(yield Ae(Se)).find(at=>at.measurementId===Qe);Oe&&(yield pe[Oe.appId])}}catch(Ft){Le.error(Ft)}ae("config",Qe,Tt)})).apply(this,arguments)}function ft(ae,pe,Se,Be,Qe){return lt.apply(this,arguments)}function lt(){return(lt=(0,_.Z)(function*(ae,pe,Se,Be,Qe){try{let Tt=[];if(Qe&&Qe.send_to){let At=Qe.send_to;Array.isArray(At)||(At=[At]);const Ft=yield Ae(Se);for(const Oe of At){const at=Ft.find(Ln=>Ln.measurementId===Oe),Lt=at&&pe[at.appId];if(!Lt){Tt=[];break}Tt.push(Lt)}}0===Tt.length&&(Tt=Object.values(pe)),yield Promise.all(Tt),ae("event",Be,Qe||{})}catch(Tt){Le.error(Tt)}})).apply(this,arguments)}function xe(){const ae=window.document.getElementsByTagName("script");for(const pe of Object.values(ae))if(pe.src&&pe.src.includes(te))return pe;return null}const $e=new ue.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),re=new class J{constructor(pe={},Se=1e3){this.throttleMetadata=pe,this.intervalMillis=Se}getThrottleMetadata(pe){return this.throttleMetadata[pe]}setThrottleMetadata(pe,Se){this.throttleMetadata[pe]=Se}deleteThrottleMetadata(pe){delete this.throttleMetadata[pe]}};function le(ae){return new Headers({Accept:"application/json","x-goog-api-key":ae})}function ie(ae){return We.apply(this,arguments)}function We(){return(We=(0,_.Z)(function*(ae){var pe;const{appId:Se,apiKey:Be}=ae,Qe={method:"GET",headers:le(Be)},Tt=W.replace("{app-id}",Se),At=yield fetch(Tt,Qe);if(200!==At.status&&304!==At.status){let Ft="";try{const Oe=yield At.json();null!==(pe=Oe.error)&&void 0!==pe&&pe.message&&(Ft=Oe.error.message)}catch{}throw $e.create("config-fetch-failed",{httpStatus:At.status,responseMessage:Ft})}return At.json()})).apply(this,arguments)}function je(ae){return mt.apply(this,arguments)}function mt(){return(mt=(0,_.Z)(function*(ae,pe=re,Se){const{appId:Be,apiKey:Qe,measurementId:Tt}=ae.options;if(!Be)throw $e.create("no-app-id");if(!Qe){if(Tt)return{measurementId:Tt,appId:Be};throw $e.create("no-api-key")}const At=pe.getThrottleMetadata(Be)||{backoffCount:0,throttleEndTimeMillis:Date.now()},Ft=new ar;return setTimeout((0,_.Z)(function*(){Ft.abort()}),void 0!==Se?Se:6e4),rn({appId:Be,apiKey:Qe,measurementId:Tt},At,Ft,pe)})).apply(this,arguments)}function rn(ae,pe,Se){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,_.Z)(function*(ae,{throttleEndTimeMillis:pe,backoffCount:Se},Be,Qe=re){var Tt,At;const{appId:Ft,measurementId:Oe}=ae;try{yield Xe(Be,pe)}catch(at){if(Oe)return Le.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Oe} provided in the "measurementId" field in the local Firebase config. [${null===(Tt=at)||void 0===Tt?void 0:Tt.message}]`),{appId:Ft,measurementId:Oe};throw at}try{const at=yield ie(ae);return Qe.deleteThrottleMetadata(Ft),at}catch(at){const Lt=at;if(!yn(Lt)){if(Qe.deleteThrottleMetadata(Ft),Oe)return Le.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${Oe} provided in the "measurementId" field in the local Firebase config. [${Lt?.message}]`),{appId:Ft,measurementId:Oe};throw at}const Ln=503===Number(null===(At=Lt?.customData)||void 0===At?void 0:At.httpStatus)?(0,ue.$s)(Se,Qe.intervalMillis,30):(0,ue.$s)(Se,Qe.intervalMillis),Yn={throttleEndTimeMillis:Date.now()+Ln,backoffCount:Se+1};return Qe.setThrottleMetadata(Ft,Yn),Le.debug(`Calling attemptFetch again in ${Ln} millis`),rn(ae,Yn,Be,Qe)}})).apply(this,arguments)}function Xe(ae,pe){return new Promise((Se,Be)=>{const Qe=Math.max(pe-Date.now(),0),Tt=setTimeout(Se,Qe);ae.addEventListener(()=>{clearTimeout(Tt),Be($e.create("fetch-throttle",{throttleEndTimeMillis:pe}))})})}function yn(ae){if(!(ae instanceof ue.ZR&&ae.customData))return!1;const pe=Number(ae.customData.httpStatus);return 429===pe||500===pe||503===pe||504===pe}class ar{constructor(){this.listeners=[]}addEventListener(pe){this.listeners.push(pe)}abort(){this.listeners.forEach(pe=>pe())}}let vn,Vr;function rr(){return(rr=(0,_.Z)(function*(ae,pe,Se,Be,Qe){if(Qe&&Qe.global)ae("event",Se,Be);else{const Tt=yield pe;ae("event",Se,Object.assign(Object.assign({},Be),{send_to:Tt}))}})).apply(this,arguments)}function ur(ae){Vr=ae}function xi(ae){vn=ae}function st(){return Pn.apply(this,arguments)}function Pn(){return(Pn=(0,_.Z)(function*(){var ae;if(!(0,ue.hl)())return Le.warn($e.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,ue.eu)()}catch(pe){return Le.warn($e.create("indexeddb-unavailable",{errorInfo:null===(ae=pe)||void 0===ae?void 0:ae.toString()}).message),!1}return!0})).apply(this,arguments)}function xn(){return(xn=(0,_.Z)(function*(ae,pe,Se,Be,Qe,Tt,At){var Ft;const Oe=je(ae);Oe.then(mn=>{Se[mn.measurementId]=mn.appId,ae.options.measurementId&&mn.measurementId!==ae.options.measurementId&&Le.warn(`The measurement ID in the local Firebase config (${ae.options.measurementId}) does not match the measurement ID fetched from the server (${mn.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(mn=>Le.error(mn)),pe.push(Oe);const at=st().then(mn=>{if(mn)return Be.getId()}),[Lt,Ln]=yield Promise.all([Oe,at]);xe()||De(Tt,Lt.measurementId),Vr&&(Qe("consent","default",Vr),ur(void 0)),Qe("js",new Date);const Yn=null!==(Ft=At?.config)&&void 0!==Ft?Ft:{};return Yn.origin="firebase",Yn.update=!0,null!=Ln&&(Yn[we]=Ln),Qe("config",Lt.measurementId,Yn),vn&&(Qe("set",vn),xi(void 0)),Lt.measurementId})).apply(this,arguments)}class jr{constructor(pe){this.app=pe}_delete(){return delete $n[this.app.options.appId],Promise.resolve()}}let $n={},Fn=[];const Gn={};let dt,Gt,fn="dataLayer",wn=!1;function Rt(ae,pe,Se){!function lr(){const ae=[];if((0,ue.ru)()&&ae.push("This is a browser extension environment."),(0,ue.zI)()||ae.push("Cookies are not available."),ae.length>0){const pe=ae.map((Be,Qe)=>`(${Qe+1}) ${Be}`).join(" "),Se=$e.create("invalid-analytics-context",{errorInfo:pe});Le.warn(Se.message)}}();const Be=ae.options.appId;if(!Be)throw $e.create("no-app-id");if(!ae.options.apiKey){if(!ae.options.measurementId)throw $e.create("no-api-key");Le.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${ae.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=$n[Be])throw $e.create("already-exists",{id:Be});if(!wn){!function it(ae){let pe=[];Array.isArray(window[ae])?pe=window[ae]:window[ae]=pe}(fn);const{wrappedGtag:Tt,gtagCore:At}=function Te(ae,pe,Se,Be,Qe){let Tt=function(...At){window[Be].push(arguments)};return window[Qe]&&"function"==typeof window[Qe]&&(Tt=window[Qe]),window[Qe]=function Pe(ae,pe,Se,Be){function Tt(){return(Tt=(0,_.Z)(function*(At,Ft,Oe){try{"event"===At?yield ft(ae,pe,Se,Ft,Oe):"config"===At?yield Ee(ae,pe,Se,Be,Ft,Oe):"consent"===At?ae("consent","update",Oe):ae("set",Ft)}catch(at){Le.error(at)}})).apply(this,arguments)}return function Qe(At,Ft,Oe){return Tt.apply(this,arguments)}}(Tt,ae,pe,Se),{gtagCore:Tt,wrappedGtag:window[Qe]}}($n,Fn,Gn,fn,"gtag");Gt=Tt,dt=At,wn=!0}return $n[Be]=function di(ae,pe,Se,Be,Qe,Tt,At){return xn.apply(this,arguments)}(ae,Fn,Gn,pe,dt,fn,Se),new jr(ae)}function Qr(ae=(0,ne.getApp)()){ae=(0,ue.m9)(ae);const pe=(0,ne._getProvider)(ae,ce);return pe.isInitialized()?pe.getImmediate():function un(ae,pe={}){const Se=(0,ne._getProvider)(ae,ce);if(Se.isInitialized()){const Qe=Se.getImmediate();if((0,ue.vZ)(pe,Se.getOptions()))return Qe;throw $e.create("already-initialized")}return Se.initialize({options:pe})}(ae)}function Dr(){return sn.apply(this,arguments)}function sn(){return(sn=(0,_.Z)(function*(){if((0,ue.ru)()||!(0,ue.zI)()||!(0,ue.hl)())return!1;try{return yield(0,ue.eu)()}catch{return!1}})).apply(this,arguments)}const ht="@firebase/analytics";!function pn(){(0,ne._registerComponent)(new ge.wA(ce,(pe,{options:Se})=>Rt(pe.getProvider("app").getImmediate(),pe.getProvider("installations-internal").getImmediate(),Se),"PUBLIC")),(0,ne._registerComponent)(new ge.wA("analytics-internal",function ae(pe){try{const Se=pe.getProvider(ce).getImmediate();return{logEvent:(Be,Qe,Tt)=>function Ne(ae,pe,Se,Be){ae=(0,ue.m9)(ae),function dn(ae,pe,Se,Be,Qe){return rr.apply(this,arguments)}(Gt,$n[ae.app.options.appId],pe,Se,Be).catch(Qe=>Le.error(Qe))}(Se,Be,Qe,Tt)}}catch(Se){throw $e.create("interop-component-reg-failed",{reason:Se})}},"PRIVATE")),(0,ne.registerVersion)(ht,"0.8.0"),(0,ne.registerVersion)(ht,"0.8.0","esm2017")}()},5867:(_t,ke,F)=>{F.d(ke,{C6:()=>_.getApps,Mq:()=>_.getApp,ZF:()=>_.initializeApp});var _=F(9681);(0,_.registerVersion)("firebase","9.10.0","app")},127:(_t,ke,F)=>{F.d(ke,{Z:()=>_.Z});var _=F(3942);_.Z.registerVersion("firebase","9.10.0","app-compat")},2476:(_t,ke,F)=>{F.r(ke);var _=F(5861),ne=F(3942),B=F(2090),ue=F(9681),ge=F(655),ye=F(1877),ce=F(4859);const De=function Le(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},it=function Ae(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Ee=new B.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ft=new ye.Yd("@firebase/auth");function lt(v,...f){ft.logLevel<=ye.in.ERROR&&ft.error(`Auth (${ue.SDK_VERSION}): ${v}`,...f)}function Pe(v,...f){throw $e(v,...f)}function Te(v,...f){return $e(v,...f)}function xe(v,f,m){const E=Object.assign(Object.assign({},it()),{[f]:m});return new B.LL("auth","Firebase",E).create(f,{appName:v.name})}function Ze(v,f,m){if(!(f instanceof m))throw m.name!==f.constructor.name&&Pe(v,"argument-error"),xe(v,"argument-error",`Type of ${f.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $e(v,...f){if("string"!=typeof v){const m=f[0],E=[...f.slice(1)];return E[0]&&(E[0].appName=v.name),v._errorFactory.create(m,...E)}return Ee.create(v,...f)}function j(v,f,...m){if(!v)throw $e(f,...m)}function Ce(v){const f="INTERNAL ASSERTION FAILED: "+v;throw lt(f),new Error(f)}function J(v,f){v||Ce(f)}const re=new Map;function le(v){J(v instanceof Function,"Expected a class definition");let f=re.get(v);return f?(J(f instanceof v,"Instance stored in cache mismatched with class"),f):(f=new v,re.set(v,f),f)}function je(){var v;return typeof self<"u"&&(null===(v=self.location)||void 0===v?void 0:v.href)||""}function mt(){return"http:"===rn()||"https:"===rn()}function rn(){var v;return typeof self<"u"&&(null===(v=self.location)||void 0===v?void 0:v.protocol)||null}class yn{constructor(f,m){this.shortDelay=f,this.longDelay=m,J(m>f,"Short delay should be less than long delay!"),this.isMobile=(0,B.uI)()||(0,B.b$)()}get(){return function Bt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(mt()||(0,B.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ar(v,f){J(v.emulator,"Emulator should always be set here");const{url:m}=v.emulator;return f?`${m}${f.startsWith("/")?f.slice(1):f}`:m}class vn{static initialize(f,m,E){this.fetchImpl=f,m&&(this.headersImpl=m),E&&(this.responseImpl=E)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Ce("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Ce("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Ce("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const dn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},rr=new yn(3e4,6e4);function St(v,f){return v.tenantId&&!f.tenantId?Object.assign(Object.assign({},f),{tenantId:v.tenantId}):f}function Zt(v,f,m,E){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,_.Z)(function*(v,f,m,E,S={}){return ci(v,S,(0,_.Z)(function*(){let R={},Q={};E&&("GET"===f?Q=E:R={body:JSON.stringify(E)});const me=(0,B.xO)(Object.assign({key:v.config.apiKey},Q)).slice(1),qe=yield v._getAdditionalHeaders();return qe["Content-Type"]="application/json",v.languageCode&&(qe["X-Firebase-Locale"]=v.languageCode),vn.fetch()(gr(v,v.config.apiHost,m,me),Object.assign({method:f,headers:qe,referrerPolicy:"no-referrer"},R))}))})).apply(this,arguments)}function ci(v,f,m){return pr.apply(this,arguments)}function pr(){return(pr=(0,_.Z)(function*(v,f,m){v._canInitEmulator=!1;const E=Object.assign(Object.assign({},dn),f);try{const S=new Vr(v),R=yield Promise.race([m(),S.promise]);S.clearNetworkTimeout();const Q=yield R.json();if("needConfirmation"in Q)throw ur(v,"account-exists-with-different-credential",Q);if(R.ok&&!("errorMessage"in Q))return Q;{const me=R.ok?Q.errorMessage:Q.error.message,[qe,ct]=me.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===qe)throw ur(v,"credential-already-in-use",Q);if("EMAIL_EXISTS"===qe)throw ur(v,"email-already-in-use",Q);if("USER_DISABLED"===qe)throw ur(v,"user-disabled",Q);const Dt=E[qe]||qe.toLowerCase().replace(/[_\s]+/g,"-");if(ct)throw xe(v,Dt,ct);Pe(v,Dt)}}catch(S){if(S instanceof B.ZR)throw S;Pe(v,"network-request-failed")}})).apply(this,arguments)}function On(v,f,m,E){return Yr.apply(this,arguments)}function Yr(){return(Yr=(0,_.Z)(function*(v,f,m,E,S={}){const R=yield Zt(v,f,m,E,S);return"mfaPendingCredential"in R&&Pe(v,"multi-factor-auth-required",{_serverResponse:R}),R})).apply(this,arguments)}function gr(v,f,m,E){const S=`${f}${m}?${E}`;return v.config.emulator?ar(v.config,S):`${v.config.apiScheme}://${S}`}class Vr{constructor(f){this.auth=f,this.timer=null,this.promise=new Promise((m,E)=>{this.timer=setTimeout(()=>E(Te(this.auth,"network-request-failed")),rr.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ur(v,f,m){const E={appName:v.name};m.email&&(E.email=m.email),m.phoneNumber&&(E.phoneNumber=m.phoneNumber);const S=Te(v,f,E);return S.customData._tokenResponse=m,S}function st(){return(st=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:delete",f)})).apply(this,arguments)}function Pn(v,f){return di.apply(this,arguments)}function di(){return(di=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function xn(v,f){return jr.apply(this,arguments)}function jr(){return(jr=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:lookup",f)})).apply(this,arguments)}function $n(v){if(v)try{const f=new Date(Number(v));if(!isNaN(f.getTime()))return f.toUTCString()}catch{}}function fn(){return(fn=(0,_.Z)(function*(v,f=!1){const m=(0,B.m9)(v),E=yield m.getIdToken(f),S=dt(E);j(S&&S.exp&&S.auth_time&&S.iat,m.auth,"internal-error");const R="object"==typeof S.firebase?S.firebase:void 0,Q=R?.sign_in_provider;return{claims:S,token:E,authTime:$n(yt(S.auth_time)),issuedAtTime:$n(yt(S.iat)),expirationTime:$n(yt(S.exp)),signInProvider:Q||null,signInSecondFactor:R?.sign_in_second_factor||null}})).apply(this,arguments)}function yt(v){return 1e3*Number(v)}function dt(v){var f;const[m,E,S]=v.split(".");if(void 0===m||void 0===E||void 0===S)return lt("JWT malformed, contained fewer than 3 sections"),null;try{const R=(0,B.tV)(E);return R?JSON.parse(R):(lt("Failed to decode base64 JWT payload"),null)}catch(R){return lt("Caught error parsing JWT payload as JSON",null===(f=R)||void 0===f?void 0:f.toString()),null}}function wn(v,f){return mr.apply(this,arguments)}function mr(){return(mr=(0,_.Z)(function*(v,f,m=!1){if(m)return f;try{return yield f}catch(E){throw E instanceof B.ZR&&lr(E)&&v.auth.currentUser===v&&(yield v.auth.signOut()),E}})).apply(this,arguments)}function lr({code:v}){return"auth/user-disabled"===v||"auth/user-token-expired"===v}class Rt{constructor(f){this.user=f,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(f){var m;if(f){const E=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),E}{this.errorBackoff=3e4;const S=(null!==(m=this.user.stsTokenManager.expirationTime)&&void 0!==m?m:0)-Date.now()-3e5;return Math.max(0,S)}}schedule(f=!1){var m=this;if(!this.isRunning)return;const E=this.getInterval(f);this.timerId=setTimeout((0,_.Z)(function*(){yield m.iteration()}),E)}iteration(){var f=this;return(0,_.Z)(function*(){var m;try{yield f.user.getIdToken(!0)}catch(E){return void("auth/network-request-failed"===(null===(m=E)||void 0===m?void 0:m.code)&&f.schedule(!0))}f.schedule()})()}}class Qr{constructor(f,m){this.createdAt=f,this.lastLoginAt=m,this._initializeTime()}_initializeTime(){this.lastSignInTime=$n(this.lastLoginAt),this.creationTime=$n(this.createdAt)}_copy(f){this.createdAt=f.createdAt,this.lastLoginAt=f.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function un(v){return Dr.apply(this,arguments)}function Dr(){return(Dr=(0,_.Z)(function*(v){var f;const m=v.auth,E=yield v.getIdToken(),S=yield wn(v,xn(m,{idToken:E}));j(S?.users.length,m,"internal-error");const R=S.users[0];v._notifyReloadListener(R);const Q=null!==(f=R.providerUserInfo)&&void 0!==f&&f.length?V(R.providerUserInfo):[],me=H(v.providerData,Q),Dt=!!v.isAnonymous&&!(v.email&&R.passwordHash||me?.length),It={uid:R.localId,displayName:R.displayName||null,photoURL:R.photoUrl||null,email:R.email||null,emailVerified:R.emailVerified||!1,phoneNumber:R.phoneNumber||null,tenantId:R.tenantId||null,providerData:me,metadata:new Qr(R.createdAt,R.lastLoginAt),isAnonymous:Dt};Object.assign(v,It)})).apply(this,arguments)}function Y(){return(Y=(0,_.Z)(function*(v){const f=(0,B.m9)(v);yield un(f),yield f.auth._persistUserIfCurrent(f),f.auth._notifyListenersIfCurrent(f)})).apply(this,arguments)}function H(v,f){return[...v.filter(E=>!f.some(S=>S.providerId===E.providerId)),...f]}function V(v){return v.map(f=>{var{providerId:m}=f,E=(0,ge._T)(f,["providerId"]);return{providerId:m,uid:E.rawId||"",displayName:E.displayName||null,email:E.email||null,phoneNumber:E.phoneNumber||null,photoURL:E.photoUrl||null}})}function z(){return(z=(0,_.Z)(function*(v,f){const m=yield ci(v,{},(0,_.Z)(function*(){const E=(0,B.xO)({grant_type:"refresh_token",refresh_token:f}).slice(1),{tokenApiHost:S,apiKey:R}=v.config,Q=gr(v,S,"/v1/token",`key=${R}`),me=yield v._getAdditionalHeaders();return me["Content-Type"]="application/x-www-form-urlencoded",vn.fetch()(Q,{method:"POST",headers:me,body:E})}));return{accessToken:m.access_token,expiresIn:m.expires_in,refreshToken:m.refresh_token}})).apply(this,arguments)}class Ne{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(f){j(f.idToken,"internal-error"),j(typeof f.idToken<"u","internal-error"),j(typeof f.refreshToken<"u","internal-error");const m="expiresIn"in f&&typeof f.expiresIn<"u"?Number(f.expiresIn):function Gt(v){const f=dt(v);return j(f,"internal-error"),j(typeof f.exp<"u","internal-error"),j(typeof f.iat<"u","internal-error"),Number(f.exp)-Number(f.iat)}(f.idToken);this.updateTokensAndExpiration(f.idToken,f.refreshToken,m)}getToken(f,m=!1){var E=this;return(0,_.Z)(function*(){return j(!E.accessToken||E.refreshToken,f,"user-token-expired"),m||!E.accessToken||E.isExpired?E.refreshToken?(yield E.refresh(f,E.refreshToken),E.accessToken):null:E.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(f,m){var E=this;return(0,_.Z)(function*(){const{accessToken:S,refreshToken:R,expiresIn:Q}=yield function G(v,f){return z.apply(this,arguments)}(f,m);E.updateTokensAndExpiration(S,R,Number(Q))})()}updateTokensAndExpiration(f,m,E){this.refreshToken=m||null,this.accessToken=f||null,this.expirationTime=Date.now()+1e3*E}static fromJSON(f,m){const{refreshToken:E,accessToken:S,expirationTime:R}=m,Q=new Ne;return E&&(j("string"==typeof E,"internal-error",{appName:f}),Q.refreshToken=E),S&&(j("string"==typeof S,"internal-error",{appName:f}),Q.accessToken=S),R&&(j("number"==typeof R,"internal-error",{appName:f}),Q.expirationTime=R),Q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(f){this.accessToken=f.accessToken,this.refreshToken=f.refreshToken,this.expirationTime=f.expirationTime}_clone(){return Object.assign(new Ne,this.toJSON())}_performRefresh(){return Ce("not implemented")}}function Ye(v,f){j("string"==typeof v||typeof v>"u","internal-error",{appName:f})}class ht{constructor(f){var{uid:m,auth:E,stsTokenManager:S}=f,R=(0,ge._T)(f,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Rt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=m,this.auth=E,this.stsTokenManager=S,this.accessToken=S.accessToken,this.displayName=R.displayName||null,this.email=R.email||null,this.emailVerified=R.emailVerified||!1,this.phoneNumber=R.phoneNumber||null,this.photoURL=R.photoURL||null,this.isAnonymous=R.isAnonymous||!1,this.tenantId=R.tenantId||null,this.providerData=R.providerData?[...R.providerData]:[],this.metadata=new Qr(R.createdAt||void 0,R.lastLoginAt||void 0)}getIdToken(f){var m=this;return(0,_.Z)(function*(){const E=yield wn(m,m.stsTokenManager.getToken(m.auth,f));return j(E,m.auth,"internal-error"),m.accessToken!==E&&(m.accessToken=E,yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)),E})()}getIdTokenResult(f){return function Gn(v){return fn.apply(this,arguments)}(this,f)}reload(){return function sn(v){return Y.apply(this,arguments)}(this)}_assign(f){this!==f&&(j(this.uid===f.uid,this.auth,"internal-error"),this.displayName=f.displayName,this.photoURL=f.photoURL,this.email=f.email,this.emailVerified=f.emailVerified,this.phoneNumber=f.phoneNumber,this.isAnonymous=f.isAnonymous,this.tenantId=f.tenantId,this.providerData=f.providerData.map(m=>Object.assign({},m)),this.metadata._copy(f.metadata),this.stsTokenManager._assign(f.stsTokenManager))}_clone(f){return new ht(Object.assign(Object.assign({},this),{auth:f,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(f){j(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=f,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(f){this.reloadListener?this.reloadListener(f):this.reloadUserInfo=f}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(f,m=!1){var E=this;return(0,_.Z)(function*(){let S=!1;f.idToken&&f.idToken!==E.stsTokenManager.accessToken&&(E.stsTokenManager.updateFromServerResponse(f),S=!0),m&&(yield un(E)),yield E.auth._persistUserIfCurrent(E),S&&E.auth._notifyListenersIfCurrent(E)})()}delete(){var f=this;return(0,_.Z)(function*(){const m=yield f.getIdToken();return yield wn(f,function xi(v,f){return st.apply(this,arguments)}(f.auth,{idToken:m})),f.stsTokenManager.clearRefreshToken(),f.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(f=>Object.assign({},f)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(f,m){var E,S,R,Q,me,qe,ct,Dt;const It=null!==(E=m.displayName)&&void 0!==E?E:void 0,qn=null!==(S=m.email)&&void 0!==S?S:void 0,Qi=null!==(R=m.phoneNumber)&&void 0!==R?R:void 0,Yo=null!==(Q=m.photoURL)&&void 0!==Q?Q:void 0,Au=null!==(me=m.tenantId)&&void 0!==me?me:void 0,bf=null!==(qe=m._redirectEventId)&&void 0!==qe?qe:void 0,La=null!==(ct=m.createdAt)&&void 0!==ct?ct:void 0,fy=null!==(Dt=m.lastLoginAt)&&void 0!==Dt?Dt:void 0,{uid:$g,emailVerified:Rd,isAnonymous:Cf,providerData:Hg,stsTokenManager:Tf}=m;j($g&&Tf,f,"internal-error");const c0=Ne.fromJSON(this.name,Tf);j("string"==typeof $g,f,"internal-error"),Ye(It,f.name),Ye(qn,f.name),j("boolean"==typeof Rd,f,"internal-error"),j("boolean"==typeof Cf,f,"internal-error"),Ye(Qi,f.name),Ye(Yo,f.name),Ye(Au,f.name),Ye(bf,f.name),Ye(La,f.name),Ye(fy,f.name);const Gl=new ht({uid:$g,auth:f,email:qn,emailVerified:Rd,displayName:It,isAnonymous:Cf,photoURL:Yo,phoneNumber:Qi,tenantId:Au,stsTokenManager:c0,createdAt:La,lastLoginAt:fy});return Hg&&Array.isArray(Hg)&&(Gl.providerData=Hg.map(Gg=>Object.assign({},Gg))),bf&&(Gl._redirectEventId=bf),Gl}static _fromIdTokenResponse(f,m,E=!1){return(0,_.Z)(function*(){const S=new Ne;S.updateFromServerResponse(m);const R=new ht({uid:m.localId,auth:f,stsTokenManager:S,isAnonymous:E});return yield un(R),R})()}}const pn=(()=>{class v{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,_.Z)(function*(){return!0})()}_set(m,E){var S=this;return(0,_.Z)(function*(){S.storage[m]=E})()}_get(m){var E=this;return(0,_.Z)(function*(){const S=E.storage[m];return void 0===S?null:S})()}_remove(m){var E=this;return(0,_.Z)(function*(){delete E.storage[m]})()}_addListener(m,E){}_removeListener(m,E){}}return v.type="NONE",v})();function ae(v,f,m){return`firebase:${v}:${f}:${m}`}class pe{constructor(f,m,E){this.persistence=f,this.auth=m,this.userKey=E;const{config:S,name:R}=this.auth;this.fullUserKey=ae(this.userKey,S.apiKey,R),this.fullPersistenceKey=ae("persistence",S.apiKey,R),this.boundEventHandler=m._onStorageEvent.bind(m),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(f){return this.persistence._set(this.fullUserKey,f.toJSON())}getCurrentUser(){var f=this;return(0,_.Z)(function*(){const m=yield f.persistence._get(f.fullUserKey);return m?ht._fromJSON(f.auth,m):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(f){var m=this;return(0,_.Z)(function*(){if(m.persistence===f)return;const E=yield m.getCurrentUser();return yield m.removeCurrentUser(),m.persistence=f,E?m.setCurrentUser(E):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(f,m,E="authUser"){return(0,_.Z)(function*(){if(!m.length)return new pe(le(pn),f,E);const S=(yield Promise.all(m.map(function(){var ct=(0,_.Z)(function*(Dt){if(yield Dt._isAvailable())return Dt});return function(Dt){return ct.apply(this,arguments)}}()))).filter(ct=>ct);let R=S[0]||le(pn);const Q=ae(E,f.config.apiKey,f.name);let me=null;for(const ct of m)try{const Dt=yield ct._get(Q);if(Dt){const It=ht._fromJSON(f,Dt);ct!==R&&(me=It),R=ct;break}}catch{}const qe=S.filter(ct=>ct._shouldAllowMigration);return R._shouldAllowMigration&&qe.length?(R=qe[0],me&&(yield R._set(Q,me.toJSON())),yield Promise.all(m.map(function(){var ct=(0,_.Z)(function*(Dt){if(Dt!==R)try{yield Dt._remove(Q)}catch{}});return function(Dt){return ct.apply(this,arguments)}}())),new pe(R,f,E)):new pe(R,f,E)})()}}function Se(v){const f=v.toLowerCase();if(f.includes("opera/")||f.includes("opr/")||f.includes("opios/"))return"Opera";if(At(f))return"IEMobile";if(f.includes("msie")||f.includes("trident/"))return"IE";if(f.includes("edge/"))return"Edge";if(Be(f))return"Firefox";if(f.includes("silk/"))return"Silk";if(Oe(f))return"Blackberry";if(at(f))return"Webos";if(Qe(f))return"Safari";if((f.includes("chrome/")||Tt(f))&&!f.includes("edge/"))return"Chrome";if(Ft(f))return"Android";{const E=v.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===E?.length)return E[1]}return"Other"}function Be(v=(0,B.z$)()){return/firefox\//i.test(v)}function Qe(v=(0,B.z$)()){const f=v.toLowerCase();return f.includes("safari/")&&!f.includes("chrome/")&&!f.includes("crios/")&&!f.includes("android")}function Tt(v=(0,B.z$)()){return/crios\//i.test(v)}function At(v=(0,B.z$)()){return/iemobile/i.test(v)}function Ft(v=(0,B.z$)()){return/android/i.test(v)}function Oe(v=(0,B.z$)()){return/blackberry/i.test(v)}function at(v=(0,B.z$)()){return/webos/i.test(v)}function Lt(v=(0,B.z$)()){return/iphone|ipad|ipod/i.test(v)||/macintosh/i.test(v)&&/mobile/i.test(v)}function Ri(v=(0,B.z$)()){return Lt(v)||Ft(v)||at(v)||Oe(v)||/windows phone/i.test(v)||At(v)}function $i(v,f=[]){let m;switch(v){case"Browser":m=Se((0,B.z$)());break;case"Worker":m=`${Se((0,B.z$)())}-${v}`;break;default:m=v}const E=f.length?f.join(","):"FirebaseCore-web";return`${m}/JsCore/${ue.SDK_VERSION}/${E}`}class vs{constructor(f){this.auth=f,this.queue=[]}pushCallback(f,m){const E=R=>new Promise((Q,me)=>{try{Q(f(R))}catch(qe){me(qe)}});E.onAbort=m,this.queue.push(E);const S=this.queue.length-1;return()=>{this.queue[S]=()=>Promise.resolve()}}runMiddleware(f){var m=this;return(0,_.Z)(function*(){var E;if(m.auth.currentUser===f)return;const S=[];try{for(const R of m.queue)yield R(f),R.onAbort&&S.push(R.onAbort)}catch(R){S.reverse();for(const Q of S)try{Q()}catch{}throw m.auth._errorFactory.create("login-blocked",{originalMessage:null===(E=R)||void 0===E?void 0:E.message})}})()}}class $t{constructor(f,m,E){this.app=f,this.heartbeatServiceProvider=m,this.config=E,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ie(this),this.idTokenSubscription=new Ie(this),this.beforeStateQueue=new vs(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ee,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=f.name,this.clientVersion=E.sdkClientVersion}_initializeWithPersistence(f,m){var E=this;return m&&(this._popupRedirectResolver=le(m)),this._initializationPromise=this.queue((0,_.Z)(function*(){var S,R;if(!E._deleted&&(E.persistenceManager=yield pe.create(E,f),!E._deleted)){if(null!==(S=E._popupRedirectResolver)&&void 0!==S&&S._shouldInitProactively)try{yield E._popupRedirectResolver._initialize(E)}catch{}yield E.initializeCurrentUser(m),E.lastNotifiedUid=(null===(R=E.currentUser)||void 0===R?void 0:R.uid)||null,!E._deleted&&(E._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var f=this;return(0,_.Z)(function*(){if(f._deleted)return;const m=yield f.assertedPersistence.getCurrentUser();if(f.currentUser||m){if(f.currentUser&&m&&f.currentUser.uid===m.uid)return f._currentUser._assign(m),void(yield f.currentUser.getIdToken());yield f._updateCurrentUser(m,!0)}})()}initializeCurrentUser(f){var m=this;return(0,_.Z)(function*(){var E;const S=yield m.assertedPersistence.getCurrentUser();let R=S,Q=!1;if(f&&m.config.authDomain){yield m.getOrInitRedirectPersistenceManager();const me=null===(E=m.redirectUser)||void 0===E?void 0:E._redirectEventId,qe=R?._redirectEventId,ct=yield m.tryRedirectSignIn(f);(!me||me===qe)&&ct?.user&&(R=ct.user,Q=!0)}if(!R)return m.directlySetCurrentUser(null);if(!R._redirectEventId){if(Q)try{yield m.beforeStateQueue.runMiddleware(R)}catch(me){R=S,m._popupRedirectResolver._overrideRedirectResult(m,()=>Promise.reject(me))}return R?m.reloadAndSetCurrentUserOrClear(R):m.directlySetCurrentUser(null)}return j(m._popupRedirectResolver,m,"argument-error"),yield m.getOrInitRedirectPersistenceManager(),m.redirectUser&&m.redirectUser._redirectEventId===R._redirectEventId?m.directlySetCurrentUser(R):m.reloadAndSetCurrentUserOrClear(R)})()}tryRedirectSignIn(f){var m=this;return(0,_.Z)(function*(){let E=null;try{E=yield m._popupRedirectResolver._completeRedirectFn(m,f,!0)}catch{yield m._setRedirectUser(null)}return E})()}reloadAndSetCurrentUserOrClear(f){var m=this;return(0,_.Z)(function*(){var E;try{yield un(f)}catch(S){if("auth/network-request-failed"!==(null===(E=S)||void 0===E?void 0:E.code))return m.directlySetCurrentUser(null)}return m.directlySetCurrentUser(f)})()}useDeviceLanguage(){this.languageCode=function Xe(){if(typeof navigator>"u")return null;const v=navigator;return v.languages&&v.languages[0]||v.language||null}()}_delete(){var f=this;return(0,_.Z)(function*(){f._deleted=!0})()}updateCurrentUser(f){var m=this;return(0,_.Z)(function*(){const E=f?(0,B.m9)(f):null;return E&&j(E.auth.config.apiKey===m.config.apiKey,m,"invalid-user-token"),m._updateCurrentUser(E&&E._clone(m))})()}_updateCurrentUser(f,m=!1){var E=this;return(0,_.Z)(function*(){if(!E._deleted)return f&&j(E.tenantId===f.tenantId,E,"tenant-id-mismatch"),m||(yield E.beforeStateQueue.runMiddleware(f)),E.queue((0,_.Z)(function*(){yield E.directlySetCurrentUser(f),E.notifyAuthListeners()}))})()}signOut(){var f=this;return(0,_.Z)(function*(){return yield f.beforeStateQueue.runMiddleware(null),(f.redirectPersistenceManager||f._popupRedirectResolver)&&(yield f._setRedirectUser(null)),f._updateCurrentUser(null,!0)})()}setPersistence(f){var m=this;return this.queue((0,_.Z)(function*(){yield m.assertedPersistence.setPersistence(le(f))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(f){this._errorFactory=new B.LL("auth","Firebase",f())}onAuthStateChanged(f,m,E){return this.registerStateListener(this.authStateSubscription,f,m,E)}beforeAuthStateChanged(f,m){return this.beforeStateQueue.pushCallback(f,m)}onIdTokenChanged(f,m,E){return this.registerStateListener(this.idTokenSubscription,f,m,E)}toJSON(){var f;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(f=this._currentUser)||void 0===f?void 0:f.toJSON()}}_setRedirectUser(f,m){var E=this;return(0,_.Z)(function*(){const S=yield E.getOrInitRedirectPersistenceManager(m);return null===f?S.removeCurrentUser():S.setCurrentUser(f)})()}getOrInitRedirectPersistenceManager(f){var m=this;return(0,_.Z)(function*(){if(!m.redirectPersistenceManager){const E=f&&le(f)||m._popupRedirectResolver;j(E,m,"argument-error"),m.redirectPersistenceManager=yield pe.create(m,[le(E._redirectPersistence)],"redirectUser"),m.redirectUser=yield m.redirectPersistenceManager.getCurrentUser()}return m.redirectPersistenceManager})()}_redirectUserForId(f){var m=this;return(0,_.Z)(function*(){var E,S;return m._isInitialized&&(yield m.queue((0,_.Z)(function*(){}))),(null===(E=m._currentUser)||void 0===E?void 0:E._redirectEventId)===f?m._currentUser:(null===(S=m.redirectUser)||void 0===S?void 0:S._redirectEventId)===f?m.redirectUser:null})()}_persistUserIfCurrent(f){var m=this;return(0,_.Z)(function*(){if(f===m.currentUser)return m.queue((0,_.Z)(function*(){return m.directlySetCurrentUser(f)}))})()}_notifyListenersIfCurrent(f){f===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var f,m;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const E=null!==(m=null===(f=this.currentUser)||void 0===f?void 0:f.uid)&&void 0!==m?m:null;this.lastNotifiedUid!==E&&(this.lastNotifiedUid=E,this.authStateSubscription.next(this.currentUser))}registerStateListener(f,m,E,S){if(this._deleted)return()=>{};const R="function"==typeof m?m:m.next.bind(m),Q=this._isInitialized?Promise.resolve():this._initializationPromise;return j(Q,this,"internal-error"),Q.then(()=>R(this.currentUser)),"function"==typeof m?f.addObserver(m,E,S):f.addObserver(m)}directlySetCurrentUser(f){var m=this;return(0,_.Z)(function*(){m.currentUser&&m.currentUser!==f&&m._currentUser._stopProactiveRefresh(),f&&m.isProactiveRefreshEnabled&&f._startProactiveRefresh(),m.currentUser=f,f?yield m.assertedPersistence.setCurrentUser(f):yield m.assertedPersistence.removeCurrentUser()})()}queue(f){return this.operations=this.operations.then(f,f),this.operations}get assertedPersistence(){return j(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(f){!f||this.frameworks.includes(f)||(this.frameworks.push(f),this.frameworks.sort(),this.clientVersion=$i(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var f=this;return(0,_.Z)(function*(){var m;const E={"X-Client-Version":f.clientVersion};f.app.options.appId&&(E["X-Firebase-gmpid"]=f.app.options.appId);const S=yield null===(m=f.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getHeartbeatsHeader();return S&&(E["X-Firebase-Client"]=S),E})()}}function X(v){return(0,B.m9)(v)}class Ie{constructor(f){this.auth=f,this.observer=null,this.addObserver=(0,B.ne)(m=>this.observer=m)}get next(){return j(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function pt(v){const f=v.indexOf(":");return f<0?"":v.substr(0,f+1)}function hn(v){if(!v)return null;const f=Number(v);return isNaN(f)?null:f}class In{constructor(f,m){this.providerId=f,this.signInMethod=m}toJSON(){return Ce("not implemented")}_getIdTokenResponse(f){return Ce("not implemented")}_linkToIdToken(f,m){return Ce("not implemented")}_getReauthenticationResolver(f){return Ce("not implemented")}}function Xr(v,f){return xr.apply(this,arguments)}function xr(){return(xr=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:resetPassword",St(v,f))})).apply(this,arguments)}function bn(v,f){return rl.apply(this,arguments)}function rl(){return(rl=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function il(v,f){return Qs.apply(this,arguments)}function Qs(){return(Qs=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:update",St(v,f))})).apply(this,arguments)}function ws(){return(ws=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithPassword",St(v,f))})).apply(this,arguments)}function us(v,f){return Ni.apply(this,arguments)}function Ni(){return(Ni=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:sendOobCode",St(v,f))})).apply(this,arguments)}function Sr(v,f){return ma.apply(this,arguments)}function ma(){return(ma=(0,_.Z)(function*(v,f){return us(v,f)})).apply(this,arguments)}function $r(v,f){return Ar.apply(this,arguments)}function Ar(){return(Ar=(0,_.Z)(function*(v,f){return us(v,f)})).apply(this,arguments)}function No(v,f){return Es.apply(this,arguments)}function Es(){return(Es=(0,_.Z)(function*(v,f){return us(v,f)})).apply(this,arguments)}function tu(v,f){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,_.Z)(function*(v,f){return us(v,f)})).apply(this,arguments)}function Vc(){return(Vc=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithEmailLink",St(v,f))})).apply(this,arguments)}function nu(){return(nu=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithEmailLink",St(v,f))})).apply(this,arguments)}class ru extends In{constructor(f,m,E,S=null){super("password",E),this._email=f,this._password=m,this._tenantId=S}static _fromEmailAndPassword(f,m){return new ru(f,m,"password")}static _fromEmailAndCode(f,m,E=null){return new ru(f,m,"emailLink",E)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f;if(m?.email&&m?.password){if("password"===m.signInMethod)return this._fromEmailAndPassword(m.email,m.password);if("emailLink"===m.signInMethod)return this._fromEmailAndCode(m.email,m.password,m.tenantId)}return null}_getIdTokenResponse(f){var m=this;return(0,_.Z)(function*(){switch(m.signInMethod){case"password":return function ga(v,f){return ws.apply(this,arguments)}(f,{returnSecureToken:!0,email:m._email,password:m._password});case"emailLink":return function Bc(v,f){return Vc.apply(this,arguments)}(f,{email:m._email,oobCode:m._password});default:Pe(f,"internal-error")}})()}_linkToIdToken(f,m){var E=this;return(0,_.Z)(function*(){switch(E.signInMethod){case"password":return bn(f,{idToken:m,returnSecureToken:!0,email:E._email,password:E._password});case"emailLink":return function sl(v,f){return nu.apply(this,arguments)}(f,{idToken:m,email:E._email,oobCode:E._password});default:Pe(f,"internal-error")}})()}_getReauthenticationResolver(f){return this._getIdTokenResponse(f)}}function _r(v,f){return jc.apply(this,arguments)}function jc(){return(jc=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithIdp",St(v,f))})).apply(this,arguments)}class Hi extends In{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(f){const m=new Hi(f.providerId,f.signInMethod);return f.idToken||f.accessToken?(f.idToken&&(m.idToken=f.idToken),f.accessToken&&(m.accessToken=f.accessToken),f.nonce&&!f.pendingToken&&(m.nonce=f.nonce),f.pendingToken&&(m.pendingToken=f.pendingToken)):f.oauthToken&&f.oauthTokenSecret?(m.accessToken=f.oauthToken,m.secret=f.oauthTokenSecret):Pe("argument-error"),m}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f,{providerId:E,signInMethod:S}=m,R=(0,ge._T)(m,["providerId","signInMethod"]);if(!E||!S)return null;const Q=new Hi(E,S);return Q.idToken=R.idToken||void 0,Q.accessToken=R.accessToken||void 0,Q.secret=R.secret,Q.nonce=R.nonce,Q.pendingToken=R.pendingToken||null,Q}_getIdTokenResponse(f){return _r(f,this.buildRequest())}_linkToIdToken(f,m){const E=this.buildRequest();return E.idToken=m,_r(f,E)}_getReauthenticationResolver(f){const m=this.buildRequest();return m.autoCreate=!1,_r(f,m)}buildRequest(){const f={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)f.pendingToken=this.pendingToken;else{const m={};this.idToken&&(m.id_token=this.idToken),this.accessToken&&(m.access_token=this.accessToken),this.secret&&(m.oauth_token_secret=this.secret),m.providerId=this.providerId,this.nonce&&!this.pendingToken&&(m.nonce=this.nonce),f.postBody=(0,B.xO)(m)}return f}}function $c(v,f){return Hc.apply(this,arguments)}function Hc(){return(Hc=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:sendVerificationCode",St(v,f))})).apply(this,arguments)}function Wc(){return(Wc=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithPhoneNumber",St(v,f))})).apply(this,arguments)}function Oh(){return(Oh=(0,_.Z)(function*(v,f){const m=yield On(v,"POST","/v1/accounts:signInWithPhoneNumber",St(v,f));if(m.temporaryProof)throw ur(v,"account-exists-with-different-credential",m);return m})).apply(this,arguments)}const zc={USER_NOT_FOUND:"user-not-found"};function Fh(){return(Fh=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithPhoneNumber",St(v,Object.assign(Object.assign({},f),{operation:"REAUTH"})),zc)})).apply(this,arguments)}class Is extends In{constructor(f){super("phone","phone"),this.params=f}static _fromVerification(f,m){return new Is({verificationId:f,verificationCode:m})}static _fromTokenResponse(f,m){return new Is({phoneNumber:f,temporaryProof:m})}_getIdTokenResponse(f){return function Gc(v,f){return Wc.apply(this,arguments)}(f,this._makeVerificationRequest())}_linkToIdToken(f,m){return function B_(v,f){return Oh.apply(this,arguments)}(f,Object.assign({idToken:m},this._makeVerificationRequest()))}_getReauthenticationResolver(f){return function V_(v,f){return Fh.apply(this,arguments)}(f,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:f,phoneNumber:m,verificationId:E,verificationCode:S}=this.params;return f&&m?{temporaryProof:f,phoneNumber:m}:{sessionInfo:E,code:S}}toJSON(){const f={providerId:this.providerId};return this.params.phoneNumber&&(f.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(f.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(f.verificationCode=this.params.verificationCode),this.params.verificationId&&(f.verificationId=this.params.verificationId),f}static fromJSON(f){"string"==typeof f&&(f=JSON.parse(f));const{verificationId:m,verificationCode:E,phoneNumber:S,temporaryProof:R}=f;return E||m||S||R?new Is({verificationId:m,verificationCode:E,phoneNumber:S,temporaryProof:R}):null}}class iu{constructor(f){var m,E,S,R,Q,me;const qe=(0,B.zd)((0,B.pd)(f)),ct=null!==(m=qe.apiKey)&&void 0!==m?m:null,Dt=null!==(E=qe.oobCode)&&void 0!==E?E:null,It=function ol(v){switch(v){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(S=qe.mode)&&void 0!==S?S:null);j(ct&&Dt&&It,"argument-error"),this.apiKey=ct,this.operation=It,this.code=Dt,this.continueUrl=null!==(R=qe.continueUrl)&&void 0!==R?R:null,this.languageCode=null!==(Q=qe.languageCode)&&void 0!==Q?Q:null,this.tenantId=null!==(me=qe.tenantId)&&void 0!==me?me:null}static parseLink(f){const m=function ag(v){const f=(0,B.zd)((0,B.pd)(v)).link,m=f?(0,B.zd)((0,B.pd)(f)).deep_link_id:null,E=(0,B.zd)((0,B.pd)(v)).deep_link_id;return(E?(0,B.zd)((0,B.pd)(E)).link:null)||E||m||f||v}(f);try{return new iu(m)}catch{return null}}}let Gi=(()=>{class v{constructor(){this.providerId=v.PROVIDER_ID}static credential(m,E){return ru._fromEmailAndPassword(m,E)}static credentialWithLink(m,E){const S=iu.parseLink(E);return j(S,"argument-error"),ru._fromEmailAndCode(m,S.code,S.tenantId)}}return v.PROVIDER_ID="password",v.EMAIL_PASSWORD_SIGN_IN_METHOD="password",v.EMAIL_LINK_SIGN_IN_METHOD="emailLink",v})();class bs{constructor(f){this.providerId=f,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(f){this.defaultLanguageCode=f}setCustomParameters(f){return this.customParameters=f,this}getCustomParameters(){return this.customParameters}}class Cs extends bs{constructor(){super(...arguments),this.scopes=[]}addScope(f){return this.scopes.includes(f)||this.scopes.push(f),this}getScopes(){return[...this.scopes]}}class Xs extends Cs{static credentialFromJSON(f){const m="string"==typeof f?JSON.parse(f):f;return j("providerId"in m&&"signInMethod"in m,"argument-error"),Hi._fromParams(m)}credential(f){return this._credential(Object.assign(Object.assign({},f),{nonce:f.rawNonce}))}_credential(f){return j(f.idToken||f.accessToken,"argument-error"),Hi._fromParams(Object.assign(Object.assign({},f),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(f){return Xs.oauthCredentialFromTaggedObject(f)}static credentialFromError(f){return Xs.oauthCredentialFromTaggedObject(f.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{oauthIdToken:m,oauthAccessToken:E,oauthTokenSecret:S,pendingToken:R,nonce:Q,providerId:me}=f;if(!E&&!S&&!m&&!R||!me)return null;try{return new Xs(me)._credential({idToken:m,accessToken:E,nonce:Q,pendingToken:R})}catch{return null}}}let _a=(()=>{class v extends Cs{constructor(){super("facebook.com")}static credential(m){return Hi._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.FACEBOOK_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return v.credential(m.oauthAccessToken)}catch{return null}}}return v.FACEBOOK_SIGN_IN_METHOD="facebook.com",v.PROVIDER_ID="facebook.com",v})(),su=(()=>{class v extends Cs{constructor(){super("google.com"),this.addScope("profile")}static credential(m,E){return Hi._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.GOOGLE_SIGN_IN_METHOD,idToken:m,accessToken:E})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:E,oauthAccessToken:S}=m;if(!E&&!S)return null;try{return v.credential(E,S)}catch{return null}}}return v.GOOGLE_SIGN_IN_METHOD="google.com",v.PROVIDER_ID="google.com",v})(),al=(()=>{class v extends Cs{constructor(){super("github.com")}static credential(m){return Hi._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.GITHUB_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return v.credential(m.oauthAccessToken)}catch{return null}}}return v.GITHUB_SIGN_IN_METHOD="github.com",v.PROVIDER_ID="github.com",v})();class Ts extends In{constructor(f,m){super(f,f),this.pendingToken=m}_getIdTokenResponse(f){return _r(f,this.buildRequest())}_linkToIdToken(f,m){const E=this.buildRequest();return E.idToken=m,_r(f,E)}_getReauthenticationResolver(f){const m=this.buildRequest();return m.autoCreate=!1,_r(f,m)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(f){const m="string"==typeof f?JSON.parse(f):f,{providerId:E,signInMethod:S,pendingToken:R}=m;return E&&S&&R&&E===S?new Ts(E,R):null}static _create(f,m){return new Ts(f,m)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Po extends bs{constructor(f){j(f.startsWith("saml."),"argument-error"),super(f)}static credentialFromResult(f){return Po.samlCredentialFromTaggedObject(f)}static credentialFromError(f){return Po.samlCredentialFromTaggedObject(f.customData||{})}static credentialFromJSON(f){const m=Ts.fromJSON(f);return j(m,"argument-error"),m}static samlCredentialFromTaggedObject({_tokenResponse:f}){if(!f)return null;const{pendingToken:m,providerId:E}=f;if(!m||!E)return null;try{return Ts._create(E,m)}catch{return null}}}let Hr=(()=>{class v extends Cs{constructor(){super("twitter.com")}static credential(m,E){return Hi._fromParams({providerId:v.PROVIDER_ID,signInMethod:v.TWITTER_SIGN_IN_METHOD,oauthToken:m,oauthTokenSecret:E})}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthAccessToken:E,oauthTokenSecret:S}=m;if(!E||!S)return null;try{return v.credential(E,S)}catch{return null}}}return v.TWITTER_SIGN_IN_METHOD="twitter.com",v.PROVIDER_ID="twitter.com",v})();function Oo(v,f){return ya.apply(this,arguments)}function ya(){return(ya=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signUp",St(v,f))})).apply(this,arguments)}class ei{constructor(f){this.user=f.user,this.providerId=f.providerId,this._tokenResponse=f._tokenResponse,this.operationType=f.operationType}static _fromIdTokenResponse(f,m,E,S=!1){return(0,_.Z)(function*(){const R=yield ht._fromIdTokenResponse(f,E,S),Q=ug(E);return new ei({user:R,providerId:Q,_tokenResponse:E,operationType:m})})()}static _forOperation(f,m,E){return(0,_.Z)(function*(){yield f._updateTokensIfNecessary(E,!0);const S=ug(E);return new ei({user:f,providerId:S,_tokenResponse:E,operationType:m})})()}}function ug(v){return v.providerId?v.providerId:"phoneNumber"in v?"phone":null}function Xn(){return(Xn=(0,_.Z)(function*(v){var f;const m=X(v);if(yield m._initializationPromise,null!==(f=m.currentUser)&&void 0!==f&&f.isAnonymous)return new ei({user:m.currentUser,providerId:null,operationType:"signIn"});const E=yield Oo(m,{returnSecureToken:!0}),S=yield ei._fromIdTokenResponse(m,"signIn",E,!0);return yield m._updateCurrentUser(S.user),S})).apply(this,arguments)}class ou extends B.ZR{constructor(f,m,E,S){var R;super(m.code,m.message),this.operationType=E,this.user=S,Object.setPrototypeOf(this,ou.prototype),this.customData={appName:f.name,tenantId:null!==(R=f.tenantId)&&void 0!==R?R:void 0,_serverResponse:m.customData._serverResponse,operationType:E}}static _fromErrorAndOperation(f,m,E,S){return new ou(f,m,E,S)}}function Fo(v,f,m,E){return("reauthenticate"===f?m._getReauthenticationResolver(v):m._getIdTokenResponse(v)).catch(R=>{throw"auth/multi-factor-auth-required"===R.code?ou._fromErrorAndOperation(v,R,f,E):R})}function Js(v){return new Set(v.map(({providerId:f})=>f).filter(f=>!!f))}function qc(){return(qc=(0,_.Z)(function*(v,f){const m=(0,B.m9)(v);yield on(!0,m,f);const{providerUserInfo:E}=yield Pn(m.auth,{idToken:yield m.getIdToken(),deleteProvider:[f]}),S=Js(E||[]);return m.providerData=m.providerData.filter(R=>S.has(R.providerId)),S.has("phone")||(m.phoneNumber=null),yield m.auth._persistUserIfCurrent(m),m})).apply(this,arguments)}function ki(v,f){return eo.apply(this,arguments)}function eo(){return(eo=(0,_.Z)(function*(v,f,m=!1){const E=yield wn(v,f._linkToIdToken(v.auth,yield v.getIdToken()),m);return ei._forOperation(v,"link",E)})).apply(this,arguments)}function on(v,f,m){return Kc.apply(this,arguments)}function Kc(){return(Kc=(0,_.Z)(function*(v,f,m){yield un(f);const S=!1===v?"provider-already-linked":"no-such-provider";j(Js(f.providerData).has(m)===v,f.auth,S)})).apply(this,arguments)}function Lo(v,f){return ll.apply(this,arguments)}function ll(){return(ll=(0,_.Z)(function*(v,f,m=!1){var E;const{auth:S}=v,R="reauthenticate";try{const Q=yield wn(v,Fo(S,R,f,v),m);j(Q.idToken,S,"internal-error");const me=dt(Q.idToken);j(me,S,"internal-error");const{sub:qe}=me;return j(v.uid===qe,S,"user-mismatch"),ei._forOperation(v,R,Q)}catch(Q){throw"auth/user-not-found"===(null===(E=Q)||void 0===E?void 0:E.code)&&Pe(S,"user-mismatch"),Q}})).apply(this,arguments)}function ls(v,f){return au.apply(this,arguments)}function au(){return(au=(0,_.Z)(function*(v,f,m=!1){const E="signIn",S=yield Fo(v,E,f),R=yield ei._fromIdTokenResponse(v,E,S);return m||(yield v._updateCurrentUser(R.user)),R})).apply(this,arguments)}function va(v,f){return N.apply(this,arguments)}function N(){return(N=(0,_.Z)(function*(v,f){return ls(X(v),f)})).apply(this,arguments)}function O(v,f){return K.apply(this,arguments)}function K(){return(K=(0,_.Z)(function*(v,f){const m=(0,B.m9)(v);return yield on(!1,m,f.providerId),ki(m,f)})).apply(this,arguments)}function de(v,f){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,_.Z)(function*(v,f){return Lo((0,B.m9)(v),f)})).apply(this,arguments)}function tt(v,f){return gt.apply(this,arguments)}function gt(){return(gt=(0,_.Z)(function*(v,f){return On(v,"POST","/v1/accounts:signInWithCustomToken",St(v,f))})).apply(this,arguments)}function ir(){return(ir=(0,_.Z)(function*(v,f){const m=X(v),E=yield tt(m,{token:f,returnSecureToken:!0}),S=yield ei._fromIdTokenResponse(m,"signIn",E);return yield m._updateCurrentUser(S.user),S})).apply(this,arguments)}class Me{constructor(f,m){this.factorId=f,this.uid=m.mfaEnrollmentId,this.enrollmentTime=new Date(m.enrolledAt).toUTCString(),this.displayName=m.displayName}static _fromServerResponse(f,m){return"phoneInfo"in m?Et._fromServerResponse(f,m):Pe(f,"internal-error")}}class Et extends Me{constructor(f){super("phone",f),this.phoneNumber=f.phoneInfo}static _fromServerResponse(f,m){return new Et(m)}}function Vt(v,f,m){var E;j((null===(E=m.url)||void 0===E?void 0:E.length)>0,v,"invalid-continue-uri"),j(typeof m.dynamicLinkDomain>"u"||m.dynamicLinkDomain.length>0,v,"invalid-dynamic-link-domain"),f.continueUrl=m.url,f.dynamicLinkDomain=m.dynamicLinkDomain,f.canHandleCodeInApp=m.handleCodeInApp,m.iOS&&(j(m.iOS.bundleId.length>0,v,"missing-ios-bundle-id"),f.iOSBundleId=m.iOS.bundleId),m.android&&(j(m.android.packageName.length>0,v,"missing-android-pkg-name"),f.androidInstallApp=m.android.installApp,f.androidMinimumVersionCode=m.android.minimumVersion,f.androidPackageName=m.android.packageName)}function Hn(){return(Hn=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v),S={requestType:"PASSWORD_RESET",email:f};m&&Vt(E,S,m),yield $r(E,S)})).apply(this,arguments)}function Wi(){return(Wi=(0,_.Z)(function*(v,f,m){yield Xr((0,B.m9)(v),{oobCode:f,newPassword:m})})).apply(this,arguments)}function uu(){return(uu=(0,_.Z)(function*(v,f){yield il((0,B.m9)(v),{oobCode:f})})).apply(this,arguments)}function Ea(v,f){return to.apply(this,arguments)}function to(){return(to=(0,_.Z)(function*(v,f){const m=(0,B.m9)(v),E=yield Xr(m,{oobCode:f}),S=E.requestType;switch(j(S,m,"internal-error"),S){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":j(E.newEmail,m,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":j(E.mfaInfo,m,"internal-error");default:j(E.email,m,"internal-error")}let R=null;return E.mfaInfo&&(R=Me._fromServerResponse(X(m),E.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.newEmail:E.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.email:E.newEmail)||null,multiFactorInfo:R},operation:S}})).apply(this,arguments)}function ro(){return(ro=(0,_.Z)(function*(v,f){const{data:m}=yield Ea((0,B.m9)(v),f);return m.email})).apply(this,arguments)}function cr(){return(cr=(0,_.Z)(function*(v,f,m){const E=X(v),S=yield Oo(E,{returnSecureToken:!0,email:f,password:m}),R=yield ei._fromIdTokenResponse(E,"signIn",S);return yield E._updateCurrentUser(R.user),R})).apply(this,arguments)}function ba(){return(ba=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v),S={requestType:"EMAIL_SIGNIN",email:f};j(m.handleCodeInApp,E,"argument-error"),m&&Vt(E,S,m),yield No(E,S)})).apply(this,arguments)}function Uh(){return(Uh=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v),S=Gi.credentialWithLink(f,m||je());return j(S._tenantId===(E.tenantId||null),E,"tenant-id-mismatch"),va(E,S)})).apply(this,arguments)}function XE(v,f){return lg.apply(this,arguments)}function lg(){return(lg=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:createAuthUri",St(v,f))})).apply(this,arguments)}function cl(){return(cl=(0,_.Z)(function*(v,f){const E={identifier:f,continueUri:mt()?je():"http://localhost"},{signinMethods:S}=yield XE((0,B.m9)(v),E);return S||[]})).apply(this,arguments)}function dl(){return(dl=(0,_.Z)(function*(v,f){const m=(0,B.m9)(v),S={requestType:"VERIFY_EMAIL",idToken:yield v.getIdToken()};f&&Vt(m.auth,S,f);const{email:R}=yield Sr(m.auth,S);R!==v.email&&(yield v.reload())})).apply(this,arguments)}function Bh(){return(Bh=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v),R={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield v.getIdToken(),newEmail:f};m&&Vt(E.auth,R,m);const{email:Q}=yield tu(E.auth,R);Q!==v.email&&(yield v.reload())})).apply(this,arguments)}function dg(v,f){return Vh.apply(this,arguments)}function Vh(){return(Vh=(0,_.Z)(function*(v,f){return Zt(v,"POST","/v1/accounts:update",f)})).apply(this,arguments)}function jh(){return(jh=(0,_.Z)(function*(v,{displayName:f,photoURL:m}){if(void 0===f&&void 0===m)return;const E=(0,B.m9)(v),R={idToken:yield E.getIdToken(),displayName:f,photoUrl:m,returnSecureToken:!0},Q=yield wn(E,dg(E.auth,R));E.displayName=Q.displayName||null,E.photoURL=Q.photoUrl||null;const me=E.providerData.find(({providerId:qe})=>"password"===qe);me&&(me.displayName=E.displayName,me.photoURL=E.photoURL),yield E._updateTokensIfNecessary(Q)})).apply(this,arguments)}function lu(v,f,m){return $h.apply(this,arguments)}function $h(){return($h=(0,_.Z)(function*(v,f,m){const{auth:E}=v,R={idToken:yield v.getIdToken(),returnSecureToken:!0};f&&(R.email=f),m&&(R.password=m);const Q=yield wn(v,bn(E,R));yield v._updateTokensIfNecessary(Q,!0)})).apply(this,arguments)}class Pi{constructor(f,m,E={}){this.isNewUser=f,this.providerId=m,this.profile=E}}class Wn extends Pi{constructor(f,m,E,S){super(f,m,E),this.username=S}}class W_ extends Pi{constructor(f,m){super(f,"facebook.com",m)}}class z_ extends Wn{constructor(f,m){super(f,"github.com",m,"string"==typeof m?.login?m?.login:null)}}class q_ extends Pi{constructor(f,m){super(f,"google.com",m)}}class K_ extends Wn{constructor(f,m,E){super(f,"twitter.com",m,E)}}function Zc(v){const{user:f,_tokenResponse:m}=v;return f.isAnonymous&&!m?{providerId:null,isNewUser:!1,profile:null}:function Rr(v){var f,m;if(!v)return null;const{providerId:E}=v,S=v.rawUserInfo?JSON.parse(v.rawUserInfo):{},R=v.isNewUser||"identitytoolkit#SignupNewUserResponse"===v.kind;if(!E&&v?.idToken){const Q=null===(m=null===(f=dt(v.idToken))||void 0===f?void 0:f.firebase)||void 0===m?void 0:m.sign_in_provider;if(Q)return new Pi(R,"anonymous"!==Q&&"custom"!==Q?Q:null)}if(!E)return null;switch(E){case"facebook.com":return new W_(R,S);case"github.com":return new z_(R,S);case"google.com":return new q_(R,S);case"twitter.com":return new K_(R,S,v.screenName||null);case"custom":case"anonymous":return new Pi(R,null);default:return new Pi(R,E,S)}}(m)}class Ta{constructor(f,m,E){this.type=f,this.credential=m,this.auth=E}static _fromIdtoken(f,m){return new Ta("enroll",f,m)}static _fromMfaPendingCredential(f){return new Ta("signin",f)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(f){var m,E;if(f?.multiFactorSession){if(null!==(m=f.multiFactorSession)&&void 0!==m&&m.pendingCredential)return Ta._fromMfaPendingCredential(f.multiFactorSession.pendingCredential);if(null!==(E=f.multiFactorSession)&&void 0!==E&&E.idToken)return Ta._fromIdtoken(f.multiFactorSession.idToken)}return null}}class zh{constructor(f,m,E){this.session=f,this.hints=m,this.signInResolver=E}static _fromError(f,m){const E=X(f),S=m.customData._serverResponse,R=(S.mfaInfo||[]).map(me=>Me._fromServerResponse(E,me));j(S.mfaPendingCredential,E,"internal-error");const Q=Ta._fromMfaPendingCredential(S.mfaPendingCredential);return new zh(Q,R,function(){var me=(0,_.Z)(function*(qe){const ct=yield qe._process(E,Q);delete S.mfaInfo,delete S.mfaPendingCredential;const Dt=Object.assign(Object.assign({},S),{idToken:ct.idToken,refreshToken:ct.refreshToken});switch(m.operationType){case"signIn":const It=yield ei._fromIdTokenResponse(E,m.operationType,Dt);return yield E._updateCurrentUser(It.user),It;case"reauthenticate":return j(m.user,E,"internal-error"),ei._forOperation(m.user,m.operationType,Dt);default:Pe(E,"internal-error")}});return function(qe){return me.apply(this,arguments)}}())}resolveSignIn(f){var m=this;return(0,_.Z)(function*(){return m.signInResolver(f)})()}}function qh(v,f){return Zt(v,"POST","/v2/accounts/mfaEnrollment:start",St(v,f))}class Z_{constructor(f){this.user=f,this.enrolledFactors=[],f._onReload(m=>{m.mfaInfo&&(this.enrolledFactors=m.mfaInfo.map(E=>Me._fromServerResponse(f.auth,E)))})}static _fromUser(f){return new Z_(f)}getSession(){var f=this;return(0,_.Z)(function*(){return Ta._fromIdtoken(yield f.user.getIdToken(),f.user.auth)})()}enroll(f,m){var E=this;return(0,_.Z)(function*(){const S=f,R=yield E.getSession(),Q=yield wn(E.user,S._process(E.user.auth,R,m));return yield E.user._updateTokensIfNecessary(Q),E.user.reload()})()}unenroll(f){var m=this;return(0,_.Z)(function*(){var E;const S="string"==typeof f?f:f.uid,R=yield m.user.getIdToken(),Q=yield wn(m.user,function pg(v,f){return Zt(v,"POST","/v2/accounts/mfaEnrollment:withdraw",St(v,f))}(m.user.auth,{idToken:R,mfaEnrollmentId:S}));m.enrolledFactors=m.enrolledFactors.filter(({uid:me})=>me!==S),yield m.user._updateTokensIfNecessary(Q);try{yield m.user.reload()}catch(me){if("auth/user-token-expired"!==(null===(E=me)||void 0===E?void 0:E.code))throw me}})()}}const pl=new WeakMap,gl="__sak";class Jc{constructor(f,m){this.storageRetriever=f,this.type=m}_isAvailable(){try{return this.storage?(this.storage.setItem(gl,"1"),this.storage.removeItem(gl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(f,m){return this.storage.setItem(f,JSON.stringify(m)),Promise.resolve()}_get(f){const m=this.storage.getItem(f);return Promise.resolve(m?JSON.parse(m):null)}_remove(f){return this.storage.removeItem(f),Promise.resolve()}get storage(){return this.storageRetriever()}}const yl=(()=>{class v extends Jc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(m,E)=>this.onStorageEvent(m,E),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function ml(){const v=(0,B.z$)();return Qe(v)||Lt(v)}()&&function Rn(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Ri(),this._shouldAllowMigration=!0}forAllChangedKeys(m){for(const E of Object.keys(this.listeners)){const S=this.storage.getItem(E),R=this.localCache[E];S!==R&&m(E,R,S)}}onStorageEvent(m,E=!1){if(!m.key)return void this.forAllChangedKeys((me,qe,ct)=>{this.notifyListeners(me,ct)});const S=m.key;if(E?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const me=this.storage.getItem(S);if(m.newValue!==me)null!==m.newValue?this.storage.setItem(S,m.newValue):this.storage.removeItem(S);else if(this.localCache[S]===m.newValue&&!E)return}const R=()=>{const me=this.storage.getItem(S);!E&&this.localCache[S]===me||this.notifyListeners(S,me)},Q=this.storage.getItem(S);!function mn(){return(0,B.w1)()&&10===document.documentMode}()||Q===m.newValue||m.newValue===m.oldValue?R():setTimeout(R,10)}notifyListeners(m,E){this.localCache[m]=E;const S=this.listeners[m];if(S)for(const R of Array.from(S))R(E&&JSON.parse(E))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((m,E,S)=>{this.onStorageEvent(new StorageEvent("storage",{key:m,oldValue:E,newValue:S}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(m,E){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[m]||(this.listeners[m]=new Set,this.localCache[m]=this.storage.getItem(m)),this.listeners[m].add(E)}_removeListener(m,E){this.listeners[m]&&(this.listeners[m].delete(E),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(m,E){var S=()=>super._set,R=this;return(0,_.Z)(function*(){yield S().call(R,m,E),R.localCache[m]=JSON.stringify(E)})()}_get(m){var E=()=>super._get,S=this;return(0,_.Z)(function*(){const R=yield E().call(S,m);return S.localCache[m]=JSON.stringify(R),R})()}_remove(m){var E=()=>super._remove,S=this;return(0,_.Z)(function*(){yield E().call(S,m),delete S.localCache[m]})()}}return v.type="LOCAL",v})(),As=(()=>{class v extends Jc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(m,E){}_removeListener(m,E){}}return v.type="SESSION",v})();let _g=(()=>{class v{constructor(m){this.eventTarget=m,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(m){const E=this.receivers.find(R=>R.isListeningto(m));if(E)return E;const S=new v(m);return this.receivers.push(S),S}isListeningto(m){return this.eventTarget===m}handleEvent(m){var E=this;return(0,_.Z)(function*(){const S=m,{eventId:R,eventType:Q,data:me}=S.data,qe=E.handlersMap[Q];if(!qe?.size)return;S.ports[0].postMessage({status:"ack",eventId:R,eventType:Q});const ct=Array.from(qe).map(function(){var It=(0,_.Z)(function*(qn){return qn(S.origin,me)});return function(qn){return It.apply(this,arguments)}}()),Dt=yield function ed(v){return Promise.all(v.map(function(){var f=(0,_.Z)(function*(m){try{return{fulfilled:!0,value:yield m}}catch(E){return{fulfilled:!1,reason:E}}});return function(m){return f.apply(this,arguments)}}()))}(ct);S.ports[0].postMessage({status:"done",eventId:R,eventType:Q,response:Dt})})()}_subscribe(m,E){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[m]||(this.handlersMap[m]=new Set),this.handlersMap[m].add(E)}_unsubscribe(m,E){this.handlersMap[m]&&E&&this.handlersMap[m].delete(E),(!E||0===this.handlersMap[m].size)&&delete this.handlersMap[m],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return v.receivers=[],v})();function wl(v="",f=10){let m="";for(let E=0;E<f;E++)m+=Math.floor(10*Math.random());return v+m}class Y_{constructor(f){this.target=f,this.handlers=new Set}removeMessageHandler(f){f.messageChannel&&(f.messageChannel.port1.removeEventListener("message",f.onMessage),f.messageChannel.port1.close()),this.handlers.delete(f)}_send(f,m,E=50){var S=this;return(0,_.Z)(function*(){const R=typeof MessageChannel<"u"?new MessageChannel:null;if(!R)throw new Error("connection_unavailable");let Q,me;return new Promise((qe,ct)=>{const Dt=wl("",20);R.port1.start();const It=setTimeout(()=>{ct(new Error("unsupported_event"))},E);me={messageChannel:R,onMessage(qn){const Qi=qn;if(Qi.data.eventId===Dt)switch(Qi.data.status){case"ack":clearTimeout(It),Q=setTimeout(()=>{ct(new Error("timeout"))},3e3);break;case"done":clearTimeout(Q),qe(Qi.data.response);break;default:clearTimeout(It),clearTimeout(Q),ct(new Error("invalid_response"))}}},S.handlers.add(me),R.port1.addEventListener("message",me.onMessage),S.target.postMessage({eventType:f,eventId:Dt,data:m},[R.port2])}).finally(()=>{me&&S.removeMessageHandler(me)})})()}}function yr(){return window}function Kh(){return typeof yr().WorkerGlobalScope<"u"&&"function"==typeof yr().importScripts}function Il(){return(Il=(0,_.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const du="firebaseLocalStorageDb",hu="firebaseLocalStorage",rd="fbase_key";class bl{constructor(f){this.request=f}toPromise(){return new Promise((f,m)=>{this.request.addEventListener("success",()=>{f(this.request.result)}),this.request.addEventListener("error",()=>{m(this.request.error)})})}}function Cl(v,f){return v.transaction([hu],f?"readwrite":"readonly").objectStore(hu)}function fu(){const v=indexedDB.open(du,1);return new Promise((f,m)=>{v.addEventListener("error",()=>{m(v.error)}),v.addEventListener("upgradeneeded",()=>{const E=v.result;try{E.createObjectStore(hu,{keyPath:rd})}catch(S){m(S)}}),v.addEventListener("success",(0,_.Z)(function*(){const E=v.result;E.objectStoreNames.contains(hu)?f(E):(E.close(),yield function JE(){const v=indexedDB.deleteDatabase(du);return new bl(v).toPromise()}(),f(yield fu()))}))})}function Da(v,f,m){return Zh.apply(this,arguments)}function Zh(){return(Zh=(0,_.Z)(function*(v,f,m){const E=Cl(v,!0).put({[rd]:f,value:m});return new bl(E).toPromise()})).apply(this,arguments)}function Yh(){return(Yh=(0,_.Z)(function*(v,f){const m=Cl(v,!1).get(f),E=yield new bl(m).toPromise();return void 0===E?null:E.value})).apply(this,arguments)}function pu(v,f){const m=Cl(v,!0).delete(f);return new bl(m).toPromise()}const gu=(()=>{class v{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var m=this;return(0,_.Z)(function*(){return m.db||(m.db=yield fu()),m.db})()}_withRetries(m){var E=this;return(0,_.Z)(function*(){let S=0;for(;;)try{const R=yield E._openDb();return yield m(R)}catch(R){if(S++>3)throw R;E.db&&(E.db.close(),E.db=void 0)}})()}initializeServiceWorkerMessaging(){var m=this;return(0,_.Z)(function*(){return Kh()?m.initializeReceiver():m.initializeSender()})()}initializeReceiver(){var m=this;return(0,_.Z)(function*(){m.receiver=_g._getInstance(function nd(){return Kh()?self:null}()),m.receiver._subscribe("keyChanged",function(){var E=(0,_.Z)(function*(S,R){return{keyProcessed:(yield m._poll()).includes(R.key)}});return function(S,R){return E.apply(this,arguments)}}()),m.receiver._subscribe("ping",function(){var E=(0,_.Z)(function*(S,R){return["keyChanged"]});return function(S,R){return E.apply(this,arguments)}}())})()}initializeSender(){var m=this;return(0,_.Z)(function*(){var E,S;if(m.activeServiceWorker=yield function El(){return Il.apply(this,arguments)}(),!m.activeServiceWorker)return;m.sender=new Y_(m.activeServiceWorker);const R=yield m.sender._send("ping",{},800);!R||(null===(E=R[0])||void 0===E?void 0:E.fulfilled)&&(null===(S=R[0])||void 0===S?void 0:S.value.includes("keyChanged"))&&(m.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(m){var E=this;return(0,_.Z)(function*(){if(E.sender&&E.activeServiceWorker&&function td(){var v;return(null===(v=navigator?.serviceWorker)||void 0===v?void 0:v.controller)||null}()===E.activeServiceWorker)try{yield E.sender._send("keyChanged",{key:m},E.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,_.Z)(function*(){try{if(!indexedDB)return!1;const m=yield fu();return yield Da(m,gl,"1"),yield pu(m,gl),!0}catch{}return!1})()}_withPendingWrite(m){var E=this;return(0,_.Z)(function*(){E.pendingWrites++;try{yield m()}finally{E.pendingWrites--}})()}_set(m,E){var S=this;return(0,_.Z)(function*(){return S._withPendingWrite((0,_.Z)(function*(){return yield S._withRetries(R=>Da(R,m,E)),S.localCache[m]=E,S.notifyServiceWorker(m)}))})()}_get(m){var E=this;return(0,_.Z)(function*(){const S=yield E._withRetries(R=>function vg(v,f){return Yh.apply(this,arguments)}(R,m));return E.localCache[m]=S,S})()}_remove(m){var E=this;return(0,_.Z)(function*(){return E._withPendingWrite((0,_.Z)(function*(){return yield E._withRetries(S=>pu(S,m)),delete E.localCache[m],E.notifyServiceWorker(m)}))})()}_poll(){var m=this;return(0,_.Z)(function*(){const E=yield m._withRetries(Q=>{const me=Cl(Q,!1).getAll();return new bl(me).toPromise()});if(!E)return[];if(0!==m.pendingWrites)return[];const S=[],R=new Set;for(const{fbase_key:Q,value:me}of E)R.add(Q),JSON.stringify(m.localCache[Q])!==JSON.stringify(me)&&(m.notifyListeners(Q,me),S.push(Q));for(const Q of Object.keys(m.localCache))m.localCache[Q]&&!R.has(Q)&&(m.notifyListeners(Q,null),S.push(Q));return S})()}notifyListeners(m,E){this.localCache[m]=E;const S=this.listeners[m];if(S)for(const R of Array.from(S))R(E)}startPolling(){var m=this;this.stopPolling(),this.pollTimer=setInterval((0,_.Z)(function*(){return m._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(m,E){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[m]||(this.listeners[m]=new Set,this._get(m)),this.listeners[m].add(E)}_removeListener(m,E){this.listeners[m]&&(this.listeners[m].delete(E),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return v.type="LOCAL",v})();function id(v,f){return Zt(v,"POST","/v2/accounts/mfaSignIn:start",St(v,f))}function Sa(){return(Sa=(0,_.Z)(function*(v){return(yield Zt(v,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Qh(v){return new Promise((f,m)=>{const E=document.createElement("script");E.setAttribute("src",v),E.onload=f,E.onerror=S=>{const R=Te("internal-error");R.customData=S,m(R)},E.type="text/javascript",E.charset="UTF-8",function Dl(){var v,f;return null!==(f=null===(v=document.getElementsByTagName("head"))||void 0===v?void 0:v[0])&&void 0!==f?f:document}().appendChild(E)})}function Xh(v){return`__${v}${Math.floor(1e6*Math.random())}`}const Jh=1e12;class Un{constructor(f){this.auth=f,this.counter=Jh,this._widgets=new Map}render(f,m){const E=this.counter;return this._widgets.set(E,new e0(f,this.auth.name,m||{})),this.counter++,E}reset(f){var m;const E=f||Jh;null===(m=this._widgets.get(E))||void 0===m||m.delete(),this._widgets.delete(E)}getResponse(f){var m;return(null===(m=this._widgets.get(f||Jh))||void 0===m?void 0:m.getResponse())||""}execute(f){var m=this;return(0,_.Z)(function*(){var E;return null===(E=m._widgets.get(f||Jh))||void 0===E||E.execute(),""})()}}class e0{constructor(f,m,E){this.params=E,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const S="string"==typeof f?document.getElementById(f):f;j(S,"argument-error",{appName:m}),this.container=S,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function dD(v){const f=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let E=0;E<v;E++)f.push(m.charAt(Math.floor(Math.random()*m.length)));return f.join("")}(50);const{callback:f,"expired-callback":m}=this.params;if(f)try{f(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,m)try{m()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Q_=Xh("rcb"),hD=new yn(3e4,6e4);class pD{constructor(){var f;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(f=yr().grecaptcha)||void 0===f||!f.render)}load(f,m=""){return j(function gD(v){return v.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(v)}(m),f,"argument-error"),this.shouldResolveImmediately(m)?Promise.resolve(yr().grecaptcha):new Promise((E,S)=>{const R=yr().setTimeout(()=>{S(Te(f,"network-request-failed"))},hD.get());yr()[Q_]=()=>{yr().clearTimeout(R),delete yr()[Q_];const me=yr().grecaptcha;if(!me)return void S(Te(f,"internal-error"));const qe=me.render;me.render=(ct,Dt)=>{const It=qe(ct,Dt);return this.counter++,It},this.hostLanguage=m,E(me)},Qh(`https://www.google.com/recaptcha/api.js??${(0,B.xO)({onload:Q_,render:"explicit",hl:m})}`).catch(()=>{clearTimeout(R),S(Te(f,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(f){var m;return!(null===(m=yr().grecaptcha)||void 0===m||!m.render)&&(f===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class od{load(f){return(0,_.Z)(function*(){return new Un(f)})()}clearedOneInstance(){}}const t0="recaptcha",n0={theme:"light",type:"image"};class Nr{constructor(f,m=Object.assign({},n0),E){this.parameters=m,this.type=t0,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=X(E),this.isInvisible="invisible"===this.parameters.size,j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const S="string"==typeof f?document.getElementById(f):f;j(S,this.auth,"argument-error"),this.container=S,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new od:new pD,this.validateStartingState()}verify(){var f=this;return(0,_.Z)(function*(){f.assertNotDestroyed();const m=yield f.render(),E=f.getAssertedRecaptcha();return E.getResponse(m)||new Promise(R=>{const Q=me=>{!me||(f.tokenChangeListeners.delete(Q),R(me))};f.tokenChangeListeners.add(Q),f.isInvisible&&E.execute(m)})})()}render(){try{this.assertNotDestroyed()}catch(f){return Promise.reject(f)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(f=>{throw this.renderPromise=null,f})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(f=>{this.container.removeChild(f)})}validateStartingState(){j(!this.parameters.sitekey,this.auth,"argument-error"),j(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),j(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(f){return m=>{if(this.tokenChangeListeners.forEach(E=>E(m)),"function"==typeof f)f(m);else if("string"==typeof f){const E=yr()[f];"function"==typeof E&&E(m)}}}assertNotDestroyed(){j(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var f=this;return(0,_.Z)(function*(){if(yield f.init(),!f.widgetId){let m=f.container;if(!f.isInvisible){const E=document.createElement("div");m.appendChild(E),m=E}f.widgetId=f.getAssertedRecaptcha().render(m,f.parameters)}return f.widgetId})()}init(){var f=this;return(0,_.Z)(function*(){j(mt()&&!Kh(),f.auth,"internal-error"),yield function be(){let v=null;return new Promise(f=>{"complete"!==document.readyState?(v=()=>f(),window.addEventListener("load",v)):f()}).catch(f=>{throw v&&window.removeEventListener("load",v),f})}(),f.recaptcha=yield f._recaptchaLoader.load(f.auth,f.auth.languageCode||void 0);const m=yield function Tl(v){return Sa.apply(this,arguments)}(f.auth);j(m,f.auth,"internal-error"),f.parameters.sitekey=m})()}getAssertedRecaptcha(){return j(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Jn{constructor(f,m){this.verificationId=f,this.onConfirmation=m}confirm(f){const m=Is._fromVerification(this.verificationId,f);return this.onConfirmation(m)}}function k(){return(k=(0,_.Z)(function*(v,f,m){const E=X(v),S=yield so(E,f,(0,B.m9)(m));return new Jn(S,R=>va(E,R))})).apply(this,arguments)}function zi(){return(zi=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v);yield on(!1,E,"phone");const S=yield so(E.auth,f,(0,B.m9)(m));return new Jn(S,R=>O(E,R))})).apply(this,arguments)}function $o(){return($o=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v),S=yield so(E.auth,f,(0,B.m9)(m));return new Jn(S,R=>de(E,R))})).apply(this,arguments)}function so(v,f,m){return ad.apply(this,arguments)}function ad(){return(ad=(0,_.Z)(function*(v,f,m){var E;const S=yield m.verify();try{let R;if(j("string"==typeof S,v,"argument-error"),j(m.type===t0,v,"argument-error"),R="string"==typeof f?{phoneNumber:f}:f,"session"in R){const Q=R.session;if("phoneNumber"in R)return j("enroll"===Q.type,v,"internal-error"),(yield qh(v,{idToken:Q.credential,phoneEnrollmentInfo:{phoneNumber:R.phoneNumber,recaptchaToken:S}})).phoneSessionInfo.sessionInfo;{j("signin"===Q.type,v,"internal-error");const me=(null===(E=R.multiFactorHint)||void 0===E?void 0:E.uid)||R.multiFactorUid;return j(me,v,"missing-multi-factor-info"),(yield id(v,{mfaPendingCredential:Q.credential,mfaEnrollmentId:me,phoneSignInInfo:{recaptchaToken:S}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:Q}=yield $c(v,{phoneNumber:R.phoneNumber,recaptchaToken:S});return Q}}finally{m._reset()}})).apply(this,arguments)}function ud(){return(ud=(0,_.Z)(function*(v,f){yield ki((0,B.m9)(v),f)})).apply(this,arguments)}let xs=(()=>{class v{constructor(m){this.providerId=v.PROVIDER_ID,this.auth=X(m)}verifyPhoneNumber(m,E){return so(this.auth,m,(0,B.m9)(E))}static credential(m,E){return Is._fromVerification(m,E)}static credentialFromResult(m){return v.credentialFromTaggedObject(m)}static credentialFromError(m){return v.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{phoneNumber:E,temporaryProof:S}=m;return E&&S?Is._fromTokenResponse(E,S):null}}return v.PROVIDER_ID="phone",v.PHONE_SIGN_IN_METHOD="phone",v})();function Ho(v,f){return f?le(f):(j(v._popupRedirectResolver,v,"argument-error"),v._popupRedirectResolver)}class oo extends In{constructor(f){super("custom","custom"),this.params=f}_getIdTokenResponse(f){return _r(f,this._buildIdpRequest())}_linkToIdToken(f,m){return _r(f,this._buildIdpRequest(m))}_getReauthenticationResolver(f){return _r(f,this._buildIdpRequest())}_buildIdpRequest(f){const m={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return f&&(m.idToken=f),m}}function mi(v){return ls(v.auth,new oo(v),v.bypassAuthState)}function ld(v){const{auth:f,user:m}=v;return j(m,f,"internal-error"),Lo(m,new oo(v),v.bypassAuthState)}function Rs(v){return Go.apply(this,arguments)}function Go(){return(Go=(0,_.Z)(function*(v){const{auth:f,user:m}=v;return j(m,f,"internal-error"),ki(m,new oo(v),v.bypassAuthState)})).apply(this,arguments)}class cd{constructor(f,m,E,S,R=!1){this.auth=f,this.resolver=E,this.user=S,this.bypassAuthState=R,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(m)?m:[m]}execute(){var f=this;return new Promise(function(){var m=(0,_.Z)(function*(E,S){f.pendingPromise={resolve:E,reject:S};try{f.eventManager=yield f.resolver._initialize(f.auth),yield f.onExecution(),f.eventManager.registerConsumer(f)}catch(R){f.reject(R)}});return function(E,S){return m.apply(this,arguments)}}())}onAuthEvent(f){var m=this;return(0,_.Z)(function*(){const{urlResponse:E,sessionId:S,postBody:R,tenantId:Q,error:me,type:qe}=f;if(me)return void m.reject(me);const ct={auth:m.auth,requestUri:E,sessionId:S,tenantId:Q||void 0,postBody:R||void 0,user:m.user,bypassAuthState:m.bypassAuthState};try{m.resolve(yield m.getIdpTask(qe)(ct))}catch(Dt){m.reject(Dt)}})()}onError(f){this.reject(f)}getIdpTask(f){switch(f){case"signInViaPopup":case"signInViaRedirect":return mi;case"linkViaPopup":case"linkViaRedirect":return Rs;case"reauthViaPopup":case"reauthViaRedirect":return ld;default:Pe(this.auth,"internal-error")}}resolve(f){J(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(f),this.unregisterAndCleanUp()}reject(f){J(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(f),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ig=new yn(2e3,1e4);function Aa(){return(Aa=(0,_.Z)(function*(v,f,m){const E=X(v);Ze(v,f,bs);const S=Ho(E,m);return new ao(E,"signInViaPopup",f,S).executeNotNull()})).apply(this,arguments)}function qi(){return(qi=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v);Ze(E.auth,f,bs);const S=Ho(E.auth,m);return new ao(E.auth,"reauthViaPopup",f,S,E).executeNotNull()})).apply(this,arguments)}function Al(){return(Al=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v);Ze(E.auth,f,bs);const S=Ho(E.auth,m);return new ao(E.auth,"linkViaPopup",f,S,E).executeNotNull()})).apply(this,arguments)}let ao=(()=>{class v extends cd{constructor(m,E,S,R,Q){super(m,E,R,Q),this.provider=S,this.authWindow=null,this.pollId=null,v.currentPopupAction&&v.currentPopupAction.cancel(),v.currentPopupAction=this}executeNotNull(){var m=this;return(0,_.Z)(function*(){const E=yield m.execute();return j(E,m.auth,"internal-error"),E})()}onExecution(){var m=this;return(0,_.Z)(function*(){J(1===m.filter.length,"Popup operations only handle one event");const E=wl();m.authWindow=yield m.resolver._openPopup(m.auth,m.provider,m.filter[0],E),m.authWindow.associatedEvent=E,m.resolver._originValidation(m.auth).catch(S=>{m.reject(S)}),m.resolver._isIframeWebStorageSupported(m.auth,S=>{S||m.reject(Te(m.auth,"web-storage-unsupported"))}),m.pollUserCancellation()})()}get eventId(){var m;return(null===(m=this.authWindow)||void 0===m?void 0:m.associatedEvent)||null}cancel(){this.reject(Te(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,v.currentPopupAction=null}pollUserCancellation(){const m=()=>{var E,S;this.pollId=null!==(S=null===(E=this.authWindow)||void 0===E?void 0:E.window)&&void 0!==S&&S.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Te(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(m,Ig.get())};m()}}return v.currentPopupAction=null,v})();const Wr=new Map;class Ki extends cd{constructor(f,m,E=!1){super(f,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],m,void 0,E),this.eventId=null}execute(){var f=()=>super.execute,m=this;return(0,_.Z)(function*(){let E=Wr.get(m.auth._key());if(!E){try{const R=(yield function Ns(v,f){return nf.apply(this,arguments)}(m.resolver,m.auth))?yield f().call(m):null;E=()=>Promise.resolve(R)}catch(S){E=()=>Promise.reject(S)}Wr.set(m.auth._key(),E)}return m.bypassAuthState||Wr.set(m.auth._key(),()=>Promise.resolve(null)),E()})()}onAuthEvent(f){var m=()=>super.onAuthEvent,E=this;return(0,_.Z)(function*(){if("signInViaRedirect"===f.type)return m().call(E,f);if("unknown"!==f.type){if(f.eventId){const S=yield E.auth._redirectUserForId(f.eventId);if(S)return E.user=S,m().call(E,f);E.resolve(null)}}else E.resolve(null)})()}onExecution(){return(0,_.Z)(function*(){})()}cleanUp(){}}function nf(){return(nf=(0,_.Z)(function*(v,f){const m=bg(f),E=Wo(v);if(!(yield E._isAvailable()))return!1;const S="true"===(yield E._get(m));return yield E._remove(m),S})).apply(this,arguments)}function Ma(v,f){return Ml.apply(this,arguments)}function Ml(){return(Ml=(0,_.Z)(function*(v,f){return Wo(v)._set(bg(f),"true")})).apply(this,arguments)}function zn(v,f){Wr.set(v._key(),f)}function Wo(v){return le(v._redirectPersistence)}function bg(v){return ae("pendingRedirect",v.config.apiKey,v.name)}function dd(){return(dd=(0,_.Z)(function*(v,f,m){const E=X(v);Ze(v,f,bs);const S=Ho(E,m);return yield Ma(S,E),S._openRedirect(E,f,"signInViaRedirect")})).apply(this,arguments)}function mu(){return(mu=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v);Ze(E.auth,f,bs);const S=Ho(E.auth,m);yield Ma(S,E.auth);const R=yield pd(E);return S._openRedirect(E.auth,f,"reauthViaRedirect",R)})).apply(this,arguments)}function uo(){return(uo=(0,_.Z)(function*(v,f,m){const E=(0,B.m9)(v);Ze(E.auth,f,bs);const S=Ho(E.auth,m);yield on(!1,E,f.providerId),yield Ma(S,E.auth);const R=yield pd(E);return S._openRedirect(E.auth,f,"linkViaRedirect",R)})).apply(this,arguments)}function fd(){return(fd=(0,_.Z)(function*(v,f){return yield X(v)._initializationPromise,Zi(v,f,!1)})).apply(this,arguments)}function Zi(v,f){return yu.apply(this,arguments)}function yu(){return(yu=(0,_.Z)(function*(v,f,m=!1){const E=X(v),S=Ho(E,f),Q=yield new Ki(E,S,m).execute();return Q&&!m&&(delete Q.user._redirectEventId,yield E._persistUserIfCurrent(Q.user),yield E._setRedirectUser(null,f)),Q})).apply(this,arguments)}function pd(v){return zo.apply(this,arguments)}function zo(){return(zo=(0,_.Z)(function*(v){const f=wl(`${v.uid}:::`);return v._redirectEventId=f,yield v.auth._setRedirectUser(v),yield v.auth._persistUserIfCurrent(v),f})).apply(this,arguments)}class gd{constructor(f){this.auth=f,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(f){this.consumers.add(f),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,f)&&(this.sendToConsumer(this.queuedRedirectEvent,f),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(f){this.consumers.delete(f)}onEvent(f){if(this.hasEventBeenHandled(f))return!1;let m=!1;return this.consumers.forEach(E=>{this.isEventForConsumer(f,E)&&(m=!0,this.sendToConsumer(f,E),this.saveEventToCache(f))}),this.hasHandledPotentialRedirect||!function Ra(v){switch(v.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return af(v);default:return!1}}(f)||(this.hasHandledPotentialRedirect=!0,m||(this.queuedRedirectEvent=f,m=!0)),m}sendToConsumer(f,m){var E;if(f.error&&!af(f)){const S=(null===(E=f.error.code)||void 0===E?void 0:E.split("auth/")[1])||"internal-error";m.onError(Te(this.auth,S))}else m.onAuthEvent(f)}isEventForConsumer(f,m){const E=null===m.eventId||!!f.eventId&&f.eventId===m.eventId;return m.filter.includes(f.type)&&E}hasEventBeenHandled(f){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(sf(f))}saveEventToCache(f){this.cachedEventUids.add(sf(f)),this.lastProcessedEventTime=Date.now()}}function sf(v){return[v.type,v.eventId,v.sessionId,v.tenantId].filter(f=>f).join("-")}function af({type:v,error:f}){return"unknown"===v&&"auth/no-auth-event"===f?.code}function qo(v){return md.apply(this,arguments)}function md(){return(md=(0,_.Z)(function*(v,f={}){return Zt(v,"GET","/v1/projects",f)})).apply(this,arguments)}const ey=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_d=/^https?/;function uf(){return(uf=(0,_.Z)(function*(v){if(v.config.emulator)return;const{authorizedDomains:f}=yield qo(v);for(const m of f)try{if(ny(m))return}catch{}Pe(v,"unauthorized-domain")})).apply(this,arguments)}function ny(v){const f=je(),{protocol:m,hostname:E}=new URL(f);if(v.startsWith("chrome-extension://")){const Q=new URL(v);return""===Q.hostname&&""===E?"chrome-extension:"===m&&v.replace("chrome-extension://","")===f.replace("chrome-extension://",""):"chrome-extension:"===m&&Q.hostname===E}if(!_d.test(m))return!1;if(ey.test(v))return E===v;const S=v.replace(/\./g,"\\.");return new RegExp("^(.+\\."+S+"|"+S+")$","i").test(E)}const lf=new yn(3e4,6e4);function yd(){const v=yr().___jsl;if(v?.H)for(const f of Object.keys(v.H))if(v.H[f].r=v.H[f].r||[],v.H[f].L=v.H[f].L||[],v.H[f].r=[...v.H[f].L],v.CP)for(let m=0;m<v.CP.length;m++)v.CP[m]=null}let Nl=null;function ry(v){return Nl=Nl||function vu(v){return new Promise((f,m)=>{var E,S,R;function Q(){yd(),gapi.load("gapi.iframes",{callback:()=>{f(gapi.iframes.getContext())},ontimeout:()=>{yd(),m(Te(v,"network-request-failed"))},timeout:lf.get()})}if(null!==(S=null===(E=yr().gapi)||void 0===E?void 0:E.iframes)&&void 0!==S&&S.Iframe)f(gapi.iframes.getContext());else{if(null===(R=yr().gapi)||void 0===R||!R.load){const me=Xh("iframefcb");return yr()[me]=()=>{gapi.load?Q():m(Te(v,"network-request-failed"))},Qh(`https://apis.google.com/js/api.js?onload=${me}`).catch(qe=>m(qe))}Q()}}).catch(f=>{throw Nl=null,f})}(v),Nl}const cf=new yn(5e3,15e3),o0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vd=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Dg(v){const f=v.config;j(f.authDomain,v,"auth-domain-config-required");const m=f.emulator?ar(f,"emulator/auth/iframe"):`https://${v.config.authDomain}/__/auth/iframe`,E={apiKey:f.apiKey,appName:v.name,v:ue.SDK_VERSION},S=vd.get(v.config.apiHost);S&&(E.eid=S);const R=v._getFrameworks();return R.length&&(E.fw=R.join(",")),`${m}?${(0,B.xO)(E).slice(1)}`}function wu(){return wu=(0,_.Z)(function*(v){const f=yield ry(v),m=yr().gapi;return j(m,v,"internal-error"),f.open({where:document.body,url:Dg(v),messageHandlersFilter:m.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o0,dontclear:!0},E=>new Promise(function(){var S=(0,_.Z)(function*(R,Q){yield E.restyle({setHideOnLeave:!1});const me=Te(v,"network-request-failed"),qe=yr().setTimeout(()=>{Q(me)},cf.get());function ct(){yr().clearTimeout(qe),R(E)}E.ping(ct).then(ct,()=>{Q(me)})});return function(R,Q){return S.apply(this,arguments)}}()))}),wu.apply(this,arguments)}const hf={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Iu{constructor(f){this.window=f,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bu(v,f,m,E,S,R){j(v.config.authDomain,v,"auth-domain-config-required"),j(v.config.apiKey,v,"invalid-api-key");const Q={apiKey:v.config.apiKey,appName:v.name,authType:m,redirectUrl:E,v:ue.SDK_VERSION,eventId:S};if(f instanceof bs){f.setDefaultLanguage(v.languageCode),Q.providerId=f.providerId||"",(0,B.xb)(f.getCustomParameters())||(Q.customParameters=JSON.stringify(f.getCustomParameters()));for(const[qe,ct]of Object.entries(R||{}))Q[qe]=ct}if(f instanceof Cs){const qe=f.getScopes().filter(ct=>""!==ct);qe.length>0&&(Q.scopes=qe.join(","))}v.tenantId&&(Q.tid=v.tenantId);const me=Q;for(const qe of Object.keys(me))void 0===me[qe]&&delete me[qe];return`${function ay({config:v}){return v.emulator?ar(v,"emulator/auth/handler"):`https://${v.authDomain}/__/auth/handler`}(v)}?${(0,B.xO)(me).slice(1)}`}const pf="webStorageSupport";class ks extends class Mg{constructor(f){this.factorId=f}_process(f,m,E){switch(m.type){case"enroll":return this._finalizeEnroll(f,m.credential,E);case"signin":return this._finalizeSignIn(f,m.credential);default:return Ce("unexpected MultiFactorSessionType")}}}{constructor(f){super("phone"),this.credential=f}static _fromCredential(f){return new ks(f)}_finalizeEnroll(f,m,E){return function Xc(v,f){return Zt(v,"POST","/v2/accounts/mfaEnrollment:finalize",St(v,f))}(f,{idToken:m,displayName:E,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(f,m){return function sd(v,f){return Zt(v,"POST","/v2/accounts/mfaSignIn:finalize",St(v,f))}(f,{mfaPendingCredential:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let kl=(()=>{class v{constructor(){}static assertion(m){return ks._fromCredential(m)}}return v.FACTOR_ID="phone",v})();var xg="@firebase/auth";class Rg{constructor(f){this.auth=f,this.internalListeners=new Map}getUid(){var f;return this.assertAuthConfigured(),(null===(f=this.auth.currentUser)||void 0===f?void 0:f.uid)||null}getToken(f){var m=this;return(0,_.Z)(function*(){return m.assertAuthConfigured(),yield m.auth._initializationPromise,m.auth.currentUser?{accessToken:yield m.auth.currentUser.getIdToken(f)}:null})()}addAuthTokenListener(f){if(this.assertAuthConfigured(),this.internalListeners.has(f))return;const m=this.auth.onIdTokenChanged(E=>{var S;f((null===(S=E)||void 0===S?void 0:S.stsTokenManager.accessToken)||null)});this.internalListeners.set(f,m),this.updateProactiveRefresh()}removeAuthTokenListener(f){this.assertAuthConfigured();const m=this.internalListeners.get(f);!m||(this.internalListeners.delete(f),m(),this.updateProactiveRefresh())}assertAuthConfigured(){j(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ko(){return window}function Ed(){return(Ed=(0,_.Z)(function*(v,f,m){var E;const{BuildInfo:S}=Ko();J(f.sessionId,"AuthEvent did not contain a session ID");const R=yield gf(f.sessionId),Q={};return Lt()?Q.ibi=S.packageName:Ft()?Q.apn=S.packageName:Pe(v,"operation-not-supported-in-this-environment"),S.displayName&&(Q.appDisplayName=S.displayName),Q.sessionId=R,bu(v,m,f.type,void 0,null!==(E=f.eventId)&&void 0!==E?E:void 0,Q)})).apply(this,arguments)}function Pl(){return(Pl=(0,_.Z)(function*(v){const{BuildInfo:f}=Ko(),m={};Lt()?m.iosBundleId=f.packageName:Ft()?m.androidPackageName=f.packageName:Pe(v,"operation-not-supported-in-this-environment"),yield qo(v,m)})).apply(this,arguments)}function Ol(){return(Ol=(0,_.Z)(function*(v,f,m){const{cordova:E}=Ko();let S=()=>{};try{yield new Promise((R,Q)=>{let me=null;function qe(){var It;R();const qn=null===(It=E.plugins.browsertab)||void 0===It?void 0:It.close;"function"==typeof qn&&qn(),"function"==typeof m?.close&&m.close()}function ct(){me||(me=window.setTimeout(()=>{Q(Te(v,"redirect-cancelled-by-user"))},2e3))}function Dt(){"visible"===document?.visibilityState&&ct()}f.addPassiveListener(qe),document.addEventListener("resume",ct,!1),Ft()&&document.addEventListener("visibilitychange",Dt,!1),S=()=>{f.removePassiveListener(qe),document.removeEventListener("resume",ct,!1),document.removeEventListener("visibilitychange",Dt,!1),me&&window.clearTimeout(me)}})}finally{S()}})).apply(this,arguments)}function gf(v){return mf.apply(this,arguments)}function mf(){return(mf=(0,_.Z)(function*(v){const f=An(v),m=yield crypto.subtle.digest("SHA-256",f);return Array.from(new Uint8Array(m)).map(S=>S.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function An(v){if(J(/[0-9a-zA-Z]+/.test(v),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(v);const f=new ArrayBuffer(v.length),m=new Uint8Array(f);for(let E=0;E<v.length;E++)m[E]=v.charCodeAt(E);return m}!function a0(v){(0,ue._registerComponent)(new ce.wA("auth",(f,{options:m})=>{const E=f.getProvider("app").getImmediate(),S=f.getProvider("heartbeat"),{apiKey:R,authDomain:Q}=E.options;return((me,qe)=>{j(R&&!R.includes(":"),"invalid-api-key",{appName:me.name}),j(!Q?.includes(":"),"argument-error",{appName:me.name});const ct={apiKey:R,authDomain:Q,clientPlatform:v,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$i(v)},Dt=new $t(me,qe,ct);return function We(v,f){const m=f?.persistence||[],E=(Array.isArray(m)?m:[m]).map(le);f?.errorMap&&v._updateErrorMap(f.errorMap),v._initializeWithPersistence(E,f?.popupRedirectResolver)}(Dt,m),Dt})(E,S)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((f,m,E)=>{f.getProvider("auth-internal").initialize()})),(0,ue._registerComponent)(new ce.wA("auth-internal",f=>{const m=X(f.getProvider("auth").getImmediate());return new Rg(m)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,ue.registerVersion)(xg,"0.20.7",function ly(v){switch(v){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(v)),(0,ue.registerVersion)(xg,"0.20.7","esm2017")}("Browser");class Qt extends gd{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(f=>{this.resolveInialized=f})}addPassiveListener(f){this.passiveListeners.add(f)}removePassiveListener(f){this.passiveListeners.delete(f)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(f){return this.resolveInialized(),this.passiveListeners.forEach(m=>m(f)),super.onEvent(f)}initialized(){var f=this;return(0,_.Z)(function*(){yield f.initPromise})()}}function _f(v){return Id.apply(this,arguments)}function Id(){return(Id=(0,_.Z)(function*(v){const f=yield Vn()._get(Xt(v));return f&&(yield Vn()._remove(Xt(v))),f})).apply(this,arguments)}function Og(){const v=[],f="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let m=0;m<20;m++){const E=Math.floor(Math.random()*f.length);v.push(f.charAt(E))}return v.join("")}function Vn(){return le(yl)}function Xt(v){return ae("authEvent",v.config.apiKey,v.name)}function Tu(v){if(!v?.includes("?"))return{};const[f,...m]=v.split("?");return(0,B.zd)(m.join("?"))}function Fg(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Te("no-auth-event")}}function Bl(){var v;return(null===(v=self?.location)||void 0===v?void 0:v.protocol)||null}function Bg(v=(0,B.z$)()){return!("file:"!==Bl()&&"ionic:"!==Bl()&&"capacitor:"!==Bl()||!v.toLowerCase().match(/iphone|ipad|ipod|android/))}function Jt(){try{const v=self.localStorage,f=wl();if(v)return v.setItem(f,"1"),v.removeItem(f),!function cs(v=(0,B.z$)()){return function l0(){return(0,B.w1)()&&11===document?.documentMode}()||function hy(v=(0,B.z$)()){return/Edge\/\d+/.test(v)}(v)}()||(0,B.hl)()}catch{return ka()&&(0,B.hl)()}return!1}function ka(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function Pa(){return(function Ug(){return"http:"===Bl()||"https:"===Bl()}()||(0,B.ru)()||Bg())&&!function dy(){return(0,B.b$)()||(0,B.UG)()}()&&Jt()&&!ka()}function Td(){return Bg()&&typeof document<"u"}function Oa(){return(Oa=(0,_.Z)(function*(){return!!Td()&&new Promise(v=>{const f=setTimeout(()=>{v(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(f),v(!0)})})})).apply(this,arguments)}const hi={LOCAL:"local",NONE:"none",SESSION:"session"},zr=j,Vg="persistence";function Du(v){return Dd.apply(this,arguments)}function Dd(){return(Dd=(0,_.Z)(function*(v){yield v._initializationPromise;const f=yf(),m=ae(Vg,v.config.apiKey,v.name);f&&f.setItem(m,v._getPersistence())})).apply(this,arguments)}function yf(){var v;try{return(null===(v=function Yi(){return typeof window<"u"?window:null}())||void 0===v?void 0:v.sessionStorage)||null}catch{return null}}const Sd=j;class ri{constructor(){this.browserResolver=le(class wd{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=As,this._completeRedirectFn=Zi,this._overrideRedirectResult=zn}_openPopup(f,m,E,S){var R=this;return(0,_.Z)(function*(){var Q;J(null===(Q=R.eventManagers[f._key()])||void 0===Q?void 0:Q.manager,"_initialize() not called before _openPopup()");const me=bu(f,m,E,je(),S);return function ff(v,f,m,E=500,S=600){const R=Math.max((window.screen.availHeight-S)/2,0).toString(),Q=Math.max((window.screen.availWidth-E)/2,0).toString();let me="";const qe=Object.assign(Object.assign({},hf),{width:E.toString(),height:S.toString(),top:R,left:Q}),ct=(0,B.z$)().toLowerCase();m&&(me=Tt(ct)?"_blank":m),Be(ct)&&(f=f||"http://localhost",qe.scrollbars="yes");const Dt=Object.entries(qe).reduce((qn,[Qi,Yo])=>`${qn}${Qi}=${Yo},`,"");if(function Yn(v=(0,B.z$)()){var f;return Lt(v)&&!(null===(f=window.navigator)||void 0===f||!f.standalone)}(ct)&&"_self"!==me)return function Sg(v,f){const m=document.createElement("a");m.href=v,m.target=f;const E=document.createEvent("MouseEvent");E.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),m.dispatchEvent(E)}(f||"",me),new Iu(null);const It=window.open(f||"",me,Dt);j(It,v,"popup-blocked");try{It.focus()}catch{}return new Iu(It)}(f,me,wl())})()}_openRedirect(f,m,E,S){var R=this;return(0,_.Z)(function*(){return yield R._originValidation(f),function io(v){yr().location.href=v}(bu(f,m,E,je(),S)),new Promise(()=>{})})()}_initialize(f){const m=f._key();if(this.eventManagers[m]){const{manager:S,promise:R}=this.eventManagers[m];return S?Promise.resolve(S):(J(R,"If manager is not set, promise should be"),R)}const E=this.initAndGetManager(f);return this.eventManagers[m]={promise:E},E.catch(()=>{delete this.eventManagers[m]}),E}initAndGetManager(f){var m=this;return(0,_.Z)(function*(){const E=yield function df(v){return wu.apply(this,arguments)}(f),S=new gd(f);return E.register("authEvent",R=>(j(R?.authEvent,f,"invalid-auth-event"),{status:S.onEvent(R.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),m.eventManagers[f._key()]={manager:S},m.iframes[f._key()]=E,S})()}_isIframeWebStorageSupported(f,m){this.iframes[f._key()].send(pf,{type:pf},S=>{var R;const Q=null===(R=S?.[0])||void 0===R?void 0:R[pf];void 0!==Q&&m(!!Q),Pe(f,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(f){const m=f._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function ty(v){return uf.apply(this,arguments)}(f)),this.originValidationPromises[m]}get _shouldInitProactively(){return Ri()||Qe()||Lt()}}),this.cordovaResolver=le(class cy{constructor(){this._redirectPersistence=As,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Zi,this._overrideRedirectResult=zn}_initialize(f){var m=this;return(0,_.Z)(function*(){const E=f._key();let S=m.eventManagers.get(E);return S||(S=new Qt(f),m.eventManagers.set(E,S),m.attachCallbackListeners(f,S)),S})()}_openPopup(f){Pe(f,"operation-not-supported-in-this-environment")}_openRedirect(f,m,E,S){var R=this;return(0,_.Z)(function*(){!function Fl(v){var f,m,E,S,R,Q,me,qe,ct,Dt;const It=Ko();j("function"==typeof(null===(f=It?.universalLinks)||void 0===f?void 0:f.subscribe),v,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),j(typeof(null===(m=It?.BuildInfo)||void 0===m?void 0:m.packageName)<"u",v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),j("function"==typeof(null===(R=null===(S=null===(E=It?.cordova)||void 0===E?void 0:E.plugins)||void 0===S?void 0:S.browsertab)||void 0===R?void 0:R.openUrl),v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),j("function"==typeof(null===(qe=null===(me=null===(Q=It?.cordova)||void 0===Q?void 0:Q.plugins)||void 0===me?void 0:me.browsertab)||void 0===qe?void 0:qe.isAvailable),v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),j("function"==typeof(null===(Dt=null===(ct=It?.cordova)||void 0===ct?void 0:ct.InAppBrowser)||void 0===Dt?void 0:Dt.open),v,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(f);const Q=yield R._initialize(f);yield Q.initialized(),Q.resetRedirect(),function rf(){Wr.clear()}(),yield R._originValidation(f);const me=function Os(v,f,m=null){return{type:f,eventId:m,urlResponse:null,sessionId:Og(),postBody:null,tenantId:v.tenantId,error:Te(v,"no-auth-event")}}(f,E,S);yield function Bn(v,f){return Vn()._set(Xt(v),f)}(f,me);const qe=yield function kg(v,f,m){return Ed.apply(this,arguments)}(f,me,m),ct=yield function Ps(v){const{cordova:f}=Ko();return new Promise(m=>{f.plugins.browsertab.isAvailable(E=>{let S=null;E?f.plugins.browsertab.openUrl(v):S=f.InAppBrowser.open(v,function Ln(v=(0,B.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(v)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(v)}()?"_blank":"_system","location=yes"),m(S)})})}(qe);return function Cu(v,f,m){return Ol.apply(this,arguments)}(f,Q,ct)})()}_isIframeWebStorageSupported(f,m){throw new Error("Method not implemented.")}_originValidation(f){const m=f._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function Pg(v){return Pl.apply(this,arguments)}(f)),this.originValidationPromises[m]}attachCallbackListeners(f,m){const{universalLinks:E,handleOpenURL:S,BuildInfo:R}=Ko(),Q=setTimeout((0,_.Z)(function*(){yield _f(f),m.onEvent(Fg())}),500),me=function(){var Dt=(0,_.Z)(function*(It){clearTimeout(Q);const qn=yield _f(f);let Qi=null;qn&&It?.url&&(Qi=function Ll(v,f){var m,E;const S=function bd(v){const f=Tu(v),m=f.link?decodeURIComponent(f.link):void 0,E=Tu(m).link,S=f.deep_link_id?decodeURIComponent(f.deep_link_id):void 0;return Tu(S).link||S||E||m||v}(f);if(S.includes("/__/auth/callback")){const R=Tu(S),Q=R.firebaseError?function ni(v){try{return JSON.parse(v)}catch{return null}}(decodeURIComponent(R.firebaseError)):null,me=null===(E=null===(m=Q?.code)||void 0===m?void 0:m.split("auth/"))||void 0===E?void 0:E[1],qe=me?Te(me):null;return qe?{type:v.type,eventId:v.eventId,tenantId:v.tenantId,error:qe,urlResponse:null,sessionId:null,postBody:null}:{type:v.type,eventId:v.eventId,tenantId:v.tenantId,sessionId:v.sessionId,urlResponse:S,postBody:null}}return null}(qn,It.url)),m.onEvent(Qi||Fg())});return function(qn){return Dt.apply(this,arguments)}}();typeof E<"u"&&"function"==typeof E.subscribe&&E.subscribe(null,me);const qe=S,ct=`${R.packageName.toLowerCase()}://`;Ko().handleOpenURL=function(){var Dt=(0,_.Z)(function*(It){if(It.toLowerCase().startsWith(ct)&&me({url:It}),"function"==typeof qe)try{qe(It)}catch(qn){console.error(qn)}});return function(It){return Dt.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=As,this._completeRedirectFn=Zi,this._overrideRedirectResult=zn}_initialize(f){var m=this;return(0,_.Z)(function*(){return yield m.selectUnderlyingResolver(),m.assertedUnderlyingResolver._initialize(f)})()}_openPopup(f,m,E,S){var R=this;return(0,_.Z)(function*(){return yield R.selectUnderlyingResolver(),R.assertedUnderlyingResolver._openPopup(f,m,E,S)})()}_openRedirect(f,m,E,S){var R=this;return(0,_.Z)(function*(){return yield R.selectUnderlyingResolver(),R.assertedUnderlyingResolver._openRedirect(f,m,E,S)})()}_isIframeWebStorageSupported(f,m){this.assertedUnderlyingResolver._isIframeWebStorageSupported(f,m)}_originValidation(f){return this.assertedUnderlyingResolver._originValidation(f)}get _shouldInitProactively(){return Td()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Sd(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var f=this;return(0,_.Z)(function*(){if(f.underlyingResolver)return;const m=yield function Fs(){return Oa.apply(this,arguments)}();f.underlyingResolver=m?f.cordovaResolver:f.browserResolver})()}}function vf(v){return v.unwrap()}function Md(v){return wf(v)}function wf(v){const{_tokenResponse:f}=v instanceof B.ZR?v.customData:v;if(!f)return null;if(!(v instanceof B.ZR)&&"temporaryProof"in f&&"phoneNumber"in f)return xs.credentialFromResult(v);const m=f.providerId;if(!m||"password"===m)return null;let E;switch(m){case"google.com":E=su;break;case"facebook.com":E=_a;break;case"github.com":E=al;break;case"twitter.com":E=Hr;break;default:const{oauthIdToken:S,oauthAccessToken:R,oauthTokenSecret:Q,pendingToken:me,nonce:qe}=f;return R||Q||S||me?me?m.startsWith("saml.")?Ts._create(m,me):Hi._fromParams({providerId:m,signInMethod:m,pendingToken:me,idToken:S,accessToken:R}):new Xs(m).credential({idToken:S,accessToken:R,rawNonce:qe}):null}return v instanceof B.ZR?E.credentialFromError(v):E.credentialFromResult(v)}function en(v,f){return f.catch(m=>{throw m instanceof B.ZR&&function Fa(v,f){var m,E;const S=null===(m=f.customData)||void 0===m?void 0:m._tokenResponse;if("auth/multi-factor-auth-required"===(null===(E=f)||void 0===E?void 0:E.code))f.resolver=new jl(v,function fl(v,f){var m;const E=(0,B.m9)(v),S=f;return j(f.customData.operationType,E,"argument-error"),j(null===(m=S.customData._serverResponse)||void 0===m?void 0:m.mfaPendingCredential,E,"argument-error"),zh._fromError(E,S)}(v,f));else if(S){const R=wf(f),Q=f;R&&(Q.credential=R,Q.tenantId=S.tenantId||void 0,Q.email=S.email||void 0,Q.phoneNumber=S.phoneNumber||void 0)}}(v,m),m}).then(m=>{const S=m.user;return{operationType:m.operationType,credential:Md(m),additionalUserInfo:Zc(m),user:ii.getOrCreate(S)}})}function Ef(v,f){return If.apply(this,arguments)}function If(){return(If=(0,_.Z)(function*(v,f){const m=yield f;return{verificationId:m.verificationId,confirm:E=>en(v,m.confirm(E))}})).apply(this,arguments)}class jl{constructor(f,m){this.resolver=m,this.auth=function Ad(v){return v.wrapped()}(f)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(f){return en(vf(this.auth),this.resolver.resolveSignIn(f))}}class ii{constructor(f){this._delegate=f,this.multiFactor=function cu(v){const f=(0,B.m9)(v);return pl.has(f)||pl.set(f,Z_._fromUser(f)),pl.get(f)}(f)}static getOrCreate(f){return ii.USER_MAP.has(f)||ii.USER_MAP.set(f,new ii(f)),ii.USER_MAP.get(f)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(f){return this._delegate.getIdTokenResult(f)}getIdToken(f){return this._delegate.getIdToken(f)}linkAndRetrieveDataWithCredential(f){return this.linkWithCredential(f)}linkWithCredential(f){var m=this;return(0,_.Z)(function*(){return en(m.auth,O(m._delegate,f))})()}linkWithPhoneNumber(f,m){var E=this;return(0,_.Z)(function*(){return Ef(E.auth,function er(v,f,m){return zi.apply(this,arguments)}(E._delegate,f,m))})()}linkWithPopup(f){var m=this;return(0,_.Z)(function*(){return en(m.auth,function ti(v,f,m){return Al.apply(this,arguments)}(m._delegate,f,ri))})()}linkWithRedirect(f){var m=this;return(0,_.Z)(function*(){return yield Du(X(m.auth)),function _u(v,f,m){return function J_(v,f,m){return uo.apply(this,arguments)}(v,f,m)}(m._delegate,f,ri)})()}reauthenticateAndRetrieveDataWithCredential(f){return this.reauthenticateWithCredential(f)}reauthenticateWithCredential(f){var m=this;return(0,_.Z)(function*(){return en(m.auth,de(m._delegate,f))})()}reauthenticateWithPhoneNumber(f,m){return Ef(this.auth,function ef(v,f,m){return $o.apply(this,arguments)}(this._delegate,f,m))}reauthenticateWithPopup(f){return en(this.auth,function tf(v,f,m){return qi.apply(this,arguments)}(this._delegate,f,ri))}reauthenticateWithRedirect(f){var m=this;return(0,_.Z)(function*(){return yield Du(X(m.auth)),function hd(v,f,m){return function xa(v,f,m){return mu.apply(this,arguments)}(v,f,m)}(m._delegate,f,ri)})()}sendEmailVerification(f){return function $_(v,f){return dl.apply(this,arguments)}(this._delegate,f)}unlink(f){var m=this;return(0,_.Z)(function*(){return yield function gi(v,f){return qc.apply(this,arguments)}(m._delegate,f),m})()}updateEmail(f){return function hg(v,f){return lu((0,B.m9)(v),f,null)}(this._delegate,f)}updatePassword(f){return function hl(v,f){return lu((0,B.m9)(v),null,f)}(this._delegate,f)}updatePhoneNumber(f){return function X_(v,f){return ud.apply(this,arguments)}(this._delegate,f)}updateProfile(f){return function G_(v,f){return jh.apply(this,arguments)}(this._delegate,f)}verifyBeforeUpdateEmail(f,m){return function H_(v,f,m){return Bh.apply(this,arguments)}(this._delegate,f,m)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}ii.USER_MAP=new WeakMap;const Ls=j;let Us=(()=>{class v{constructor(m,E){if(this.app=m,E.isInitialized())return this._delegate=E.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:S}=m.options;Ls(S,"invalid-api-key",{appName:m.name}),Ls(S,"invalid-api-key",{appName:m.name});const R=typeof window<"u"?ri:void 0;this._delegate=E.initialize({options:{persistence:qt(S,m.name),popupRedirectResolver:R}}),this._delegate._updateErrorMap(De),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?ii.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(m){this._delegate.languageCode=m}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(m){this._delegate.tenantId=m}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(m,E){!function He(v,f,m){const E=X(v);j(E._canInitEmulator,E,"emulator-config-failed"),j(/^https?:\/\//.test(f),E,"invalid-emulator-scheme");const S=!!m?.disableWarnings,R=pt(f),{host:Q,port:me}=function Yt(v){const f=pt(v),m=/(\/\/)?([^?#/]+)/.exec(v.substr(f.length));if(!m)return{host:"",port:null};const E=m[2].split("@").pop()||"",S=/^(\[[^\]]+\])(:|$)/.exec(E);if(S){const R=S[1];return{host:R,port:hn(E.substr(R.length+1))}}{const[R,Q]=E.split(":");return{host:R,port:hn(Q)}}}(f);E.config.emulator={url:`${R}//${Q}${null===me?"":`:${me}`}/`},E.settings.appVerificationDisabledForTesting=!0,E.emulatorConfig=Object.freeze({host:Q,port:me,protocol:R.replace(":",""),options:Object.freeze({disableWarnings:S})}),S||function Qn(){function v(){const f=document.createElement("p"),m=f.style;f.innerText="Running in emulator mode. Do not use with production credentials.",m.position="fixed",m.width="100%",m.backgroundColor="#ffffff",m.border=".1em solid #000000",m.color="#b50000",m.bottom="0px",m.left="0px",m.margin="0px",m.zIndex="10000",m.textAlign="center",f.classList.add("firebase-emulator-warning"),document.body.appendChild(f)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",v):v())}()}(this._delegate,m,E)}applyActionCode(m){return function Gr(v,f){return uu.apply(this,arguments)}(this._delegate,m)}checkActionCode(m){return Ea(this._delegate,m)}confirmPasswordReset(m,E){return function wa(v,f,m){return Wi.apply(this,arguments)}(this._delegate,m,E)}createUserWithEmailAndPassword(m,E){var S=this;return(0,_.Z)(function*(){return en(S._delegate,function Ia(v,f,m){return cr.apply(this,arguments)}(S._delegate,m,E))})()}fetchProvidersForEmail(m){return this.fetchSignInMethodsForEmail(m)}fetchSignInMethodsForEmail(m){return function cg(v,f){return cl.apply(this,arguments)}(this._delegate,m)}isSignInWithEmailLink(m){return function Uo(v,f){return"EMAIL_SIGNIN"===iu.parseLink(f)?.operation}(0,m)}getRedirectResult(){var m=this;return(0,_.Z)(function*(){Ls(Pa(),m._delegate,"operation-not-supported-in-this-environment");const E=yield function xl(v,f){return fd.apply(this,arguments)}(m._delegate,ri);return E?en(m._delegate,Promise.resolve(E)):{credential:null,user:null}})()}addFrameworkForLogging(m){!function Lg(v,f){X(v)._logFramework(f)}(this._delegate,m)}onAuthStateChanged(m,E,S){const{next:R,error:Q,complete:me}=Su(m,E,S);return this._delegate.onAuthStateChanged(R,Q,me)}onIdTokenChanged(m,E,S){const{next:R,error:Q,complete:me}=Su(m,E,S);return this._delegate.onIdTokenChanged(R,Q,me)}sendSignInLinkToEmail(m,E){return function Lh(v,f,m){return ba.apply(this,arguments)}(this._delegate,m,E)}sendPasswordResetEmail(m,E){return function Ds(v,f,m){return Hn.apply(this,arguments)}(this._delegate,m,E||void 0)}setPersistence(m){var E=this;return(0,_.Z)(function*(){let S;switch(function Vl(v,f){zr(Object.values(hi).includes(f),v,"invalid-persistence-type"),(0,B.b$)()?zr(f!==hi.SESSION,v,"unsupported-persistence-type"):(0,B.UG)()?zr(f===hi.NONE,v,"unsupported-persistence-type"):ka()?zr(f===hi.NONE||f===hi.LOCAL&&(0,B.hl)(),v,"unsupported-persistence-type"):zr(f===hi.NONE||Jt(),v,"unsupported-persistence-type")}(E._delegate,m),m){case hi.SESSION:S=As;break;case hi.LOCAL:S=(yield le(gu)._isAvailable())?gu:yl;break;case hi.NONE:S=pn;break;default:return Pe("argument-error",{appName:E._delegate.name})}return E._delegate.setPersistence(S)})()}signInAndRetrieveDataWithCredential(m){return this.signInWithCredential(m)}signInAnonymously(){return en(this._delegate,function YE(v){return Xn.apply(this,arguments)}(this._delegate))}signInWithCredential(m){return en(this._delegate,va(this._delegate,m))}signInWithCustomToken(m){return en(this._delegate,function ln(v,f){return ir.apply(this,arguments)}(this._delegate,m))}signInWithEmailAndPassword(m,E){return en(this._delegate,function Ss(v,f,m){return va((0,B.m9)(v),Gi.credential(f,m))}(this._delegate,m,E))}signInWithEmailLink(m,E){return en(this._delegate,function QE(v,f,m){return Uh.apply(this,arguments)}(this._delegate,m,E))}signInWithPhoneNumber(m,E){return Ef(this._delegate,function Ms(v,f,m){return k.apply(this,arguments)}(this._delegate,m,E))}signInWithPopup(m){var E=this;return(0,_.Z)(function*(){return Ls(Pa(),E._delegate,"operation-not-supported-in-this-environment"),en(E._delegate,function kr(v,f,m){return Aa.apply(this,arguments)}(E._delegate,m,ri))})()}signInWithRedirect(m){var E=this;return(0,_.Z)(function*(){return Ls(Pa(),E._delegate,"operation-not-supported-in-this-environment"),yield Du(E._delegate),function vr(v,f,m){return function Cg(v,f,m){return dd.apply(this,arguments)}(v,f,m)}(E._delegate,m,ri)})()}updateCurrentUser(m){return this._delegate.updateCurrentUser(m)}verifyPasswordResetCode(m){return function no(v,f){return ro.apply(this,arguments)}(this._delegate,m)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return v.Persistence=hi,v})();function Su(v,f,m){let E=v;"function"!=typeof v&&({next:E,error:f,complete:m}=v);const S=E;return{next:Q=>S(Q&&ii.getOrCreate(Q)),error:f,complete:m}}function qt(v,f){const m=function Zo(v,f){const m=yf();if(!m)return[];const E=ae(Vg,v,f);switch(m.getItem(E)){case hi.NONE:return[pn];case hi.LOCAL:return[gu,As];case hi.SESSION:return[As];default:return[]}}(v,f);if(typeof self<"u"&&!m.includes(gu)&&m.push(gu),typeof window<"u")for(const E of[yl,As])m.includes(E)||m.push(E);return m.includes(pn)||m.push(pn),m}class $l{constructor(){this.providerId="phone",this._delegate=new xs(vf(ne.Z.auth()))}static credential(f,m){return xs.credential(f,m)}verifyPhoneNumber(f,m){return this._delegate.verifyPhoneNumber(f,m)}unwrap(){return this._delegate}}$l.PHONE_SIGN_IN_METHOD=xs.PHONE_SIGN_IN_METHOD,$l.PROVIDER_ID=xs.PROVIDER_ID;const Hl=j;class jg{constructor(f,m,E=ne.Z.app()){var S;Hl(null===(S=E.options)||void 0===S?void 0:S.apiKey,"invalid-api-key",{appName:E.name}),this._delegate=new Nr(f,m,E.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function xd(v){v.INTERNAL.registerComponent(new ce.wA("auth-compat",f=>{const m=f.getProvider("app-compat").getImmediate(),E=f.getProvider("auth");return new Us(m,E)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Gi,FacebookAuthProvider:_a,GithubAuthProvider:al,GoogleAuthProvider:su,OAuthProvider:Xs,SAMLAuthProvider:Po,PhoneAuthProvider:$l,PhoneMultiFactorGenerator:kl,RecaptchaVerifier:jg,TwitterAuthProvider:Hr,Auth:Us,AuthCredential:In,Error:B.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),v.registerVersion("@firebase/auth-compat","0.2.20")}(ne.Z)},9751:(_t,ke,F)=>{F.d(ke,{y:()=>we});var _=F(930),ne=F(727),B=F(8822),ue=F(9635),ge=F(2416),ye=F(576),ce=F(2806);let we=(()=>{class te{constructor(Ae){Ae&&(this._subscribe=Ae)}lift(Ae){const De=new te;return De.source=this,De.operator=Ae,De}subscribe(Ae,De,it){const Ee=function W(te){return te&&te instanceof _.Lv||function $(te){return te&&(0,ye.m)(te.next)&&(0,ye.m)(te.error)&&(0,ye.m)(te.complete)}(te)&&(0,ne.Nn)(te)}(Ae)?Ae:new _.Hp(Ae,De,it);return(0,ce.x)(()=>{const{operator:fe,source:ft}=this;Ee.add(fe?fe.call(Ee,ft):ft?this._subscribe(Ee):this._trySubscribe(Ee))}),Ee}_trySubscribe(Ae){try{return this._subscribe(Ae)}catch(De){Ae.error(De)}}forEach(Ae,De){return new(De=_e(De))((it,Ee)=>{const fe=new _.Hp({next:ft=>{try{Ae(ft)}catch(lt){Ee(lt),fe.unsubscribe()}},error:Ee,complete:it});this.subscribe(fe)})}_subscribe(Ae){var De;return null===(De=this.source)||void 0===De?void 0:De.subscribe(Ae)}[B.L](){return this}pipe(...Ae){return(0,ue.U)(Ae)(this)}toPromise(Ae){return new(Ae=_e(Ae))((De,it)=>{let Ee;this.subscribe(fe=>Ee=fe,fe=>it(fe),()=>De(Ee))})}}return te.create=Le=>new te(Le),te})();function _e(te){var Le;return null!==(Le=te??ge.v.Promise)&&void 0!==Le?Le:Promise}},7579:(_t,ke,F)=>{F.d(ke,{x:()=>ce});var _=F(9751),ne=F(727);const ue=(0,F(3888).d)(_e=>function(){_e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ge=F(8737),ye=F(2806);let ce=(()=>{class _e extends _.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(W){const te=new we(this,this);return te.operator=W,te}_throwIfClosed(){if(this.closed)throw new ue}next(W){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const te of this.currentObservers)te.next(W)}})}error(W){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=W;const{observers:te}=this;for(;te.length;)te.shift().error(W)}})}complete(){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:W}=this;for(;W.length;)W.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var W;return(null===(W=this.observers)||void 0===W?void 0:W.length)>0}_trySubscribe(W){return this._throwIfClosed(),super._trySubscribe(W)}_subscribe(W){return this._throwIfClosed(),this._checkFinalizedStatuses(W),this._innerSubscribe(W)}_innerSubscribe(W){const{hasError:te,isStopped:Le,observers:Ae}=this;return te||Le?ne.Lc:(this.currentObservers=null,Ae.push(W),new ne.w0(()=>{this.currentObservers=null,(0,ge.P)(Ae,W)}))}_checkFinalizedStatuses(W){const{hasError:te,thrownError:Le,isStopped:Ae}=this;te?W.error(Le):Ae&&W.complete()}asObservable(){const W=new _.y;return W.source=this,W}}return _e.create=($,W)=>new we($,W),_e})();class we extends ce{constructor($,W){super(),this.destination=$,this.source=W}next($){var W,te;null===(te=null===(W=this.destination)||void 0===W?void 0:W.next)||void 0===te||te.call(W,$)}error($){var W,te;null===(te=null===(W=this.destination)||void 0===W?void 0:W.error)||void 0===te||te.call(W,$)}complete(){var $,W;null===(W=null===($=this.destination)||void 0===$?void 0:$.complete)||void 0===W||W.call($)}_subscribe($){var W,te;return null!==(te=null===(W=this.source)||void 0===W?void 0:W.subscribe($))&&void 0!==te?te:ne.Lc}}},930:(_t,ke,F)=>{F.d(ke,{Hp:()=>it,Lv:()=>te});var _=F(576),ne=F(727),B=F(2416),ue=F(7849),ge=F(5032);const ye=_e("C",void 0,void 0);function _e(Pe,Te,xe){return{kind:Pe,value:Te,error:xe}}var $=F(3410),W=F(2806);class te extends ne.w0{constructor(Te){super(),this.isStopped=!1,Te?(this.destination=Te,(0,ne.Nn)(Te)&&Te.add(this)):this.destination=lt}static create(Te,xe,Ze){return new it(Te,xe,Ze)}next(Te){this.isStopped?ft(function we(Pe){return _e("N",Pe,void 0)}(Te),this):this._next(Te)}error(Te){this.isStopped?ft(function ce(Pe){return _e("E",void 0,Pe)}(Te),this):(this.isStopped=!0,this._error(Te))}complete(){this.isStopped?ft(ye,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Te){this.destination.next(Te)}_error(Te){try{this.destination.error(Te)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Le=Function.prototype.bind;function Ae(Pe,Te){return Le.call(Pe,Te)}class De{constructor(Te){this.partialObserver=Te}next(Te){const{partialObserver:xe}=this;if(xe.next)try{xe.next(Te)}catch(Ze){Ee(Ze)}}error(Te){const{partialObserver:xe}=this;if(xe.error)try{xe.error(Te)}catch(Ze){Ee(Ze)}else Ee(Te)}complete(){const{partialObserver:Te}=this;if(Te.complete)try{Te.complete()}catch(xe){Ee(xe)}}}class it extends te{constructor(Te,xe,Ze){let $e;if(super(),(0,_.m)(Te)||!Te)$e={next:Te??void 0,error:xe??void 0,complete:Ze??void 0};else{let j;this&&B.v.useDeprecatedNextContext?(j=Object.create(Te),j.unsubscribe=()=>this.unsubscribe(),$e={next:Te.next&&Ae(Te.next,j),error:Te.error&&Ae(Te.error,j),complete:Te.complete&&Ae(Te.complete,j)}):$e=Te}this.destination=new De($e)}}function Ee(Pe){B.v.useDeprecatedSynchronousErrorHandling?(0,W.O)(Pe):(0,ue.h)(Pe)}function ft(Pe,Te){const{onStoppedNotification:xe}=B.v;xe&&$.z.setTimeout(()=>xe(Pe,Te))}const lt={closed:!0,next:ge.Z,error:function fe(Pe){throw Pe},complete:ge.Z}},727:(_t,ke,F)=>{F.d(ke,{Lc:()=>ye,w0:()=>ge,Nn:()=>ce});var _=F(576);const B=(0,F(3888).d)(_e=>function(W){_e(this),this.message=W?`${W.length} errors occurred during unsubscription:\n${W.map((te,Le)=>`${Le+1}) ${te.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=W});var ue=F(8737);class ge{constructor($){this.initialTeardown=$,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let $;if(!this.closed){this.closed=!0;const{_parentage:W}=this;if(W)if(this._parentage=null,Array.isArray(W))for(const Ae of W)Ae.remove(this);else W.remove(this);const{initialTeardown:te}=this;if((0,_.m)(te))try{te()}catch(Ae){$=Ae instanceof B?Ae.errors:[Ae]}const{_finalizers:Le}=this;if(Le){this._finalizers=null;for(const Ae of Le)try{we(Ae)}catch(De){$=$??[],De instanceof B?$=[...$,...De.errors]:$.push(De)}}if($)throw new B($)}}add($){var W;if($&&$!==this)if(this.closed)we($);else{if($ instanceof ge){if($.closed||$._hasParent(this))return;$._addParent(this)}(this._finalizers=null!==(W=this._finalizers)&&void 0!==W?W:[]).push($)}}_hasParent($){const{_parentage:W}=this;return W===$||Array.isArray(W)&&W.includes($)}_addParent($){const{_parentage:W}=this;this._parentage=Array.isArray(W)?(W.push($),W):W?[W,$]:$}_removeParent($){const{_parentage:W}=this;W===$?this._parentage=null:Array.isArray(W)&&(0,ue.P)(W,$)}remove($){const{_finalizers:W}=this;W&&(0,ue.P)(W,$),$ instanceof ge&&$._removeParent(this)}}ge.EMPTY=(()=>{const _e=new ge;return _e.closed=!0,_e})();const ye=ge.EMPTY;function ce(_e){return _e instanceof ge||_e&&"closed"in _e&&(0,_.m)(_e.remove)&&(0,_.m)(_e.add)&&(0,_.m)(_e.unsubscribe)}function we(_e){(0,_.m)(_e)?_e():_e.unsubscribe()}},2416:(_t,ke,F)=>{F.d(ke,{v:()=>_});const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(_t,ke,F)=>{F.d(ke,{E:()=>ne});const ne=new(F(9751).y)(ge=>ge.complete())},8996:(_t,ke,F)=>{F.d(ke,{D:()=>Te});var _=F(8421),ne=F(5363),B=F(9468),ye=F(9751),we=F(2202),_e=F(576),$=F(9672);function te(xe,Ze){if(!xe)throw new Error("Iterable cannot be null");return new ye.y($e=>{(0,$.f)($e,Ze,()=>{const j=xe[Symbol.asyncIterator]();(0,$.f)($e,Ze,()=>{j.next().then(Ce=>{Ce.done?$e.complete():$e.next(Ce.value)})},0,!0)})})}var Le=F(3670),Ae=F(8239),De=F(1144),it=F(6495),Ee=F(2206),fe=F(4532),ft=F(3260);function Te(xe,Ze){return Ze?function Pe(xe,Ze){if(null!=xe){if((0,Le.c)(xe))return function ue(xe,Ze){return(0,_.Xf)(xe).pipe((0,B.R)(Ze),(0,ne.Q)(Ze))}(xe,Ze);if((0,De.z)(xe))return function ce(xe,Ze){return new ye.y($e=>{let j=0;return Ze.schedule(function(){j===xe.length?$e.complete():($e.next(xe[j++]),$e.closed||this.schedule())})})}(xe,Ze);if((0,Ae.t)(xe))return function ge(xe,Ze){return(0,_.Xf)(xe).pipe((0,B.R)(Ze),(0,ne.Q)(Ze))}(xe,Ze);if((0,Ee.D)(xe))return te(xe,Ze);if((0,it.T)(xe))return function W(xe,Ze){return new ye.y($e=>{let j;return(0,$.f)($e,Ze,()=>{j=xe[we.h](),(0,$.f)($e,Ze,()=>{let Ce,J;try{({value:Ce,done:J}=j.next())}catch(re){return void $e.error(re)}J?$e.complete():$e.next(Ce)},0,!0)}),()=>(0,_e.m)(j?.return)&&j.return()})}(xe,Ze);if((0,ft.L)(xe))return function lt(xe,Ze){return te((0,ft.Q)(xe),Ze)}(xe,Ze)}throw(0,fe.z)(xe)}(xe,Ze):(0,_.Xf)(xe)}},8421:(_t,ke,F)=>{F.d(ke,{Xf:()=>Le});var _=F(655),ne=F(1144),B=F(8239),ue=F(9751),ge=F(3670),ye=F(2206),ce=F(4532),we=F(6495),_e=F(3260),$=F(576),W=F(7849),te=F(8822);function Le(Pe){if(Pe instanceof ue.y)return Pe;if(null!=Pe){if((0,ge.c)(Pe))return function Ae(Pe){return new ue.y(Te=>{const xe=Pe[te.L]();if((0,$.m)(xe.subscribe))return xe.subscribe(Te);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Pe);if((0,ne.z)(Pe))return function De(Pe){return new ue.y(Te=>{for(let xe=0;xe<Pe.length&&!Te.closed;xe++)Te.next(Pe[xe]);Te.complete()})}(Pe);if((0,B.t)(Pe))return function it(Pe){return new ue.y(Te=>{Pe.then(xe=>{Te.closed||(Te.next(xe),Te.complete())},xe=>Te.error(xe)).then(null,W.h)})}(Pe);if((0,ye.D)(Pe))return fe(Pe);if((0,we.T)(Pe))return function Ee(Pe){return new ue.y(Te=>{for(const xe of Pe)if(Te.next(xe),Te.closed)return;Te.complete()})}(Pe);if((0,_e.L)(Pe))return function ft(Pe){return fe((0,_e.Q)(Pe))}(Pe)}throw(0,ce.z)(Pe)}function fe(Pe){return new ue.y(Te=>{(function lt(Pe,Te){var xe,Ze,$e,j;return(0,_.mG)(this,void 0,void 0,function*(){try{for(xe=(0,_.KL)(Pe);!(Ze=yield xe.next()).done;)if(Te.next(Ze.value),Te.closed)return}catch(Ce){$e={error:Ce}}finally{try{Ze&&!Ze.done&&(j=xe.return)&&(yield j.call(xe))}finally{if($e)throw $e.error}}Te.complete()})})(Pe,Te).catch(xe=>Te.error(xe))})}},6451:(_t,ke,F)=>{F.d(ke,{T:()=>ye});var _=F(8189),ne=F(8421),B=F(515),ue=F(7669),ge=F(8996);function ye(...ce){const we=(0,ue.yG)(ce),_e=(0,ue._6)(ce,1/0),$=ce;return $.length?1===$.length?(0,ne.Xf)($[0]):(0,_.J)(_e)((0,ge.D)($,we)):B.E}},5403:(_t,ke,F)=>{F.d(ke,{x:()=>ne});var _=F(930);function ne(ue,ge,ye,ce,we){return new B(ue,ge,ye,ce,we)}class B extends _.Lv{constructor(ge,ye,ce,we,_e,$){super(ge),this.onFinalize=_e,this.shouldUnsubscribe=$,this._next=ye?function(W){try{ye(W)}catch(te){ge.error(te)}}:super._next,this._error=we?function(W){try{we(W)}catch(te){ge.error(te)}finally{this.unsubscribe()}}:super._error,this._complete=ce?function(){try{ce()}catch(W){ge.error(W)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ge;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ye}=this;super.unsubscribe(),!ye&&(null===(ge=this.onFinalize)||void 0===ge||ge.call(this))}}}},4004:(_t,ke,F)=>{F.d(ke,{U:()=>B});var _=F(4482),ne=F(5403);function B(ue,ge){return(0,_.e)((ye,ce)=>{let we=0;ye.subscribe((0,ne.x)(ce,_e=>{ce.next(ue.call(ge,_e,we++))}))})}},8189:(_t,ke,F)=>{F.d(ke,{J:()=>B});var _=F(5577),ne=F(4671);function B(ue=1/0){return(0,_.z)(ne.y,ue)}},5577:(_t,ke,F)=>{F.d(ke,{z:()=>we});var _=F(4004),ne=F(8421),B=F(4482),ue=F(9672),ge=F(5403),ce=F(576);function we(_e,$,W=1/0){return(0,ce.m)($)?we((te,Le)=>(0,_.U)((Ae,De)=>$(te,Ae,Le,De))((0,ne.Xf)(_e(te,Le))),W):("number"==typeof $&&(W=$),(0,B.e)((te,Le)=>function ye(_e,$,W,te,Le,Ae,De,it){const Ee=[];let fe=0,ft=0,lt=!1;const Pe=()=>{lt&&!Ee.length&&!fe&&$.complete()},Te=Ze=>fe<te?xe(Ze):Ee.push(Ze),xe=Ze=>{Ae&&$.next(Ze),fe++;let $e=!1;(0,ne.Xf)(W(Ze,ft++)).subscribe((0,ge.x)($,j=>{Le?.(j),Ae?Te(j):$.next(j)},()=>{$e=!0},void 0,()=>{if($e)try{for(fe--;Ee.length&&fe<te;){const j=Ee.shift();De?(0,ue.f)($,De,()=>xe(j)):xe(j)}Pe()}catch(j){$.error(j)}}))};return _e.subscribe((0,ge.x)($,Te,()=>{lt=!0,Pe()})),()=>{it?.()}}(te,Le,_e,W)))}},5363:(_t,ke,F)=>{F.d(ke,{Q:()=>ue});var _=F(9672),ne=F(4482),B=F(5403);function ue(ge,ye=0){return(0,ne.e)((ce,we)=>{ce.subscribe((0,B.x)(we,_e=>(0,_.f)(we,ge,()=>we.next(_e),ye),()=>(0,_.f)(we,ge,()=>we.complete(),ye),_e=>(0,_.f)(we,ge,()=>we.error(_e),ye)))})}},3099:(_t,ke,F)=>{F.d(ke,{B:()=>ge});var _=F(8421),ne=F(7579),B=F(930),ue=F(4482);function ge(ce={}){const{connector:we=(()=>new ne.x),resetOnError:_e=!0,resetOnComplete:$=!0,resetOnRefCountZero:W=!0}=ce;return te=>{let Le,Ae,De,it=0,Ee=!1,fe=!1;const ft=()=>{Ae?.unsubscribe(),Ae=void 0},lt=()=>{ft(),Le=De=void 0,Ee=fe=!1},Pe=()=>{const Te=Le;lt(),Te?.unsubscribe()};return(0,ue.e)((Te,xe)=>{it++,!fe&&!Ee&&ft();const Ze=De=De??we();xe.add(()=>{it--,0===it&&!fe&&!Ee&&(Ae=ye(Pe,W))}),Ze.subscribe(xe),!Le&&it>0&&(Le=new B.Hp({next:$e=>Ze.next($e),error:$e=>{fe=!0,ft(),Ae=ye(lt,_e,$e),Ze.error($e)},complete:()=>{Ee=!0,ft(),Ae=ye(lt,$),Ze.complete()}}),(0,_.Xf)(Te).subscribe(Le))})(te)}}function ye(ce,we,..._e){if(!0===we)return void ce();if(!1===we)return;const $=new B.Hp({next:()=>{$.unsubscribe(),ce()}});return we(..._e).subscribe($)}},9468:(_t,ke,F)=>{F.d(ke,{R:()=>ne});var _=F(4482);function ne(B,ue=0){return(0,_.e)((ge,ye)=>{ye.add(B.schedule(()=>ge.subscribe(ye),ue))})}},8505:(_t,ke,F)=>{F.d(ke,{b:()=>ge});var _=F(576),ne=F(4482),B=F(5403),ue=F(4671);function ge(ye,ce,we){const _e=(0,_.m)(ye)||ce||we?{next:ye,error:ce,complete:we}:ye;return _e?(0,ne.e)(($,W)=>{var te;null===(te=_e.subscribe)||void 0===te||te.call(_e);let Le=!0;$.subscribe((0,B.x)(W,Ae=>{var De;null===(De=_e.next)||void 0===De||De.call(_e,Ae),W.next(Ae)},()=>{var Ae;Le=!1,null===(Ae=_e.complete)||void 0===Ae||Ae.call(_e),W.complete()},Ae=>{var De;Le=!1,null===(De=_e.error)||void 0===De||De.call(_e,Ae),W.error(Ae)},()=>{var Ae,De;Le&&(null===(Ae=_e.unsubscribe)||void 0===Ae||Ae.call(_e)),null===(De=_e.finalize)||void 0===De||De.call(_e)}))}):ue.y}},4408:(_t,ke,F)=>{F.d(ke,{o:()=>ge});var _=F(727);class ne extends _.w0{constructor(ce,we){super()}schedule(ce,we=0){return this}}const B={setInterval(ye,ce,...we){const{delegate:_e}=B;return _e?.setInterval?_e.setInterval(ye,ce,...we):setInterval(ye,ce,...we)},clearInterval(ye){const{delegate:ce}=B;return(ce?.clearInterval||clearInterval)(ye)},delegate:void 0};var ue=F(8737);class ge extends ne{constructor(ce,we){super(ce,we),this.scheduler=ce,this.work=we,this.pending=!1}schedule(ce,we=0){if(this.closed)return this;this.state=ce;const _e=this.id,$=this.scheduler;return null!=_e&&(this.id=this.recycleAsyncId($,_e,we)),this.pending=!0,this.delay=we,this.id=this.id||this.requestAsyncId($,this.id,we),this}requestAsyncId(ce,we,_e=0){return B.setInterval(ce.flush.bind(ce,this),_e)}recycleAsyncId(ce,we,_e=0){if(null!=_e&&this.delay===_e&&!1===this.pending)return we;B.clearInterval(we)}execute(ce,we){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const _e=this._execute(ce,we);if(_e)return _e;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(ce,we){let $,_e=!1;try{this.work(ce)}catch(W){_e=!0,$=W||new Error("Scheduled action threw falsy error")}if(_e)return this.unsubscribe(),$}unsubscribe(){if(!this.closed){const{id:ce,scheduler:we}=this,{actions:_e}=we;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ue.P)(_e,this),null!=ce&&(this.id=this.recycleAsyncId(we,ce,null)),this.delay=null,super.unsubscribe()}}}},7565:(_t,ke,F)=>{F.d(ke,{v:()=>B});var _=F(6063);class ne{constructor(ge,ye=ne.now){this.schedulerActionCtor=ge,this.now=ye}schedule(ge,ye=0,ce){return new this.schedulerActionCtor(this,ge).schedule(ce,ye)}}ne.now=_.l.now;class B extends ne{constructor(ge,ye=ne.now){super(ge,ye),this.actions=[],this._active=!1,this._scheduled=void 0}flush(ge){const{actions:ye}=this;if(this._active)return void ye.push(ge);let ce;this._active=!0;do{if(ce=ge.execute(ge.state,ge.delay))break}while(ge=ye.shift());if(this._active=!1,ce){for(;ge=ye.shift();)ge.unsubscribe();throw ce}}}},4986:(_t,ke,F)=>{F.d(ke,{z:()=>B});var _=F(4408);const B=new(F(7565).v)(_.o)},6063:(_t,ke,F)=>{F.d(ke,{l:()=>_});const _={now:()=>(_.delegate||Date).now(),delegate:void 0}},3410:(_t,ke,F)=>{F.d(ke,{z:()=>_});const _={setTimeout(ne,B,...ue){const{delegate:ge}=_;return ge?.setTimeout?ge.setTimeout(ne,B,...ue):setTimeout(ne,B,...ue)},clearTimeout(ne){const{delegate:B}=_;return(B?.clearTimeout||clearTimeout)(ne)},delegate:void 0}},2202:(_t,ke,F)=>{F.d(ke,{h:()=>ne});const ne=function _(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(_t,ke,F)=>{F.d(ke,{L:()=>_});const _="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(_t,ke,F)=>{F.d(ke,{_6:()=>ye,jO:()=>ue,yG:()=>ge});var _=F(576);function B(ce){return ce[ce.length-1]}function ue(ce){return(0,_.m)(B(ce))?ce.pop():void 0}function ge(ce){return function ne(ce){return ce&&(0,_.m)(ce.schedule)}(B(ce))?ce.pop():void 0}function ye(ce,we){return"number"==typeof B(ce)?ce.pop():we}},8737:(_t,ke,F)=>{function _(ne,B){if(ne){const ue=ne.indexOf(B);0<=ue&&ne.splice(ue,1)}}F.d(ke,{P:()=>_})},3888:(_t,ke,F)=>{function _(ne){const ue=ne(ge=>{Error.call(ge),ge.stack=(new Error).stack});return ue.prototype=Object.create(Error.prototype),ue.prototype.constructor=ue,ue}F.d(ke,{d:()=>_})},2806:(_t,ke,F)=>{F.d(ke,{O:()=>ue,x:()=>B});var _=F(2416);let ne=null;function B(ge){if(_.v.useDeprecatedSynchronousErrorHandling){const ye=!ne;if(ye&&(ne={errorThrown:!1,error:null}),ge(),ye){const{errorThrown:ce,error:we}=ne;if(ne=null,ce)throw we}}else ge()}function ue(ge){_.v.useDeprecatedSynchronousErrorHandling&&ne&&(ne.errorThrown=!0,ne.error=ge)}},9672:(_t,ke,F)=>{function _(ne,B,ue,ge=0,ye=!1){const ce=B.schedule(function(){ue(),ye?ne.add(this.schedule(null,ge)):this.unsubscribe()},ge);if(ne.add(ce),!ye)return ce}F.d(ke,{f:()=>_})},4671:(_t,ke,F)=>{function _(ne){return ne}F.d(ke,{y:()=>_})},1144:(_t,ke,F)=>{F.d(ke,{z:()=>_});const _=ne=>ne&&"number"==typeof ne.length&&"function"!=typeof ne},2206:(_t,ke,F)=>{F.d(ke,{D:()=>ne});var _=F(576);function ne(B){return Symbol.asyncIterator&&(0,_.m)(B?.[Symbol.asyncIterator])}},576:(_t,ke,F)=>{function _(ne){return"function"==typeof ne}F.d(ke,{m:()=>_})},3670:(_t,ke,F)=>{F.d(ke,{c:()=>B});var _=F(8822),ne=F(576);function B(ue){return(0,ne.m)(ue[_.L])}},6495:(_t,ke,F)=>{F.d(ke,{T:()=>B});var _=F(2202),ne=F(576);function B(ue){return(0,ne.m)(ue?.[_.h])}},8239:(_t,ke,F)=>{F.d(ke,{t:()=>ne});var _=F(576);function ne(B){return(0,_.m)(B?.then)}},3260:(_t,ke,F)=>{F.d(ke,{L:()=>ue,Q:()=>B});var _=F(655),ne=F(576);function B(ge){return(0,_.FC)(this,arguments,function*(){const ce=ge.getReader();try{for(;;){const{value:we,done:_e}=yield(0,_.qq)(ce.read());if(_e)return yield(0,_.qq)(void 0);yield yield(0,_.qq)(we)}}finally{ce.releaseLock()}})}function ue(ge){return(0,ne.m)(ge?.getReader)}},4482:(_t,ke,F)=>{F.d(ke,{A:()=>ne,e:()=>B});var _=F(576);function ne(ue){return(0,_.m)(ue?.lift)}function B(ue){return ge=>{if(ne(ge))return ge.lift(function(ye){try{return ue(ye,this)}catch(ce){this.error(ce)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(_t,ke,F)=>{function _(){}F.d(ke,{Z:()=>_})},9635:(_t,ke,F)=>{F.d(ke,{U:()=>B,z:()=>ne});var _=F(4671);function ne(...ue){return B(ue)}function B(ue){return 0===ue.length?_.y:1===ue.length?ue[0]:function(ye){return ue.reduce((ce,we)=>we(ce),ye)}}},7849:(_t,ke,F)=>{F.d(ke,{h:()=>B});var _=F(2416),ne=F(3410);function B(ue){ne.z.setTimeout(()=>{const{onUnhandledError:ge}=_.v;if(!ge)throw ue;ge(ue)})}},4532:(_t,ke,F)=>{function _(ne){return new TypeError(`You provided ${null!==ne&&"object"==typeof ne?"an invalid object":`'${ne}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}F.d(ke,{z:()=>_})},655:(_t,ke,F)=>{function ue(J,re){var le={};for(var ie in J)Object.prototype.hasOwnProperty.call(J,ie)&&re.indexOf(ie)<0&&(le[ie]=J[ie]);if(null!=J&&"function"==typeof Object.getOwnPropertySymbols){var We=0;for(ie=Object.getOwnPropertySymbols(J);We<ie.length;We++)re.indexOf(ie[We])<0&&Object.prototype.propertyIsEnumerable.call(J,ie[We])&&(le[ie[We]]=J[ie[We]])}return le}function we(J,re,le,ie){return new(le||(le=Promise))(function(je,mt){function rn(yn){try{Xe(ie.next(yn))}catch(ar){mt(ar)}}function Bt(yn){try{Xe(ie.throw(yn))}catch(ar){mt(ar)}}function Xe(yn){yn.done?je(yn.value):function We(je){return je instanceof le?je:new le(function(mt){mt(je)})}(yn.value).then(rn,Bt)}Xe((ie=ie.apply(J,re||[])).next())})}function Ee(J){return this instanceof Ee?(this.v=J,this):new Ee(J)}function fe(J,re,le){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var We,ie=le.apply(J,re||[]),je=[];return We={},mt("next"),mt("throw"),mt("return"),We[Symbol.asyncIterator]=function(){return this},We;function mt(vn){ie[vn]&&(We[vn]=function(dn){return new Promise(function(rr,St){je.push([vn,dn,rr,St])>1||rn(vn,dn)})})}function rn(vn,dn){try{!function Bt(vn){vn.value instanceof Ee?Promise.resolve(vn.value.v).then(Xe,yn):ar(je[0][2],vn)}(ie[vn](dn))}catch(rr){ar(je[0][3],rr)}}function Xe(vn){rn("next",vn)}function yn(vn){rn("throw",vn)}function ar(vn,dn){vn(dn),je.shift(),je.length&&rn(je[0][0],je[0][1])}}function lt(J){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var le,re=J[Symbol.asyncIterator];return re?re.call(J):(J=function te(J){var re="function"==typeof Symbol&&Symbol.iterator,le=re&&J[re],ie=0;if(le)return le.call(J);if(J&&"number"==typeof J.length)return{next:function(){return J&&ie>=J.length&&(J=void 0),{value:J&&J[ie++],done:!J}}};throw new TypeError(re?"Object is not iterable.":"Symbol.iterator is not defined.")}(J),le={},ie("next"),ie("throw"),ie("return"),le[Symbol.asyncIterator]=function(){return this},le);function ie(je){le[je]=J[je]&&function(mt){return new Promise(function(rn,Bt){!function We(je,mt,rn,Bt){Promise.resolve(Bt).then(function(Xe){je({value:Xe,done:rn})},mt)}(rn,Bt,(mt=J[je](mt)).done,mt.value)})}}}F.d(ke,{FC:()=>fe,KL:()=>lt,_T:()=>ue,mG:()=>we,qq:()=>Ee})},4650:(_t,ke,F)=>{F.d(ke,{$8M:()=>sd,$Z:()=>fo,AFp:()=>oM,AaK:()=>we,CRH:()=>kb,CZH:()=>vw,CqO:()=>wI,D6c:()=>AO,EJc:()=>JP,F$t:()=>si,F4k:()=>Yd,FYo:()=>qe,FiY:()=>xl,G48:()=>bM,GfV:()=>qn,HOy:()=>pc,Hsn:()=>qa,JOm:()=>Qo,LFG:()=>vr,LSH:()=>co,Lbi:()=>ZP,Lck:()=>gb,MAs:()=>yI,MMx:()=>ow,NdJ:()=>Vu,OlP:()=>Un,Oqu:()=>$v,PXZ:()=>fO,Q6J:()=>_o,QGY:()=>an,QP$:()=>Tt,QbO:()=>YP,Qsj:()=>ct,R0b:()=>Io,RDi:()=>Dg,Rgc:()=>yp,SBq:()=>R,Sil:()=>tO,Suo:()=>FA,TTD:()=>Cs,TgZ:()=>yo,W1O:()=>VA,X6Q:()=>gO,XFs:()=>st,Xpm:()=>G,Xts:()=>Jt,Y36:()=>Xo,YKP:()=>iw,YNc:()=>ep,Yjl:()=>pe,Yz7:()=>dn,Z0I:()=>Mi,ZZ4:()=>tC,_Bn:()=>rw,_UZ:()=>za,_Vd:()=>m,_c5:()=>LM,_uU:()=>RI,aQg:()=>nC,c2e:()=>QP,cJS:()=>St,cg1:()=>ap,dDg:()=>cO,dqk:()=>Gt,eFA:()=>Wb,ekj:()=>Uv,eoX:()=>mM,f3M:()=>dd,g9A:()=>uM,h0i:()=>Gu,hGG:()=>SO,iGM:()=>OA,ifc:()=>dt,ip1:()=>sM,jDz:()=>aw,kL8:()=>eh,lG2:()=>ae,lnq:()=>op,lqb:()=>Fa,lri:()=>pM,oAB:()=>ht,oxw:()=>Dv,q4F:()=>Qi,qLn:()=>Af,qZA:()=>Mm,rWj:()=>gM,sBO:()=>mO,sIi:()=>Qf,s_b:()=>ah,soG:()=>ww,tb:()=>lM,tp0:()=>Zi,uIk:()=>Jf,vHH:()=>De,vpe:()=>la,wAp:()=>kt,xp6:()=>P0,z2F:()=>bp,zSh:()=>Sd,zs3:()=>Yl});var _=F(7579),ne=F(727),B=F(9751),ue=F(6451),ge=F(3099);function ye(s){for(let o in s)if(s[o]===ye)return o;throw Error("Could not find renamed property on target object.")}function we(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(we).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function _e(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const $=ye({__forward_ref__:ye});function W(s){return s.__forward_ref__=W,s.toString=function(){return we(this())},s}function te(s){return function Le(s){return"function"==typeof s&&s.hasOwnProperty($)&&s.__forward_ref__===W}(s)?s():s}class De extends Error{constructor(o,u){super(function it(s,o){return`NG0${Math.abs(s)}${o?": "+o.trim():""}`}(o,u)),this.code=o}}function Ee(s){return"string"==typeof s?s:null==s?"":String(s)}function Te(s,o){throw new De(-201,!1)}function Bt(s,o){null==s&&function Xe(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function dn(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function St(s){return{providers:s.providers||[],imports:s.imports||[]}}function Zt(s){return ci(s,gr)||ci(s,ur)}function Mi(s){return null!==Zt(s)}function ci(s,o){return s.hasOwnProperty(o)?s[o]:null}function Yr(s){return s&&(s.hasOwnProperty(Vr)||s.hasOwnProperty(xi))?s[Vr]:null}const gr=ye({\u0275prov:ye}),Vr=ye({\u0275inj:ye}),ur=ye({ngInjectableDef:ye}),xi=ye({ngInjectorDef:ye});var st=(()=>((st=st||{})[st.Default=0]="Default",st[st.Host=1]="Host",st[st.Self=2]="Self",st[st.SkipSelf=4]="SkipSelf",st[st.Optional=8]="Optional",st))();let Pn;function xn(s){const o=Pn;return Pn=s,o}function jr(s,o,u){const c=Zt(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&st.Optional?null:void 0!==o?o:void Te(we(s))}function Fn(s){return{toString:s}.toString()}var Gn=(()=>((Gn=Gn||{})[Gn.OnPush=0]="OnPush",Gn[Gn.Default=1]="Default",Gn))(),dt=(()=>{return(s=dt||(dt={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",dt;var s})();const Gt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),lr={},Rt=[],Qr=ye({\u0275cmp:ye}),un=ye({\u0275dir:ye}),Dr=ye({\u0275pipe:ye}),sn=ye({\u0275mod:ye}),Y=ye({\u0275fac:ye}),H=ye({__NG_ELEMENT_ID__:ye});let V=0;function G(s){return Fn(()=>{const u=!0===s.standalone,c={},h={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:c,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===Gn.OnPush,directiveDefs:null,pipeDefs:null,standalone:u,dependencies:u&&s.dependencies||null,getStandaloneInjector:null,selectors:s.selectors||Rt,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||dt.Emulated,id:"c"+V++,styles:s.styles||Rt,_:null,setInput:null,schemas:s.schemas||null,tView:null},g=s.dependencies,w=s.features;return h.inputs=pn(s.inputs,c),h.outputs=pn(s.outputs),w&&w.forEach(I=>I(h)),h.directiveDefs=g?()=>("function"==typeof g?g():g).map(Ne).filter(Ye):null,h.pipeDefs=g?()=>("function"==typeof g?g():g).map(Qe).filter(Ye):null,h})}function Ne(s){return Se(s)||Be(s)}function Ye(s){return null!==s}function ht(s){return Fn(()=>({type:s.type,bootstrap:s.bootstrap||Rt,declarations:s.declarations||Rt,imports:s.imports||Rt,exports:s.exports||Rt,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function pn(s,o){if(null==s)return lr;const u={};for(const c in s)if(s.hasOwnProperty(c)){let h=s[c],g=h;Array.isArray(h)&&(g=h[1],h=h[0]),u[h]=c,o&&(o[h]=g)}return u}const ae=G;function pe(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function Se(s){return s[Qr]||null}function Be(s){return s[un]||null}function Qe(s){return s[Dr]||null}function Tt(s){const o=Se(s)||Be(s)||Qe(s);return null!==o&&o.standalone}function At(s,o){const u=s[sn]||null;if(!u&&!0===o)throw new Error(`Type ${we(s)} does not have '\u0275mod' property.`);return u}function $r(s){return Array.isArray(s)&&"object"==typeof s[1]}function Ar(s){return Array.isArray(s)&&!0===s[1]}function No(s){return 0!=(8&s.flags)}function Es(s){return 2==(2&s.flags)}function tu(s){return 1==(1&s.flags)}function Jr(s){return null!==s.template}function Bc(s){return 0!=(256&s[2])}function Gi(s,o){return s.hasOwnProperty(Y)?s[Y]:null}class bs{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function Cs(){return Xs}function Xs(s){return s.type.prototype.ngOnChanges&&(s.setInput=su),_a}function _a(){const s=ul(this),o=s?.current;if(o){const u=s.previous;if(u===lr)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function su(s,o,u,c){const h=ul(s)||function Ts(s,o){return s[al]=o}(s,{previous:lr,current:null}),g=h.current||(h.current={}),w=h.previous,I=this.declaredInputs[u],C=w[I];g[I]=new bs(C&&C.currentValue,o,w===lr),s[c]=o}Cs.ngInherit=!0;const al="__ngSimpleChanges__";function ul(s){return s[al]||null}function Xn(s){for(;Array.isArray(s);)s=s[0];return s}function Js(s,o){return Xn(o[s])}function gi(s,o){return Xn(o[s.index])}function ki(s,o){return s.data[o]}function on(s,o){const u=o[s];return $r(u)?u:u[0]}function Lo(s){return 64==(64&s[2])}function ls(s,o){return null==o?null:s[o]}function au(s){s[18]=0}function va(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const N={lFrame:G_(null),bindingsEnabled:!0};function gt(){return N.bindingsEnabled}function Me(){return N.lFrame.lView}function Et(){return N.lFrame.tView}function Hn(){let s=wa();for(;null!==s&&64===s.type;)s=s.parent;return s}function wa(){return N.lFrame.currentTNode}function Gr(s,o){const u=N.lFrame;u.currentTNode=s,u.isParent=o}function uu(){return N.lFrame.isParent}function Ea(){N.lFrame.isParent=!1}function Ss(){return N.lFrame.bindingIndex}function ba(){return N.lFrame.bindingIndex++}function Uo(s){const o=N.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+s,u}function XE(s,o){const u=N.lFrame;u.bindingIndex=u.bindingRootIndex=s,cg(o)}function cg(s){N.lFrame.currentDirectiveIndex=s}function $_(){return N.lFrame.currentQueryIndex}function dl(s){N.lFrame.currentQueryIndex=s}function H_(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function Bh(s,o,u){if(u&st.SkipSelf){let h=o,g=s;for(;!(h=h.parent,null!==h||u&st.Host||(h=H_(g),null===h||(g=g[15],10&h.type))););if(null===h)return!1;o=h,s=g}const c=N.lFrame=Vh();return c.currentTNode=o,c.lView=s,!0}function dg(s){const o=Vh(),u=s[1];N.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Vh(){const s=N.lFrame,o=null===s?null:s.child;return null===o?G_(s):o}function G_(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function jh(){const s=N.lFrame;return N.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const hg=jh;function hl(){const s=jh();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function Rr(){return N.lFrame.selectedIndex}function Pi(s){N.lFrame.selectedIndex=s}function Wn(){const s=N.lFrame;return ki(s.tView,s.selectedIndex)}function Yc(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const g=s.data[u].type.prototype,{ngAfterContentInit:w,ngAfterContentChecked:I,ngAfterViewInit:C,ngAfterViewChecked:D,ngOnDestroy:x}=g;w&&(s.contentHooks||(s.contentHooks=[])).push(-u,w),I&&((s.contentHooks||(s.contentHooks=[])).push(u,I),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,I)),C&&(s.viewHooks||(s.viewHooks=[])).push(-u,C),D&&((s.viewHooks||(s.viewHooks=[])).push(u,D),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,D)),null!=x&&(s.destroyHooks||(s.destroyHooks=[])).push(u,x)}}function Qc(s,o,u){Wh(s,o,3,u)}function Ca(s,o,u,c){(3&s[2])===u&&Wh(s,o,u,c)}function Gh(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function Wh(s,o,u,c){const g=c??-1,w=o.length-1;let I=0;for(let C=void 0!==c?65535&s[18]:0;C<w;C++)if("number"==typeof o[C+1]){if(I=o[C],null!=c&&I>=c)break}else o[C]<0&&(s[18]+=65536),(I<g||-1==g)&&(fg(s,u,o,C),s[18]=(4294901760&s[18])+C+2),C++}function fg(s,o,u,c){const h=u[c]<0,g=u[c+1],I=s[h?-u[c]:u[c]];if(h){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{g.call(I)}finally{}}}else try{g.call(I)}finally{}}class Vo{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function cu(s,o,u){let c=0;for(;c<u.length;){const h=u[c];if("number"==typeof h){if(0!==h)break;c++;const g=u[c++],w=u[c++],I=u[c++];s.setAttribute(o,w,I,g)}else{const g=h,w=u[++c];Jc(g)?s.setProperty(o,g,w):s.setAttribute(o,g,w),c++}}return c}function gl(s){return 3===s||4===s||6===s}function Jc(s){return 64===s.charCodeAt(0)}function ml(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const h=o[c];"number"==typeof h?u=h:0===u||gg(s,u,h,null,-1===u||2===u?o[++c]:null)}}return s}function gg(s,o,u,c,h){let g=0,w=s.length;if(-1===o)w=-1;else for(;g<s.length;){const I=s[g++];if("number"==typeof I){if(I===o){w=-1;break}if(I>o){w=g-1;break}}}for(;g<s.length;){const I=s[g];if("number"==typeof I)break;if(I===u){if(null===c)return void(null!==h&&(s[g+1]=h));if(c===s[g+1])return void(s[g+2]=h)}g++,null!==c&&g++,null!==h&&g++}-1!==w&&(s.splice(w,0,o),g=w+1),s.splice(g++,0,u),null!==c&&s.splice(g++,0,c),null!==h&&s.splice(g++,0,h)}function mg(s){return-1!==s}function _l(s){return 32767&s}function vl(s,o){let u=function yl(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let As=!0;function ed(s){const o=As;return As=s,o}let yr=0;const io={};function El(s,o){const u=td(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,Il(c.data,s),Il(o,null),Il(c.blueprint,null));const h=nd(s,o),g=s.injectorIndex;if(mg(h)){const w=_l(h),I=vl(h,o),C=I[1].data;for(let D=0;D<8;D++)o[g+D]=I[w+D]|C[w+D]}return o[g+8]=h,g}function Il(s,o){s.push(0,0,0,0,0,0,0,0,o)}function td(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function nd(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,h=o;for(;null!==h;){if(c=id(h),null===c)return-1;if(u++,h=h[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function du(s,o,u){!function Kh(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(H)&&(c=u[H]),null==c&&(c=u[H]=yr++);const h=255&c;o.data[s+(h>>5)]|=1<<h}(s,o,u)}function hu(s,o,u){if(u&st.Optional||void 0!==s)return s;Te()}function rd(s,o,u,c){if(u&st.Optional&&void 0===c&&(c=null),0==(u&(st.Self|st.Host))){const h=s[9],g=xn(void 0);try{return h?h.get(o,c,u&st.Optional):jr(o,c,u&st.Optional)}finally{xn(g)}}return hu(c,0,u)}function bl(s,o,u,c=st.Default,h){if(null!==s){if(1024&o[2]){const w=function gu(s,o,u,c,h){let g=s,w=o;for(;null!==g&&null!==w&&1024&w[2]&&!(256&w[2]);){const I=Cl(g,w,u,c|st.Self,io);if(I!==io)return I;let C=g.parent;if(!C){const D=w[21];if(D){const x=D.get(u,io,c);if(x!==io)return x}C=id(w),w=w[15]}g=C}return h}(s,o,u,c,io);if(w!==io)return w}const g=Cl(s,o,u,c,io);if(g!==io)return g}return rd(o,u,c,h)}function Cl(s,o,u,c,h){const g=function Zh(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(H)?s[H]:void 0;return"number"==typeof o?o>=0?255&o:wg:o}(u);if("function"==typeof g){if(!Bh(o,s,c))return c&st.Host?hu(h,0,c):rd(o,u,c,h);try{const w=g(c);if(null!=w||c&st.Optional)return w;Te()}finally{hg()}}else if("number"==typeof g){let w=null,I=td(s,o),C=-1,D=c&st.Host?o[16][6]:null;for((-1===I||c&st.SkipSelf)&&(C=-1===I?nd(s,o):o[I+8],-1!==C&&Yh(c,!1)?(w=o[1],I=_l(C),o=vl(C,o)):I=-1);-1!==I;){const x=o[1];if(vg(g,I,x.data)){const L=JE(I,o,u,w,c,D);if(L!==io)return L}C=o[I+8],-1!==C&&Yh(c,o[1].data[I+8]===D)&&vg(g,I,o)?(w=x,I=_l(C),o=vl(C,o)):I=-1}}return h}function JE(s,o,u,c,h,g){const w=o[1],I=w.data[s+8],x=fu(I,w,u,null==c?Es(I)&&As:c!=w&&0!=(3&I.type),h&st.Host&&g===I);return null!==x?Da(o,w,x,I):io}function fu(s,o,u,c,h){const g=s.providerIndexes,w=o.data,I=1048575&g,C=s.directiveStart,x=g>>20,q=h?I+x:s.directiveEnd;for(let se=c?I:I+x;se<q;se++){const Re=w[se];if(se<C&&u===Re||se>=C&&Re.type===u)return se}if(h){const se=w[C];if(se&&Jr(se)&&se.type===u)return C}return null}function Da(s,o,u,c){let h=s[u];const g=o.data;if(function Ta(s){return s instanceof Vo}(h)){const w=h;w.resolving&&function ft(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new De(-200,`Circular dependency in DI detected for ${s}${u}`)}(function fe(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():Ee(s)}(g[u]));const I=ed(w.canSeeViewProviders);w.resolving=!0;const C=w.injectImpl?xn(w.injectImpl):null;Bh(s,c,st.Default);try{h=s[u]=w.factory(void 0,g,s,c),o.firstCreatePass&&u>=c.directiveStart&&function Hh(s,o,u){const{ngOnChanges:c,ngOnInit:h,ngDoCheck:g}=o.type.prototype;if(c){const w=Xs(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,w),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,w)}h&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,h),g&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,g),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,g))}(u,g[u],o)}finally{null!==C&&xn(C),ed(I),w.resolving=!1,hg()}}return h}function vg(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function Yh(s,o){return!(s&st.Self||s&st.Host&&o)}class pu{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return bl(this._tNode,this._lView,o,c,u)}}function wg(){return new pu(Hn(),Me())}function id(s){const o=s[1],u=o.type;return 2===u?o.declTNode:1===u?s[6]:null}function sd(s){return function yg(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let h=0;for(;h<c;){const g=u[h];if(gl(g))break;if(0===g)h+=2;else if("number"==typeof g)for(h++;h<c&&"string"==typeof u[h];)h++;else{if(g===o)return u[h+1];h+=2}}}return null}(Hn(),s)}const Sa="__parameters__";function Sl(s,o,u){return Fn(()=>{const c=function Xh(s){return function(...u){if(s){const c=s(...u);for(const h in c)this[h]=c[h]}}}(o);function h(...g){if(this instanceof h)return c.apply(this,g),this;const w=new h(...g);return I.annotation=w,I;function I(C,D,x){const L=C.hasOwnProperty(Sa)?C[Sa]:Object.defineProperty(C,Sa,{value:[]})[Sa];for(;L.length<=x;)L.push(null);return(L[x]=L[x]||[]).push(w),C}}return u&&(h.prototype=Object.create(u.prototype)),h.prototype.ngMetadataName=s,h.annotationCls=h,h})}class Un{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=dn({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function er(s,o){void 0===o&&(o=s);for(let u=0;u<s.length;u++){let c=s[u];Array.isArray(c)?(o===s&&(o=s.slice(0,u)),er(c,o)):o!==s&&o.push(c)}return o}function zi(s,o){s.forEach(u=>Array.isArray(u)?zi(u,o):o(u))}function ef(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function $o(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}function so(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}function mi(s,o,u){let c=Rs(s,o);return c>=0?s[1|c]=u:(c=~c,function ud(s,o,u,c){let h=s.length;if(h==o)s.push(u,c);else if(1===h)s.push(c,s[0]),s[0]=u;else{for(h--,s.push(s[h-1],s[h]);h>o;)s[h]=s[h-2],h--;s[o]=u,s[o+1]=c}}(s,c,o,u)),c}function ld(s,o){const u=Rs(s,o);if(u>=0)return s[1|u]}function Rs(s,o){return function cd(s,o,u){let c=0,h=s.length>>u;for(;h!==c;){const g=c+(h-c>>1),w=s[g<<u];if(o===w)return g<<u;w>o?h=g:c=g+1}return~(h<<u)}(s,o,1)}const Wr={},Ki="__NG_DI_FLAG__",Ns="ngTempTokenPath",Ma=/\n/gm,rf="__source";let zn;function Wo(s){const o=zn;return zn=s,o}function bg(s,o=st.Default){if(void 0===zn)throw new De(-203,!1);return null===zn?jr(s,void 0,o):zn.get(s,o&st.Optional?null:void 0,o)}function vr(s,o=st.Default){return(function di(){return Pn}()||bg)(te(s),o)}function dd(s,o=st.Default){return"number"!=typeof o&&(o=0|(o.optional&&8)|(o.host&&1)|(o.self&&2)|(o.skipSelf&&4)),vr(s,o)}function hd(s){const o=[];for(let u=0;u<s.length;u++){const c=te(s[u]);if(Array.isArray(c)){if(0===c.length)throw new De(900,!1);let h,g=st.Default;for(let w=0;w<c.length;w++){const I=c[w],C=mu(I);"number"==typeof C?-1===C?h=I.token:g|=C:h=I}o.push(vr(h,g))}else o.push(vr(c))}return o}function xa(s,o){return s[Ki]=o,s.prototype[Ki]=o,s}function mu(s){return s[Ki]}const xl=xa(Sl("Optional"),8),Zi=xa(Sl("SkipSelf"),4);let vd;function Dg(s){vd=s}class bu{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function ks(s){return s instanceof bu?s.changingThisBreaksApplicationSecurity:s}const Pg=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var wr=(()=>((wr=wr||{})[wr.NONE=0]="NONE",wr[wr.HTML=1]="HTML",wr[wr.STYLE=2]="STYLE",wr[wr.SCRIPT=3]="SCRIPT",wr[wr.URL=4]="URL",wr[wr.RESOURCE_URL=5]="RESOURCE_URL",wr))();function co(s){const o=function cs(){const s=Me();return s&&s[12]}();return o?o.sanitize(wr.URL,s)||"":function kl(s,o){const u=function xg(s){return s instanceof bu&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===o}(s,"URL")?ks(s):function Pl(s){return(s=String(s)).match(Pg)?s:"unsafe:"+s}(Ee(s))}const Jt=new Un("ENVIRONMENT_INITIALIZER"),ka=new Un("INJECTOR",-1),Pa=new Un("INJECTOR_DEF_TYPES");class Td{get(o,u=Wr){if(u===Wr){const c=new Error(`NullInjectorError: No provider for ${we(o)}!`);throw c.name="NullInjectorError",c}return u}}function Fs(...s){return{\u0275providers:Oa(0,s)}}function Oa(s,...o){const u=[],c=new Set;let h;return zi(o,g=>{const w=g;hi(w,u,[],c)&&(h||(h=[]),h.push(w))}),void 0!==h&&Yi(h,u),u}function Yi(s,o){for(let u=0;u<s.length;u++){const{providers:h}=s[u];zi(h,g=>{o.push(g)})}}function hi(s,o,u,c){if(!(s=te(s)))return!1;let h=null,g=Yr(s);const w=!g&&Se(s);if(g||w){if(w&&!w.standalone)return!1;h=s}else{const C=s.ngModule;if(g=Yr(C),!g)return!1;h=C}const I=c.has(h);if(w){if(I)return!1;if(c.add(h),w.dependencies){const C="function"==typeof w.dependencies?w.dependencies():w.dependencies;for(const D of C)hi(D,o,u,c)}}else{if(!g)return!1;{if(null!=g.imports&&!I){let D;c.add(h);try{zi(g.imports,x=>{hi(x,o,u,c)&&(D||(D=[]),D.push(x))})}finally{}void 0!==D&&Yi(D,o)}if(!I){const D=Gi(h)||(()=>new h);o.push({provide:h,useFactory:D,deps:Rt},{provide:Pa,useValue:h,multi:!0},{provide:Jt,useValue:()=>vr(h),multi:!0})}const C=g.providers;null==C||I||zi(C,x=>{o.push(x)})}}return h!==s&&void 0!==s.providers}const Vg=ye({provide:String,useValue:ye});function Vl(s){return null!==s&&"object"==typeof s&&Vg in s}function Zo(s){return"function"==typeof s}const Sd=new Un("Set Injector scope."),ri={},vf={};let Ad;function Md(){return void 0===Ad&&(Ad=new Td),Ad}class Fa{}class wf extends Fa{constructor(o,u,c,h){super(),this.parent=u,this.source=c,this.scopes=h,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,$l(o,w=>this.processProvider(w)),this.records.set(ka,ii(void 0,this)),h.has("environment")&&this.records.set(Fa,ii(void 0,this));const g=this.records.get(Sd);null!=g&&"string"==typeof g.value&&this.scopes.add(g.value),this.injectorDefTypes=new Set(this.get(Pa.multi,Rt,st.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const u=Wo(this),c=xn(void 0);try{return o()}finally{Wo(u),xn(c)}}get(o,u=Wr,c=st.Default){this.assertNotDestroyed();const h=Wo(this),g=xn(void 0);try{if(!(c&st.SkipSelf)){let I=this.records.get(o);if(void 0===I){const C=function Su(s){return"function"==typeof s||"object"==typeof s&&s instanceof Un}(o)&&Zt(o);I=C&&this.injectableDefInScope(C)?ii(en(o),ri):null,this.records.set(o,I)}if(null!=I)return this.hydrate(o,I)}return(c&st.Self?Md():this.parent).get(o,u=c&st.Optional&&u===Wr?null:u)}catch(w){if("NullInjectorError"===w.name){if((w[Ns]=w[Ns]||[]).unshift(we(o)),h)throw w;return function _u(s,o,u,c){const h=s[Ns];throw o[rf]&&h.unshift(o[rf]),s.message=function J_(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.slice(2):s;let h=we(o);if(Array.isArray(o))h=o.map(we).join(" -> ");else if("object"==typeof o){let g=[];for(let w in o)if(o.hasOwnProperty(w)){let I=o[w];g.push(w+":"+("string"==typeof I?JSON.stringify(I):we(I)))}h=`{${g.join(", ")}}`}return`${u}${c?"("+c+")":""}[${h}]: ${s.replace(Ma,"\n  ")}`}("\n"+s.message,h,u,c),s.ngTokenPath=h,s[Ns]=null,s}(w,o,"R3InjectorError",this.source)}throw w}finally{xn(g),Wo(h)}}resolveInjectorInitializers(){const o=Wo(this),u=xn(void 0);try{const c=this.get(Jt.multi,Rt,st.Self);for(const h of c)h()}finally{Wo(o),xn(u)}}toString(){const o=[],u=this.records;for(const c of u.keys())o.push(we(c));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new De(205,!1)}processProvider(o){let u=Zo(o=te(o))?o:te(o&&o.provide);const c=function If(s){return Vl(s)?ii(void 0,s.useValue):ii(jl(s),ri)}(o);if(Zo(o)||!0!==o.multi)this.records.get(u);else{let h=this.records.get(u);h||(h=ii(void 0,ri,!0),h.factory=()=>hd(h.multi),this.records.set(u,h)),u=o,h.multi.push(o)}this.records.set(u,c)}hydrate(o,u){return u.value===ri&&(u.value=vf,u.value=u.factory()),"object"==typeof u.value&&u.value&&function Us(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=te(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function en(s){const o=Zt(s),u=null!==o?o.factory:Gi(s);if(null!==u)return u;if(s instanceof Un)throw new De(204,!1);if(s instanceof Function)return function Ef(s){const o=s.length;if(o>0)throw so(o,"?"),new De(204,!1);const u=function pr(s){const o=s&&(s[gr]||s[ur]);if(o){const u=function On(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new De(204,!1)}function jl(s,o,u){let c;if(Zo(s)){const h=te(s);return Gi(h)||en(h)}if(Vl(s))c=()=>te(s.useValue);else if(function Dd(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...hd(s.deps||[]));else if(function Du(s){return!(!s||!s.useExisting)}(s))c=()=>vr(te(s.useExisting));else{const h=te(s&&(s.useClass||s.provide));if(!function Ls(s){return!!s.deps}(s))return Gi(h)||en(h);c=()=>new h(...hd(s.deps))}return c}function ii(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function qt(s){return!!s.\u0275providers}function $l(s,o){for(const u of s)Array.isArray(u)?$l(u,o):qt(u)?$l(u.\u0275providers,o):o(u)}class jg{}class f{resolveComponentFactory(o){throw function tr(s){const o=Error(`No component factory found for ${we(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let m=(()=>{class s{}return s.NULL=new f,s})();function E(){return S(Hn(),Me())}function S(s,o){return new R(gi(s,o))}let R=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=E,s})();function Q(s){return s instanceof R?s.nativeElement:s}class qe{}let ct=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function Dt(){const s=Me(),u=on(Hn().index,s);return($r(u)?u:s)[11]}(),s})(),It=(()=>{class s{}return s.\u0275prov=dn({token:s,providedIn:"root",factory:()=>null}),s})();class qn{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Qi=new qn("14.2.2"),Yo={};function my(s){return s.ngOriginalError}class Af{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&my(o);for(;u&&my(u);)u=my(u);return u||null}}const kd=new Map;let Mf=0;const Od="__ngContext__";function Pr(s,o){$r(o)?(s[Od]=o[20],function Pd(s){kd.set(s[20],s)}(o)):s[Od]=o}function Xi(s){return s instanceof Function?s():s}var Qo=(()=>((Qo=Qo||{})[Qo.Important=1]="Important",Qo[Qo.DashCase=2]="DashCase",Qo))();function Cy(s,o){return undefined(s,o)}function Nf(s){const o=s[3];return Ar(o)?o[3]:o}function Dy(s){return kf(s[13])}function Sy(s){return kf(s[4])}function kf(s){for(;null!==s&&!Ar(s);)s=s[4];return s}function Zl(s,o,u,c,h){if(null!=c){let g,w=!1;Ar(c)?g=c:$r(c)&&(w=!0,c=c[0]);const I=Xn(c);0===s&&null!==u?null==h?Yg(o,u,I):Ru(o,u,I,h||null,!0):1===s&&null!==u?Ru(o,u,I,h||null,!0):2===s?function Ly(s,o,u){const c=Qg(s,o);c&&function DD(s,o,u,c){s.removeChild(o,u,c)}(s,c,o,u)}(o,I,w):3===s&&o.destroyNode(I),null!=g&&function R0(s,o,u,c,h){const g=u[7];g!==Xn(u)&&Zl(o,s,c,g,h);for(let I=10;I<u.length;I++){const C=u[I];Of(C[1],C,s,o,c,g)}}(o,s,g,u,h)}}function qg(s,o,u){return s.createElement(o,u)}function T0(s,o){const u=s[9],c=u.indexOf(o),h=o[3];512&o[2]&&(o[2]&=-513,va(h,-1)),u.splice(c,1)}function xy(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const h=c[17];null!==h&&h!==s&&T0(h,c),o>0&&(s[u-1][4]=c[4]);const g=$o(s,10+o);!function b0(s,o){Of(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const w=g[19];null!==w&&w.detachView(g[1]),c[3]=null,c[4]=null,c[2]&=-65}return c}function D0(s,o){if(!(128&o[2])){const u=o[11];u.destroyNode&&Of(s,o,u,3,null,null),function C0(s){let o=s[13];if(!o)return Kg(s[1],s);for(;o;){let u=null;if($r(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)$r(o)&&Kg(o[1],o),o=o[3];null===o&&(o=s),$r(o)&&Kg(o[1],o),u=o&&o[4]}o=u}}(o)}}function Kg(s,o){if(!(128&o[2])){o[2]&=-65,o[2]|=128,function Ry(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const h=o[u[c]];if(!(h instanceof Vo)){const g=u[c+1];if(Array.isArray(g))for(let w=0;w<g.length;w+=2){const I=h[g[w]],C=g[w+1];try{C.call(I)}finally{}}else try{g.call(h)}finally{}}}}(s,o),function Zg(s,o){const u=s.cleanup,c=o[7];let h=-1;if(null!==u)for(let g=0;g<u.length-1;g+=2)if("string"==typeof u[g]){const w=u[g+1],I="function"==typeof w?w(o):Xn(o[w]),C=c[h=u[g+2]],D=u[g+3];"boolean"==typeof D?I.removeEventListener(u[g],C,D):D>=0?c[h=D]():c[h=-D].unsubscribe(),g+=2}else{const w=c[h=u[g+1]];u[g].call(w)}if(null!==c){for(let g=h+1;g<c.length;g++)(0,c[g])();o[7]=null}}(s,o),1===o[1].type&&o[11].destroy();const u=o[17];if(null!==u&&Ar(o[3])){u!==o[3]&&T0(u,o);const c=o[19];null!==c&&c.detachView(s)}!function yD(s){kd.delete(s[20])}(o)}}function Ny(s,o,u){return function S0(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];if(2&c.flags){const h=s.data[c.directiveStart].encapsulation;if(h===dt.None||h===dt.Emulated)return null}return gi(c,u)}(s,o.parent,u)}function Ru(s,o,u,c,h){s.insertBefore(o,u,c,h)}function Yg(s,o,u){s.appendChild(o,u)}function A0(s,o,u,c,h){null!==c?Ru(s,o,u,c,h):Yg(s,o,u)}function Qg(s,o){return s.parentNode(o)}function M0(s,o,u){return ky(s,o,u)}let ky=function x0(s,o,u){return 40&s.type?gi(s,u):null};function Pf(s,o,u,c){const h=Ny(s,c,o),g=o[11],I=M0(c.parent||o[6],c,o);if(null!=h)if(Array.isArray(u))for(let C=0;C<u.length;C++)A0(g,h,u[C],I,!1);else A0(g,h,u,I,!1)}function Xg(s,o){if(null!==o){const u=o.type;if(3&u)return gi(o,s);if(4&u)return Ud(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return Xg(s,c);{const h=s[o.index];return Ar(h)?Ud(-1,h):Xn(h)}}if(32&u)return Cy(o,s)()||Xn(s[o.index]);{const c=Fy(s,o);return null!==c?Array.isArray(c)?c[0]:Xg(Nf(s[16]),c):Xg(s,o.next)}}return null}function Fy(s,o){return null!==o?s[16][6].projection[o.projection]:null}function Ud(s,o){const u=10+s+1;if(u<o.length){const c=o[u],h=c[1].firstChild;if(null!==h)return Xg(c,h)}return o[7]}function Uy(s,o,u,c,h,g,w){for(;null!=u;){const I=c[u.index],C=u.type;if(w&&0===o&&(I&&Pr(Xn(I),c),u.flags|=4),64!=(64&u.flags))if(8&C)Uy(s,o,u.child,c,h,g,!1),Zl(o,s,h,I,g);else if(32&C){const D=Cy(u,c);let x;for(;x=D();)Zl(o,s,h,x,g);Zl(o,s,h,I,g)}else 16&C?Jg(s,o,c,u,h,g):Zl(o,s,h,I,g);u=w?u.projectionNext:u.next}}function Of(s,o,u,c,h,g){Uy(u,c,s.firstChild,o,h,g,!1)}function Jg(s,o,u,c,h,g){const w=u[16],C=w[6].projection[c.projection];if(Array.isArray(C))for(let D=0;D<C.length;D++)Zl(o,s,h,C[D],g);else Uy(s,o,C,w[3],h,g,!0)}function N0(s,o,u){s.setAttribute(o,"style",u)}function em(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function Ba(s,o,u){let c=s.length;for(;;){const h=s.indexOf(o,u);if(-1===h)return h;if(0===h||s.charCodeAt(h-1)<=32){const g=o.length;if(h+g===c||s.charCodeAt(h+g)<=32)return h}u=h+1}}const By="ng-template";function Nu(s,o,u){let c=0;for(;c<s.length;){let h=s[c++];if(u&&"class"===h){if(h=s[c],-1!==Ba(h.toLowerCase(),o,0))return!0}else if(1===h){for(;c<s.length&&"string"==typeof(h=s[c++]);)if(h.toLowerCase()===o)return!0;return!1}}return!1}function Ff(s){return 4===s.type&&s.value!==By}function tm(s,o,u){return o===(4!==s.type||u?s.value:By)}function RD(s,o,u){let c=4;const h=s.attrs||[],g=function kD(s){for(let o=0;o<s.length;o++)if(gl(s[o]))return o;return s.length}(h);let w=!1;for(let I=0;I<o.length;I++){const C=o[I];if("number"!=typeof C){if(!w)if(4&c){if(c=2|1&c,""!==C&&!tm(s,C,u)||""===C&&1===o.length){if(ho(c))return!1;w=!0}}else{const D=8&c?C:o[++I];if(8&c&&null!==s.attrs){if(!Nu(s.attrs,D,u)){if(ho(c))return!1;w=!0}continue}const L=ND(8&c?"class":C,h,Ff(s),u);if(-1===L){if(ho(c))return!1;w=!0;continue}if(""!==D){let q;q=L>g?"":h[L+1].toLowerCase();const se=8&c?q:null;if(se&&-1!==Ba(se,D,0)||2&c&&D!==q){if(ho(c))return!1;w=!0}}}}else{if(!w&&!ho(c)&&!ho(C))return!1;if(w&&ho(C))continue;w=!1,c=C|1&c}}return ho(c)||w}function ho(s){return 0==(1&s)}function ND(s,o,u,c){if(null===o)return-1;let h=0;if(c||!u){let g=!1;for(;h<o.length;){const w=o[h];if(w===s)return h;if(3===w||6===w)g=!0;else{if(1===w||2===w){let I=o[++h];for(;"string"==typeof I;)I=o[++h];continue}if(4===w)break;if(0===w){h+=4;continue}}h+=g?1:2}return-1}return function ku(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function Vy(s,o,u=!1){for(let c=0;c<o.length;c++)if(RD(s,o[c],u))return!0;return!1}function Lf(s,o){e:for(let u=0;u<o.length;u++){const c=o[u];if(s.length===c.length){for(let h=0;h<s.length;h++)if(s[h]!==c[h])continue e;return!0}}return!1}function k0(s,o){return s?":not("+o.trim()+")":o}function PD(s){let o=s[0],u=1,c=2,h="",g=!1;for(;u<s.length;){let w=s[u];if("string"==typeof w)if(2&c){const I=s[++u];h+="["+w+(I.length>0?'="'+I+'"':"")+"]"}else 8&c?h+="."+w:4&c&&(h+=" "+w);else""!==h&&!ho(w)&&(o+=k0(g,h),h=""),c=w,g=g||!ho(c);u++}return""!==h&&(o+=k0(g,h)),o}const Kt={};function P0(s){rm(Et(),Me(),Rr()+s,!1)}function rm(s,o,u,c){if(!c)if(3==(3&o[2])){const g=s.preOrderCheckHooks;null!==g&&Qc(o,g,u)}else{const g=s.preOrderHooks;null!==g&&Ca(o,g,0,u)}Pi(u)}function sm(s,o=null,u=null,c){const h=om(s,o,u,c);return h.resolveInjectorInitializers(),h}function om(s,o=null,u=null,c,h=new Set){const g=[u||Rt,Fs(s)];return c=c||("object"==typeof s?void 0:we(s)),new wf(g,o||Md(),c||null,h)}let Yl=(()=>{class s{static create(u,c){if(Array.isArray(u))return sm({name:""},c,u,"");{const h=u.name??"";return sm({name:h},u.parent,u.providers,h)}}}return s.THROW_IF_NOT_FOUND=Wr,s.NULL=new Td,s.\u0275prov=dn({token:s,providedIn:"any",factory:()=>vr(ka)}),s.__NG_ELEMENT_ID__=-1,s})();function Xo(s,o=st.Default){const u=Me();return null===u?vr(s,o):bl(Hn(),u,te(s),o)}function fo(){throw new Error("invalid")}function cm(s,o){return s<<17|o<<2}function js(s){return s>>17&32767}function Jl(s){return 2|s}function Va(s){return(131068&s)>>2}function Ji(s,o){return-131069&s|o<<2}function Yy(s){return 1|s}function nI(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const h=u[c],g=u[c+1];if(-1!==g){const w=s.data[g];dl(h),w.contentQueries(2,o[g],g)}}}function Wf(s,o,u,c,h,g,w,I,C,D,x){const L=o.blueprint.slice();return L[0]=h,L[2]=76|c,(null!==x||s&&1024&s[2])&&(L[2]|=1024),au(L),L[3]=L[15]=s,L[8]=u,L[10]=w||s&&s[10],L[11]=I||s&&s[11],L[12]=C||s&&s[12]||null,L[9]=D||s&&s[9]||null,L[6]=g,L[20]=function zl(){return Mf++}(),L[21]=x,L[16]=2==o.type?s[16]:L,L}function nc(s,o,u,c,h){let g=s.data[o];if(null===g)g=function zf(s,o,u,c,h){const g=wa(),w=uu(),C=s.data[o]=function ov(s,o,u,c,h,g){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,w?g:g&&g.parent,u,o,c,h);return null===s.firstChild&&(s.firstChild=C),null!==g&&(w?null==g.child&&null!==C.parent&&(g.child=C):null===g.next&&(g.next=C)),C}(s,o,u,c,h),function QE(){return N.lFrame.inI18n}()&&(g.flags|=64);else if(64&g.type){g.type=u,g.value=c,g.attrs=h;const w=function Wi(){const s=N.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();g.injectorIndex=null===w?-1:w.injectorIndex}return Gr(g,!0),g}function rc(s,o,u,c){if(0===u)return-1;const h=o.length;for(let g=0;g<u;g++)o.push(c),s.blueprint.push(c),s.data.push(null);return h}function yi(s,o,u){dg(o);try{const c=s.viewQuery;null!==c&&fv(1,c,u);const h=s.template;null!==h&&ja(s,o,h,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&nI(s,o),s.staticViewQueries&&fv(2,s.viewQuery,u);const g=s.components;null!==g&&function WD(s,o){for(let u=0;u<o.length;u++)nS(s,o[u])}(o,g)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,hl()}}function ic(s,o,u,c){const h=o[2];if(128!=(128&h)){dg(o);try{au(o),function Lh(s){return N.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&ja(s,o,u,2,c);const w=3==(3&h);if(w){const D=s.preOrderCheckHooks;null!==D&&Qc(o,D,null)}else{const D=s.preOrderHooks;null!==D&&Ca(o,D,0,null),Gh(o,0)}if(function eS(s){for(let o=Dy(s);null!==o;o=Sy(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const h=u[c],g=h[3];0==(512&h[2])&&va(g,1),h[2]|=512}}}(o),function JD(s){for(let o=Dy(s);null!==o;o=Sy(o))for(let u=10;u<o.length;u++){const c=o[u],h=c[1];Lo(c)&&ic(h,c,h.template,c[8])}}(o),null!==s.contentQueries&&nI(s,o),w){const D=s.contentCheckHooks;null!==D&&Qc(o,D)}else{const D=s.contentHooks;null!==D&&Ca(o,D,1),Gh(o,1)}!function GD(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const h=u[c];if(h<0)Pi(~h);else{const g=h,w=u[++c],I=u[++c];XE(w,g),I(2,o[g])}}}finally{Pi(-1)}}(s,o);const I=s.components;null!==I&&function sv(s,o){for(let u=0;u<o.length;u++)tS(s,o[u])}(o,I);const C=s.viewQuery;if(null!==C&&fv(2,C,c),w){const D=s.viewCheckHooks;null!==D&&Qc(o,D)}else{const D=s.viewHooks;null!==D&&Ca(o,D,2),Gh(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-41,512&o[2]&&(o[2]&=-513,va(o[3],-1))}finally{hl()}}}function ja(s,o,u,c,h){const g=Rr(),w=2&c;try{Pi(-1),w&&o.length>22&&rm(s,o,22,!1),u(c,h)}finally{Pi(g)}}function es(s,o,u){!gt()||(function aI(s,o,u,c){const h=u.directiveStart,g=u.directiveEnd;s.firstCreatePass||El(u,o),Pr(c,o);const w=u.initialInputs;for(let I=h;I<g;I++){const C=s.data[I],D=Jr(C);D&&YD(o,u,C);const x=Da(o,s,I,u);Pr(x,o),null!==w&&QD(0,I-h,x,C,0,w),D&&(on(u.index,o)[8]=x)}}(s,o,u,gi(u,o)),128==(128&u.flags)&&function uI(s,o,u){const c=u.directiveStart,h=u.directiveEnd,g=u.index,w=function lg(){return N.lFrame.currentDirectiveIndex}();try{Pi(g);for(let I=c;I<h;I++){const C=s.data[I],D=o[I];cg(I),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&Hs(C,D)}}finally{Pi(-1),cg(w)}}(s,o,u))}function $a(s,o,u=gi){const c=o.localNames;if(null!==c){let h=o.index+1;for(let g=0;g<c.length;g+=2){const w=c[g+1],I=-1===w?u(o,s):s[w];s[h++]=I}}}function ym(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=vm(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function vm(s,o,u,c,h,g,w,I,C,D){const x=22+c,L=x+h,q=function Ou(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:Kt);return u}(x,L),se="function"==typeof D?D():D;return q[1]={type:s,blueprint:q,template:u,queries:null,viewQuery:I,declTNode:o,data:q.slice().fill(null,x),bindingStartIndex:x,expandoStartIndex:L,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof w?w():w,firstChild:null,schemas:C,consts:se,incompleteFirstPass:!1}}function rI(s,o,u,c){const h=pv(o);null===u?h.push(c):(h.push(u),s.firstCreatePass&&pI(s).push(c,h.length-1))}function iI(s,o,u){for(let c in s)if(s.hasOwnProperty(c)){const h=s[c];(u=null===u?{}:u).hasOwnProperty(c)?u[c].push(o,h):u[c]=[o,h]}return u}function sI(s,o){const c=o.directiveEnd,h=s.data,g=o.attrs,w=[];let I=null,C=null;for(let D=o.directiveStart;D<c;D++){const x=h[D],L=x.inputs,q=null===g||Ff(o)?null:XD(L,g);w.push(q),I=iI(L,D,I),C=iI(x.outputs,D,C)}null!==I&&(I.hasOwnProperty("class")&&(o.flags|=16),I.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=w,o.inputs=I,o.outputs=C}function Gd(s,o){const u=on(o,s);16&u[2]||(u[2]|=32)}function Im(s,o,u,c){let h=!1;if(gt()){const g=function lI(s,o,u){const c=s.directiveRegistry;let h=null;if(c)for(let g=0;g<c.length;g++){const w=c[g];Vy(u,w.selectors,!1)&&(h||(h=[]),du(El(u,o),s,w.type),Jr(w)?(cI(s,u),h.unshift(w)):h.push(w))}return h}(s,o,u),w=null===c?null:{"":-1};if(null!==g){h=!0,lv(u,s.data.length,g.length);for(let x=0;x<g.length;x++){const L=g[x];L.providersResolver&&L.providersResolver(L)}let I=!1,C=!1,D=rc(s,o,g.length,null);for(let x=0;x<g.length;x++){const L=g[x];u.mergedAttrs=ml(u.mergedAttrs,L.hostAttrs),dI(s,u,o,D,L),ZD(D,L,w),null!==L.contentQueries&&(u.flags|=8),(null!==L.hostBindings||null!==L.hostAttrs||0!==L.hostVars)&&(u.flags|=128);const q=L.type.prototype;!I&&(q.ngOnChanges||q.ngOnInit||q.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),I=!0),!C&&(q.ngOnChanges||q.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),C=!0),D++}sI(s,u)}w&&function KD(s,o,u){if(o){const c=s.localNames=[];for(let h=0;h<o.length;h+=2){const g=u[o[h+1]];if(null==g)throw new De(-301,!1);c.push(o[h],g)}}}(u,c,w)}return u.mergedAttrs=ml(u.mergedAttrs,u.attrs),h}function uv(s,o,u,c,h,g){const w=g.hostBindings;if(w){let I=s.hostBindingOpCodes;null===I&&(I=s.hostBindingOpCodes=[]);const C=~o.index;(function oI(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(I)!=C&&I.push(C),I.push(c,h,w)}}function Hs(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function cI(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function ZD(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Jr(o)&&(u[""]=s)}}function lv(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}function dI(s,o,u,c,h){s.data[c]=h;const g=h.factory||(h.factory=Gi(h.type)),w=new Vo(g,Jr(h),Xo);s.blueprint[c]=w,u[c]=w,uv(s,o,0,c,rc(s,u,h.hostVars,Kt),h)}function YD(s,o,u){const c=gi(o,s),h=ym(u),g=s[10],w=bm(s,Wf(s,h,null,u.onPush?32:16,c,o,g,g.createRenderer(c,u),null,null,null));s[o.index]=w}function ea(s,o,u,c,h,g){const w=gi(s,o);!function cv(s,o,u,c,h,g,w){if(null==g)s.removeAttribute(o,h,u);else{const I=null==w?Ee(g):w(g,c||"",h);s.setAttribute(o,h,I,u)}}(o[11],w,g,s.value,u,c,h)}function QD(s,o,u,c,h,g){const w=g[o];if(null!==w){const I=c.setInput;for(let C=0;C<w.length;){const D=w[C++],x=w[C++],L=w[C++];null!==I?c.setInput(u,L,D,x):u[x]=L}}}function XD(s,o){let u=null,c=0;for(;c<o.length;){const h=o[c];if(0!==h)if(5!==h){if("number"==typeof h)break;s.hasOwnProperty(h)&&(null===u&&(u=[]),u.push(h,s[h],o[c+1])),c+=2}else c+=2;else c+=4}return u}function hI(s,o,u,c){return new Array(s,!0,!1,o,null,0,c,u,null,null)}function tS(s,o){const u=on(o,s);if(Lo(u)){const c=u[1];48&u[2]?ic(c,u,c.template,u[8]):u[5]>0&&dv(u)}}function dv(s){for(let c=Dy(s);null!==c;c=Sy(c))for(let h=10;h<c.length;h++){const g=c[h];if(Lo(g))if(512&g[2]){const w=g[1];ic(w,g,w.template,g[8])}else g[5]>0&&dv(g)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const h=on(u[c],s);Lo(h)&&h[5]>0&&dv(h)}}function nS(s,o){const u=on(o,s),c=u[1];(function rS(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),yi(c,u,u[8])}function bm(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function hv(s){for(;s;){s[2]|=32;const o=Nf(s);if(Bc(s)&&!o)return s;s=o}return null}function Cm(s,o,u,c=!0){const h=o[10];h.begin&&h.begin();try{ic(s,o,s.template,u)}catch(w){throw c&&gI(o,w),w}finally{h.end&&h.end()}}function fv(s,o,u){dl(0),o(s,u)}function pv(s){return s[7]||(s[7]=[])}function pI(s){return s.cleanup||(s.cleanup=[])}function gI(s,o){const u=s[9],c=u?u.get(Af,null):null;c&&c.handleError(o)}function mv(s,o,u,c,h){for(let g=0;g<u.length;){const w=u[g++],I=u[g++],C=o[w],D=s.data[w];null!==D.setInput?D.setInput(C,h,c,I):C[I]=h}}function Ha(s,o,u){const c=Js(o,s);!function I0(s,o,u){s.setValue(o,u)}(s[11],c,u)}function Tm(s,o,u){let c=u?s.styles:null,h=u?s.classes:null,g=0;if(null!==o)for(let w=0;w<o.length;w++){const I=o[w];"number"==typeof I?g=I:1==g?h=_e(h,I):2==g&&(c=_e(c,I+": "+o[++w]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=h:s.classesWithoutHost=h}function Kf(s,o,u,c,h=!1){for(;null!==u;){const g=o[u.index];if(null!==g&&c.push(Xn(g)),Ar(g))for(let I=10;I<g.length;I++){const C=g[I],D=C[1].firstChild;null!==D&&Kf(C[1],C,D,c)}const w=u.type;if(8&w)Kf(s,o,u.child,c);else if(32&w){const I=Cy(u,o);let C;for(;C=I();)c.push(C)}else if(16&w){const I=Fy(o,u);if(Array.isArray(I))c.push(...I);else{const C=Nf(o[16]);Kf(C[1],C,I,c,!0)}}u=h?u.projectionNext:u.next}return c}class Zf{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return Kf(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Ar(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(xy(o,c),$o(u,c))}this._attachedToViewContainer=!1}D0(this._lView[1],this._lView)}onDestroy(o){rI(this._lView[1],this._lView,null,o)}markForCheck(){hv(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Cm(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new De(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function CD(s,o){Of(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new De(902,!1);this._appRef=o}}class iS extends Zf{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Cm(o[1],o,o[8],!1)}checkNoChanges(){}get context(){return null}}class _v extends m{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=Se(o);return new Yf(u,this.ngModule)}}function mI(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class oS{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,c){const h=this.injector.get(o,Yo,c);return h!==Yo||u===Yo?h:this.parentInjector.get(o,u,c)}}class Yf extends jg{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function OD(s){return s.map(PD).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return mI(this.componentDef.inputs)}get outputs(){return mI(this.componentDef.outputs)}create(o,u,c,h){let g=(h=h||this.ngModule)instanceof Fa?h:h?.injector;g&&null!==this.componentDef.getStandaloneInjector&&(g=this.componentDef.getStandaloneInjector(g)||g);const w=g?new oS(o,g):o,I=w.get(qe,null);if(null===I)throw new De(407,!1);const C=w.get(It,null),D=I.createRenderer(null,this.componentDef),x=this.componentDef.selectors[0][0]||"div",L=c?function zD(s,o,u){return s.selectRootElement(o,u===dt.ShadowDom)}(D,c,this.componentDef.encapsulation):qg(I.createRenderer(null,this.componentDef),x,function sS(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(x)),q=this.componentDef.onPush?288:272,se=vm(0,null,null,1,0,null,null,null,null,null),Re=Wf(null,se,null,q,null,null,I,D,C,w,null);let Ke,nt;dg(Re);try{const vt=function lS(s,o,u,c,h,g){const w=u[1];u[22]=s;const C=nc(w,22,2,"#host",null),D=C.mergedAttrs=o.hostAttrs;null!==D&&(Tm(C,D,!0),null!==s&&(cu(h,s,D),null!==C.classes&&em(h,s,C.classes),null!==C.styles&&N0(h,s,C.styles)));const x=c.createRenderer(s,o),L=Wf(u,ym(o),null,o.onPush?32:16,u[22],C,c,x,g||null,null,null);return w.firstCreatePass&&(du(El(C,u),w,o.type),cI(w,C),lv(C,u.length,1)),bm(u,L),u[22]=L}(L,this.componentDef,Re,I,D);if(L)if(c)cu(D,L,["ng-version",Qi.full]);else{const{attrs:Ot,classes:Fe}=function nm(s){const o=[],u=[];let c=1,h=2;for(;c<s.length;){let g=s[c];if("string"==typeof g)2===h?""!==g&&o.push(g,s[++c]):8===h&&u.push(g);else{if(!ho(h))break;h=g}c++}return{attrs:o,classes:u}}(this.componentDef.selectors[0]);Ot&&cu(D,L,Ot),Fe&&Fe.length>0&&em(D,L,Fe.join(" "))}if(nt=ki(se,22),void 0!==u){const Ot=nt.projection=[];for(let Fe=0;Fe<this.ngContentSelectors.length;Fe++){const jt=u[Fe];Ot.push(null!=jt?Array.from(jt):null)}}Ke=function cS(s,o,u,c){const h=u[1],g=function av(s,o,u){const c=Hn();s.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),dI(s,c,o,rc(s,o,1,null),u),sI(s,c));const h=Da(o,s,c.directiveStart,c);Pr(h,o);const g=gi(c,o);return g&&Pr(g,o),h}(h,u,o);if(s[8]=u[8]=g,null!==c)for(const I of c)I(g,o);if(o.contentQueries){const I=Hn();o.contentQueries(1,g,I.directiveStart)}const w=Hn();return!h.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Pi(w.index),uv(u[1],w,0,w.directiveStart,w.directiveEnd,o),Hs(o,g)),g}(vt,this.componentDef,Re,[aP]),yi(se,Re,null)}finally{hl()}return new uS(this.componentType,Ke,S(nt,Re),Re,nt)}}class uS extends class Hl{}{constructor(o,u,c,h,g){super(),this.location=c,this._rootLView=h,this._tNode=g,this.instance=u,this.hostView=this.changeDetectorRef=new iS(h),this.componentType=o}setInput(o,u){const c=this._tNode.inputs;let h;if(null!==c&&(h=c[o])){const g=this._rootLView;mv(g[1],g,h,o,u),Gd(g,this._tNode.index)}}get injector(){return new pu(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function aP(){const s=Hn();Yc(Me()[1],s)}let Sm=null;function sc(){if(!Sm){const s=Gt.Symbol;if(s&&s.iterator)Sm=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Sm=c)}}}return Sm}function Qf(s){return!!Lu(s)&&(Array.isArray(s)||!(s instanceof Map)&&sc()in s)}function Lu(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function vi(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function oc(s,o,u,c){const h=vi(s,o,u);return vi(s,o+1,c)||h}function Jf(s,o,u,c){const h=Me();return vi(h,ba(),o)&&(Et(),ea(Wn(),h,s,o,u,c)),Jf}function zd(s,o,u,c,h,g,w,I){const D=function dr(s,o,u,c,h){const g=oc(s,o,u,c);return vi(s,o+2,h)||g}(s,Ss(),u,h,w);return Uo(3),D?o+Ee(u)+c+Ee(h)+g+Ee(w)+I:Kt}function Ga(s,o,u,c,h,g,w,I,C,D){const L=function Gs(s,o,u,c,h,g){const w=oc(s,o,u,c);return oc(s,o+2,h,g)||w}(s,Ss(),u,h,w,C);return Uo(4),L?o+Ee(u)+c+Ee(h)+g+Ee(w)+I+Ee(C)+D:Kt}function ep(s,o,u,c,h,g,w,I){const C=Me(),D=Et(),x=s+22,L=D.firstCreatePass?function Oi(s,o,u,c,h,g,w,I,C){const D=o.consts,x=nc(o,s,4,w||null,ls(D,I));Im(o,u,x,ls(D,C)),Yc(o,x);const L=x.tViews=vm(2,x,c,h,g,o.directiveRegistry,o.pipeRegistry,null,o.schemas,D);return null!==o.queries&&(o.queries.template(o,x),L.queries=o.queries.embeddedTView(x)),x}(x,D,C,o,u,c,h,g,w):D.data[x];Gr(L,!1);const q=C[11].createComment("");Pf(D,C,q,L),Pr(q,C),bm(C,C[x]=hI(q,C,q,L)),tu(L)&&es(D,C,L),null!=w&&$a(C,L,I)}function yI(s){return function eo(s,o){return s[o]}(function no(){return N.lFrame.contextLView}(),22+s)}function _o(s,o,u){const c=Me();return vi(c,ba(),o)&&function ts(s,o,u,c,h,g,w,I){const C=gi(o,u);let x,D=o.inputs;!I&&null!=D&&(x=D[c])?(mv(s,u,x,c,h),Es(o)&&Gd(u,o.index)):3&o.type&&(c=function qD(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),h=null!=w?w(h,o.value||"",c):h,g.setProperty(C,c,h))}(Et(),Wn(),c,s,o,c[11],u,!1),_o}function Wa(s,o,u,c,h){const w=h?"class":"style";mv(s,u,o.inputs[w],w,c)}function yo(s,o,u,c){const h=Me(),g=Et(),w=22+s,I=h[11],C=h[w]=qg(I,o,function Zc(){return N.lFrame.currentNamespace}()),D=g.firstCreatePass?function wi(s,o,u,c,h,g,w){const I=o.consts,D=nc(o,s,2,h,ls(I,g));return Im(o,u,D,ls(I,w)),null!==D.attrs&&Tm(D,D.attrs,!1),null!==D.mergedAttrs&&Tm(D,D.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,D),D}(w,g,h,0,o,u,c):g.data[w];Gr(D,!0);const x=D.mergedAttrs;null!==x&&cu(I,C,x);const L=D.classes;null!==L&&em(I,C,L);const q=D.styles;return null!==q&&N0(I,C,q),64!=(64&D.flags)&&Pf(g,h,C,D),0===function de(){return N.lFrame.elementDepthCount}()&&Pr(C,h),function Ue(){N.lFrame.elementDepthCount++}(),tu(D)&&(es(g,h,D),function qf(s,o,u){if(No(o)){const h=o.directiveEnd;for(let g=o.directiveStart;g<h;g++){const w=s.data[g];w.contentQueries&&w.contentQueries(1,u[g],g)}}}(g,D,h)),null!==c&&$a(h,D),yo}function Mm(){let s=Hn();uu()?Ea():(s=s.parent,Gr(s,!1));const o=s;!function tt(){N.lFrame.elementDepthCount--}();const u=Et();return u.firstCreatePass&&(Yc(u,s),No(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function Xc(s){return 0!=(16&s.flags)}(o)&&Wa(u,o,Me(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function pg(s){return 0!=(32&s.flags)}(o)&&Wa(u,o,Me(),o.stylesWithoutHost,!1),Mm}function za(s,o,u,c){return yo(s,o,u,c),Mm(),za}function an(s){return!!s&&"function"==typeof s.then}function Yd(s){return!!s&&"function"==typeof s.subscribe}const wI=Yd;function Vu(s,o,u,c){const h=Me(),g=Et(),w=Hn();return function vo(s,o,u,c,h,g,w,I){const C=tu(c),x=s.firstCreatePass&&pI(s),L=o[8],q=pv(o);let se=!0;if(3&c.type||I){const nt=gi(c,o),vt=I?I(nt):nt,Ot=q.length,Fe=I?Nn=>I(Xn(Nn[c.index])):c.index;let jt=null;if(!I&&C&&(jt=function gS(s,o,u,c){const h=s.cleanup;if(null!=h)for(let g=0;g<h.length-1;g+=2){const w=h[g];if(w===u&&h[g+1]===c){const I=o[7],C=h[g+2];return I.length>C?I[C]:null}"string"==typeof w&&(g+=2)}return null}(s,o,h,c.index)),null!==jt)(jt.__ngLastListenerFn__||jt).__ngNextListenerFn__=g,jt.__ngLastListenerFn__=g,se=!1;else{g=Tv(c,o,L,g,!1);const Nn=u.listen(vt,h,g);q.push(g,Nn),x&&x.push(h,Fe,Ot,Ot+1)}}else g=Tv(c,o,L,g,!1);const Re=c.outputs;let Ke;if(se&&null!==Re&&(Ke=Re[h])){const nt=Ke.length;if(nt)for(let vt=0;vt<nt;vt+=2){const hr=o[Ke[vt]][Ke[vt+1]].subscribe(g),ch=q.length;q.push(g,hr),x&&x.push(h,c.index,ch,-(ch+1))}}}(g,h,h[11],w,s,o,0,c),Vu}function Cv(s,o,u,c){try{return!1!==u(c)}catch(h){return gI(s,h),!1}}function Tv(s,o,u,c,h){return function g(w){if(w===Function)return c;hv(2&s.flags?on(s.index,o):o);let C=Cv(o,0,c,w),D=g.__ngNextListenerFn__;for(;D;)C=Cv(o,0,D,w)&&C,D=D.__ngNextListenerFn__;return h&&!1===C&&(w.preventDefault(),w.returnValue=!1),C}}function Dv(s=1){return function lu(s){return(N.lFrame.contextLView=function $h(s,o){for(;s>0;)o=o[15],s--;return o}(s,N.lFrame.contextLView))[8]}(s)}function lP(s,o){let u=null;const c=function jy(s){const o=s.attrs;if(null!=o){const u=o.indexOf(5);if(0==(1&u))return o[u+1]}return null}(s);for(let h=0;h<o.length;h++){const g=o[h];if("*"!==g){if(null===c?Vy(s,g,!0):Lf(c,g))return h}else u=h}return u}function si(s){const o=Me()[16][6];if(!o.projection){const c=o.projection=so(s?s.length:1,null),h=c.slice();let g=o.child;for(;null!==g;){const w=s?lP(g,s):0;null!==w&&(h[w]?h[w].projectionNext=g:c[w]=g,h[w]=g),g=g.next}}}function qa(s,o=0,u){const c=Me(),h=Et(),g=nc(h,22+s,16,null,u||null);null===g.projection&&(g.projection=o),Ea(),64!=(64&g.flags)&&function AD(s,o,u){Jg(o[11],0,o,u,Ny(s,u,o),M0(u.parent||o[6],u,o))}(h,c,g)}function Qd(s,o,u,c,h){const g=s[u+1],w=null===o;let I=c?js(g):Va(g),C=!1;for(;0!==I&&(!1===C||w);){const x=s[I+1];mS(s[I],o)&&(C=!0,s[I+1]=c?Yy(x):Jl(x)),I=c?js(x):Va(x)}C&&(s[u+1]=c?Jl(g):Yy(g))}function mS(s,o){return null===s||null==o||(Array.isArray(s)?s[1]:s)===o||!(!Array.isArray(s)||"string"!=typeof o)&&Rs(s,o)>=0}function Uv(s,o){return function wo(s,o,u,c){const h=Me(),g=Et(),w=Uo(2);g.firstUpdatePass&&function np(s,o,u,c){const h=s.data;if(null===h[u+1]){const g=h[Rr()],w=function km(s,o){return o>=s.expandoStartIndex}(s,u);(function fc(s,o){return 0!=(s.flags&(o?16:32))})(g,c)&&null===o&&!w&&(o=!1),o=function wS(s,o,u,c){const h=function cl(s){const o=N.lFrame.currentDirectiveIndex;return-1===o?null:s[o]}(s);let g=c?o.residualClasses:o.residualStyles;if(null===h)0===(c?o.classBindings:o.styleBindings)&&(u=rp(u=Vv(null,s,o,u,c),o.attrs,c),g=null);else{const w=o.directiveStylingLast;if(-1===w||s[w]!==h)if(u=Vv(h,s,o,u,c),null===g){let C=function dc(s,o,u){const c=u?o.classBindings:o.styleBindings;if(0!==Va(c))return s[js(c)]}(s,o,c);void 0!==C&&Array.isArray(C)&&(C=Vv(null,s,o,C[1],c),C=rp(C,o.attrs,c),function Bv(s,o,u,c){s[js(u?o.classBindings:o.styleBindings)]=c}(s,o,c,C))}else g=function dP(s,o,u){let c;const h=o.directiveEnd;for(let g=1+o.directiveStylingLast;g<h;g++)c=rp(c,s[g].hostAttrs,u);return rp(c,o.attrs,u)}(s,o,c)}return void 0!==g&&(c?o.residualClasses=g:o.residualStyles=g),u}(h,g,o,c),function cc(s,o,u,c,h,g){let w=g?o.classBindings:o.styleBindings,I=js(w),C=Va(w);s[c]=u;let x,D=!1;if(Array.isArray(u)){const L=u;x=L[1],(null===x||Rs(L,x)>0)&&(D=!0)}else x=u;if(h)if(0!==C){const q=js(s[I+1]);s[c+1]=cm(q,I),0!==q&&(s[q+1]=Ji(s[q+1],c)),s[I+1]=function jf(s,o){return 131071&s|o<<17}(s[I+1],c)}else s[c+1]=cm(I,0),0!==I&&(s[I+1]=Ji(s[I+1],c)),I=c;else s[c+1]=cm(C,0),0===I?I=c:s[C+1]=Ji(s[C+1],c),C=c;D&&(s[c+1]=Jl(s[c+1])),Qd(s,x,c,!0),Qd(s,x,c,!1),function gn(s,o,u,c,h){const g=h?s.residualClasses:s.residualStyles;null!=g&&"string"==typeof o&&Rs(g,o)>=0&&(u[c+1]=Yy(u[c+1]))}(o,x,s,c,g),w=cm(I,C),g?o.classBindings=w:o.styleBindings=w}(h,g,o,u,w,c)}}(g,s,w,c),o!==Kt&&vi(h,w,o)&&function hc(s,o,u,c,h,g,w,I){if(!(3&o.type))return;const C=s.data,D=C[I+1];sp(function Zy(s){return 1==(1&s)}(D)?jv(C,o,u,h,Va(D),w):void 0)||(sp(g)||function dm(s){return 2==(2&s)}(D)&&(g=jv(C,null,u,h,I,w)),function MD(s,o,u,c,h){if(o)h?s.addClass(u,c):s.removeClass(u,c);else{let g=-1===c.indexOf("-")?void 0:Qo.DashCase;null==h?s.removeStyle(u,c,g):("string"==typeof h&&h.endsWith("!important")&&(h=h.slice(0,-10),g|=Qo.Important),s.setStyle(u,c,h,g))}}(c,w,Js(Rr(),u),h,g))}(g,g.data[Rr()],h,h[11],s,h[w+1]=function xI(s,o){return null==s||("string"==typeof o?s+=o:"object"==typeof s&&(s=we(ks(s)))),s}(o,u),c,w)}(s,o,null,!0),Uv}function Vv(s,o,u,c,h){let g=null;const w=u.directiveEnd;let I=u.directiveStylingLast;for(-1===I?I=u.directiveStart:I++;I<w&&(g=o[I],c=rp(c,g.hostAttrs,h),g!==s);)I++;return null!==s&&(u.directiveStylingLast=I),c}function rp(s,o,u){const c=u?1:2;let h=-1;if(null!==o)for(let g=0;g<o.length;g++){const w=o[g];"number"==typeof w?h=w:h===c&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),mi(s,w,!!u||o[++g]))}return void 0===s?null:s}function jv(s,o,u,c,h,g){const w=null===o;let I;for(;h>0;){const C=s[h],D=Array.isArray(C),x=D?C[1]:C,L=null===x;let q=u[h+1];q===Kt&&(q=L?Rt:void 0);let se=L?ld(q,c):x===c?q:void 0;if(D&&!sp(se)&&(se=ld(C,c)),sp(se)&&(I=se,w))return I;const Re=s[h+1];h=w?js(Re):Va(Re)}if(null!==o){let C=g?o.residualClasses:o.residualStyles;null!=C&&(I=ld(C,c))}return I}function sp(s){return void 0!==s}function RI(s,o=""){const u=Me(),c=Et(),h=s+22,g=c.firstCreatePass?nc(c,h,1,o,null):c.data[h],w=u[h]=function Ld(s,o){return s.createText(o)}(u[11],o);Pf(c,u,w,g),Gr(g,!1)}function $v(s){return Pm("",s,""),$v}function Pm(s,o,u){const c=Me(),h=function ac(s,o,u,c){return vi(s,ba(),u)?o+Ee(u)+c:Kt}(c,s,o,u);return h!==Kt&&Ha(c,Rr(),h),Pm}function op(s,o,u,c,h,g,w){const I=Me(),C=zd(I,s,o,u,c,h,g,w);return C!==Kt&&Ha(I,Rr(),C),op}function pc(s,o,u,c,h,g,w,I,C){const D=Me(),x=Ga(D,s,o,u,c,h,g,w,I,C);return x!==Kt&&Ha(D,Rr(),x),pc}const ua=void 0;var Yv=["en",[["a","p"],["AM","PM"],ua],[["AM","PM"],ua,ua],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ua,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ua,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ua,"{1} 'at' {0}",ua],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function BI(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let _c={};function ap(s){const o=function $I(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=jI(o);if(u)return u;const c=o.split("-")[0];if(u=jI(c),u)return u;if("en"===c)return Yv;throw new De(701,!1)}function eh(s){return ap(s)[kt.PluralCase]}function jI(s){return s in _c||(_c[s]=Gt.ng&&Gt.ng.common&&Gt.ng.common.locales&&Gt.ng.common.locales[s]),_c[s]}var kt=(()=>((kt=kt||{})[kt.LocaleId=0]="LocaleId",kt[kt.DayPeriodsFormat=1]="DayPeriodsFormat",kt[kt.DayPeriodsStandalone=2]="DayPeriodsStandalone",kt[kt.DaysFormat=3]="DaysFormat",kt[kt.DaysStandalone=4]="DaysStandalone",kt[kt.MonthsFormat=5]="MonthsFormat",kt[kt.MonthsStandalone=6]="MonthsStandalone",kt[kt.Eras=7]="Eras",kt[kt.FirstDayOfWeek=8]="FirstDayOfWeek",kt[kt.WeekendRange=9]="WeekendRange",kt[kt.DateFormat=10]="DateFormat",kt[kt.TimeFormat=11]="TimeFormat",kt[kt.DateTimeFormat=12]="DateTimeFormat",kt[kt.NumberSymbols=13]="NumberSymbols",kt[kt.NumberFormats=14]="NumberFormats",kt[kt.CurrencyCode=15]="CurrencyCode",kt[kt.CurrencySymbol=16]="CurrencySymbol",kt[kt.CurrencyName=17]="CurrencyName",kt[kt.Currencies=18]="Currencies",kt[kt.Directionality=19]="Directionality",kt[kt.PluralCase=20]="PluralCase",kt[kt.ExtraData=21]="ExtraData",kt))();const yc="en-US";let WI=yc;function qm(s,o,u,c,h){if(s=te(s),Array.isArray(s))for(let g=0;g<s.length;g++)qm(s[g],o,u,c,h);else{const g=Et(),w=Me();let I=Zo(s)?s:te(s.provide),C=jl(s);const D=Hn(),x=1048575&D.providerIndexes,L=D.directiveStart,q=D.providerIndexes>>20;if(Zo(s)||!s.multi){const se=new Vo(C,h,Xo),Re=tw(I,o,h?x:x+q,L);-1===Re?(du(El(D,w),g,I),Km(g,s,o.length),o.push(I),D.directiveStart++,D.directiveEnd++,h&&(D.providerIndexes+=1048576),u.push(se),w.push(se)):(u[Re]=se,w[Re]=se)}else{const se=tw(I,o,x+q,L),Re=tw(I,o,x,x+q),Ke=se>=0&&u[se],nt=Re>=0&&u[Re];if(h&&!nt||!h&&!Ke){du(El(D,w),g,I);const vt=function dA(s,o,u,c,h){const g=new Vo(s,u,Xo);return g.multi=[],g.index=o,g.componentProviders=0,pb(g,h,c&&!u),g}(h?cA:lA,u.length,h,c,C);!h&&nt&&(u[Re].providerFactory=vt),Km(g,s,o.length,0),o.push(I),D.directiveStart++,D.directiveEnd++,h&&(D.providerIndexes+=1048576),u.push(vt),w.push(vt)}else Km(g,s,se>-1?se:Re,pb(u[h?Re:se],C,!h&&c));!h&&c&&nt&&u[Re].componentProviders++}}}function Km(s,o,u,c){const h=Zo(o),g=function yf(s){return!!s.useClass}(o);if(h||g){const C=(g?te(o.useClass):o).prototype.ngOnDestroy;if(C){const D=s.destroyHooks||(s.destroyHooks=[]);if(!h&&o.multi){const x=D.indexOf(u);-1===x?D.push(u,[c,C]):D[x+1].push(c,C)}else D.push(u,C)}}}function pb(s,o,u){return u&&s.componentProviders++,s.multi.push(o)-1}function tw(s,o,u,c){for(let h=u;h<c;h++)if(o[h]===s)return h;return-1}function lA(s,o,u,c){return nw(this.multi,[])}function cA(s,o,u,c){const h=this.multi;let g;if(this.providerFactory){const w=this.providerFactory.componentProviders,I=Da(u,u[1],this.providerFactory.index,c);g=I.slice(0,w),nw(h,g);for(let C=w;C<I.length;C++)g.push(I[C])}else g=[],nw(h,g);return g}function nw(s,o){for(let u=0;u<s.length;u++)o.push((0,s[u])());return o}function rw(s,o=[]){return u=>{u.providersResolver=(c,h)=>function fb(s,o,u){const c=Et();if(c.firstCreatePass){const h=Jr(s);qm(u,c.data,c.blueprint,h,!0),qm(o,c.data,c.blueprint,h,!1)}}(c,h?h(s):s,o)}}class Gu{}class iw{}function gb(s,o){return new mb(s,o??null)}class mb extends Gu{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new _v(this);const c=At(o);this._bootstrapComponents=Xi(c.bootstrap),this._r3Injector=om(o,u,[{provide:Gu,useValue:this},{provide:m,useValue:this.componentFactoryResolver}],we(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class sw extends iw{constructor(o){super(),this.moduleType=o}create(o){return new mb(this.moduleType,o)}}class hA extends Gu{constructor(o,u,c){super(),this.componentFactoryResolver=new _v(this),this.instance=null;const h=new wf([...o,{provide:Gu,useValue:this},{provide:m,useValue:this.componentFactoryResolver}],u||Md(),c,new Set(["environment"]));this.injector=h,h.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function ow(s,o,u=null){return new hA(s,o,u).injector}let Zm=(()=>{class s{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const c=Oa(0,u.type),h=c.length>0?ow([c],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,h)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=dn({token:s,providedIn:"environment",factory:()=>new s(vr(Fa))}),s})();function aw(s){s.getStandaloneInjector=o=>o.get(Zm).getOrCreateStandaloneInjector(s)}function e_(s){return o=>{setTimeout(s,void 0,o)}}const la=class SA extends _.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){let h=o,g=u||(()=>null),w=c;if(o&&"object"==typeof o){const C=o;h=C.next?.bind(C),g=C.error?.bind(C),w=C.complete?.bind(C)}this.__isAsync&&(g=e_(g),h&&(h=e_(h)),w&&(w=e_(w)));const I=super.subscribe({next:h,error:g,complete:w});return o instanceof ne.w0&&o.add(I),I}};function AA(){return this._results[sc()]()}class dw{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=sc(),c=dw.prototype;c[u]||(c[u]=AA)}get changes(){return this._changes||(this._changes=new la)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const h=er(o);(this._changesDetected=!function k(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let h=s[c],g=o[c];if(u&&(h=u(h),g=u(g)),g!==h)return!1}return!0}(c._results,h,u))&&(c._results=h,c.length=h.length,c.last=h[this.length-1],c.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let yp=(()=>{class s{}return s.__NG_ELEMENT_ID__=xA,s})();const MA=yp,Ab=class extends MA{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o,u){const c=this._declarationTContainer.tViews,h=Wf(this._declarationLView,c,o,16,null,c.declTNode,null,null,null,null,u||null);h[17]=this._declarationLView[this._declarationTContainer.index];const w=this._declarationLView[19];return null!==w&&(h[19]=w.createEmbeddedView(c)),yi(c,h,o),new Zf(h)}};function xA(){return hw(Hn(),Me())}function hw(s,o){return 4&s.type?new Ab(o,s,S(s,o)):null}let ah=(()=>{class s{}return s.__NG_ELEMENT_ID__=Mb,s})();function Mb(){return uh(Hn(),Me())}const bP=ah,bc=class extends bP{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return S(this._hostTNode,this._hostLView)}get injector(){return new pu(this._hostTNode,this._hostLView)}get parentInjector(){const o=nd(this._hostTNode,this._hostLView);if(mg(o)){const u=vl(o,this._hostLView),c=_l(o);return new pu(u[1].data[c+8],u)}return new pu(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=fw(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){let h,g;"number"==typeof c?h=c:null!=c&&(h=c.index,g=c.injector);const w=o.createEmbeddedView(u||{},g);return this.insert(w,h),w}createComponent(o,u,c,h,g){const w=o&&!function Jn(s){return"function"==typeof s}(o);let I;if(w)I=u;else{const L=u||{};I=L.index,c=L.injector,h=L.projectableNodes,g=L.environmentInjector||L.ngModuleRef}const C=w?o:new Yf(Se(o)),D=c||this.parentInjector;if(!g&&null==C.ngModule){const q=(w?D:this.parentInjector).get(Fa,null);q&&(g=q)}const x=C.create(D,h,void 0,g);return this.insert(x.hostView,I),x}insert(o,u){const c=o._lView,h=c[1];if(function ll(s){return Ar(s[3])}(c)){const x=this.indexOf(o);if(-1!==x)this.detach(x);else{const L=c[3],q=new bc(L,L[6],L[3]);q.detach(q.indexOf(o))}}const g=this._adjustIndex(u),w=this._lContainer;!function My(s,o,u,c){const h=10+c,g=u.length;c>0&&(u[h-1][4]=o),c<g-10?(o[4]=u[h],ef(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const w=o[17];null!==w&&u!==w&&function TD(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(w,o);const I=o[19];null!==I&&I.insertView(s),o[2]|=64}(h,c,w,g);const I=Ud(g,w),C=c[11],D=Qg(C,w[7]);return null!==D&&function bD(s,o,u,c,h,g){c[0]=h,c[6]=o,Of(s,c,u,1,h,g)}(h,w[6],C,c,D,I),o.attachToViewContainerRef(),ef(xb(w),g,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=fw(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=xy(this._lContainer,u);c&&($o(xb(this._lContainer),u),D0(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=xy(this._lContainer,u);return c&&null!=$o(xb(this._lContainer),u)?new Zf(c):null}_adjustIndex(o,u=0){return o??this.length+u}};function fw(s){return s[8]}function xb(s){return s[8]||(s[8]=[])}function uh(s,o){let u;const c=o[s.index];if(Ar(c))u=c;else{let h;if(8&s.type)h=Xn(c);else{const g=o[11];h=g.createComment("");const w=gi(s,o);Ru(g,Qg(g,w),h,function SD(s,o){return s.nextSibling(o)}(g,w),!1)}o[s.index]=u=hI(c,o,h,s),bm(o,u)}return new bc(u,s,o)}class Ya{constructor(o){this.queryList=o,this.matches=null}clone(){return new Ya(this.queryList)}setDirty(){this.queryList.setDirty()}}class Rb{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,h=[];for(let g=0;g<c;g++){const w=u.getByIndex(g);h.push(this.queries[w.indexInDeclarationView].clone())}return new Rb(h)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==BA(o,u).matches&&this.queries[u].setDirty()}}class NA{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class vp{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const h=null!==u?u.length:0,g=this.getByIndex(c).embeddedTView(o,h);g&&(g.indexInDeclarationView=c,null!==u?u.push(g):u=[g])}return null!==u?new vp(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class mw{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new mw(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let h=0;h<c.length;h++){const g=c[h];this.matchTNodeWithReadOption(o,u,CP(u,g)),this.matchTNodeWithReadOption(o,u,fu(u,o,g,!1,!1))}else c===yp?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,fu(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const h=this.metadata.read;if(null!==h)if(h===R||h===ah||h===yp&&4&u.type)this.addMatch(u.index,-2);else{const g=fu(u,o,h,!1,!1);null!==g&&this.addMatch(u.index,g)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function CP(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function DP(s,o,u,c){return-1===u?function TP(s,o){return 11&s.type?S(s,o):4&s.type?hw(s,o):null}(o,s):-2===u?function kA(s,o,u){return u===R?S(o,s):u===yp?hw(o,s):u===ah?uh(o,s):void 0}(s,o,c):Da(s,s[1],u,o)}function PA(s,o,u,c){const h=o[19].queries[c];if(null===h.matches){const g=s.data,w=u.matches,I=[];for(let C=0;C<w.length;C+=2){const D=w[C];I.push(D<0?null:DP(o,g[D],w[C+1],u.metadata.read))}h.matches=I}return h.matches}function Nb(s,o,u,c){const h=s.queries.getByIndex(u),g=h.matches;if(null!==g){const w=PA(s,o,h,u);for(let I=0;I<g.length;I+=2){const C=g[I];if(C>0)c.push(w[I/2]);else{const D=g[I+1],x=o[-C];for(let L=10;L<x.length;L++){const q=x[L];q[17]===q[3]&&Nb(q[1],q,D,c)}if(null!==x[9]){const L=x[9];for(let q=0;q<L.length;q++){const se=L[q];Nb(se[1],se,D,c)}}}}}return c}function OA(s){const o=Me(),u=Et(),c=$_();dl(c+1);const h=BA(u,c);if(s.dirty&&function Kc(s){return 4==(4&s[2])}(o)===(2==(2&h.metadata.flags))){if(null===h.matches)s.reset([]);else{const g=h.crossesNgTemplate?Nb(u,o,c,[]):PA(u,o,h,c);s.reset(g,Q),s.notifyOnChanges()}return!0}return!1}function FA(s,o,u,c){const h=Et();if(h.firstCreatePass){const g=Hn();(function UA(s,o,u){null===s.queries&&(s.queries=new vp),s.queries.track(new mw(o,u))})(h,new NA(o,u,c),g.index),function AP(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(h,s),2==(2&u)&&(h.staticContentQueries=!0)}!function Pb(s,o,u){const c=new dw(4==(4&u));rI(s,o,c,c.destroy),null===o[19]&&(o[19]=new Rb),o[19].queries.push(new Ya(c))}(h,Me(),u)}function kb(){return function LA(s,o){return s[19].queries[o].queryList}(Me(),$_())}function BA(s,o){return s.queries.getByIndex(o)}function VA(s,o){return hw(s,o)}function yw(...s){}const sM=new Un("Application Initializer");let vw=(()=>{class s{constructor(u){this.appInits=u,this.resolve=yw,this.reject=yw,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,h)=>{this.resolve=c,this.reject=h})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const g=this.appInits[h]();if(an(g))u.push(g);else if(wI(g)){const w=new Promise((I,C)=>{g.subscribe({complete:I,error:C})});u.push(w)}}Promise.all(u).then(()=>{c()}).catch(h=>{this.reject(h)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)(vr(sM,8))},s.\u0275prov=dn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const oM=new Un("AppId",{providedIn:"root",factory:function aM(){return`${Bb()}${Bb()}${Bb()}`}});function Bb(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const uM=new Un("Platform Initializer"),ZP=new Un("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),lM=new Un("appBootstrapListener"),YP=new Un("AnimationModuleType");let QP=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=dn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const ww=new Un("LocaleId",{providedIn:"root",factory:()=>dd(ww,st.Optional|st.SkipSelf)||function XP(){return typeof $localize<"u"&&$localize.locale||yc}()}),JP=new Un("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class eO{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let tO=(()=>{class s{compileModuleSync(u){return new sw(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),g=Xi(At(u).declarations).reduce((w,I)=>{const C=Se(I);return C&&w.push(new Yf(C)),w},[]);return new eO(c,g)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=dn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const iO=(()=>Promise.resolve(0))();function Vb(s){typeof Zone>"u"?iO.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Io{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new la(!1),this.onMicrotaskEmpty=new la(!1),this.onStable=new la(!1),this.onError=new la(!1),typeof Zone>"u")throw new De(908,!1);Zone.assertZonePatched();const h=this;if(h._nesting=0,h._outer=h._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const g=Zone.AsyncStackTaggingZoneSpec;h._inner=h._inner.fork(new g("Angular"))}Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!c&&u,h.shouldCoalesceRunChangeDetection=c,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function sO(){let s=Gt.requestAnimationFrame,o=Gt.cancelAnimationFrame;if(typeof Zone<"u"&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function uO(s){const o=()=>{!function aO(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(Gt,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,$b(s),s.isCheckStableRunning=!0,jb(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),$b(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,h,g,w,I)=>{try{return hM(s),u.invokeTask(h,g,w,I)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||s.shouldCoalesceRunChangeDetection)&&o(),fM(s)}},onInvoke:(u,c,h,g,w,I,C)=>{try{return hM(s),u.invoke(h,g,w,I,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),fM(s)}},onHasTask:(u,c,h,g)=>{u.hasTask(h,g),c===h&&("microTask"==g.change?(s._hasPendingMicrotasks=g.microTask,$b(s),jb(s)):"macroTask"==g.change&&(s.hasPendingMacrotasks=g.macroTask))},onHandleError:(u,c,h,g)=>(u.handleError(h,g),s.runOutsideAngular(()=>s.onError.emit(g)),!1)})}(h)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Io.isInAngularZone())throw new De(909,!1)}static assertNotInAngularZone(){if(Io.isInAngularZone())throw new De(909,!1)}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,h){const g=this._inner,w=g.scheduleEventTask("NgZoneEvent: "+h,o,oO,yw,yw);try{return g.runTask(w,u,c)}finally{g.cancelTask(w)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const oO={};function jb(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function $b(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function hM(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function fM(s){s._nesting--,jb(s)}class lO{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new la,this.onMicrotaskEmpty=new la,this.onStable=new la,this.onError=new la}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,h){return o.apply(u,c)}}const pM=new Un(""),gM=new Un("");let Ew,cO=(()=>{class s{constructor(u,c,h){this._ngZone=u,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Ew||(function dO(s){Ew=s}(h),h.addToWindow(c)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Io.assertNotInAngularZone(),Vb(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Vb(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,h){let g=-1;c&&c>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(w=>w.timeoutId!==g),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:g,updateCb:h})}whenStable(u,c,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,c,h){return[]}}return s.\u0275fac=function(u){return new(u||s)(vr(Io),vr(mM),vr(gM))},s.\u0275prov=dn({token:s,factory:s.\u0275fac}),s})(),mM=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return Ew?.findTestabilityInTree(this,u,c)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=dn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})(),Cc=null;const _M=new Un("AllowMultipleToken"),Hb=new Un("PlatformDestroyListeners");class fO{constructor(o,u){this.name=o,this.token=u}}function Wb(s,o,u=[]){const c=`Platform: ${o}`,h=new Un(c);return(g=[])=>{let w=Tw();if(!w||w.injector.get(_M,!1)){const I=[...u,...g,{provide:h,useValue:!0}];s?s(I):function yM(s){if(Cc&&!Cc.get(_M,!1))throw new De(400,!1);Cc=s;const o=s.get(zb);(function bw(s){const o=s.get(uM,null);o&&o.forEach(u=>u())})(s)}(function Cw(s=[],o){return Yl.create({name:o,providers:[{provide:Sd,useValue:"platform"},{provide:Hb,useValue:new Set([()=>Cc=null])},...s]})}(I,c))}return function pO(s){const o=Tw();if(!o)throw new De(401,!1);return o}()}}function Tw(){return Cc?.get(zb)??null}let zb=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const h=function Kb(s,o){let u;return u="noop"===s?new lO:("zone.js"===s?void 0:s)||new Io(o),u}(c?.ngZone,function qb(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(c)),g=[{provide:Io,useValue:h}];return h.run(()=>{const w=Yl.create({providers:g,parent:this.injector,name:u.moduleType.name}),I=u.create(w),C=I.injector.get(Af,null);if(!C)throw new De(402,!1);return h.runOutsideAngular(()=>{const D=h.onError.subscribe({next:x=>{C.handleError(x)}});I.onDestroy(()=>{Sw(this._modules,I),D.unsubscribe()})}),function Dw(s,o,u){try{const c=u();return an(c)?c.catch(h=>{throw o.runOutsideAngular(()=>s.handleError(h)),h}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(C,h,()=>{const D=I.injector.get(vw);return D.runInitializers(),D.donePromise.then(()=>(function Bm(s){Bt(s,"Expected localeId to be defined"),"string"==typeof s&&(WI=s.toLowerCase().replace(/_/g,"-"))}(I.injector.get(ww,yc)||yc),this._moduleDoBootstrap(I),I))})})}bootstrapModule(u,c=[]){const h=wM({},c);return function Gb(s,o,u){const c=new sw(u);return Promise.resolve(c)}(0,0,u).then(g=>this.bootstrapModuleFactory(g,h))}_moduleDoBootstrap(u){const c=u.injector.get(bp);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(h=>c.bootstrap(h));else{if(!u.instance.ngDoBootstrap)throw new De(403,!1);u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new De(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(Hb,null);u&&(u.forEach(c=>c()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)(vr(Yl))},s.\u0275prov=dn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function wM(s,o){return Array.isArray(o)?o.reduce(wM,s):{...s,...o}}let bp=(()=>{class s{constructor(u,c,h){this._zone=u,this._injector=c,this._exceptionHandler=h,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const g=new B.y(I=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{I.next(this._stable),I.complete()})}),w=new B.y(I=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{Io.assertNotInAngularZone(),Vb(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,I.next(!0))})})});const D=this._zone.onUnstable.subscribe(()=>{Io.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{I.next(!1)}))});return()=>{C.unsubscribe(),D.unsubscribe()}});this.isStable=(0,ue.T)(g,w.pipe((0,ge.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(u,c){const h=u instanceof jg;if(!this._injector.get(vw).done)throw!h&&Tt(u),new De(405,false);let w;w=h?u:this._injector.get(m).resolveComponentFactory(u),this.componentTypes.push(w.componentType);const I=function hO(s){return s.isBoundToModule}(w)?void 0:this._injector.get(Gu),D=w.create(Yl.NULL,[],c||w.selector,I),x=D.location.nativeElement,L=D.injector.get(pM,null);return L?.registerApplication(x),D.onDestroy(()=>{this.detachView(D.hostView),Sw(this.components,D),L?.unregisterApplication(x)}),this._loadComponent(D),D}tick(){if(this._runningTick)throw new De(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;Sw(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(lM,[]).concat(this._bootstrapListeners).forEach(h=>h(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>Sw(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new De(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)(vr(Io),vr(Fa),vr(Af))},s.\u0275prov=dn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function Sw(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}let IM=!0,Yb=!1;function gO(){return Yb=!0,IM}function bM(){if(Yb)throw new Error("Cannot enable prod mode after platform setup.");IM=!1}let mO=(()=>{class s{}return s.__NG_ELEMENT_ID__=_O,s})();function _O(s){return function yO(s,o,u){if(Es(s)&&!u){const c=on(s.index,o);return new Zf(c,c)}return 47&s.type?new Zf(o[16],o):null}(Hn(),Me(),16==(16&s))}class MM{constructor(){}supports(o){return Qf(o)}create(o){return new IO(o)}}const EO=(s,o)=>o;class IO{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||EO}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,h=0,g=null;for(;u||c;){const w=!c||u&&u.currentIndex<RM(c,h,g)?u:c,I=RM(w,h,g),C=w.currentIndex;if(w===c)h--,c=c._nextRemoved;else if(u=u._next,null==w.previousIndex)h++;else{g||(g=[]);const D=I-h,x=C-h;if(D!=x){for(let q=0;q<D;q++){const se=q<g.length?g[q]:g[q]=0,Re=se+q;x<=Re&&Re<D&&(g[q]=se+1)}g[w.previousIndex]=x-D}}I!==C&&o(w,I,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Qf(o))throw new De(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let h,g,w,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let I=0;I<this.length;I++)g=o[I],w=this._trackByFn(I,g),null!==u&&Object.is(u.trackById,w)?(c&&(u=this._verifyReinsertion(u,g,w,I)),Object.is(u.item,g)||this._addIdentityChange(u,g)):(u=this._mismatch(u,g,w,I),c=!0),u=u._next}else h=0,function pS(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[sc()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,I=>{w=this._trackByFn(h,I),null!==u&&Object.is(u.trackById,w)?(c&&(u=this._verifyReinsertion(u,I,w,h)),Object.is(u.item,I)||this._addIdentityChange(u,I)):(u=this._mismatch(u,I,w,h),c=!0),u=u._next,h++}),this.length=h;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,h){let g;return null===o?g=this._itTail:(g=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,g,h)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,h))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,g,h)):o=this._addAfter(new bO(u,c),g,h),o}_verifyReinsertion(o,u,c,h){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==g?o=this._reinsertAfter(g,o._prev,h):o.currentIndex!=h&&(o.currentIndex=h,this._addToMoves(o,h)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const h=o._prevRemoved,g=o._nextRemoved;return null===h?this._removalsHead=g:h._nextRemoved=g,null===g?this._removalsTail=h:g._prevRemoved=h,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const h=null===u?this._itHead:u._next;return o._next=h,o._prev=u,null===h?this._itTail=o:h._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new xM),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new xM),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class bO{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class CO{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class xM{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new CO,this.map.set(u,c)),c.add(o)}get(o,u){const h=this.map.get(o);return h?h.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function RM(s,o,u){const c=s.previousIndex;if(null===c)return c;let h=0;return u&&c<u.length&&(h=u[c]),c+o+h}class NM{constructor(){}supports(o){return o instanceof Map||Lu(o)}create(){return new kM}}class kM{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||Lu(o)))throw new De(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,h)=>{if(u&&u.key===h)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const g=this._getOrCreateRecordForKey(h,c);u=this._insertBeforeOrAppend(u,g)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const h=this._records.get(o);this._maybeAddToChanges(h,u);const g=h._prev,w=h._next;return g&&(g._next=w),w&&(w._prev=g),h._next=null,h._prev=null,h}const c=new TO(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class TO{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function PM(){return new tC([new MM])}let tC=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const h=c.factories.slice();u=u.concat(h)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||PM()),deps:[[s,new Zi,new xl]]}}find(u){const c=this.factories.find(h=>h.supports(u));if(null!=c)return c;throw new De(901,!1)}}return s.\u0275prov=dn({token:s,providedIn:"root",factory:PM}),s})();function OM(){return new nC([new NM])}let nC=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const h=c.factories.slice();u=u.concat(h)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||OM()),deps:[[s,new Zi,new xl]]}}find(u){const c=this.factories.find(h=>h.supports(u));if(c)return c;throw new De(901,!1)}}return s.\u0275prov=dn({token:s,providedIn:"root",factory:OM}),s})();const LM=Wb(null,"core",[]);let SO=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)(vr(bp))},s.\u0275mod=ht({type:s}),s.\u0275inj=St({}),s})();function AO(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},3942:(_t,ke,F)=>{F.d(ke,{Z:()=>De});var _=F(2090),ne=F(4859),B=F(9681),ue=F(1877);class ge{constructor(Ee,fe){this._delegate=Ee,this.firebase=fe,(0,B._addComponent)(Ee,new ne.wA("app-compat",()=>this,"PUBLIC")),this.container=Ee.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ee){this._delegate.automaticDataCollectionEnabled=Ee}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Ee=>{this._delegate.checkDestroyed(),Ee()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,B.deleteApp)(this._delegate)))}_getService(Ee,fe=B._DEFAULT_ENTRY_NAME){var ft;this._delegate.checkDestroyed();const lt=this._delegate.container.getProvider(Ee);return!lt.isInitialized()&&"EXPLICIT"===(null===(ft=lt.getComponent())||void 0===ft?void 0:ft.instantiationMode)&&lt.initialize(),lt.getImmediate({identifier:fe})}_removeServiceInstance(Ee,fe=B._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Ee).clearInstance(fe)}_addComponent(Ee){(0,B._addComponent)(this._delegate,Ee)}_addOrOverwriteComponent(Ee){(0,B._addOrOverwriteComponent)(this._delegate,Ee)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ce=new _.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),$=function _e(){const it=function we(it){const Ee={},fe={__esModule:!0,initializeApp:function Pe($e,j={}){const Ce=B.initializeApp($e,j);if((0,_.r3)(Ee,Ce.name))return Ee[Ce.name];const J=new it(Ce,fe);return Ee[Ce.name]=J,J},app:lt,registerVersion:B.registerVersion,setLogLevel:B.setLogLevel,onLog:B.onLog,apps:null,SDK_VERSION:B.SDK_VERSION,INTERNAL:{registerComponent:function xe($e){const j=$e.name,Ce=j.replace("-compat","");if(B._registerComponent($e)&&"PUBLIC"===$e.type){const J=(re=lt())=>{if("function"!=typeof re[Ce])throw ce.create("invalid-app-argument",{appName:j});return re[Ce]()};void 0!==$e.serviceProps&&(0,_.ZB)(J,$e.serviceProps),fe[Ce]=J,it.prototype[Ce]=function(...re){return this._getService.bind(this,j).apply(this,$e.multipleInstances?re:[])}}return"PUBLIC"===$e.type?fe[Ce]:null},removeApp:function ft($e){delete Ee[$e]},useAsService:function Ze($e,j){return"serverAuth"===j?null:j},modularAPIs:B}};function lt($e){if(!(0,_.r3)(Ee,$e=$e||B._DEFAULT_ENTRY_NAME))throw ce.create("no-app",{appName:$e});return Ee[$e]}return fe.default=fe,Object.defineProperty(fe,"apps",{get:function Te(){return Object.keys(Ee).map($e=>Ee[$e])}}),lt.App=it,fe}(ge);return it.INTERNAL=Object.assign(Object.assign({},it.INTERNAL),{createFirebaseNamespace:_e,extendNamespace:function Ee(fe){(0,_.ZB)(it,fe)},createSubscribe:_.ne,ErrorFactory:_.LL,deepExtend:_.ZB}),it}(),W=new ue.Yd("@firebase/app-compat");if((0,_.jU)()&&void 0!==self.firebase){W.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const it=self.firebase.SDK_VERSION;it&&it.indexOf("LITE")>=0&&W.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const De=$;!function Ae(it){(0,B.registerVersion)("@firebase/app-compat","0.1.34",it)}()},9681:(_t,ke,F)=>{F.r(ke),F.d(ke,{FirebaseError:()=>ue.ZR,SDK_VERSION:()=>Yr,_DEFAULT_ENTRY_NAME:()=>Bt,_addComponent:()=>vn,_addOrOverwriteComponent:()=>dn,_apps:()=>yn,_clearComponents:()=>Mi,_components:()=>ar,_getProvider:()=>St,_registerComponent:()=>rr,_removeServiceInstance:()=>Zt,deleteApp:()=>xi,getApp:()=>Vr,getApps:()=>ur,initializeApp:()=>gr,onLog:()=>di,registerVersion:()=>Pn,setLogLevel:()=>xn});var _=F(5861),ne=F(4859),B=F(1877),ue=F(2090),ge=F(8766);class ye{constructor(G){this.container=G}getPlatformInfoString(){return this.container.getProviders().map(z=>{if(function ce(V){return"VERSION"===V.getComponent()?.type}(z)){const Ne=z.getImmediate();return`${Ne.library}/${Ne.version}`}return null}).filter(z=>z).join(" ")}}const we="@firebase/app",$=new B.Yd("@firebase/app"),Bt="[DEFAULT]",Xe={[we]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},yn=new Map,ar=new Map;function vn(V,G){try{V.container.addComponent(G)}catch(z){$.debug(`Component ${G.name} failed to register with FirebaseApp ${V.name}`,z)}}function dn(V,G){V.container.addOrOverwriteComponent(G)}function rr(V){const G=V.name;if(ar.has(G))return $.debug(`There were multiple attempts to register component ${G}.`),!1;ar.set(G,V);for(const z of yn.values())vn(z,V);return!0}function St(V,G){const z=V.container.getProvider("heartbeat").getImmediate({optional:!0});return z&&z.triggerHeartbeat(),V.container.getProvider(G)}function Zt(V,G,z=Bt){St(V,G).clearInstance(z)}function Mi(){ar.clear()}const pr=new ue.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class On{constructor(G,z,Ne){this._isDeleted=!1,this._options=Object.assign({},G),this._config=Object.assign({},z),this._name=z.name,this._automaticDataCollectionEnabled=z.automaticDataCollectionEnabled,this._container=Ne,this.container.addComponent(new ne.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(G){this.checkDestroyed(),this._automaticDataCollectionEnabled=G}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(G){this._isDeleted=G}checkDestroyed(){if(this.isDeleted)throw pr.create("app-deleted",{appName:this._name})}}const Yr="9.10.0";function gr(V,G={}){"object"!=typeof G&&(G={name:G});const z=Object.assign({name:Bt,automaticDataCollectionEnabled:!1},G),Ne=z.name;if("string"!=typeof Ne||!Ne)throw pr.create("bad-app-name",{appName:String(Ne)});const Ye=yn.get(Ne);if(Ye){if((0,ue.vZ)(V,Ye.options)&&(0,ue.vZ)(z,Ye.config))return Ye;throw pr.create("duplicate-app",{appName:Ne})}const ht=new ne.H0(Ne);for(const pn of ar.values())ht.addComponent(pn);const En=new On(V,z,ht);return yn.set(Ne,En),En}function Vr(V=Bt){const G=yn.get(V);if(!G)throw pr.create("no-app",{appName:V});return G}function ur(){return Array.from(yn.values())}function xi(V){return st.apply(this,arguments)}function st(){return(st=(0,_.Z)(function*(V){const G=V.name;yn.has(G)&&(yn.delete(G),yield Promise.all(V.container.getProviders().map(z=>z.delete())),V.isDeleted=!0)})).apply(this,arguments)}function Pn(V,G,z){var Ne;let Ye=null!==(Ne=Xe[V])&&void 0!==Ne?Ne:V;z&&(Ye+=`-${z}`);const ht=Ye.match(/\s|\//),En=G.match(/\s|\//);if(ht||En){const pn=[`Unable to register library "${Ye}" with version "${G}":`];return ht&&pn.push(`library name "${Ye}" contains illegal characters (whitespace or "/")`),ht&&En&&pn.push("and"),En&&pn.push(`version name "${G}" contains illegal characters (whitespace or "/")`),void $.warn(pn.join(" "))}rr(new ne.wA(`${Ye}-version`,()=>({library:Ye,version:G}),"VERSION"))}function di(V,G){if(null!==V&&"function"!=typeof V)throw pr.create("invalid-log-argument");(0,B.Am)(V,G)}function xn(V){(0,B.Ub)(V)}const Fn="firebase-heartbeat-store";let Gn=null;function fn(){return Gn||(Gn=(0,ge.X3)("firebase-heartbeat-database",1,{upgrade:(V,G)=>{0===G&&V.createObjectStore(Fn)}}).catch(V=>{throw pr.create("idb-open",{originalErrorMessage:V.message})})),Gn}function dt(){return(dt=(0,_.Z)(function*(V){var G;try{return(yield fn()).transaction(Fn).objectStore(Fn).get(mr(V))}catch(z){if(z instanceof ue.ZR)$.warn(z.message);else{const Ne=pr.create("idb-get",{originalErrorMessage:null===(G=z)||void 0===G?void 0:G.message});$.warn(Ne.message)}}})).apply(this,arguments)}function Gt(V,G){return wn.apply(this,arguments)}function wn(){return(wn=(0,_.Z)(function*(V,G){var z;try{const Ye=(yield fn()).transaction(Fn,"readwrite");return yield Ye.objectStore(Fn).put(G,mr(V)),Ye.done}catch(Ne){if(Ne instanceof ue.ZR)$.warn(Ne.message);else{const Ye=pr.create("idb-set",{originalErrorMessage:null===(z=Ne)||void 0===z?void 0:z.message});$.warn(Ye.message)}}})).apply(this,arguments)}function mr(V){return`${V.name}!${V.options.appId}`}class Qr{constructor(G){this.container=G,this._heartbeatsCache=null;const z=this.container.getProvider("app").getImmediate();this._storage=new sn(z),this._heartbeatsCachePromise=this._storage.read().then(Ne=>(this._heartbeatsCache=Ne,Ne))}triggerHeartbeat(){var G=this;return(0,_.Z)(function*(){const Ne=G.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Ye=un();if(null===G._heartbeatsCache&&(G._heartbeatsCache=yield G._heartbeatsCachePromise),G._heartbeatsCache.lastSentHeartbeatDate!==Ye&&!G._heartbeatsCache.heartbeats.some(ht=>ht.date===Ye))return G._heartbeatsCache.heartbeats.push({date:Ye,agent:Ne}),G._heartbeatsCache.heartbeats=G._heartbeatsCache.heartbeats.filter(ht=>{const En=new Date(ht.date).valueOf();return Date.now()-En<=2592e6}),G._storage.overwrite(G._heartbeatsCache)})()}getHeartbeatsHeader(){var G=this;return(0,_.Z)(function*(){if(null===G._heartbeatsCache&&(yield G._heartbeatsCachePromise),null===G._heartbeatsCache||0===G._heartbeatsCache.heartbeats.length)return"";const z=un(),{heartbeatsToSend:Ne,unsentEntries:Ye}=function Dr(V,G=1024){const z=[];let Ne=V.slice();for(const Ye of V){const ht=z.find(En=>En.agent===Ye.agent);if(ht){if(ht.dates.push(Ye.date),Y(z)>G){ht.dates.pop();break}}else if(z.push({agent:Ye.agent,dates:[Ye.date]}),Y(z)>G){z.pop();break}Ne=Ne.slice(1)}return{heartbeatsToSend:z,unsentEntries:Ne}}(G._heartbeatsCache.heartbeats),ht=(0,ue.L)(JSON.stringify({version:2,heartbeats:Ne}));return G._heartbeatsCache.lastSentHeartbeatDate=z,Ye.length>0?(G._heartbeatsCache.heartbeats=Ye,yield G._storage.overwrite(G._heartbeatsCache)):(G._heartbeatsCache.heartbeats=[],G._storage.overwrite(G._heartbeatsCache)),ht})()}}function un(){return(new Date).toISOString().substring(0,10)}class sn{constructor(G){this.app=G,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,_.Z)(function*(){return!!(0,ue.hl)()&&(0,ue.eu)().then(()=>!0).catch(()=>!1)})()}read(){var G=this;return(0,_.Z)(function*(){return(yield G._canUseIndexedDBPromise)&&(yield function yt(V){return dt.apply(this,arguments)}(G.app))||{heartbeats:[]}})()}overwrite(G){var z=this;return(0,_.Z)(function*(){var Ne;if(yield z._canUseIndexedDBPromise){const ht=yield z.read();return Gt(z.app,{lastSentHeartbeatDate:null!==(Ne=G.lastSentHeartbeatDate)&&void 0!==Ne?Ne:ht.lastSentHeartbeatDate,heartbeats:G.heartbeats})}})()}add(G){var z=this;return(0,_.Z)(function*(){var Ne;if(yield z._canUseIndexedDBPromise){const ht=yield z.read();return Gt(z.app,{lastSentHeartbeatDate:null!==(Ne=G.lastSentHeartbeatDate)&&void 0!==Ne?Ne:ht.lastSentHeartbeatDate,heartbeats:[...ht.heartbeats,...G.heartbeats]})}})()}}function Y(V){return(0,ue.L)(JSON.stringify({version:2,heartbeats:V})).length}!function H(V){rr(new ne.wA("platform-logger",G=>new ye(G),"PRIVATE")),rr(new ne.wA("heartbeat",G=>new Qr(G),"PRIVATE")),Pn(we,"0.7.33",V),Pn(we,"0.7.33","esm2017"),Pn("fire-js","")}("")},4859:(_t,ke,F)=>{F.d(ke,{H0:()=>we,wA:()=>B,zt:()=>ge});var _=F(5861),ne=F(2090);class B{constructor($,W,te){this.name=$,this.instanceFactory=W,this.type=te,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode($){return this.instantiationMode=$,this}setMultipleInstances($){return this.multipleInstances=$,this}setServiceProps($){return this.serviceProps=$,this}setInstanceCreatedCallback($){return this.onInstanceCreated=$,this}}const ue="[DEFAULT]";class ge{constructor($,W){this.name=$,this.container=W,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get($){const W=this.normalizeInstanceIdentifier($);if(!this.instancesDeferred.has(W)){const te=new ne.BH;if(this.instancesDeferred.set(W,te),this.isInitialized(W)||this.shouldAutoInitialize())try{const Le=this.getOrInitializeService({instanceIdentifier:W});Le&&te.resolve(Le)}catch{}}return this.instancesDeferred.get(W).promise}getImmediate($){var W;const te=this.normalizeInstanceIdentifier($?.identifier),Le=null!==(W=$?.optional)&&void 0!==W&&W;if(!this.isInitialized(te)&&!this.shouldAutoInitialize()){if(Le)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:te})}catch(Ae){if(Le)return null;throw Ae}}getComponent(){return this.component}setComponent($){if($.name!==this.name)throw Error(`Mismatching Component ${$.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=$,this.shouldAutoInitialize()){if(function ce(_e){return"EAGER"===_e.instantiationMode}($))try{this.getOrInitializeService({instanceIdentifier:ue})}catch{}for(const[W,te]of this.instancesDeferred.entries()){const Le=this.normalizeInstanceIdentifier(W);try{const Ae=this.getOrInitializeService({instanceIdentifier:Le});te.resolve(Ae)}catch{}}}}clearInstance($=ue){this.instancesDeferred.delete($),this.instancesOptions.delete($),this.instances.delete($)}delete(){var $=this;return(0,_.Z)(function*(){const W=Array.from($.instances.values());yield Promise.all([...W.filter(te=>"INTERNAL"in te).map(te=>te.INTERNAL.delete()),...W.filter(te=>"_delete"in te).map(te=>te._delete())])})()}isComponentSet(){return null!=this.component}isInitialized($=ue){return this.instances.has($)}getOptions($=ue){return this.instancesOptions.get($)||{}}initialize($={}){const{options:W={}}=$,te=this.normalizeInstanceIdentifier($.instanceIdentifier);if(this.isInitialized(te))throw Error(`${this.name}(${te}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Le=this.getOrInitializeService({instanceIdentifier:te,options:W});for(const[Ae,De]of this.instancesDeferred.entries())te===this.normalizeInstanceIdentifier(Ae)&&De.resolve(Le);return Le}onInit($,W){var te;const Le=this.normalizeInstanceIdentifier(W),Ae=null!==(te=this.onInitCallbacks.get(Le))&&void 0!==te?te:new Set;Ae.add($),this.onInitCallbacks.set(Le,Ae);const De=this.instances.get(Le);return De&&$(De,Le),()=>{Ae.delete($)}}invokeOnInitCallbacks($,W){const te=this.onInitCallbacks.get(W);if(te)for(const Le of te)try{Le($,W)}catch{}}getOrInitializeService({instanceIdentifier:$,options:W={}}){let te=this.instances.get($);if(!te&&this.component&&(te=this.component.instanceFactory(this.container,{instanceIdentifier:(_e=$,_e===ue?void 0:_e),options:W}),this.instances.set($,te),this.instancesOptions.set($,W),this.invokeOnInitCallbacks(te,$),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,$,te)}catch{}var _e;return te||null}normalizeInstanceIdentifier($=ue){return this.component?this.component.multipleInstances?$:ue:$}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class we{constructor($){this.name=$,this.providers=new Map}addComponent($){const W=this.getProvider($.name);if(W.isComponentSet())throw new Error(`Component ${$.name} has already been registered with ${this.name}`);W.setComponent($)}addOrOverwriteComponent($){this.getProvider($.name).isComponentSet()&&this.providers.delete($.name),this.addComponent($)}getProvider($){if(this.providers.has($))return this.providers.get($);const W=new ge($,this);return this.providers.set($,W),W}getProviders(){return Array.from(this.providers.values())}}},2833:(_t,ke,F)=>{var _=F(5861),ne=F(9681),B=F(4859),ue=F(2090),ge=F(8766);const ye="@firebase/installations",ce="0.5.12",_e=`w:${ce}`,$="FIS_v2",it=new ue.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Ee(X){return X instanceof ue.ZR&&X.code.includes("request-failed")}function fe({projectId:X}){return`https://firebaseinstallations.googleapis.com/v1/projects/${X}/installations`}function ft(X){return{token:X.token,requestStatus:2,expiresIn:j(X.expiresIn),creationTime:Date.now()}}function lt(X,Ie){return Pe.apply(this,arguments)}function Pe(){return(Pe=(0,_.Z)(function*(X,Ie){const pt=(yield Ie.json()).error;return it.create("request-failed",{requestName:X,serverCode:pt.code,serverMessage:pt.message,serverStatus:pt.status})})).apply(this,arguments)}function Te({apiKey:X}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":X})}function xe(X,{refreshToken:Ie}){const He=Te(X);return He.append("Authorization",function Ce(X){return`${$} ${X}`}(Ie)),He}function Ze(X){return $e.apply(this,arguments)}function $e(){return($e=(0,_.Z)(function*(X){const Ie=yield X();return Ie.status>=500&&Ie.status<600?X():Ie})).apply(this,arguments)}function j(X){return Number(X.replace("s","000"))}function J(X,Ie){return re.apply(this,arguments)}function re(){return(re=(0,_.Z)(function*({appConfig:X,heartbeatServiceProvider:Ie},{fid:He}){const pt=fe(X),Yt=Te(X),hn=Ie.getImmediate({optional:!0});if(hn){const xr=yield hn.getHeartbeatsHeader();xr&&Yt.append("x-firebase-client",xr)}const In={method:"POST",headers:Yt,body:JSON.stringify({fid:He,authVersion:$,appId:X.appId,sdkVersion:_e})},Xr=yield Ze(()=>fetch(pt,In));if(Xr.ok){const xr=yield Xr.json();return{fid:xr.fid||He,registrationStatus:2,refreshToken:xr.refreshToken,authToken:ft(xr.authToken)}}throw yield lt("Create Installation",Xr)})).apply(this,arguments)}function le(X){return new Promise(Ie=>{setTimeout(Ie,X)})}const We=/^[cdef][\w-]{21}$/;function mt(){try{const X=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(X),X[0]=112+X[0]%16;const He=function rn(X){return function ie(X){return btoa(String.fromCharCode(...X)).replace(/\+/g,"-").replace(/\//g,"_")}(X).substr(0,22)}(X);return We.test(He)?He:""}catch{return""}}function Bt(X){return`${X.appName}!${X.appId}`}const Xe=new Map;function yn(X,Ie){const He=Bt(X);dn(He,Ie),function rr(X,Ie){const He=function Zt(){return!St&&"BroadcastChannel"in self&&(St=new BroadcastChannel("[Firebase] FID Change"),St.onmessage=X=>{dn(X.data.key,X.data.fid)}),St}();He&&He.postMessage({key:X,fid:Ie}),function Mi(){0===Xe.size&&St&&(St.close(),St=null)}()}(He,Ie)}function dn(X,Ie){const He=Xe.get(X);if(He)for(const pt of He)pt(Ie)}let St=null;const On="firebase-installations-store";let Yr=null;function gr(){return Yr||(Yr=(0,ge.X3)("firebase-installations-database",1,{upgrade:(X,Ie)=>{0===Ie&&X.createObjectStore(On)}})),Yr}function Vr(X,Ie){return ur.apply(this,arguments)}function ur(){return(ur=(0,_.Z)(function*(X,Ie){const He=Bt(X),Yt=(yield gr()).transaction(On,"readwrite"),hn=Yt.objectStore(On),Qn=yield hn.get(He);return yield hn.put(Ie,He),yield Yt.done,(!Qn||Qn.fid!==Ie.fid)&&yn(X,Ie.fid),Ie})).apply(this,arguments)}function xi(X){return st.apply(this,arguments)}function st(){return(st=(0,_.Z)(function*(X){const Ie=Bt(X),pt=(yield gr()).transaction(On,"readwrite");yield pt.objectStore(On).delete(Ie),yield pt.done})).apply(this,arguments)}function Pn(X,Ie){return di.apply(this,arguments)}function di(){return(di=(0,_.Z)(function*(X,Ie){const He=Bt(X),Yt=(yield gr()).transaction(On,"readwrite"),hn=Yt.objectStore(On),Qn=yield hn.get(He),In=Ie(Qn);return void 0===In?yield hn.delete(He):yield hn.put(In,He),yield Yt.done,In&&(!Qn||Qn.fid!==In.fid)&&yn(X,In.fid),In})).apply(this,arguments)}function xn(X){return jr.apply(this,arguments)}function jr(){return(jr=(0,_.Z)(function*(X){let Ie;const He=yield Pn(X.appConfig,pt=>{const Yt=$n(pt),hn=Fn(X,Yt);return Ie=hn.registrationPromise,hn.installationEntry});return""===He.fid?{installationEntry:yield Ie}:{installationEntry:He,registrationPromise:Ie}})).apply(this,arguments)}function $n(X){return wn(X||{fid:mt(),registrationStatus:0})}function Fn(X,Ie){if(0===Ie.registrationStatus){if(!navigator.onLine)return{installationEntry:Ie,registrationPromise:Promise.reject(it.create("app-offline"))};const He={fid:Ie.fid,registrationStatus:1,registrationTime:Date.now()},pt=function Gn(X,Ie){return fn.apply(this,arguments)}(X,He);return{installationEntry:He,registrationPromise:pt}}return 1===Ie.registrationStatus?{installationEntry:Ie,registrationPromise:yt(X)}:{installationEntry:Ie}}function fn(){return(fn=(0,_.Z)(function*(X,Ie){try{const He=yield J(X,Ie);return Vr(X.appConfig,He)}catch(He){throw Ee(He)&&409===He.customData.serverCode?yield xi(X.appConfig):yield Vr(X.appConfig,{fid:Ie.fid,registrationStatus:0}),He}})).apply(this,arguments)}function yt(X){return dt.apply(this,arguments)}function dt(){return(dt=(0,_.Z)(function*(X){let Ie=yield Gt(X.appConfig);for(;1===Ie.registrationStatus;)yield le(100),Ie=yield Gt(X.appConfig);if(0===Ie.registrationStatus){const{installationEntry:He,registrationPromise:pt}=yield xn(X);return pt||He}return Ie})).apply(this,arguments)}function Gt(X){return Pn(X,Ie=>{if(!Ie)throw it.create("installation-not-found");return wn(Ie)})}function wn(X){return function mr(X){return 1===X.registrationStatus&&X.registrationTime+1e4<Date.now()}(X)?{fid:X.fid,registrationStatus:0}:X}function lr(X,Ie){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,_.Z)(function*({appConfig:X,heartbeatServiceProvider:Ie},He){const pt=Qr(X,He),Yt=xe(X,He),hn=Ie.getImmediate({optional:!0});if(hn){const xr=yield hn.getHeartbeatsHeader();xr&&Yt.append("x-firebase-client",xr)}const In={method:"POST",headers:Yt,body:JSON.stringify({installation:{sdkVersion:_e,appId:X.appId}})},Xr=yield Ze(()=>fetch(pt,In));if(Xr.ok)return ft(yield Xr.json());throw yield lt("Generate Auth Token",Xr)})).apply(this,arguments)}function Qr(X,{fid:Ie}){return`${fe(X)}/${Ie}/authTokens:generate`}function un(X){return Dr.apply(this,arguments)}function Dr(){return(Dr=(0,_.Z)(function*(X,Ie=!1){let He;const pt=yield Pn(X.appConfig,hn=>{if(!z(hn))throw it.create("not-registered");const Qn=hn.authToken;if(!Ie&&Ne(Qn))return hn;if(1===Qn.requestStatus)return He=sn(X,Ie),hn;{if(!navigator.onLine)throw it.create("app-offline");const In=ht(hn);return He=V(X,In),In}});return He?yield He:pt.authToken})).apply(this,arguments)}function sn(X,Ie){return Y.apply(this,arguments)}function Y(){return(Y=(0,_.Z)(function*(X,Ie){let He=yield H(X.appConfig);for(;1===He.authToken.requestStatus;)yield le(100),He=yield H(X.appConfig);const pt=He.authToken;return 0===pt.requestStatus?un(X,Ie):pt})).apply(this,arguments)}function H(X){return Pn(X,Ie=>{if(!z(Ie))throw it.create("not-registered");return function En(X){return 1===X.requestStatus&&X.requestTime+1e4<Date.now()}(Ie.authToken)?Object.assign(Object.assign({},Ie),{authToken:{requestStatus:0}}):Ie})}function V(X,Ie){return G.apply(this,arguments)}function G(){return(G=(0,_.Z)(function*(X,Ie){try{const He=yield lr(X,Ie),pt=Object.assign(Object.assign({},Ie),{authToken:He});return yield Vr(X.appConfig,pt),He}catch(He){if(!Ee(He)||401!==He.customData.serverCode&&404!==He.customData.serverCode){const pt=Object.assign(Object.assign({},Ie),{authToken:{requestStatus:0}});yield Vr(X.appConfig,pt)}else yield xi(X.appConfig);throw He}})).apply(this,arguments)}function z(X){return void 0!==X&&2===X.registrationStatus}function Ne(X){return 2===X.requestStatus&&!function Ye(X){const Ie=Date.now();return Ie<X.creationTime||X.creationTime+X.expiresIn<Ie+36e5}(X)}function ht(X){const Ie={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},X),{authToken:Ie})}function ae(){return(ae=(0,_.Z)(function*(X){const Ie=X,{installationEntry:He,registrationPromise:pt}=yield xn(Ie);return pt?pt.catch(console.error):un(Ie).catch(console.error),He.fid})).apply(this,arguments)}function Se(){return(Se=(0,_.Z)(function*(X,Ie=!1){const He=X;return yield Be(He),(yield un(He,Ie)).token})).apply(this,arguments)}function Be(X){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,_.Z)(function*(X){const{registrationPromise:Ie}=yield xn(X);Ie&&(yield Ie)})).apply(this,arguments)}function mn(X){return it.create("missing-app-config-values",{valueName:X})}const Ri="installations",$i=X=>{const Ie=X.getProvider("app").getImmediate(),He=function Yn(X){if(!X||!X.options)throw mn("App Configuration");if(!X.name)throw mn("App Name");const Ie=["projectId","apiKey","appId"];for(const He of Ie)if(!X.options[He])throw mn(He);return{appName:X.name,projectId:X.options.projectId,apiKey:X.options.apiKey,appId:X.options.appId}}(Ie);return{app:Ie,appConfig:He,heartbeatServiceProvider:(0,ne._getProvider)(Ie,"heartbeat"),_delete:()=>Promise.resolve()}},vs=X=>{const Ie=X.getProvider("app").getImmediate(),He=(0,ne._getProvider)(Ie,Ri).getImmediate();return{getId:()=>function pn(X){return ae.apply(this,arguments)}(He),getToken:Yt=>function pe(X){return Se.apply(this,arguments)}(He,Yt)}};(function $t(){(0,ne._registerComponent)(new B.wA(Ri,$i,"PUBLIC")),(0,ne._registerComponent)(new B.wA("installations-internal",vs,"PRIVATE"))})(),(0,ne.registerVersion)(ye,ce),(0,ne.registerVersion)(ye,ce,"esm2017")},1877:(_t,ke,F)=>{F.d(ke,{Am:()=>_e,Ub:()=>we,Yd:()=>ce,in:()=>ne});const _=[];var ne=(()=>{return($=ne||(ne={}))[$.DEBUG=0]="DEBUG",$[$.VERBOSE=1]="VERBOSE",$[$.INFO=2]="INFO",$[$.WARN=3]="WARN",$[$.ERROR=4]="ERROR",$[$.SILENT=5]="SILENT",ne;var $})();const B={debug:ne.DEBUG,verbose:ne.VERBOSE,info:ne.INFO,warn:ne.WARN,error:ne.ERROR,silent:ne.SILENT},ue=ne.INFO,ge={[ne.DEBUG]:"log",[ne.VERBOSE]:"log",[ne.INFO]:"info",[ne.WARN]:"warn",[ne.ERROR]:"error"},ye=($,W,...te)=>{if(W<$.logLevel)return;const Le=(new Date).toISOString(),Ae=ge[W];if(!Ae)throw new Error(`Attempted to log a message with an invalid logType (value: ${W})`);console[Ae](`[${Le}]  ${$.name}:`,...te)};class ce{constructor(W){this.name=W,this._logLevel=ue,this._logHandler=ye,this._userLogHandler=null,_.push(this)}get logLevel(){return this._logLevel}set logLevel(W){if(!(W in ne))throw new TypeError(`Invalid value "${W}" assigned to \`logLevel\``);this._logLevel=W}setLogLevel(W){this._logLevel="string"==typeof W?B[W]:W}get logHandler(){return this._logHandler}set logHandler(W){if("function"!=typeof W)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=W}get userLogHandler(){return this._userLogHandler}set userLogHandler(W){this._userLogHandler=W}debug(...W){this._userLogHandler&&this._userLogHandler(this,ne.DEBUG,...W),this._logHandler(this,ne.DEBUG,...W)}log(...W){this._userLogHandler&&this._userLogHandler(this,ne.VERBOSE,...W),this._logHandler(this,ne.VERBOSE,...W)}info(...W){this._userLogHandler&&this._userLogHandler(this,ne.INFO,...W),this._logHandler(this,ne.INFO,...W)}warn(...W){this._userLogHandler&&this._userLogHandler(this,ne.WARN,...W),this._logHandler(this,ne.WARN,...W)}error(...W){this._userLogHandler&&this._userLogHandler(this,ne.ERROR,...W),this._logHandler(this,ne.ERROR,...W)}}function we($){_.forEach(W=>{W.setLogLevel($)})}function _e($,W){for(const te of _){let Le=null;W&&W.level&&(Le=B[W.level]),te.userLogHandler=null===$?null:(Ae,De,...it)=>{const Ee=it.map(fe=>{if(null==fe)return null;if("string"==typeof fe)return fe;if("number"==typeof fe||"boolean"==typeof fe)return fe.toString();if(fe instanceof Error)return fe.message;try{return JSON.stringify(fe)}catch{return null}}).filter(fe=>fe).join(" ");De>=(Le??Ae.logLevel)&&$({level:ne[De].toLowerCase(),message:Ee,args:it,type:Ae.name})}}}},8766:(_t,ke,F)=>{F.d(ke,{Lj:()=>Pe,X3:()=>lt});var _=F(5861);let B,ue;const ce=new WeakMap,we=new WeakMap,_e=new WeakMap,$=new WeakMap,W=new WeakMap;let Ae={get(j,Ce,J){if(j instanceof IDBTransaction){if("done"===Ce)return we.get(j);if("objectStoreNames"===Ce)return j.objectStoreNames||_e.get(j);if("store"===Ce)return J.objectStoreNames[1]?void 0:J.objectStore(J.objectStoreNames[0])}return fe(j[Ce])},set:(j,Ce,J)=>(j[Ce]=J,!0),has:(j,Ce)=>j instanceof IDBTransaction&&("done"===Ce||"store"===Ce)||Ce in j};function Ee(j){return"function"==typeof j?function it(j){return j!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ye(){return ue||(ue=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(j)?function(...Ce){return j.apply(ft(this),Ce),fe(ce.get(this))}:function(...Ce){return fe(j.apply(ft(this),Ce))}:function(Ce,...J){const re=j.call(ft(this),Ce,...J);return _e.set(re,Ce.sort?Ce.sort():[Ce]),fe(re)}}(j):(j instanceof IDBTransaction&&function Le(j){if(we.has(j))return;const Ce=new Promise((J,re)=>{const le=()=>{j.removeEventListener("complete",ie),j.removeEventListener("error",We),j.removeEventListener("abort",We)},ie=()=>{J(),le()},We=()=>{re(j.error||new DOMException("AbortError","AbortError")),le()};j.addEventListener("complete",ie),j.addEventListener("error",We),j.addEventListener("abort",We)});we.set(j,Ce)}(j),((j,Ce)=>Ce.some(J=>j instanceof J))(j,function ge(){return B||(B=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(j,Ae):j)}function fe(j){if(j instanceof IDBRequest)return function te(j){const Ce=new Promise((J,re)=>{const le=()=>{j.removeEventListener("success",ie),j.removeEventListener("error",We)},ie=()=>{J(fe(j.result)),le()},We=()=>{re(j.error),le()};j.addEventListener("success",ie),j.addEventListener("error",We)});return Ce.then(J=>{J instanceof IDBCursor&&ce.set(J,j)}).catch(()=>{}),W.set(Ce,j),Ce}(j);if($.has(j))return $.get(j);const Ce=Ee(j);return Ce!==j&&($.set(j,Ce),W.set(Ce,j)),Ce}const ft=j=>W.get(j);function lt(j,Ce,{blocked:J,upgrade:re,blocking:le,terminated:ie}={}){const We=indexedDB.open(j,Ce),je=fe(We);return re&&We.addEventListener("upgradeneeded",mt=>{re(fe(We.result),mt.oldVersion,mt.newVersion,fe(We.transaction))}),J&&We.addEventListener("blocked",()=>J()),je.then(mt=>{ie&&mt.addEventListener("close",()=>ie()),le&&mt.addEventListener("versionchange",()=>le())}).catch(()=>{}),je}function Pe(j,{blocked:Ce}={}){const J=indexedDB.deleteDatabase(j);return Ce&&J.addEventListener("blocked",()=>Ce()),fe(J).then(()=>{})}const Te=["get","getKey","getAll","getAllKeys","count"],xe=["put","add","delete","clear"],Ze=new Map;function $e(j,Ce){if(!(j instanceof IDBDatabase)||Ce in j||"string"!=typeof Ce)return;if(Ze.get(Ce))return Ze.get(Ce);const J=Ce.replace(/FromIndex$/,""),re=Ce!==J,le=xe.includes(J);if(!(J in(re?IDBIndex:IDBObjectStore).prototype)||!le&&!Te.includes(J))return;const ie=function(){var We=(0,_.Z)(function*(je,...mt){const rn=this.transaction(je,le?"readwrite":"readonly");let Bt=rn.store;return re&&(Bt=Bt.index(mt.shift())),(yield Promise.all([Bt[J](...mt),le&&rn.done]))[0]});return function(mt){return We.apply(this,arguments)}}();return Ze.set(Ce,ie),ie}!function De(j){Ae=j(Ae)}(j=>({...j,get:(Ce,J,re)=>$e(Ce,J)||j.get(Ce,J,re),has:(Ce,J)=>!!$e(Ce,J)||j.has(Ce,J)}))},5861:(_t,ke,F)=>{function _(B,ue,ge,ye,ce,we,_e){try{var $=B[we](_e),W=$.value}catch(te){return void ge(te)}$.done?ue(W):Promise.resolve(W).then(ye,ce)}function ne(B){return function(){var ue=this,ge=arguments;return new Promise(function(ye,ce){var we=B.apply(ue,ge);function _e(W){_(we,ye,ce,_e,$,"next",W)}function $(W){_(we,ye,ce,_e,$,"throw",W)}_e(void 0)})}}F.d(ke,{Z:()=>ne})}},_t=>{_t(_t.s=5488)}]);